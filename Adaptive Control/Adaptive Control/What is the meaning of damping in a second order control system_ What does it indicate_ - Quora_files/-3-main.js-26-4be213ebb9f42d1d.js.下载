/**
 * Name: main.js
 * Generated: 1487706739639350
 */
define("third_party/json2",["shared/polyfills"],function third_party_json2(require,exports,module){"object"!=typeof JSON&&(window.JSON={}),function(){"use strict";function f(e){return 10>e?"0"+e:e}function this_value(){return this.valueOf()}function quote(e){return rx_escapable.lastIndex=0,rx_escapable.test(e)?'"'+e.replace(rx_escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var i,n,o,s,a,r=gap,d=t[e];switch(d&&"object"==typeof d&&"function"==typeof d.toJSON&&(d=d.toJSON(e)),"function"==typeof rep&&(d=rep.call(t,e,d)),typeof d){case"string":return quote(d);case"number":return isFinite(d)?String(d):"null";case"boolean":case"null":return String(d);case"object":if(!d)return"null";if(gap+=indent,a=[],"[object Array]"===Object.prototype.toString.apply(d)){for(s=d.length,i=0;s>i;i+=1)a[i]=str(i,d)||"null";return o=0===a.length?"[]":gap?"[\n"+gap+a.join(",\n"+gap)+"\n"+r+"]":"["+a.join(",")+"]",
gap=r,o}if(rep&&"object"==typeof rep)for(s=rep.length,i=0;s>i;i+=1)"string"==typeof rep[i]&&(n=rep[i],o=str(n,d),o&&a.push(quote(n)+(gap?": ":":")+o));else for(n in d)Object.prototype.hasOwnProperty.call(d,n)&&(o=str(n,d),o&&a.push(quote(n)+(gap?": ":":")+o));return o=0===a.length?"{}":gap?"{\n"+gap+a.join(",\n"+gap)+"\n"+r+"}":"{"+a.join(",")+"}",gap=r,o}}var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null;
},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value);var gap,indent,meta,rep;"function"!=typeof JSON.stringify&&(meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,i){var n;if(gap="",indent="","number"==typeof i)for(n=0;i>n;n+=1)indent+=" ";else"string"==typeof i&&(indent=i);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var i,n,o=e[t];if(o&&"object"==typeof o)for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n=walk(o,i),void 0!==n?o[i]=n:delete o[i]);return reviver.call(e,t,o)}var j;if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),
"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}()}),define("shared/util",["shared/polyfills","shared/errors"],function(e,t,i){var n=e("shared/errors");t.extend=function(e,t){e=e||{};for(var i=1;i<arguments.length;i++)if(arguments[i])for(var n in arguments[i])arguments[i].hasOwnProperty(n)&&(e[n]=arguments[i][n]);return e},t.documentFragmentFromString=function(e){var t=document.createElement("div");t.innerHTML=e;for(var i=document.createDocumentFragment(),n=t.firstChild,o=null;n;)o=n.nextSibling,i.appendChild(n),n=o;return i};var o=t.isPlainObject=function(e){if("[object Object]"!=Object.prototype.toString.call(e))return!1;var t=e.constructor;if("function"!=typeof t)return!1;var i=t.prototype;return"[object Object]"!=Object.prototype.toString.call(i)?!1:i.hasOwnProperty("isPrototypeOf")===!1?!1:!0},s=t.cloneObject=function(e){if(!Array.isArray(e)&&!o(e))return e;for(var t=e.constructor(),i=Object.keys(e),n=0;n<i.length;n++){var a=i[n];t[a]=s(e[a])}return t;
};t.firstScrollingParent=function(e){var t=null;for(e&&(t=e.parentNode);t&&t!==document.body;){var i=window.getComputedStyle(t);if(i){var n=i.getPropertyValue("overflow-y");if("scroll"==n||"auto"==n)return t}t=t.parentNode}return document.body},t.makeEnum=function(e){var t={},i=Array.isArray(e);for(var n in e)e.hasOwnProperty(n)&&(n=i?e[n]:n,t[n]=n);return t},t.once=function(e){var t;return function(){t||(t=!0,e.apply(this,arguments))}};var a=0;t.randomId=function(e){return e=e||"",[e,a++,Math.floor(4294967296*Math.random())].join("-")},t.escapeHTML=function(e){return e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;")},t.iterItems=function(e,t){if(!o(e))return void n.logJsError("util.iterItems expects a plain object. got "+e);for(var i=Object.keys(e),s=0;s<i.length;s++)t.call(null,i[s],e[i[s]])},t.getLocation=function(e){var t=e.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)([\/]{0,1}[^?#]*)(\?[^#]*|)(#.*|)$/);return t&&{protocol:t[1],host:t[2],hostname:t[3],
port:t[4],pathname:t[5],search:t[6],hash:t[7]}}}),define("shared/log.settings",["shared/polyfills","gating"],function(e,t,i){t.resetSettings=function(t){var i,n,o=e("gating").client_side_logging;if(t.enable(!!o),o){t.scopes.resetLevel("",t.level.error);for(i in o)n=o[i],t.scopes.resetLevel(i,t.level[n])}}}),define("shared/log",["shared/polyfills","shared/util","shared/log.settings"],function(e,t,i){!function(i){var n=new Date,o=function(e){return Array.prototype.join.call(e," ")},s=e("shared/util"),a=i.log=t.log=function(){return a.log.apply(a,arguments)},r=i.console,d=r||{},l=window&&"Microsoft Internet Explorer"==window.navigator.appName;if(l){var c=/MSIE ([0-9]{1,}[.0-9]{0,})/;null!==c.exec(window.navigator.userAgent)&&parseFloat(RegExp.$1)>=8?(d={},d.log=function(){r&&r.log&&r.log(o(arguments))},d.info=function(){r&&r.log&&r.info(o(arguments))},d.warn=function(){r&&r.log&&r.warn(o(arguments))},d.error=function(){r&&r.log&&r.error(o(arguments))}):d={}}var h=["log","info","warn","error"],u=function(){};
for(var p in h){var f=h[p];d[f]||(d[f]=u)}var _=function(e){void 0===e&&(e=null),this.level=e,this.children={}};_.prototype.setLevel=function(e,t,i){var n=this.tryGetChild(e,i);return null===n?(void 0===t&&(t=null),void(this.level=t)):(void 0===n.child&&(this.children[n.name]=n.child=new _),n.child.setLevel(e,t,n.continueFrom),void this.optimize(n.name))},_.prototype.removeChildren=function(e,t){var i=this.tryGetChild(e,t);return null===i?void(this.children={}):void(void 0!==i.child&&(i.child.removeChildren(e,i.continueFrom),this.optimize(i.name)))},_.prototype.optimize=function(e){var t=this.children[e];void 0!==t&&null===t.level&&0===t.childCount()&&delete this.children[e]},_.prototype.childCount=function(){var e=0;for(var t in this.children)this.children.hasOwnProperty(t)&&e++;return e},_.prototype.getLevel=function(e,t){var i=this.tryGetChild(e,t);if(null===i||void 0===i.child)return this.level;var n=i.child.getLevel(e,i.continueFrom);return null!==n?n:this.level},_.prototype.print=function(e,t,i){
var n=null===this.level?i:this.level;a.console.log(e+t+": "+a.level.toString(n)+(null===this.level?" (inherited)":""));for(t in this.children){var o=this.children[t];o.print(e+"  ",t,n)}},_.prototype.tryGetChild=function(e,t){if("string"!=typeof e)throw new Error("Scope must be string.");if(t=t||0,t>=e.length)return null;var i=e.indexOf(".",t),n=null;return 0>i?(i=e.length,n=e.substr(t,i-t)):(n=e.substr(t,i-t),i++),{name:n,child:this.children[n],continueFrom:i}};var g=function(e,t,i){this.time=new Date,this.level=e,this.scope=t,this.data=i,this.message=o(i)};g.prototype.toString=function(){return a.level.toString(this.level).concat(" ",this._timeToString(),", ",this.scope,": ",this.message)},g.prototype.print=function(){var e="trace"==this.level?"log":this.level;a.console[a.level.toString(e)].apply(a.console,[this._timeToString()+", "+this.scope+":"].concat(this.data))},g.prototype.checkScope=function(e){return this.scope==e||this.scope.startsWith(e+".")},g.prototype._timeToString=function(){
return((this.time-n)/1e3).toString()+"s"};var m=function(e){this.list=e||[]};m.prototype.toString=function(){return this.list.join("\r\n")},m.prototype.print=function(){for(var e in this.list)this.list[e].print()},m.prototype.add=function(e){return this.list.push(e)},m.prototype.count=function(){return this.list.length},m.prototype.getLast=function(){return 0===this.list.length?null:this.list[this.list.length-1]},m.prototype.clear=function(){this.list=[]},m.prototype.filter=function(e,t){var i,n;if("function"==typeof e)return i=Array.prototype.filter.apply(this.list,arguments),new m(i);void 0===t&&"string"==typeof e&&(t=e,e=null);var o="number"==typeof e;if(!o){var s={};for(n in e)s[e[n]]=e[n];e=s}i=[];for(n in this.list){var a=this.list[n];(null===e||void 0===e||(o?!(a.level<e):a.level in e))&&(null===t||void 0===t||a.checkScope(t))&&i.push(a)}return new m(i)};var v={enabled:null,outputEnabled:!0,entries:new m,level:{none:0,trace:1,log:2,info:3,warn:4,error:5,toString:function(e){switch(e){
case 0:return"none";case 1:return"trace";case 2:return"log";case 3:return"info";case 4:return"warn";case 5:return"error";default:throw new Error("Unknown log.level value.")}}},scopes:{root:new _(0),cache:{},setLevel:function(e,t){this.root.setLevel(e,t),this.cache={}},resetLevel:function(e,t){this.root.removeChildren(e),this.root.setLevel(e,t),this.cache={}},removeChildren:function(e){this.root.removeChildren(e),this.cache={}},getLevel:function(e){return void 0===this.cache[e]&&(this.cache[e]=this.root.getLevel(e)||a.level.none),this.cache[e]},hasLevel:function(e,t){var i=this.getLevel(e);return t>=i&&i!=a.level.none},print:function(e){a.console.log("Log scopes:"),this.root.print("  ","(root)")}},enabledImpl:{console:d,trace:function(e){var t=this._tryAddLogEntry(a.level.log,e,Array.prototype.slice.call(arguments,1));return null===t?null:(a.outputEnabled&&(a.console.trace?a.console.trace():a.console.log.call(a.console,("Stack trace:\r\n"+a._getStackTrace()).replace("\r\n","\r\n  "))),t);
},log:function(e){return this._tryAddLogEntry(a.level.log,e,Array.prototype.slice.call(arguments,1))},info:function(e){return this._tryAddLogEntry(a.level.info,e,Array.prototype.slice.call(arguments,1))},warn:function(e){return this._tryAddLogEntry(a.level.warn,e,Array.prototype.slice.call(arguments,1))},error:function(e){return this._tryAddLogEntry(a.level.error,e,Array.prototype.slice.call(arguments,1))},_tryAddLogEntry:function(e,t,i){if(!a.scopes.hasLevel(t,e))return null;var n=new g(e,t,i);return a.entries.add(n),a.outputEnabled&&n.print(),n},_getStackTrace:function(){var e=[],t=!1;try{o.dont.exist+=0}catch(i){var n,o,s;if(i.stack){for(n=i.stack.split("\n"),o=0,s=n.length;s>o;o++)n[o].match(/^\s*[A-Za-z0-9\-_\$]+\(/)&&e.push(n[o]);e.shift(),t=!0}else if(window&&window.opera&&i.message){for(n=i.message.split("\n"),o=0,s=n.length;s>o;o++)if(n[o].match(/^\s*[A-Za-z0-9\-_\$]+\(/)){var a=n[o];n[o+1]&&(a+=" at "+n[o+1],o++),e.push(a)}e.shift(),t=!0}}if(!t)for(var r=arguments.callee.caller;r;){
var d=r.toString(),l=d.substring(d.indexOf("function"),d.indexOf("{"))||"anonymous";e.push(l),r=r.caller}return e.join("\r\n")}},disabledImpl:{console:{log:function(){},trace:function(){},info:function(){},warn:function(){}},log:function(){},trace:function(){},info:function(){},warn:function(){},error:function(){}},enable:function(e){if(e=void 0===e?!0:e,a.enabled!==e){a.enabled=e;var t=e?a.enabledImpl:a.disabledImpl;s.extend(a,t)}},disable:function(){a.enable(!1)},enableOutput:function(e){e=null===e?!0:e,a.outputEnabled=e},disableOutput:function(){a.enableOutput(!1)},resetSettings:function(){e("shared/log.settings").resetSettings(a),a("log.resetSettings","Settings are reset to default.")}};s.extend(a,v),a.resetSettings()}(window)}),define("third_party/jquery3",["shared/polyfills"],function(e,t,i){!function(e,t){"use strict";"object"==typeof i&&"object"==typeof i.exports?i.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e);
}:t(e)}("undefined"!=typeof window?window:this,function(e,t){"use strict";function i(e,t){t=t||Z;var i=t.createElement("script");i.text=e,t.head.appendChild(i).parentNode.removeChild(i)}function n(e){var t=!!e&&"length"in e&&e.length,i=ue.type(e);return"function"===i||ue.isWindow(e)?!1:"array"===i||0===t||"number"==typeof t&&t>0&&t-1 in e}function o(e,t,i){if(ue.isFunction(t))return ue.grep(e,function(e,n){return!!t.call(e,n,e)!==i});if(t.nodeType)return ue.grep(e,function(e){return e===t!==i});if("string"==typeof t){if(Ce.test(t))return ue.filter(t,e,i);t=ue.filter(t,e)}return ue.grep(e,function(e){return oe.call(t,e)>-1!==i&&1===e.nodeType})}function s(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function a(e){var t={};return ue.each(e.match($e)||[],function(e,i){t[i]=!0}),t}function r(e){return e}function d(e){throw e}function l(e,t,i){var n;try{e&&ue.isFunction(n=e.promise)?n.call(e).done(t).fail(i):e&&ue.isFunction(n=e.then)?n.call(e,t,i):t.call(void 0,e)}catch(e){i.call(void 0,e);
}}function c(){Z.removeEventListener("DOMContentLoaded",c),e.removeEventListener("load",c),ue.ready()}function h(){this.expando=ue.expando+h.uid++}function u(e,t,i){var n;if(void 0===i&&1===e.nodeType)if(n="data-"+t.replace(Re,"-$&").toLowerCase(),i=e.getAttribute(n),"string"==typeof i){try{i="true"===i?!0:"false"===i?!1:"null"===i?null:+i+""===i?+i:Ne.test(i)?JSON.parse(i):i}catch(o){}Oe.set(e,t,i)}else i=void 0;return i}function p(e,t,i,n){var o,s=1,a=20,r=n?function(){return n.cur()}:function(){return ue.css(e,t,"")},d=r(),l=i&&i[3]||(ue.cssNumber[t]?"":"px"),c=(ue.cssNumber[t]||"px"!==l&&+d)&&Be.exec(ue.css(e,t));if(c&&c[3]!==l){l=l||c[3],i=i||[],c=+d||1;do s=s||".5",c/=s,ue.style(e,t,c+l);while(s!==(s=r()/d)&&1!==s&&--a)}return i&&(c=+c||+d||0,o=i[1]?c+(i[1]+1)*i[2]:+i[2],n&&(n.unit=l,n.start=c,n.end=o)),o}function f(e){var t,i=e.ownerDocument,n=e.nodeName,o=je[n];return o?o:(t=i.body.appendChild(i.createElement(n)),o=ue.css(t,"display"),t.parentNode.removeChild(t),"none"===o&&(o="block"),
je[n]=o,o)}function _(e,t){for(var i,n,o=[],s=0,a=e.length;a>s;s++)n=e[s],n.style&&(i=n.style.display,t?("none"===i&&(o[s]=Me.get(n,"display")||null,o[s]||(n.style.display="")),""===n.style.display&&Fe(n)&&(o[s]=f(n))):"none"!==i&&(o[s]="none",Me.set(n,"display",i)));for(s=0;a>s;s++)null!=o[s]&&(e[s].style.display=o[s]);return e}function g(e,t){var i="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&ue.nodeName(e,t)?ue.merge([e],i):i}function m(e,t){for(var i=0,n=e.length;n>i;i++)Me.set(e[i],"globalEval",!t||Me.get(t[i],"globalEval"))}function v(e,t,i,n,o){for(var s,a,r,d,l,c,h=t.createDocumentFragment(),u=[],p=0,f=e.length;f>p;p++)if(s=e[p],s||0===s)if("object"===ue.type(s))ue.merge(u,s.nodeType?[s]:s);else if(ze.test(s)){for(a=a||h.appendChild(t.createElement("div")),r=(We.exec(s)||["",""])[1].toLowerCase(),d=Ve[r]||Ve._default,a.innerHTML=d[1]+ue.htmlPrefilter(s)+d[2],c=d[0];c--;)a=a.lastChild;
ue.merge(u,a.childNodes),a=h.firstChild,a.textContent=""}else u.push(t.createTextNode(s));for(h.textContent="",p=0;s=u[p++];)if(n&&ue.inArray(s,n)>-1)o&&o.push(s);else if(l=ue.contains(s.ownerDocument,s),a=g(h.appendChild(s),"script"),l&&m(a),i)for(c=0;s=a[c++];)Qe.test(s.type||"")&&i.push(s);return h}function w(){return!0}function b(){return!1}function y(){try{return Z.activeElement}catch(e){}}function C(e,t,i,n,o,s){var a,r;if("object"==typeof t){"string"!=typeof i&&(n=n||i,i=void 0);for(r in t)C(e,r,i,n,t[r],s);return e}if(null==n&&null==o?(o=i,n=i=void 0):null==o&&("string"==typeof i?(o=n,n=void 0):(o=n,n=i,i=void 0)),o===!1)o=b;else if(!o)return e;return 1===s&&(a=o,o=function(e){return ue().off(e),a.apply(this,arguments)},o.guid=a.guid||(a.guid=ue.guid++)),e.each(function(){ue.event.add(this,t,o,n,i)})}function k(e,t){return ue.nodeName(e,"table")&&ue.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e:e}function x(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,
e}function S(e){var t=tt.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function E(e,t){var i,n,o,s,a,r,d,l;if(1===t.nodeType){if(Me.hasData(e)&&(s=Me.access(e),a=Me.set(t,s),l=s.events)){delete a.handle,a.events={};for(o in l)for(i=0,n=l[o].length;n>i;i++)ue.event.add(t,o,l[o][i])}Oe.hasData(e)&&(r=Oe.access(e),d=ue.extend({},r),Oe.set(t,d))}}function T(e,t){var i=t.nodeName.toLowerCase();"input"===i&&He.test(e.type)?t.checked=e.checked:("input"===i||"textarea"===i)&&(t.defaultValue=e.defaultValue)}function $(e,t,n,o){t=ie.apply([],t);var s,a,r,d,l,c,h=0,u=e.length,p=u-1,f=t[0],_=ue.isFunction(f);if(_||u>1&&"string"==typeof f&&!ce.checkClone&&et.test(f))return e.each(function(i){var s=e.eq(i);_&&(t[0]=f.call(this,i,s.html())),$(s,t,n,o)});if(u&&(s=v(t,e[0].ownerDocument,!1,e,o),a=s.firstChild,1===s.childNodes.length&&(s=a),a||o)){for(r=ue.map(g(s,"script"),x),d=r.length;u>h;h++)l=s,h!==p&&(l=ue.clone(l,!0,!0),d&&ue.merge(r,g(l,"script"))),n.call(e[h],l,h);if(d)for(c=r[r.length-1].ownerDocument,
ue.map(r,S),h=0;d>h;h++)l=r[h],Qe.test(l.type||"")&&!Me.access(l,"globalEval")&&ue.contains(c,l)&&(l.src?ue._evalUrl&&ue._evalUrl(l.src):i(l.textContent.replace(it,""),c))}return e}function L(e,t,i){for(var n,o=t?ue.filter(t,e):e,s=0;null!=(n=o[s]);s++)i||1!==n.nodeType||ue.cleanData(g(n)),n.parentNode&&(i&&ue.contains(n.ownerDocument,n)&&m(g(n,"script")),n.parentNode.removeChild(n));return e}function A(e,t,i){var n,o,s,a,r=e.style;return i=i||st(e),i&&(a=i.getPropertyValue(t)||i[t],""!==a||ue.contains(e.ownerDocument,e)||(a=ue.style(e,t)),!ce.pixelMarginRight()&&ot.test(a)&&nt.test(t)&&(n=r.width,o=r.minWidth,s=r.maxWidth,r.minWidth=r.maxWidth=r.width=a,a=i.width,r.width=n,r.minWidth=o,r.maxWidth=s)),void 0!==a?a+"":a}function D(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function I(e){if(e in ct)return e;for(var t=e[0].toUpperCase()+e.slice(1),i=lt.length;i--;)if(e=lt[i]+t,e in ct)return e}function M(e,t,i){var n=Be.exec(t);return n?Math.max(0,n[2]-(i||0))+(n[3]||"px"):t;
}function O(e,t,i,n,o){for(var s=i===(n?"border":"content")?4:"width"===t?1:0,a=0;4>s;s+=2)"margin"===i&&(a+=ue.css(e,i+Pe[s],!0,o)),n?("content"===i&&(a-=ue.css(e,"padding"+Pe[s],!0,o)),"margin"!==i&&(a-=ue.css(e,"border"+Pe[s]+"Width",!0,o))):(a+=ue.css(e,"padding"+Pe[s],!0,o),"padding"!==i&&(a+=ue.css(e,"border"+Pe[s]+"Width",!0,o)));return a}function N(e,t,i){var n,o=!0,s=st(e),a="border-box"===ue.css(e,"boxSizing",!1,s);if(e.getClientRects().length&&(n=e.getBoundingClientRect()[t]),0>=n||null==n){if(n=A(e,t,s),(0>n||null==n)&&(n=e.style[t]),ot.test(n))return n;o=a&&(ce.boxSizingReliable()||n===e.style[t]),n=parseFloat(n)||0}return n+O(e,t,i||(a?"border":"content"),o,s)+"px"}function R(e,t,i,n,o){return new R.prototype.init(e,t,i,n,o)}function q(){ut&&(e.requestAnimationFrame(q),ue.fx.tick())}function B(){return e.setTimeout(function(){ht=void 0}),ht=ue.now()}function P(e,t){var i,n=0,o={height:e};for(t=t?1:0;4>n;n+=2-t)i=Pe[n],o["margin"+i]=o["padding"+i]=e;return t&&(o.opacity=o.width=e),
o}function F(e,t,i){for(var n,o=(H.tweeners[t]||[]).concat(H.tweeners["*"]),s=0,a=o.length;a>s;s++)if(n=o[s].call(i,t,e))return n}function U(e,t,i){var n,o,s,a,r,d,l,c,h="width"in t||"height"in t,u=this,p={},f=e.style,g=e.nodeType&&Fe(e),m=Me.get(e,"fxshow");i.queue||(a=ue._queueHooks(e,"fx"),null==a.unqueued&&(a.unqueued=0,r=a.empty.fire,a.empty.fire=function(){a.unqueued||r()}),a.unqueued++,u.always(function(){u.always(function(){a.unqueued--,ue.queue(e,"fx").length||a.empty.fire()})}));for(n in t)if(o=t[n],pt.test(o)){if(delete t[n],s=s||"toggle"===o,o===(g?"hide":"show")){if("show"!==o||!m||void 0===m[n])continue;g=!0}p[n]=m&&m[n]||ue.style(e,n)}if(d=!ue.isEmptyObject(t),d||!ue.isEmptyObject(p)){h&&1===e.nodeType&&(i.overflow=[f.overflow,f.overflowX,f.overflowY],l=m&&m.display,null==l&&(l=Me.get(e,"display")),c=ue.css(e,"display"),"none"===c&&(l?c=l:(_([e],!0),l=e.style.display||l,c=ue.css(e,"display"),_([e]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===ue.css(e,"float")&&(d||(u.done(function(){
f.display=l}),null==l&&(c=f.display,l="none"===c?"":c)),f.display="inline-block")),i.overflow&&(f.overflow="hidden",u.always(function(){f.overflow=i.overflow[0],f.overflowX=i.overflow[1],f.overflowY=i.overflow[2]})),d=!1;for(n in p)d||(m?"hidden"in m&&(g=m.hidden):m=Me.access(e,"fxshow",{display:l}),s&&(m.hidden=!g),g&&_([e],!0),u.done(function(){g||_([e]),Me.remove(e,"fxshow");for(n in p)ue.style(e,n,p[n])})),d=F(g?m[n]:0,n,u),n in m||(m[n]=d.start,g&&(d.end=d.start,d.start=0))}}function j(e,t){var i,n,o,s,a;for(i in e)if(n=ue.camelCase(i),o=t[n],s=e[i],ue.isArray(s)&&(o=s[1],s=e[i]=s[0]),i!==n&&(e[n]=s,delete e[i]),a=ue.cssHooks[n],a&&"expand"in a){s=a.expand(s),delete e[n];for(i in s)i in e||(e[i]=s[i],t[i]=o)}else t[n]=o}function H(e,t,i){var n,o,s=0,a=H.prefilters.length,r=ue.Deferred().always(function(){delete d.elem}),d=function(){if(o)return!1;for(var t=ht||B(),i=Math.max(0,l.startTime+l.duration-t),n=i/l.duration||0,s=1-n,a=0,d=l.tweens.length;d>a;a++)l.tweens[a].run(s);return r.notifyWith(e,[l,s,i]),
1>s&&d?i:(r.resolveWith(e,[l]),!1)},l=r.promise({elem:e,props:ue.extend({},t),opts:ue.extend(!0,{specialEasing:{},easing:ue.easing._default},i),originalProperties:t,originalOptions:i,startTime:ht||B(),duration:i.duration,tweens:[],createTween:function(t,i){var n=ue.Tween(e,l.opts,t,i,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(n),n},stop:function(t){var i=0,n=t?l.tweens.length:0;if(o)return this;for(o=!0;n>i;i++)l.tweens[i].run(1);return t?(r.notifyWith(e,[l,1,0]),r.resolveWith(e,[l,t])):r.rejectWith(e,[l,t]),this}}),c=l.props;for(j(c,l.opts.specialEasing);a>s;s++)if(n=H.prefilters[s].call(l,e,c,l.opts))return ue.isFunction(n.stop)&&(ue._queueHooks(l.elem,l.opts.queue).stop=ue.proxy(n.stop,n)),n;return ue.map(c,F,l),ue.isFunction(l.opts.start)&&l.opts.start.call(e,l),ue.fx.timer(ue.extend(d,{elem:e,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function W(e){return e.getAttribute&&e.getAttribute("class")||"";
}function Q(e,t,i,n){var o;if(ue.isArray(t))ue.each(t,function(t,o){i||Et.test(e)?n(e,o):Q(e+"["+("object"==typeof o&&null!=o?t:"")+"]",o,i,n)});else if(i||"object"!==ue.type(t))n(e,t);else for(o in t)Q(e+"["+o+"]",t[o],i,n)}function V(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var n,o=0,s=t.toLowerCase().match($e)||[];if(ue.isFunction(i))for(;n=s[o++];)"+"===n[0]?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(i)):(e[n]=e[n]||[]).push(i)}}function z(e,t,i,n){function o(r){var d;return s[r]=!0,ue.each(e[r]||[],function(e,r){var l=r(t,i,n);return"string"!=typeof l||a||s[l]?a?!(d=l):void 0:(t.dataTypes.unshift(l),o(l),!1)}),d}var s={},a=e===Bt;return o(t.dataTypes[0])||!s["*"]&&o("*")}function G(e,t){var i,n,o=ue.ajaxSettings.flatOptions||{};for(i in t)void 0!==t[i]&&((o[i]?e:n||(n={}))[i]=t[i]);return n&&ue.extend(!0,e,n),e}function K(e,t,i){for(var n,o,s,a,r=e.contents,d=e.dataTypes;"*"===d[0];)d.shift(),void 0===n&&(n=e.mimeType||t.getResponseHeader("Content-Type"));if(n)for(o in r)if(r[o]&&r[o].test(n)){
d.unshift(o);break}if(d[0]in i)s=d[0];else{for(o in i){if(!d[0]||e.converters[o+" "+d[0]]){s=o;break}a||(a=o)}s=s||a}return s?(s!==d[0]&&d.unshift(s),i[s]):void 0}function J(e,t,i,n){var o,s,a,r,d,l={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)l[a.toLowerCase()]=e.converters[a];for(s=c.shift();s;)if(e.responseFields[s]&&(i[e.responseFields[s]]=t),!d&&n&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),d=s,s=c.shift())if("*"===s)s=d;else if("*"!==d&&d!==s){if(a=l[d+" "+s]||l["* "+s],!a)for(o in l)if(r=o.split(" "),r[1]===s&&(a=l[d+" "+r[0]]||l["* "+r[0]])){a===!0?a=l[o]:l[o]!==!0&&(s=r[0],c.unshift(r[1]));break}if(a!==!0)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(h){return{state:"parsererror",error:a?h:"No conversion from "+d+" to "+s}}}return{state:"success",data:t}}function X(e){return ue.isWindow(e)?e:9===e.nodeType&&e.defaultView}var Y=[],Z=e.document,ee=Object.getPrototypeOf,te=Y.slice,ie=Y.concat,ne=Y.push,oe=Y.indexOf,se={},ae=se.toString,re=se.hasOwnProperty,de=re.toString,le=de.call(Object),ce={},he="3.0.0",ue=function(e,t){
return new ue.fn.init(e,t)},pe=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,fe=/^-ms-/,_e=/-([a-z])/g,ge=function(e,t){return t.toUpperCase()};ue.fn=ue.prototype={jquery:he,constructor:ue,length:0,toArray:function(){return te.call(this)},get:function(e){return null!=e?0>e?this[e+this.length]:this[e]:te.call(this)},pushStack:function(e){var t=ue.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return ue.each(this,e)},map:function(e){return this.pushStack(ue.map(this,function(t,i){return e.call(t,i,t)}))},slice:function(){return this.pushStack(te.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(0>e?t:0);return this.pushStack(i>=0&&t>i?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:ne,sort:Y.sort,splice:Y.splice},ue.extend=ue.fn.extend=function(){var e,t,i,n,o,s,a=arguments[0]||{},r=1,d=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[r]||{},r++),
"object"==typeof a||ue.isFunction(a)||(a={}),r===d&&(a=this,r--);d>r;r++)if(null!=(e=arguments[r]))for(t in e)i=a[t],n=e[t],a!==n&&(l&&n&&(ue.isPlainObject(n)||(o=ue.isArray(n)))?(o?(o=!1,s=i&&ue.isArray(i)?i:[]):s=i&&ue.isPlainObject(i)?i:{},a[t]=ue.extend(l,s,n)):void 0!==n&&(a[t]=n));return a},ue.extend({expando:"jQuery"+(he+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===ue.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){var t=ue.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},isPlainObject:function(e){var t,i;return e&&"[object Object]"===ae.call(e)?(t=ee(e))?(i=re.call(t,"constructor")&&t.constructor,"function"==typeof i&&de.call(i)===le):!0:!1},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?se[ae.call(e)]||"object":typeof e;
},globalEval:function(e){i(e)},camelCase:function(e){return e.replace(fe,"ms-").replace(_e,ge)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t){var i,o=0;if(n(e))for(i=e.length;i>o&&t.call(e[o],o,e[o])!==!1;o++);else for(o in e)if(t.call(e[o],o,e[o])===!1)break;return e},trim:function(e){return null==e?"":(e+"").replace(pe,"")},makeArray:function(e,t){var i=t||[];return null!=e&&(n(Object(e))?ue.merge(i,"string"==typeof e?[e]:e):ne.call(i,e)),i},inArray:function(e,t,i){return null==t?-1:oe.call(t,e,i)},merge:function(e,t){for(var i=+t.length,n=0,o=e.length;i>n;n++)e[o++]=t[n];return e.length=o,e},grep:function(e,t,i){for(var n,o=[],s=0,a=e.length,r=!i;a>s;s++)n=!t(e[s],s),n!==r&&o.push(e[s]);return o},map:function(e,t,i){var o,s,a=0,r=[];if(n(e))for(o=e.length;o>a;a++)s=t(e[a],a,i),null!=s&&r.push(s);else for(a in e)s=t(e[a],a,i),null!=s&&r.push(s);return ie.apply([],r)},guid:1,proxy:function(e,t){var i,n,o;return"string"==typeof t&&(i=e[t],
t=e,e=i),ue.isFunction(e)?(n=te.call(arguments,2),o=function(){return e.apply(t||this,n.concat(te.call(arguments)))},o.guid=e.guid=e.guid||ue.guid++,o):void 0},now:Date.now,support:ce}),"function"==typeof Symbol&&(ue.fn[Symbol.iterator]=Y[Symbol.iterator]),ue.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){se["[object "+t+"]"]=t.toLowerCase()});var me=function(e){function t(e,t,i,n){var o,s,a,r,d,l,c,u=t&&t.ownerDocument,f=t?t.nodeType:9;if(i=i||[],"string"!=typeof e||!e||1!==f&&9!==f&&11!==f)return i;if(!n&&((t?t.ownerDocument||t:U)!==M&&I(t),t=t||M,N)){if(11!==f&&(d=me.exec(e)))if(o=d[1]){if(9===f){if(!(a=t.getElementById(o)))return i;if(a.id===o)return i.push(a),i}else if(u&&(a=u.getElementById(o))&&P(t,a)&&a.id===o)return i.push(a),i}else{if(d[2])return Y.apply(i,t.getElementsByTagName(e)),i;if((o=d[3])&&C.getElementsByClassName&&t.getElementsByClassName)return Y.apply(i,t.getElementsByClassName(o)),i}if(C.qsa&&!V[e+" "]&&(!R||!R.test(e))){
if(1!==f)u=t,c=e;else if("object"!==t.nodeName.toLowerCase()){for((r=t.getAttribute("id"))?r=r.replace(ye,Ce):t.setAttribute("id",r=F),l=E(e),s=l.length;s--;)l[s]="#"+r+" "+p(l[s]);c=l.join(","),u=ve.test(e)&&h(t.parentNode)||t}if(c)try{return Y.apply(i,u.querySelectorAll(c)),i}catch(_){}finally{r===F&&t.removeAttribute("id")}}}return $(e.replace(re,"$1"),t,i,n)}function i(){function e(i,n){return t.push(i+" ")>k.cacheLength&&delete e[t.shift()],e[i+" "]=n}var t=[];return e}function n(e){return e[F]=!0,e}function o(e){var t=M.createElement("fieldset");try{return!!e(t)}catch(i){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function s(e,t){for(var i=e.split("|"),n=i.length;n--;)k.attrHandle[i[n]]=t}function a(e,t){var i=t&&e,n=i&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(n)return n;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function r(e){return function(t){var i=t.nodeName.toLowerCase();return"input"===i&&t.type===e}}function d(e){
return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}function l(e){return function(t){return"label"in t&&t.disabled===e||"form"in t&&t.disabled===e||"form"in t&&t.disabled===!1&&(t.isDisabled===e||t.isDisabled!==!e&&("label"in t||!xe(t))!==e)}}function c(e){return n(function(t){return t=+t,n(function(i,n){for(var o,s=e([],i.length,t),a=s.length;a--;)i[o=s[a]]&&(i[o]=!(n[o]=i[o]))})})}function h(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function u(){}function p(e){for(var t=0,i=e.length,n="";i>t;t++)n+=e[t].value;return n}function f(e,t,i){var n=t.dir,o=t.next,s=o||n,a=i&&"parentNode"===s,r=H++;return t.first?function(t,i,o){for(;t=t[n];)if(1===t.nodeType||a)return e(t,i,o)}:function(t,i,d){var l,c,h,u=[j,r];if(d){for(;t=t[n];)if((1===t.nodeType||a)&&e(t,i,d))return!0}else for(;t=t[n];)if(1===t.nodeType||a)if(h=t[F]||(t[F]={}),c=h[t.uniqueID]||(h[t.uniqueID]={}),o&&o===t.nodeName.toLowerCase())t=t[n]||t;else{if((l=c[s])&&l[0]===j&&l[1]===r)return u[2]=l[2];
if(c[s]=u,u[2]=e(t,i,d))return!0}}}function _(e){return e.length>1?function(t,i,n){for(var o=e.length;o--;)if(!e[o](t,i,n))return!1;return!0}:e[0]}function g(e,i,n){for(var o=0,s=i.length;s>o;o++)t(e,i[o],n);return n}function m(e,t,i,n,o){for(var s,a=[],r=0,d=e.length,l=null!=t;d>r;r++)(s=e[r])&&(!i||i(s,n,o))&&(a.push(s),l&&t.push(r));return a}function v(e,t,i,o,s,a){return o&&!o[F]&&(o=v(o)),s&&!s[F]&&(s=v(s,a)),n(function(n,a,r,d){var l,c,h,u=[],p=[],f=a.length,_=n||g(t||"*",r.nodeType?[r]:r,[]),v=!e||!n&&t?_:m(_,u,e,r,d),w=i?s||(n?e:f||o)?[]:a:v;if(i&&i(v,w,r,d),o)for(l=m(w,p),o(l,[],r,d),c=l.length;c--;)(h=l[c])&&(w[p[c]]=!(v[p[c]]=h));if(n){if(s||e){if(s){for(l=[],c=w.length;c--;)(h=w[c])&&l.push(v[c]=h);s(null,w=[],l,d)}for(c=w.length;c--;)(h=w[c])&&(l=s?ee(n,h):u[c])>-1&&(n[l]=!(a[l]=h))}}else w=m(w===a?w.splice(f,w.length):w),s?s(null,a,w,d):Y.apply(a,w)})}function w(e){for(var t,i,n,o=e.length,s=k.relative[e[0].type],a=s||k.relative[" "],r=s?1:0,d=f(function(e){return e===t},a,!0),l=f(function(e){
return ee(t,e)>-1},a,!0),c=[function(e,i,n){var o=!s&&(n||i!==L)||((t=i).nodeType?d(e,i,n):l(e,i,n));return t=null,o}];o>r;r++)if(i=k.relative[e[r].type])c=[f(_(c),i)];else{if(i=k.filter[e[r].type].apply(null,e[r].matches),i[F]){for(n=++r;o>n&&!k.relative[e[n].type];n++);return v(r>1&&_(c),r>1&&p(e.slice(0,r-1).concat({value:" "===e[r-2].type?"*":""})).replace(re,"$1"),i,n>r&&w(e.slice(r,n)),o>n&&w(e=e.slice(n)),o>n&&p(e))}c.push(i)}return _(c)}function b(e,i){var o=i.length>0,s=e.length>0,a=function(n,a,r,d,l){var c,h,u,p=0,f="0",_=n&&[],g=[],v=L,w=n||s&&k.find.TAG("*",l),b=j+=null==v?1:Math.random()||.1,y=w.length;for(l&&(L=a===M||a||l);f!==y&&null!=(c=w[f]);f++){if(s&&c){for(h=0,a||c.ownerDocument===M||(I(c),r=!N);u=e[h++];)if(u(c,a||M,r)){d.push(c);break}l&&(j=b)}o&&((c=!u&&c)&&p--,n&&_.push(c))}if(p+=f,o&&f!==p){for(h=0;u=i[h++];)u(_,g,a,r);if(n){if(p>0)for(;f--;)_[f]||g[f]||(g[f]=J.call(d));g=m(g)}Y.apply(d,g),l&&!n&&g.length>0&&p+i.length>1&&t.uniqueSort(d)}return l&&(j=b,L=v),_};
return o?n(a):a}var y,C,k,x,S,E,T,$,L,A,D,I,M,O,N,R,q,B,P,F="sizzle"+1*new Date,U=e.document,j=0,H=0,W=i(),Q=i(),V=i(),z=function(e,t){return e===t&&(D=!0),0},G={}.hasOwnProperty,K=[],J=K.pop,X=K.push,Y=K.push,Z=K.slice,ee=function(e,t){for(var i=0,n=e.length;n>i;i++)if(e[i]===t)return i;return-1},te="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ie="[\\x20\\t\\r\\n\\f]",ne="(?:\\\\.|[\\w-]|[^\x00-\\xa0])+",oe="\\["+ie+"*("+ne+")(?:"+ie+"*([*^$|!~]?=)"+ie+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+ne+"))|)"+ie+"*\\]",se=":("+ne+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+oe+")*)|.*)\\)|)",ae=new RegExp(ie+"+","g"),re=new RegExp("^"+ie+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ie+"+$","g"),de=new RegExp("^"+ie+"*,"+ie+"*"),le=new RegExp("^"+ie+"*([>+~]|"+ie+")"+ie+"*"),ce=new RegExp("="+ie+"*([^\\]'\"]*?)"+ie+"*\\]","g"),he=new RegExp(se),ue=new RegExp("^"+ne+"$"),pe={
ID:new RegExp("^#("+ne+")"),CLASS:new RegExp("^\\.("+ne+")"),TAG:new RegExp("^("+ne+"|[*])"),ATTR:new RegExp("^"+oe),PSEUDO:new RegExp("^"+se),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ie+"*(even|odd|(([+-]|)(\\d*)n|)"+ie+"*(?:([+-]|)"+ie+"*(\\d+)|))"+ie+"*\\)|)","i"),bool:new RegExp("^(?:"+te+")$","i"),needsContext:new RegExp("^"+ie+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ie+"*((?:-\\d)?\\d*)"+ie+"*\\)|)(?=[^-]|$)","i")},fe=/^(?:input|select|textarea|button)$/i,_e=/^h\d$/i,ge=/^[^{]+\{\s*\[native \w/,me=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ve=/[+~]/,we=new RegExp("\\\\([\\da-f]{1,6}"+ie+"?|("+ie+")|.)","ig"),be=function(e,t,i){var n="0x"+t-65536;return n!==n||i?t:0>n?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},ye=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g,Ce=function(e,t){return t?"\x00"===e?"�":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},ke=function(){I()},xe=f(function(e){return e.disabled===!0;
},{dir:"parentNode",next:"legend"});try{Y.apply(K=Z.call(U.childNodes),U.childNodes),K[U.childNodes.length].nodeType}catch(Se){Y={apply:K.length?function(e,t){X.apply(e,Z.call(t))}:function(e,t){for(var i=e.length,n=0;e[i++]=t[n++];);e.length=i-1}}}C=t.support={},S=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},I=t.setDocument=function(e){var t,i,n=e?e.ownerDocument||e:U;return n!==M&&9===n.nodeType&&n.documentElement?(M=n,O=M.documentElement,N=!S(M),U!==M&&(i=M.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",ke,!1):i.attachEvent&&i.attachEvent("onunload",ke)),C.attributes=o(function(e){return e.className="i",!e.getAttribute("className")}),C.getElementsByTagName=o(function(e){return e.appendChild(M.createComment("")),!e.getElementsByTagName("*").length}),C.getElementsByClassName=ge.test(M.getElementsByClassName),C.getById=o(function(e){return O.appendChild(e).id=F,!M.getElementsByName||!M.getElementsByName(F).length;
}),C.getById?(k.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&N){var i=t.getElementById(e);return i?[i]:[]}},k.filter.ID=function(e){var t=e.replace(we,be);return function(e){return e.getAttribute("id")===t}}):(delete k.find.ID,k.filter.ID=function(e){var t=e.replace(we,be);return function(e){var i="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return i&&i.value===t}}),k.find.TAG=C.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):C.qsa?t.querySelectorAll(e):void 0}:function(e,t){var i,n=[],o=0,s=t.getElementsByTagName(e);if("*"===e){for(;i=s[o++];)1===i.nodeType&&n.push(i);return n}return s},k.find.CLASS=C.getElementsByClassName&&function(e,t){return"undefined"!=typeof t.getElementsByClassName&&N?t.getElementsByClassName(e):void 0},q=[],R=[],(C.qsa=ge.test(M.querySelectorAll))&&(o(function(e){O.appendChild(e).innerHTML="<a id='"+F+"'></a><select id='"+F+"-\r\\' msallowcapture=''><option selected=''></option></select>",
e.querySelectorAll("[msallowcapture^='']").length&&R.push("[*^$]="+ie+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||R.push("\\["+ie+"*(?:value|"+te+")"),e.querySelectorAll("[id~="+F+"-]").length||R.push("~="),e.querySelectorAll(":checked").length||R.push(":checked"),e.querySelectorAll("a#"+F+"+*").length||R.push(".#.+[+~]")}),o(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=M.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&R.push("name"+ie+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&R.push(":enabled",":disabled"),O.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&R.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),R.push(",.*:")})),(C.matchesSelector=ge.test(B=O.matches||O.webkitMatchesSelector||O.mozMatchesSelector||O.oMatchesSelector||O.msMatchesSelector))&&o(function(e){C.disconnectedMatch=B.call(e,"*"),
B.call(e,"[s!='']:x"),q.push("!=",se)}),R=R.length&&new RegExp(R.join("|")),q=q.length&&new RegExp(q.join("|")),t=ge.test(O.compareDocumentPosition),P=t||ge.test(O.contains)?function(e,t){var i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},z=t?function(e,t){if(e===t)return D=!0,0;var i=!e.compareDocumentPosition-!t.compareDocumentPosition;return i?i:(i=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&i||!C.sortDetached&&t.compareDocumentPosition(e)===i?e===M||e.ownerDocument===U&&P(U,e)?-1:t===M||t.ownerDocument===U&&P(U,t)?1:A?ee(A,e)-ee(A,t):0:4&i?-1:1)}:function(e,t){if(e===t)return D=!0,0;var i,n=0,o=e.parentNode,s=t.parentNode,r=[e],d=[t];if(!o||!s)return e===M?-1:t===M?1:o?-1:s?1:A?ee(A,e)-ee(A,t):0;if(o===s)return a(e,t);for(i=e;i=i.parentNode;)r.unshift(i);
for(i=t;i=i.parentNode;)d.unshift(i);for(;r[n]===d[n];)n++;return n?a(r[n],d[n]):r[n]===U?-1:d[n]===U?1:0},M):M},t.matches=function(e,i){return t(e,null,null,i)},t.matchesSelector=function(e,i){if((e.ownerDocument||e)!==M&&I(e),i=i.replace(ce,"='$1']"),C.matchesSelector&&N&&!V[i+" "]&&(!q||!q.test(i))&&(!R||!R.test(i)))try{var n=B.call(e,i);if(n||C.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(o){}return t(i,M,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==M&&I(e),P(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==M&&I(e);var i=k.attrHandle[t.toLowerCase()],n=i&&G.call(k.attrHandle,t.toLowerCase())?i(e,t,!N):void 0;return void 0!==n?n:C.attributes||!N?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null},t.escape=function(e){return(e+"").replace(ye,Ce)},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,i=[],n=0,o=0;if(D=!C.detectDuplicates,A=!C.sortStable&&e.slice(0),
e.sort(z),D){for(;t=e[o++];)t===e[o]&&(n=i.push(o));for(;n--;)e.splice(i[n],1)}return A=null,e},x=t.getText=function(e){var t,i="",n=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=x(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[n++];)i+=x(t);return i},k=t.selectors={cacheLength:50,createPseudo:n,match:pe,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(we,be),e[3]=(e[3]||e[4]||e[5]||"").replace(we,be),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,i=!e[6]&&e[2];return pe.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":i&&he.test(i)&&(t=E(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),
e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(we,be).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=W[e+" "];return t||(t=new RegExp("(^|"+ie+")"+e+"("+ie+"|$)"))&&W(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,i,n){return function(o){var s=t.attr(o,e);return null==s?"!="===i:i?(s+="","="===i?s===n:"!="===i?s!==n:"^="===i?n&&0===s.indexOf(n):"*="===i?n&&s.indexOf(n)>-1:"$="===i?n&&s.slice(-n.length)===n:"~="===i?(" "+s.replace(ae," ")+" ").indexOf(n)>-1:"|="===i?s===n||s.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,i,n,o){var s="nth"!==e.slice(0,3),a="last"!==e.slice(-4),r="of-type"===t;return 1===n&&0===o?function(e){return!!e.parentNode}:function(t,i,d){var l,c,h,u,p,f,_=s!==a?"nextSibling":"previousSibling",g=t.parentNode,m=r&&t.nodeName.toLowerCase(),v=!d&&!r,w=!1;
if(g){if(s){for(;_;){for(u=t;u=u[_];)if(r?u.nodeName.toLowerCase()===m:1===u.nodeType)return!1;f=_="only"===e&&!f&&"nextSibling"}return!0}if(f=[a?g.firstChild:g.lastChild],a&&v){for(u=g,h=u[F]||(u[F]={}),c=h[u.uniqueID]||(h[u.uniqueID]={}),l=c[e]||[],p=l[0]===j&&l[1],w=p&&l[2],u=p&&g.childNodes[p];u=++p&&u&&u[_]||(w=p=0)||f.pop();)if(1===u.nodeType&&++w&&u===t){c[e]=[j,p,w];break}}else if(v&&(u=t,h=u[F]||(u[F]={}),c=h[u.uniqueID]||(h[u.uniqueID]={}),l=c[e]||[],p=l[0]===j&&l[1],w=p),w===!1)for(;(u=++p&&u&&u[_]||(w=p=0)||f.pop())&&((r?u.nodeName.toLowerCase()!==m:1!==u.nodeType)||!++w||(v&&(h=u[F]||(u[F]={}),c=h[u.uniqueID]||(h[u.uniqueID]={}),c[e]=[j,w]),u!==t)););return w-=o,w===n||w%n===0&&w/n>=0}}},PSEUDO:function(e,i){var o,s=k.pseudos[e]||k.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return s[F]?s(i):s.length>1?(o=[e,e,"",i],k.setFilters.hasOwnProperty(e.toLowerCase())?n(function(e,t){for(var n,o=s(e,i),a=o.length;a--;)n=ee(e,o[a]),e[n]=!(t[n]=o[a])}):function(e){
return s(e,0,o)}):s}},pseudos:{not:n(function(e){var t=[],i=[],o=T(e.replace(re,"$1"));return o[F]?n(function(e,t,i,n){for(var s,a=o(e,null,n,[]),r=e.length;r--;)(s=a[r])&&(e[r]=!(t[r]=s))}):function(e,n,s){return t[0]=e,o(t,null,s,i),t[0]=null,!i.pop()}}),has:n(function(e){return function(i){return t(e,i).length>0}}),contains:n(function(e){return e=e.replace(we,be),function(t){return(t.textContent||t.innerText||x(t)).indexOf(e)>-1}}),lang:n(function(e){return ue.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(we,be).toLowerCase(),function(t){var i;do if(i=N?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return i=i.toLowerCase(),i===e||0===i.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===O},focus:function(e){return e===M.activeElement&&(!M.hasFocus||M.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:l(!1),disabled:l(!0),checked:function(e){
var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!k.pseudos.empty(e)},header:function(e){return _e.test(e.nodeName)},input:function(e){return fe.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:c(function(){return[0]}),last:c(function(e,t){return[t-1]}),eq:c(function(e,t,i){return[0>i?i+t:i]}),even:c(function(e,t){for(var i=0;t>i;i+=2)e.push(i);return e}),odd:c(function(e,t){for(var i=1;t>i;i+=2)e.push(i);return e}),lt:c(function(e,t,i){for(var n=0>i?i+t:i;--n>=0;)e.push(n);return e}),gt:c(function(e,t,i){for(var n=0>i?i+t:i;++n<t;)e.push(n);
return e})}},k.pseudos.nth=k.pseudos.eq;for(y in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})k.pseudos[y]=r(y);for(y in{submit:!0,reset:!0})k.pseudos[y]=d(y);return u.prototype=k.filters=k.pseudos,k.setFilters=new u,E=t.tokenize=function(e,i){var n,o,s,a,r,d,l,c=Q[e+" "];if(c)return i?0:c.slice(0);for(r=e,d=[],l=k.preFilter;r;){(!n||(o=de.exec(r)))&&(o&&(r=r.slice(o[0].length)||r),d.push(s=[])),n=!1,(o=le.exec(r))&&(n=o.shift(),s.push({value:n,type:o[0].replace(re," ")}),r=r.slice(n.length));for(a in k.filter)!(o=pe[a].exec(r))||l[a]&&!(o=l[a](o))||(n=o.shift(),s.push({value:n,type:a,matches:o}),r=r.slice(n.length));if(!n)break}return i?r.length:r?t.error(e):Q(e,d).slice(0)},T=t.compile=function(e,t){var i,n=[],o=[],s=V[e+" "];if(!s){for(t||(t=E(e)),i=t.length;i--;)s=w(t[i]),s[F]?n.push(s):o.push(s);s=V(e,b(o,n)),s.selector=e}return s},$=t.select=function(e,t,i,n){var o,s,a,r,d,l="function"==typeof e&&e,c=!n&&E(e=l.selector||e);if(i=i||[],1===c.length){if(s=c[0]=c[0].slice(0),s.length>2&&"ID"===(a=s[0]).type&&C.getById&&9===t.nodeType&&N&&k.relative[s[1].type]){
if(t=(k.find.ID(a.matches[0].replace(we,be),t)||[])[0],!t)return i;l&&(t=t.parentNode),e=e.slice(s.shift().value.length)}for(o=pe.needsContext.test(e)?0:s.length;o--&&(a=s[o],!k.relative[r=a.type]);)if((d=k.find[r])&&(n=d(a.matches[0].replace(we,be),ve.test(s[0].type)&&h(t.parentNode)||t))){if(s.splice(o,1),e=n.length&&p(s),!e)return Y.apply(i,n),i;break}}return(l||T(e,c))(n,t,!N,i,!t||ve.test(e)&&h(t.parentNode)||t),i},C.sortStable=F.split("").sort(z).join("")===F,C.detectDuplicates=!!D,I(),C.sortDetached=o(function(e){return 1&e.compareDocumentPosition(M.createElement("fieldset"))}),o(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||s("type|href|height|width",function(e,t,i){return i?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),C.attributes&&o(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||s("value",function(e,t,i){return i||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue;
}),o(function(e){return null==e.getAttribute("disabled")})||s(te,function(e,t,i){var n;return i?void 0:e[t]===!0?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null}),t}(e);ue.find=me,ue.expr=me.selectors,ue.expr[":"]=ue.expr.pseudos,ue.uniqueSort=ue.unique=me.uniqueSort,ue.text=me.getText,ue.isXMLDoc=me.isXML,ue.contains=me.contains,ue.escapeSelector=me.escape;var ve=function(e,t,i){for(var n=[],o=void 0!==i;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(o&&ue(e).is(i))break;n.push(e)}return n},we=function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i},be=ue.expr.match.needsContext,ye=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,Ce=/^.[^:#\[\.,]*$/;ue.filter=function(e,t,i){var n=t[0];return i&&(e=":not("+e+")"),1===t.length&&1===n.nodeType?ue.find.matchesSelector(n,e)?[n]:[]:ue.find.matches(e,ue.grep(t,function(e){return 1===e.nodeType}))},ue.fn.extend({find:function(e){var t,i,n=this.length,o=this;if("string"!=typeof e)return this.pushStack(ue(e).filter(function(){
for(t=0;n>t;t++)if(ue.contains(o[t],this))return!0}));for(i=this.pushStack([]),t=0;n>t;t++)ue.find(e,o[t],i);return n>1?ue.uniqueSort(i):i},filter:function(e){return this.pushStack(o(this,e||[],!1))},not:function(e){return this.pushStack(o(this,e||[],!0))},is:function(e){return!!o(this,"string"==typeof e&&be.test(e)?ue(e):e||[],!1).length}});var ke,xe=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,Se=ue.fn.init=function(e,t,i){var n,o;if(!e)return this;if(i=i||ke,"string"==typeof e){if(n="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:xe.exec(e),!n||!n[1]&&t)return!t||t.jquery?(t||i).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof ue?t[0]:t,ue.merge(this,ue.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:Z,!0)),ye.test(n[1])&&ue.isPlainObject(t))for(n in t)ue.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}return o=Z.getElementById(n[2]),o&&(this[0]=o,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):ue.isFunction(e)?void 0!==i.ready?i.ready(e):e(ue):ue.makeArray(e,this);
};Se.prototype=ue.fn,ke=ue(Z);var Ee=/^(?:parents|prev(?:Until|All))/,Te={children:!0,contents:!0,next:!0,prev:!0};ue.fn.extend({has:function(e){var t=ue(e,this),i=t.length;return this.filter(function(){for(var e=0;i>e;e++)if(ue.contains(this,t[e]))return!0})},closest:function(e,t){var i,n=0,o=this.length,s=[],a="string"!=typeof e&&ue(e);if(!be.test(e))for(;o>n;n++)for(i=this[n];i&&i!==t;i=i.parentNode)if(i.nodeType<11&&(a?a.index(i)>-1:1===i.nodeType&&ue.find.matchesSelector(i,e))){s.push(i);break}return this.pushStack(s.length>1?ue.uniqueSort(s):s)},index:function(e){return e?"string"==typeof e?oe.call(ue(e),this[0]):oe.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(ue.uniqueSort(ue.merge(this.get(),ue(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),ue.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return ve(e,"parentNode");
},parentsUntil:function(e,t,i){return ve(e,"parentNode",i)},next:function(e){return s(e,"nextSibling")},prev:function(e){return s(e,"previousSibling")},nextAll:function(e){return ve(e,"nextSibling")},prevAll:function(e){return ve(e,"previousSibling")},nextUntil:function(e,t,i){return ve(e,"nextSibling",i)},prevUntil:function(e,t,i){return ve(e,"previousSibling",i)},siblings:function(e){return we((e.parentNode||{}).firstChild,e)},children:function(e){return we(e.firstChild)},contents:function(e){return e.contentDocument||ue.merge([],e.childNodes)}},function(e,t){ue.fn[e]=function(i,n){var o=ue.map(this,t,i);return"Until"!==e.slice(-5)&&(n=i),n&&"string"==typeof n&&(o=ue.filter(n,o)),this.length>1&&(Te[e]||ue.uniqueSort(o),Ee.test(e)&&o.reverse()),this.pushStack(o)}});var $e=/\S+/g;ue.Callbacks=function(e){e="string"==typeof e?a(e):ue.extend({},e);var t,i,n,o,s=[],r=[],d=-1,l=function(){for(o=e.once,n=t=!0;r.length;d=-1)for(i=r.shift();++d<s.length;)s[d].apply(i[0],i[1])===!1&&e.stopOnFalse&&(d=s.length,
i=!1);e.memory||(i=!1),t=!1,o&&(s=i?[]:"")},c={add:function(){return s&&(i&&!t&&(d=s.length-1,r.push(i)),function n(t){ue.each(t,function(t,i){ue.isFunction(i)?e.unique&&c.has(i)||s.push(i):i&&i.length&&"string"!==ue.type(i)&&n(i)})}(arguments),i&&!t&&l()),this},remove:function(){return ue.each(arguments,function(e,t){for(var i;(i=ue.inArray(t,s,i))>-1;)s.splice(i,1),d>=i&&d--}),this},has:function(e){return e?ue.inArray(e,s)>-1:s.length>0},empty:function(){return s&&(s=[]),this},disable:function(){return o=r=[],s=i="",this},disabled:function(){return!s},lock:function(){return o=r=[],i||t||(s=i=""),this},locked:function(){return!!o},fireWith:function(e,i){return o||(i=i||[],i=[e,i.slice?i.slice():i],r.push(i),t||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!n}};return c},ue.extend({Deferred:function(t){var i=[["notify","progress",ue.Callbacks("memory"),ue.Callbacks("memory"),2],["resolve","done",ue.Callbacks("once memory"),ue.Callbacks("once memory"),0,"resolved"],["reject","fail",ue.Callbacks("once memory"),ue.Callbacks("once memory"),1,"rejected"]],n="pending",o={
state:function(){return n},always:function(){return s.done(arguments).fail(arguments),this},"catch":function(e){return o.then(null,e)},pipe:function(){var e=arguments;return ue.Deferred(function(t){ue.each(i,function(i,n){var o=ue.isFunction(e[n[4]])&&e[n[4]];s[n[1]](function(){var e=o&&o.apply(this,arguments);e&&ue.isFunction(e.promise)?e.promise().progress(t.notify).done(t.resolve).fail(t.reject):t[n[0]+"With"](this,o?[e]:arguments)})}),e=null}).promise()},then:function(t,n,o){function s(t,i,n,o){return function(){var l=this,c=arguments,h=function(){var e,h;if(!(a>t)){if(e=n.apply(l,c),e===i.promise())throw new TypeError("Thenable self-resolution");h=e&&("object"==typeof e||"function"==typeof e)&&e.then,ue.isFunction(h)?o?h.call(e,s(a,i,r,o),s(a,i,d,o)):(a++,h.call(e,s(a,i,r,o),s(a,i,d,o),s(a,i,r,i.notifyWith))):(n!==r&&(l=void 0,c=[e]),(o||i.resolveWith)(l,c))}},u=o?h:function(){try{h()}catch(e){ue.Deferred.exceptionHook&&ue.Deferred.exceptionHook(e,u.stackTrace),t+1>=a&&(n!==d&&(l=void 0,
c=[e]),i.rejectWith(l,c))}};t?u():(ue.Deferred.getStackHook&&(u.stackTrace=ue.Deferred.getStackHook()),e.setTimeout(u))}}var a=0;return ue.Deferred(function(e){i[0][3].add(s(0,e,ue.isFunction(o)?o:r,e.notifyWith)),i[1][3].add(s(0,e,ue.isFunction(t)?t:r)),i[2][3].add(s(0,e,ue.isFunction(n)?n:d))}).promise()},promise:function(e){return null!=e?ue.extend(e,o):o}},s={};return ue.each(i,function(e,t){var a=t[2],r=t[5];o[t[1]]=a.add,r&&a.add(function(){n=r},i[3-e][2].disable,i[0][2].lock),a.add(t[3].fire),s[t[0]]=function(){return s[t[0]+"With"](this===s?void 0:this,arguments),this},s[t[0]+"With"]=a.fireWith}),o.promise(s),t&&t.call(s,s),s},when:function(e){var t=arguments.length,i=t,n=Array(i),o=te.call(arguments),s=ue.Deferred(),a=function(e){return function(i){n[e]=this,o[e]=arguments.length>1?te.call(arguments):i,--t||s.resolveWith(n,o)}};if(1>=t&&(l(e,s.done(a(i)).resolve,s.reject),"pending"===s.state()||ue.isFunction(o[i]&&o[i].then)))return s.then();for(;i--;)l(o[i],a(i),s.reject);return s.promise();
}});var Le=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;ue.Deferred.exceptionHook=function(t,i){e.console&&e.console.warn&&t&&Le.test(t.name)&&e.console.warn("jQuery.Deferred exception: "+t.message,t.stack,i)};var Ae=ue.Deferred();ue.fn.ready=function(e){return Ae.then(e),this},ue.extend({isReady:!1,readyWait:1,holdReady:function(e){e?ue.readyWait++:ue.ready(!0)},ready:function(e){(e===!0?--ue.readyWait:ue.isReady)||(ue.isReady=!0,e!==!0&&--ue.readyWait>0||Ae.resolveWith(Z,[ue]))}}),ue.ready.then=Ae.then,"complete"===Z.readyState||"loading"!==Z.readyState&&!Z.documentElement.doScroll?e.setTimeout(ue.ready):(Z.addEventListener("DOMContentLoaded",c),e.addEventListener("load",c));var De=function(e,t,i,n,o,s,a){var r=0,d=e.length,l=null==i;if("object"===ue.type(i)){o=!0;for(r in i)De(e,t,r,i[r],!0,s,a)}else if(void 0!==n&&(o=!0,ue.isFunction(n)||(a=!0),l&&(a?(t.call(e,n),t=null):(l=t,t=function(e,t,i){return l.call(ue(e),i)})),t))for(;d>r;r++)t(e[r],i,a?n:n.call(e[r],r,t(e[r],i)));
return o?e:l?t.call(e):d?t(e[0],i):s},Ie=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};h.uid=1,h.prototype={cache:function(e){var t=e[this.expando];return t||(t={},Ie(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,i){var n,o=this.cache(e);if("string"==typeof t)o[ue.camelCase(t)]=i;else for(n in t)o[ue.camelCase(n)]=t[n];return o},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][ue.camelCase(t)]},access:function(e,t,i){return void 0===t||t&&"string"==typeof t&&void 0===i?this.get(e,t):(this.set(e,t,i),void 0!==i?i:t)},remove:function(e,t){var i,n=e[this.expando];if(void 0!==n){if(void 0!==t){ue.isArray(t)?t=t.map(ue.camelCase):(t=ue.camelCase(t),t=t in n?[t]:t.match($e)||[]),i=t.length;for(;i--;)delete n[t[i]]}(void 0===t||ue.isEmptyObject(n))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!ue.isEmptyObject(t);
}};var Me=new h,Oe=new h,Ne=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Re=/[A-Z]/g;ue.extend({hasData:function(e){return Oe.hasData(e)||Me.hasData(e)},data:function(e,t,i){return Oe.access(e,t,i)},removeData:function(e,t){Oe.remove(e,t)},_data:function(e,t,i){return Me.access(e,t,i)},_removeData:function(e,t){Me.remove(e,t)}}),ue.fn.extend({data:function(e,t){var i,n,o,s=this[0],a=s&&s.attributes;if(void 0===e){if(this.length&&(o=Oe.get(s),1===s.nodeType&&!Me.get(s,"hasDataAttrs"))){for(i=a.length;i--;)a[i]&&(n=a[i].name,0===n.indexOf("data-")&&(n=ue.camelCase(n.slice(5)),u(s,n,o[n])));Me.set(s,"hasDataAttrs",!0)}return o}return"object"==typeof e?this.each(function(){Oe.set(this,e)}):De(this,function(t){var i;if(s&&void 0===t){if(i=Oe.get(s,e),void 0!==i)return i;if(i=u(s,e),void 0!==i)return i}else this.each(function(){Oe.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){Oe.remove(this,e)})}}),ue.extend({queue:function(e,t,i){var n;return e?(t=(t||"fx")+"queue",
n=Me.get(e,t),i&&(!n||ue.isArray(i)?n=Me.access(e,t,ue.makeArray(i)):n.push(i)),n||[]):void 0},dequeue:function(e,t){t=t||"fx";var i=ue.queue(e,t),n=i.length,o=i.shift(),s=ue._queueHooks(e,t),a=function(){ue.dequeue(e,t)};"inprogress"===o&&(o=i.shift(),n--),o&&("fx"===t&&i.unshift("inprogress"),delete s.stop,o.call(e,a,s)),!n&&s&&s.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return Me.get(e,i)||Me.access(e,i,{empty:ue.Callbacks("once memory").add(function(){Me.remove(e,[t+"queue",i])})})}}),ue.fn.extend({queue:function(e,t){var i=2;return"string"!=typeof e&&(t=e,e="fx",i--),arguments.length<i?ue.queue(this[0],e):void 0===t?this:this.each(function(){var i=ue.queue(this,e,t);ue._queueHooks(this,e),"fx"===e&&"inprogress"!==i[0]&&ue.dequeue(this,e)})},dequeue:function(e){return this.each(function(){ue.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var i,n=1,o=ue.Deferred(),s=this,a=this.length,r=function(){--n||o.resolveWith(s,[s]);
};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)i=Me.get(s[a],e+"queueHooks"),i&&i.empty&&(n++,i.empty.add(r));return r(),o.promise(t)}});var qe=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Be=new RegExp("^(?:([+-])=|)("+qe+")([a-z%]*)$","i"),Pe=["Top","Right","Bottom","Left"],Fe=function(e,t){return e=t||e,"none"===e.style.display||""===e.style.display&&ue.contains(e.ownerDocument,e)&&"none"===ue.css(e,"display")},Ue=function(e,t,i,n){var o,s,a={};for(s in t)a[s]=e.style[s],e.style[s]=t[s];o=i.apply(e,n||[]);for(s in t)e.style[s]=a[s];return o},je={};ue.fn.extend({show:function(){return _(this,!0)},hide:function(){return _(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Fe(this)?ue(this).show():ue(this).hide()})}});var He=/^(?:checkbox|radio)$/i,We=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,Qe=/^$|\/(?:java|ecma)script/i,Ve={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],
tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Ve.optgroup=Ve.option,Ve.tbody=Ve.tfoot=Ve.colgroup=Ve.caption=Ve.thead,Ve.th=Ve.td;var ze=/<|&#?\w+;/;!function(){var e=Z.createDocumentFragment(),t=e.appendChild(Z.createElement("div")),i=Z.createElement("input");i.setAttribute("type","radio"),i.setAttribute("checked","checked"),i.setAttribute("name","t"),t.appendChild(i),ce.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",ce.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var Ge=Z.documentElement,Ke=/^key/,Je=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Xe=/^([^.]*)(?:\.(.+)|)/;ue.event={global:{},add:function(e,t,i,n,o){var s,a,r,d,l,c,h,u,p,f,_,g=Me.get(e);if(g)for(i.handler&&(s=i,i=s.handler,o=s.selector),o&&ue.find.matchesSelector(Ge,o),i.guid||(i.guid=ue.guid++),(d=g.events)||(d=g.events={}),(a=g.handle)||(a=g.handle=function(t){return"undefined"!=typeof ue&&ue.event.triggered!==t.type?ue.event.dispatch.apply(e,arguments):void 0;
}),t=(t||"").match($e)||[""],l=t.length;l--;)r=Xe.exec(t[l])||[],p=_=r[1],f=(r[2]||"").split(".").sort(),p&&(h=ue.event.special[p]||{},p=(o?h.delegateType:h.bindType)||p,h=ue.event.special[p]||{},c=ue.extend({type:p,origType:_,data:n,handler:i,guid:i.guid,selector:o,needsContext:o&&ue.expr.match.needsContext.test(o),namespace:f.join(".")},s),(u=d[p])||(u=d[p]=[],u.delegateCount=0,h.setup&&h.setup.call(e,n,f,a)!==!1||e.addEventListener&&e.addEventListener(p,a)),h.add&&(h.add.call(e,c),c.handler.guid||(c.handler.guid=i.guid)),o?u.splice(u.delegateCount++,0,c):u.push(c),ue.event.global[p]=!0)},remove:function(e,t,i,n,o){var s,a,r,d,l,c,h,u,p,f,_,g=Me.hasData(e)&&Me.get(e);if(g&&(d=g.events)){for(t=(t||"").match($e)||[""],l=t.length;l--;)if(r=Xe.exec(t[l])||[],p=_=r[1],f=(r[2]||"").split(".").sort(),p){for(h=ue.event.special[p]||{},p=(n?h.delegateType:h.bindType)||p,u=d[p]||[],r=r[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=s=u.length;s--;)c=u[s],!o&&_!==c.origType||i&&i.guid!==c.guid||r&&!r.test(c.namespace)||n&&n!==c.selector&&("**"!==n||!c.selector)||(u.splice(s,1),
c.selector&&u.delegateCount--,h.remove&&h.remove.call(e,c));a&&!u.length&&(h.teardown&&h.teardown.call(e,f,g.handle)!==!1||ue.removeEvent(e,p,g.handle),delete d[p])}else for(p in d)ue.event.remove(e,p+t[l],i,n,!0);ue.isEmptyObject(d)&&Me.remove(e,"handle events")}},dispatch:function(e){var t,i,n,o,s,a,r=ue.event.fix(e),d=new Array(arguments.length),l=(Me.get(this,"events")||{})[r.type]||[],c=ue.event.special[r.type]||{};for(d[0]=r,t=1;t<arguments.length;t++)d[t]=arguments[t];if(r.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,r)!==!1){for(a=ue.event.handlers.call(this,r,l),t=0;(o=a[t++])&&!r.isPropagationStopped();)for(r.currentTarget=o.elem,i=0;(s=o.handlers[i++])&&!r.isImmediatePropagationStopped();)(!r.rnamespace||r.rnamespace.test(s.namespace))&&(r.handleObj=s,r.data=s.data,n=((ue.event.special[s.origType]||{}).handle||s.handler).apply(o.elem,d),void 0!==n&&(r.result=n)===!1&&(r.preventDefault(),r.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,r),r.result;
}},handlers:function(e,t){var i,n,o,s,a=[],r=t.delegateCount,d=e.target;if(r&&d.nodeType&&("click"!==e.type||isNaN(e.button)||e.button<1))for(;d!==this;d=d.parentNode||this)if(1===d.nodeType&&(d.disabled!==!0||"click"!==e.type)){for(n=[],i=0;r>i;i++)s=t[i],o=s.selector+" ",void 0===n[o]&&(n[o]=s.needsContext?ue(o,this).index(d)>-1:ue.find(o,this,null,[d]).length),n[o]&&n.push(s);n.length&&a.push({elem:d,handlers:n})}return r<t.length&&a.push({elem:this,handlers:t.slice(r)}),a},addProp:function(e,t){Object.defineProperty(ue.Event.prototype,e,{enumerable:!0,configurable:!0,get:ue.isFunction(t)?function(){return this.originalEvent?t(this.originalEvent):void 0}:function(){return this.originalEvent?this.originalEvent[e]:void 0},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[ue.expando]?e:new ue.Event(e)},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==y()&&this.focus?(this.focus(),!1):void 0},
delegateType:"focusin"},blur:{trigger:function(){return this===y()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&ue.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(e){return ue.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},ue.removeEvent=function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i)},ue.Event=function(e,t){return this instanceof ue.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?w:b,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&ue.extend(this,t),this.timeStamp=e&&e.timeStamp||ue.now(),void(this[ue.expando]=!0)):new ue.Event(e,t)},ue.Event.prototype={constructor:ue.Event,
isDefaultPrevented:b,isPropagationStopped:b,isImmediatePropagationStopped:b,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=w,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=w,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=w,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},ue.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(e){var t=e.button;return null==e.which&&Ke.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&Je.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which;
}},ue.event.addProp),ue.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){ue.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,n=this,o=e.relatedTarget,s=e.handleObj;return(!o||o!==n&&!ue.contains(n,o))&&(e.type=s.origType,i=s.handler.apply(this,arguments),e.type=t),i}}}),ue.fn.extend({on:function(e,t,i,n){return C(this,e,t,i,n)},one:function(e,t,i,n){return C(this,e,t,i,n,1)},off:function(e,t,i){var n,o;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,ue(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof e){for(o in e)this.off(o,t,e[o]);return this}return(t===!1||"function"==typeof t)&&(i=t,t=void 0),i===!1&&(i=b),this.each(function(){ue.event.remove(this,e,i,t)})}});var Ye=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,Ze=/<script|<style|<link/i,et=/checked\s*(?:[^=]|=\s*.checked.)/i,tt=/^true\/(.*)/,it=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;
ue.extend({htmlPrefilter:function(e){return e.replace(Ye,"<$1></$2>")},clone:function(e,t,i){var n,o,s,a,r=e.cloneNode(!0),d=ue.contains(e.ownerDocument,e);if(!(ce.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||ue.isXMLDoc(e)))for(a=g(r),s=g(e),n=0,o=s.length;o>n;n++)T(s[n],a[n]);if(t)if(i)for(s=s||g(e),a=a||g(r),n=0,o=s.length;o>n;n++)E(s[n],a[n]);else E(e,r);return a=g(r,"script"),a.length>0&&m(a,!d&&g(e,"script")),r},cleanData:function(e){for(var t,i,n,o=ue.event.special,s=0;void 0!==(i=e[s]);s++)if(Ie(i)){if(t=i[Me.expando]){if(t.events)for(n in t.events)o[n]?ue.event.remove(i,n):ue.removeEvent(i,n,t.handle);i[Me.expando]=void 0}i[Oe.expando]&&(i[Oe.expando]=void 0)}}}),ue.fn.extend({detach:function(e){return L(this,e,!0)},remove:function(e){return L(this,e)},text:function(e){return De(this,function(e){return void 0===e?ue.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=e)})},null,e,arguments.length)},append:function(){
return $(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=k(this,e);t.appendChild(e)}})},prepend:function(){return $(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=k(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return $(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return $(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(ue.cleanData(g(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return ue.clone(this,e,t)})},html:function(e){return De(this,function(e){var t=this[0]||{},i=0,n=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Ze.test(e)&&!Ve[(We.exec(e)||["",""])[1].toLowerCase()]){e=ue.htmlPrefilter(e);try{for(;n>i;i++)t=this[i]||{},
1===t.nodeType&&(ue.cleanData(g(t,!1)),t.innerHTML=e);t=0}catch(o){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return $(this,arguments,function(t){var i=this.parentNode;ue.inArray(this,e)<0&&(ue.cleanData(g(this)),i&&i.replaceChild(t,this))},e)}}),ue.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){ue.fn[e]=function(e){for(var i,n=[],o=ue(e),s=o.length-1,a=0;s>=a;a++)i=a===s?this:this.clone(!0),ue(o[a])[t](i),ne.apply(n,i.get());return this.pushStack(n)}});var nt=/^margin/,ot=new RegExp("^("+qe+")(?!px)[a-z%]+$","i"),st=function(t){var i=t.ownerDocument.defaultView;return i&&i.opener||(i=e),i.getComputedStyle(t)};!function(){function t(){if(r){r.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",r.innerHTML="",Ge.appendChild(a);var t=e.getComputedStyle(r);i="1%"!==t.top,s="2px"===t.marginLeft,n="4px"===t.width,
r.style.marginRight="50%",o="4px"===t.marginRight,Ge.removeChild(a),r=null}}var i,n,o,s,a=Z.createElement("div"),r=Z.createElement("div");r.style&&(r.style.backgroundClip="content-box",r.cloneNode(!0).style.backgroundClip="",ce.clearCloneStyle="content-box"===r.style.backgroundClip,a.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",a.appendChild(r),ue.extend(ce,{pixelPosition:function(){return t(),i},boxSizingReliable:function(){return t(),n},pixelMarginRight:function(){return t(),o},reliableMarginLeft:function(){return t(),s}}))}();var at=/^(none|table(?!-c[ea]).+)/,rt={position:"absolute",visibility:"hidden",display:"block"},dt={letterSpacing:"0",fontWeight:"400"},lt=["Webkit","Moz","ms"],ct=Z.createElement("div").style;ue.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=A(e,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,
opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,i,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,s,a,r=ue.camelCase(t),d=e.style;return t=ue.cssProps[r]||(ue.cssProps[r]=I(r)||r),a=ue.cssHooks[t]||ue.cssHooks[r],void 0===i?a&&"get"in a&&void 0!==(o=a.get(e,!1,n))?o:d[t]:(s=typeof i,"string"===s&&(o=Be.exec(i))&&o[1]&&(i=p(e,t,o),s="number"),null!=i&&i===i&&("number"===s&&(i+=o&&o[3]||(ue.cssNumber[r]?"":"px")),ce.clearCloneStyle||""!==i||0!==t.indexOf("background")||(d[t]="inherit"),a&&"set"in a&&void 0===(i=a.set(e,i,n))||(d[t]=i)),void 0)}},css:function(e,t,i,n){var o,s,a,r=ue.camelCase(t);return t=ue.cssProps[r]||(ue.cssProps[r]=I(r)||r),a=ue.cssHooks[t]||ue.cssHooks[r],a&&"get"in a&&(o=a.get(e,!0,i)),void 0===o&&(o=A(e,t,n)),"normal"===o&&t in dt&&(o=dt[t]),""===i||i?(s=parseFloat(o),i===!0||isFinite(s)?s||0:o):o}}),ue.each(["height","width"],function(e,t){ue.cssHooks[t]={get:function(e,i,n){return i?!at.test(ue.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?N(e,t,n):Ue(e,rt,function(){
return N(e,t,n)}):void 0},set:function(e,i,n){var o,s=n&&st(e),a=n&&O(e,t,n,"border-box"===ue.css(e,"boxSizing",!1,s),s);return a&&(o=Be.exec(i))&&"px"!==(o[3]||"px")&&(e.style[t]=i,i=ue.css(e,t)),M(e,i,a)}}}),ue.cssHooks.marginLeft=D(ce.reliableMarginLeft,function(e,t){return t?(parseFloat(A(e,"marginLeft"))||e.getBoundingClientRect().left-Ue(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px":void 0}),ue.each({margin:"",padding:"",border:"Width"},function(e,t){ue.cssHooks[e+t]={expand:function(i){for(var n=0,o={},s="string"==typeof i?i.split(" "):[i];4>n;n++)o[e+Pe[n]+t]=s[n]||s[n-2]||s[0];return o}},nt.test(e)||(ue.cssHooks[e+t].set=M)}),ue.fn.extend({css:function(e,t){return De(this,function(e,t,i){var n,o,s={},a=0;if(ue.isArray(t)){for(n=st(e),o=t.length;o>a;a++)s[t[a]]=ue.css(e,t[a],!1,n);return s}return void 0!==i?ue.style(e,t,i):ue.css(e,t)},e,t,arguments.length>1)}}),ue.Tween=R,R.prototype={constructor:R,init:function(e,t,i,n,o,s){this.elem=e,this.prop=i,this.easing=o||ue.easing._default,
this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=s||(ue.cssNumber[i]?"":"px")},cur:function(){var e=R.propHooks[this.prop];return e&&e.get?e.get(this):R.propHooks._default.get(this)},run:function(e){var t,i=R.propHooks[this.prop];return this.options.duration?this.pos=t=ue.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):R.propHooks._default.set(this),this}},R.prototype.init.prototype=R.prototype,R.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=ue.css(e.elem,e.prop,""),t&&"auto"!==t?t:0)},set:function(e){ue.fx.step[e.prop]?ue.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[ue.cssProps[e.prop]]&&!ue.cssHooks[e.prop]?e.elem[e.prop]=e.now:ue.style(e.elem,e.prop,e.now+e.unit)}}},R.propHooks.scrollTop=R.propHooks.scrollLeft={
set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},ue.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},ue.fx=R.prototype.init,ue.fx.step={};var ht,ut,pt=/^(?:toggle|show|hide)$/,ft=/queueHooks$/;ue.Animation=ue.extend(H,{tweeners:{"*":[function(e,t){var i=this.createTween(e,t);return p(i.elem,e,Be.exec(t),i),i}]},tweener:function(e,t){ue.isFunction(e)?(t=e,e=["*"]):e=e.match($e);for(var i,n=0,o=e.length;o>n;n++)i=e[n],H.tweeners[i]=H.tweeners[i]||[],H.tweeners[i].unshift(t)},prefilters:[U],prefilter:function(e,t){t?H.prefilters.unshift(e):H.prefilters.push(e)}}),ue.speed=function(e,t,i){var n=e&&"object"==typeof e?ue.extend({},e):{complete:i||!i&&t||ue.isFunction(e)&&e,duration:e,easing:i&&t||t&&!ue.isFunction(t)&&t};return ue.fx.off||Z.hidden?n.duration=0:n.duration="number"==typeof n.duration?n.duration:n.duration in ue.fx.speeds?ue.fx.speeds[n.duration]:ue.fx.speeds._default,(null==n.queue||n.queue===!0)&&(n.queue="fx"),
n.old=n.complete,n.complete=function(){ue.isFunction(n.old)&&n.old.call(this),n.queue&&ue.dequeue(this,n.queue)},n},ue.fn.extend({fadeTo:function(e,t,i,n){return this.filter(Fe).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(e,t,i,n){var o=ue.isEmptyObject(e),s=ue.speed(t,i,n),a=function(){var t=H(this,ue.extend({},e),s);(o||Me.get(this,"finish"))&&t.stop(!0)};return a.finish=a,o||s.queue===!1?this.each(a):this.queue(s.queue,a)},stop:function(e,t,i){var n=function(e){var t=e.stop;delete e.stop,t(i)};return"string"!=typeof e&&(i=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,o=null!=e&&e+"queueHooks",s=ue.timers,a=Me.get(this);if(o)a[o]&&a[o].stop&&n(a[o]);else for(o in a)a[o]&&a[o].stop&&ft.test(o)&&n(a[o]);for(o=s.length;o--;)s[o].elem!==this||null!=e&&s[o].queue!==e||(s[o].anim.stop(i),t=!1,s.splice(o,1));(t||!i)&&ue.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,i=Me.get(this),n=i[e+"queue"],o=i[e+"queueHooks"],s=ue.timers,a=n?n.length:0;
for(i.finish=!0,ue.queue(this,e,[]),o&&o.stop&&o.stop.call(this,!0),t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;a>t;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete i.finish})}}),ue.each(["toggle","show","hide"],function(e,t){var i=ue.fn[t];ue.fn[t]=function(e,n,o){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(P(t,!0),e,n,o)}}),ue.each({slideDown:P("show"),slideUp:P("hide"),slideToggle:P("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){ue.fn[e]=function(e,i,n){return this.animate(t,e,i,n)}}),ue.timers=[],ue.fx.tick=function(){var e,t=0,i=ue.timers;for(ht=ue.now();t<i.length;t++)e=i[t],e()||i[t]!==e||i.splice(t--,1);i.length||ue.fx.stop(),ht=void 0},ue.fx.timer=function(e){ue.timers.push(e),e()?ue.fx.start():ue.timers.pop()},ue.fx.interval=13,ue.fx.start=function(){ut||(ut=e.requestAnimationFrame?e.requestAnimationFrame(q):e.setInterval(ue.fx.tick,ue.fx.interval));
},ue.fx.stop=function(){e.cancelAnimationFrame?e.cancelAnimationFrame(ut):e.clearInterval(ut),ut=null},ue.fx.speeds={slow:600,fast:200,_default:400},ue.fn.delay=function(t,i){return t=ue.fx?ue.fx.speeds[t]||t:t,i=i||"fx",this.queue(i,function(i,n){var o=e.setTimeout(i,t);n.stop=function(){e.clearTimeout(o)}})},function(){var e=Z.createElement("input"),t=Z.createElement("select"),i=t.appendChild(Z.createElement("option"));e.type="checkbox",ce.checkOn=""!==e.value,ce.optSelected=i.selected,e=Z.createElement("input"),e.value="t",e.type="radio",ce.radioValue="t"===e.value}();var _t,gt=ue.expr.attrHandle;ue.fn.extend({attr:function(e,t){return De(this,ue.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){ue.removeAttr(this,e)})}}),ue.extend({attr:function(e,t,i){var n,o,s=e.nodeType;if(3!==s&&8!==s&&2!==s)return"undefined"==typeof e.getAttribute?ue.prop(e,t,i):(1===s&&ue.isXMLDoc(e)||(o=ue.attrHooks[t.toLowerCase()]||(ue.expr.match.bool.test(t)?_t:void 0)),void 0!==i?null===i?void ue.removeAttr(e,t):o&&"set"in o&&void 0!==(n=o.set(e,i,t))?n:(e.setAttribute(t,i+""),
i):o&&"get"in o&&null!==(n=o.get(e,t))?n:(n=ue.find.attr(e,t),null==n?void 0:n))},attrHooks:{type:{set:function(e,t){if(!ce.radioValue&&"radio"===t&&ue.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}},removeAttr:function(e,t){var i,n=0,o=t&&t.match($e);if(o&&1===e.nodeType)for(;i=o[n++];)e.removeAttribute(i)}}),_t={set:function(e,t,i){return t===!1?ue.removeAttr(e,i):e.setAttribute(i,i),i}},ue.each(ue.expr.match.bool.source.match(/\w+/g),function(e,t){var i=gt[t]||ue.find.attr;gt[t]=function(e,t,n){var o,s,a=t.toLowerCase();return n||(s=gt[a],gt[a]=o,o=null!=i(e,t,n)?a:null,gt[a]=s),o}});var mt=/^(?:input|select|textarea|button)$/i,vt=/^(?:a|area)$/i;ue.fn.extend({prop:function(e,t){return De(this,ue.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[ue.propFix[e]||e]})}}),ue.extend({prop:function(e,t,i){var n,o,s=e.nodeType;if(3!==s&&8!==s&&2!==s)return 1===s&&ue.isXMLDoc(e)||(t=ue.propFix[t]||t,o=ue.propHooks[t]),
void 0!==i?o&&"set"in o&&void 0!==(n=o.set(e,i,t))?n:e[t]=i:o&&"get"in o&&null!==(n=o.get(e,t))?n:e[t]},propHooks:{tabIndex:{get:function(e){var t=ue.find.attr(e,"tabindex");return t?parseInt(t,10):mt.test(e.nodeName)||vt.test(e.nodeName)&&e.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),ce.optSelected||(ue.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),ue.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ue.propFix[this.toLowerCase()]=this});var wt=/[\t\r\n\f]/g;ue.fn.extend({addClass:function(e){var t,i,n,o,s,a,r,d=0;if(ue.isFunction(e))return this.each(function(t){ue(this).addClass(e.call(this,t,W(this)))});if("string"==typeof e&&e)for(t=e.match($e)||[];i=this[d++];)if(o=W(i),n=1===i.nodeType&&(" "+o+" ").replace(wt," ")){
for(a=0;s=t[a++];)n.indexOf(" "+s+" ")<0&&(n+=s+" ");r=ue.trim(n),o!==r&&i.setAttribute("class",r)}return this},removeClass:function(e){var t,i,n,o,s,a,r,d=0;if(ue.isFunction(e))return this.each(function(t){ue(this).removeClass(e.call(this,t,W(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof e&&e)for(t=e.match($e)||[];i=this[d++];)if(o=W(i),n=1===i.nodeType&&(" "+o+" ").replace(wt," ")){for(a=0;s=t[a++];)for(;n.indexOf(" "+s+" ")>-1;)n=n.replace(" "+s+" "," ");r=ue.trim(n),o!==r&&i.setAttribute("class",r)}return this},toggleClass:function(e,t){var i=typeof e;return"boolean"==typeof t&&"string"===i?t?this.addClass(e):this.removeClass(e):ue.isFunction(e)?this.each(function(i){ue(this).toggleClass(e.call(this,i,W(this),t),t)}):this.each(function(){var t,n,o,s;if("string"===i)for(n=0,o=ue(this),s=e.match($e)||[];t=s[n++];)o.hasClass(t)?o.removeClass(t):o.addClass(t);else(void 0===e||"boolean"===i)&&(t=W(this),t&&Me.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||e===!1?"":Me.get(this,"__className__")||""));
})},hasClass:function(e){var t,i,n=0;for(t=" "+e+" ";i=this[n++];)if(1===i.nodeType&&(" "+W(i)+" ").replace(wt," ").indexOf(t)>-1)return!0;return!1}});var bt=/\r/g,yt=/[\x20\t\r\n\f]+/g;ue.fn.extend({val:function(e){var t,i,n,o=this[0];{if(arguments.length)return n=ue.isFunction(e),this.each(function(i){var o;1===this.nodeType&&(o=n?e.call(this,i,ue(this).val()):e,null==o?o="":"number"==typeof o?o+="":ue.isArray(o)&&(o=ue.map(o,function(e){return null==e?"":e+""})),t=ue.valHooks[this.type]||ue.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,o,"value")||(this.value=o))});if(o)return t=ue.valHooks[o.type]||ue.valHooks[o.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(i=t.get(o,"value"))?i:(i=o.value,"string"==typeof i?i.replace(bt,""):null==i?"":i)}}}),ue.extend({valHooks:{option:{get:function(e){var t=ue.find.attr(e,"value");return null!=t?t:ue.trim(ue.text(e)).replace(yt," ")}},select:{get:function(e){for(var t,i,n=e.options,o=e.selectedIndex,s="select-one"===e.type,a=s?null:[],r=s?o+1:n.length,d=0>o?r:s?o:0;r>d;d++)if(i=n[d],
(i.selected||d===o)&&!i.disabled&&(!i.parentNode.disabled||!ue.nodeName(i.parentNode,"optgroup"))){if(t=ue(i).val(),s)return t;a.push(t)}return a},set:function(e,t){for(var i,n,o=e.options,s=ue.makeArray(t),a=o.length;a--;)n=o[a],(n.selected=ue.inArray(ue.valHooks.option.get(n),s)>-1)&&(i=!0);return i||(e.selectedIndex=-1),s}}}}),ue.each(["radio","checkbox"],function(){ue.valHooks[this]={set:function(e,t){return ue.isArray(t)?e.checked=ue.inArray(ue(e).val(),t)>-1:void 0}},ce.checkOn||(ue.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var Ct=/^(?:focusinfocus|focusoutblur)$/;ue.extend(ue.event,{trigger:function(t,i,n,o){var s,a,r,d,l,c,h,u=[n||Z],p=re.call(t,"type")?t.type:t,f=re.call(t,"namespace")?t.namespace.split("."):[];if(a=r=n=n||Z,3!==n.nodeType&&8!==n.nodeType&&!Ct.test(p+ue.event.triggered)&&(p.indexOf(".")>-1&&(f=p.split("."),p=f.shift(),f.sort()),l=p.indexOf(":")<0&&"on"+p,t=t[ue.expando]?t:new ue.Event(p,"object"==typeof t&&t),t.isTrigger=o?2:3,
t.namespace=f.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=n),i=null==i?[t]:ue.makeArray(i,[t]),h=ue.event.special[p]||{},o||!h.trigger||h.trigger.apply(n,i)!==!1)){if(!o&&!h.noBubble&&!ue.isWindow(n)){for(d=h.delegateType||p,Ct.test(d+p)||(a=a.parentNode);a;a=a.parentNode)u.push(a),r=a;r===(n.ownerDocument||Z)&&u.push(r.defaultView||r.parentWindow||e)}for(s=0;(a=u[s++])&&!t.isPropagationStopped();)t.type=s>1?d:h.bindType||p,c=(Me.get(a,"events")||{})[t.type]&&Me.get(a,"handle"),c&&c.apply(a,i),c=l&&a[l],c&&c.apply&&Ie(a)&&(t.result=c.apply(a,i),t.result===!1&&t.preventDefault());return t.type=p,o||t.isDefaultPrevented()||h._default&&h._default.apply(u.pop(),i)!==!1||!Ie(n)||l&&ue.isFunction(n[p])&&!ue.isWindow(n)&&(r=n[l],r&&(n[l]=null),ue.event.triggered=p,n[p](),ue.event.triggered=void 0,r&&(n[l]=r)),t.result}},simulate:function(e,t,i){var n=ue.extend(new ue.Event,i,{type:e,isSimulated:!0});ue.event.trigger(n,null,t);
}}),ue.fn.extend({trigger:function(e,t){return this.each(function(){ue.event.trigger(e,t,this)})},triggerHandler:function(e,t){var i=this[0];return i?ue.event.trigger(e,t,i,!0):void 0}}),ue.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,t){ue.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}}),ue.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),ce.focusin="onfocusin"in e,ce.focusin||ue.each({focus:"focusin",blur:"focusout"},function(e,t){var i=function(e){ue.event.simulate(t,e.target,ue.event.fix(e))};ue.event.special[t]={setup:function(){var n=this.ownerDocument||this,o=Me.access(n,t);o||n.addEventListener(e,i,!0),Me.access(n,t,(o||0)+1)},teardown:function(){var n=this.ownerDocument||this,o=Me.access(n,t)-1;o?Me.access(n,t,o):(n.removeEventListener(e,i,!0),Me.remove(n,t));
}}});var kt=e.location,xt=ue.now(),St=/\?/;ue.parseXML=function(t){var i;if(!t||"string"!=typeof t)return null;try{i=(new e.DOMParser).parseFromString(t,"text/xml")}catch(n){i=void 0}return(!i||i.getElementsByTagName("parsererror").length)&&ue.error("Invalid XML: "+t),i};var Et=/\[\]$/,Tt=/\r?\n/g,$t=/^(?:submit|button|image|reset|file)$/i,Lt=/^(?:input|select|textarea|keygen)/i;ue.param=function(e,t){var i,n=[],o=function(e,t){var i=ue.isFunction(t)?t():t;n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==i?"":i)};if(ue.isArray(e)||e.jquery&&!ue.isPlainObject(e))ue.each(e,function(){o(this.name,this.value)});else for(i in e)Q(i,e[i],t,o);return n.join("&")},ue.fn.extend({serialize:function(){return ue.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=ue.prop(this,"elements");return e?ue.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!ue(this).is(":disabled")&&Lt.test(this.nodeName)&&!$t.test(e)&&(this.checked||!He.test(e));
}).map(function(e,t){var i=ue(this).val();return null==i?null:ue.isArray(i)?ue.map(i,function(e){return{name:t.name,value:e.replace(Tt,"\r\n")}}):{name:t.name,value:i.replace(Tt,"\r\n")}}).get()}});var At=/%20/g,Dt=/#.*$/,It=/([?&])_=[^&]*/,Mt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ot=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Nt=/^(?:GET|HEAD)$/,Rt=/^\/\//,qt={},Bt={},Pt="*/".concat("*"),Ft=Z.createElement("a");Ft.href=kt.href,ue.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:kt.href,type:"GET",isLocal:Ot.test(kt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Pt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":ue.parseXML},flatOptions:{
url:!0,context:!0}},ajaxSetup:function(e,t){return t?G(G(e,ue.ajaxSettings),t):G(ue.ajaxSettings,e)},ajaxPrefilter:V(qt),ajaxTransport:V(Bt),ajax:function(t,i){function n(t,i,n,r){var l,u,p,b,y,C=i;c||(c=!0,d&&e.clearTimeout(d),o=void 0,a=r||"",k.readyState=t>0?4:0,l=t>=200&&300>t||304===t,n&&(b=K(f,k,n)),b=J(f,b,k,l),l?(f.ifModified&&(y=k.getResponseHeader("Last-Modified"),y&&(ue.lastModified[s]=y),y=k.getResponseHeader("etag"),y&&(ue.etag[s]=y)),204===t||"HEAD"===f.type?C="nocontent":304===t?C="notmodified":(C=b.state,u=b.data,p=b.error,l=!p)):(p=C,(t||!C)&&(C="error",0>t&&(t=0))),k.status=t,k.statusText=(i||C)+"",l?m.resolveWith(_,[u,C,k]):m.rejectWith(_,[k,C,p]),k.statusCode(w),w=void 0,h&&g.trigger(l?"ajaxSuccess":"ajaxError",[k,f,l?u:p]),v.fireWith(_,[k,C]),h&&(g.trigger("ajaxComplete",[k,f]),--ue.active||ue.event.trigger("ajaxStop")))}"object"==typeof t&&(i=t,t=void 0),i=i||{};var o,s,a,r,d,l,c,h,u,p,f=ue.ajaxSetup({},i),_=f.context||f,g=f.context&&(_.nodeType||_.jquery)?ue(_):ue.event,m=ue.Deferred(),v=ue.Callbacks("once memory"),w=f.statusCode||{},b={},y={},C="canceled",k={
readyState:0,getResponseHeader:function(e){var t;if(c){if(!r)for(r={};t=Mt.exec(a);)r[t[1].toLowerCase()]=t[2];t=r[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return c?a:null},setRequestHeader:function(e,t){return null==c&&(e=y[e.toLowerCase()]=y[e.toLowerCase()]||e,b[e]=t),this},overrideMimeType:function(e){return null==c&&(f.mimeType=e),this},statusCode:function(e){var t;if(e)if(c)k.always(e[k.status]);else for(t in e)w[t]=[w[t],e[t]];return this},abort:function(e){var t=e||C;return o&&o.abort(t),n(0,t),this}};if(m.promise(k),f.url=((t||f.url||kt.href)+"").replace(Rt,kt.protocol+"//"),f.type=i.method||i.type||f.method||f.type,f.dataTypes=(f.dataType||"*").toLowerCase().match($e)||[""],null==f.crossDomain){l=Z.createElement("a");try{l.href=f.url,l.href=l.href,f.crossDomain=Ft.protocol+"//"+Ft.host!=l.protocol+"//"+l.host}catch(x){f.crossDomain=!0}}if(f.data&&f.processData&&"string"!=typeof f.data&&(f.data=ue.param(f.data,f.traditional)),z(qt,f,i,k),c)return k;
h=ue.event&&f.global,h&&0===ue.active++&&ue.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!Nt.test(f.type),s=f.url.replace(Dt,""),f.hasContent?f.data&&f.processData&&0===(f.contentType||"").indexOf("application/x-www-form-urlencoded")&&(f.data=f.data.replace(At,"+")):(p=f.url.slice(s.length),f.data&&(s+=(St.test(s)?"&":"?")+f.data,delete f.data),f.cache===!1&&(s=s.replace(It,""),p=(St.test(s)?"&":"?")+"_="+xt++ +p),f.url=s+p),f.ifModified&&(ue.lastModified[s]&&k.setRequestHeader("If-Modified-Since",ue.lastModified[s]),ue.etag[s]&&k.setRequestHeader("If-None-Match",ue.etag[s])),(f.data&&f.hasContent&&f.contentType!==!1||i.contentType)&&k.setRequestHeader("Content-Type",f.contentType),k.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+Pt+"; q=0.01":""):f.accepts["*"]);for(u in f.headers)k.setRequestHeader(u,f.headers[u]);if(f.beforeSend&&(f.beforeSend.call(_,k,f)===!1||c))return k.abort();if(C="abort",
v.add(f.complete),k.done(f.success),k.fail(f.error),o=z(Bt,f,i,k)){if(k.readyState=1,h&&g.trigger("ajaxSend",[k,f]),c)return k;f.async&&f.timeout>0&&(d=e.setTimeout(function(){k.abort("timeout")},f.timeout));try{c=!1,o.send(b,n)}catch(x){if(c)throw x;n(-1,x)}}else n(-1,"No Transport");return k},getJSON:function(e,t,i){return ue.get(e,t,i,"json")},getScript:function(e,t){return ue.get(e,void 0,t,"script")}}),ue.each(["get","post"],function(e,t){ue[t]=function(e,i,n,o){return ue.isFunction(i)&&(o=o||n,n=i,i=void 0),ue.ajax(ue.extend({url:e,type:t,dataType:o,data:i,success:n},ue.isPlainObject(e)&&e))}}),ue._evalUrl=function(e){return ue.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,"throws":!0})},ue.fn.extend({wrapAll:function(e){var t;return this[0]&&(ue.isFunction(e)&&(e=e.call(this[0])),t=ue(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),
this},wrapInner:function(e){return ue.isFunction(e)?this.each(function(t){ue(this).wrapInner(e.call(this,t))}):this.each(function(){var t=ue(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)})},wrap:function(e){var t=ue.isFunction(e);return this.each(function(i){ue(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(e){return this.parent(e).not("body").each(function(){ue(this).replaceWith(this.childNodes)}),this}}),ue.expr.pseudos.hidden=function(e){return!ue.expr.pseudos.visible(e)},ue.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},ue.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(t){}};var Ut={0:200,1223:204},jt=ue.ajaxSettings.xhr();ce.cors=!!jt&&"withCredentials"in jt,ce.ajax=jt=!!jt,ue.ajaxTransport(function(t){var i,n;return ce.cors||jt&&!t.crossDomain?{send:function(o,s){var a,r=t.xhr();if(r.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(a in t.xhrFields)r[a]=t.xhrFields[a];t.mimeType&&r.overrideMimeType&&r.overrideMimeType(t.mimeType),
t.crossDomain||o["X-Requested-With"]||(o["X-Requested-With"]="XMLHttpRequest");for(a in o)r.setRequestHeader(a,o[a]);i=function(e){return function(){i&&(i=n=r.onload=r.onerror=r.onabort=r.onreadystatechange=null,"abort"===e?r.abort():"error"===e?"number"!=typeof r.status?s(0,"error"):s(r.status,r.statusText):s(Ut[r.status]||r.status,r.statusText,"text"!==(r.responseType||"text")||"string"!=typeof r.responseText?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders()))}},r.onload=i(),n=r.onerror=i("error"),void 0!==r.onabort?r.onabort=n:r.onreadystatechange=function(){4===r.readyState&&e.setTimeout(function(){i&&n()})},i=i("abort");try{r.send(t.hasContent&&t.data||null)}catch(d){if(i)throw d}},abort:function(){i&&i()}}:void 0}),ue.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),ue.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){
return ue.globalEval(e),e}}}),ue.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),ue.ajaxTransport("script",function(e){if(e.crossDomain){var t,i;return{send:function(n,o){t=ue("<script>").prop({charset:e.scriptCharset,src:e.url}).on("load error",i=function(e){t.remove(),i=null,e&&o("error"===e.type?404:200,e.type)}),Z.head.appendChild(t[0])},abort:function(){i&&i()}}}});var Ht=[],Wt=/(=)\?(?=&|$)|\?\?/;ue.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Ht.pop()||ue.expando+"_"+xt++;return this[e]=!0,e}}),ue.ajaxPrefilter("json jsonp",function(t,i,n){var o,s,a,r=t.jsonp!==!1&&(Wt.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Wt.test(t.data)&&"data");return r||"jsonp"===t.dataTypes[0]?(o=t.jsonpCallback=ue.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,r?t[r]=t[r].replace(Wt,"$1"+o):t.jsonp!==!1&&(t.url+=(St.test(t.url)?"&":"?")+t.jsonp+"="+o),t.converters["script json"]=function(){
return a||ue.error(o+" was not called"),a[0]},t.dataTypes[0]="json",s=e[o],e[o]=function(){a=arguments},n.always(function(){void 0===s?ue(e).removeProp(o):e[o]=s,t[o]&&(t.jsonpCallback=i.jsonpCallback,Ht.push(o)),a&&ue.isFunction(s)&&s(a[0]),a=s=void 0}),"script"):void 0}),ce.createHTMLDocument=function(){var e=Z.implementation.createHTMLDocument("").body;return e.innerHTML="<form></form><form></form>",2===e.childNodes.length}(),ue.parseHTML=function(e,t,i){if("string"!=typeof e)return[];"boolean"==typeof t&&(i=t,t=!1);var n,o,s;return t||(ce.createHTMLDocument?(t=Z.implementation.createHTMLDocument(""),n=t.createElement("base"),n.href=Z.location.href,t.head.appendChild(n)):t=Z),o=ye.exec(e),s=!i&&[],o?[t.createElement(o[1])]:(o=v([e],t,s),s&&s.length&&ue(s).remove(),ue.merge([],o.childNodes))},ue.fn.load=function(e,t,i){var n,o,s,a=this,r=e.indexOf(" ");return r>-1&&(n=ue.trim(e.slice(r)),e=e.slice(0,r)),ue.isFunction(t)?(i=t,t=void 0):t&&"object"==typeof t&&(o="POST"),a.length>0&&ue.ajax({
url:e,type:o||"GET",dataType:"html",data:t}).done(function(e){s=arguments,a.html(n?ue("<div>").append(ue.parseHTML(e)).find(n):e)}).always(i&&function(e,t){a.each(function(){i.apply(this,s||[e.responseText,t,e])})}),this},ue.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){ue.fn[t]=function(e){return this.on(t,e)}}),ue.expr.pseudos.animated=function(e){return ue.grep(ue.timers,function(t){return e===t.elem}).length},ue.offset={setOffset:function(e,t,i){var n,o,s,a,r,d,l,c=ue.css(e,"position"),h=ue(e),u={};"static"===c&&(e.style.position="relative"),r=h.offset(),s=ue.css(e,"top"),d=ue.css(e,"left"),l=("absolute"===c||"fixed"===c)&&(s+d).indexOf("auto")>-1,l?(n=h.position(),a=n.top,o=n.left):(a=parseFloat(s)||0,o=parseFloat(d)||0),ue.isFunction(t)&&(t=t.call(e,i,ue.extend({},r))),null!=t.top&&(u.top=t.top-r.top+a),null!=t.left&&(u.left=t.left-r.left+o),"using"in t?t.using.call(e,u):h.css(u)}},ue.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){
ue.offset.setOffset(this,e,t)});var t,i,n,o,s=this[0];if(s)return s.getClientRects().length?(n=s.getBoundingClientRect(),n.width||n.height?(o=s.ownerDocument,i=X(o),t=o.documentElement,{top:n.top+i.pageYOffset-t.clientTop,left:n.left+i.pageXOffset-t.clientLeft}):n):{top:0,left:0}},position:function(){if(this[0]){var e,t,i=this[0],n={top:0,left:0};return"fixed"===ue.css(i,"position")?t=i.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),ue.nodeName(e[0],"html")||(n=e.offset()),n={top:n.top+ue.css(e[0],"borderTopWidth",!0),left:n.left+ue.css(e[0],"borderLeftWidth",!0)}),{top:t.top-n.top-ue.css(i,"marginTop",!0),left:t.left-n.left-ue.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===ue.css(e,"position");)e=e.offsetParent;return e||Ge})}}),ue.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var i="pageYOffset"===t;ue.fn[e]=function(n){return De(this,function(e,n,o){var s=X(e);return void 0===o?s?s[t]:e[n]:void(s?s.scrollTo(i?s.pageXOffset:o,i?o:s.pageYOffset):e[n]=o);
},e,n,arguments.length)}}),ue.each(["top","left"],function(e,t){ue.cssHooks[t]=D(ce.pixelPosition,function(e,i){return i?(i=A(e,t),ot.test(i)?ue(e).position()[t]+"px":i):void 0})}),ue.each({Height:"height",Width:"width"},function(e,t){ue.each({padding:"inner"+e,content:t,"":"outer"+e},function(i,n){ue.fn[n]=function(o,s){var a=arguments.length&&(i||"boolean"!=typeof o),r=i||(o===!0||s===!0?"margin":"border");return De(this,function(t,i,o){var s;return ue.isWindow(t)?0===n.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(s=t.documentElement,Math.max(t.body["scroll"+e],s["scroll"+e],t.body["offset"+e],s["offset"+e],s["client"+e])):void 0===o?ue.css(t,i,r):ue.style(t,i,o,r)},t,a?o:void 0,a)}})}),ue.fn.extend({bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)}}),ue.parseJSON=JSON.parse,
"function"==typeof define&&define.amd&&define("jquery",[],function(){return ue});var Qt=e.jQuery,Vt=e.$;return ue.noConflict=function(t){return e.$===ue&&(e.$=Vt),t&&e.jQuery===ue&&(e.jQuery=Qt),ue},t||(e.jQuery=e.$=ue),ue})}),define("third_party/browser",["shared/polyfills"],function(e,t,i){!function(e,t){"undefined"!=typeof i&&i.exports?i.exports=t():"function"==typeof define&&define.amd?define(e,t):this[e]=t()}("bowser",function(){function e(e){function t(t){var i=e.match(t);return i&&i.length>1&&i[1]||""}function i(t){var i=e.match(t);return i&&i.length>1&&i[2]||""}var n,o=t(/(ipod|iphone|ipad)/i).toLowerCase(),s=/like android/i.test(e),r=!s&&/android/i.test(e),d=/nexus\s*[0-6]\s*/i.test(e),l=!d&&/nexus\s*[0-9]+/i.test(e),c=/CrOS/.test(e),h=/silk/i.test(e),u=/sailfish/i.test(e),p=/tizen/i.test(e),f=/(web|hpw)os/i.test(e),_=/windows phone/i.test(e),g=(/SamsungBrowser/i.test(e),!_&&/windows/i.test(e)),m=!o&&!h&&/macintosh/i.test(e),v=!r&&!u&&!p&&!f&&/linux/i.test(e),w=t(/edge\/(\d+(\.\d+)?)/i),b=t(/version\/(\d+(\.\d+)?)/i),y=/tablet/i.test(e),C=!y&&/[^-]mobi/i.test(e),k=/xbox/i.test(e);
/opera/i.test(e)?n={name:"Opera",opera:a,version:b||t(/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)}:/opr|opios/i.test(e)?n={name:"Opera",opera:a,version:t(/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i)||b}:/SamsungBrowser/i.test(e)?n={name:"Samsung Internet for Android",samsungBrowser:a,version:b||t(/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)}:/coast/i.test(e)?n={name:"Opera Coast",coast:a,version:b||t(/(?:coast)[\s\/](\d+(\.\d+)?)/i)}:/yabrowser/i.test(e)?n={name:"Yandex Browser",yandexbrowser:a,version:b||t(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/ucbrowser/i.test(e)?n={name:"UC Browser",ucbrowser:a,version:t(/(?:ucbrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/mxios/i.test(e)?n={name:"Maxthon",maxthon:a,version:t(/(?:mxios)[\s\/](\d+(?:\.\d+)+)/i)}:/epiphany/i.test(e)?n={name:"Epiphany",epiphany:a,version:t(/(?:epiphany)[\s\/](\d+(?:\.\d+)+)/i)}:/puffin/i.test(e)?n={name:"Puffin",puffin:a,version:t(/(?:puffin)[\s\/](\d+(?:\.\d+)?)/i)}:/sleipnir/i.test(e)?n={name:"Sleipnir",sleipnir:a,version:t(/(?:sleipnir)[\s\/](\d+(?:\.\d+)+)/i)
}:/k-meleon/i.test(e)?n={name:"K-Meleon",kMeleon:a,version:t(/(?:k-meleon)[\s\/](\d+(?:\.\d+)+)/i)}:_?(n={name:"Windows Phone",windowsphone:a},w?(n.msedge=a,n.version=w):(n.msie=a,n.version=t(/iemobile\/(\d+(\.\d+)?)/i))):/msie|trident/i.test(e)?n={name:"Internet Explorer",msie:a,version:t(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:c?n={name:"Chrome",chromeos:a,chromeBook:a,chrome:a,version:t(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/chrome.+? edge/i.test(e)?n={name:"Microsoft Edge",msedge:a,version:w}:/vivaldi/i.test(e)?n={name:"Vivaldi",vivaldi:a,version:t(/vivaldi\/(\d+(\.\d+)?)/i)||b}:u?n={name:"Sailfish",sailfish:a,version:t(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(e)?n={name:"SeaMonkey",seamonkey:a,version:t(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel|fxios/i.test(e)?(n={name:"Firefox",firefox:a,version:t(/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(e)&&(n.firefoxos=a)):h?n={name:"Amazon Silk",silk:a,version:t(/silk\/(\d+(\.\d+)?)/i)
}:/phantom/i.test(e)?n={name:"PhantomJS",phantom:a,version:t(/phantomjs\/(\d+(\.\d+)?)/i)}:/slimerjs/i.test(e)?n={name:"SlimerJS",slimer:a,version:t(/slimerjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(e)||/rim\stablet/i.test(e)?n={name:"BlackBerry",blackberry:a,version:b||t(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:f?(n={name:"WebOS",webos:a,version:b||t(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(e)&&(n.touchpad=a)):/bada/i.test(e)?n={name:"Bada",bada:a,version:t(/dolfin\/(\d+(\.\d+)?)/i)}:p?n={name:"Tizen",tizen:a,version:t(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||b}:/qupzilla/i.test(e)?n={name:"QupZilla",qupzilla:a,version:t(/(?:qupzilla)[\s\/](\d+(?:\.\d+)+)/i)||b}:/chromium/i.test(e)?n={name:"Chromium",chromium:a,version:t(/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i)||b}:/chrome|crios|crmo/i.test(e)?n={name:"Chrome",chrome:a,version:t(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:r?n={name:"Android",version:b}:/safari|applewebkit/i.test(e)?(n={name:"Safari",safari:a},b&&(n.version=b)):o?(n={
name:"iphone"==o?"iPhone":"ipad"==o?"iPad":"iPod"},b&&(n.version=b)):n=/googlebot/i.test(e)?{name:"Googlebot",googlebot:a,version:t(/googlebot\/(\d+(\.\d+))/i)||b}:{name:t(/^(.*)\/(.*) /),version:i(/^(.*)\/(.*) /)},!n.msedge&&/(apple)?webkit/i.test(e)?(/(apple)?webkit\/537\.36/i.test(e)?(n.name=n.name||"Blink",n.blink=a):(n.name=n.name||"Webkit",n.webkit=a),!n.version&&b&&(n.version=b)):!n.opera&&/gecko\//i.test(e)&&(n.name=n.name||"Gecko",n.gecko=a,n.version=n.version||t(/gecko\/(\d+(\.\d+)?)/i)),n.msedge||!r&&!n.silk?o?(n[o]=a,n.ios=a):m?n.mac=a:k?n.xbox=a:g?n.windows=a:v&&(n.linux=a):n.android=a;var x="";n.windowsphone?x=t(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):o?(x=t(/os (\d+([_\s]\d+)*) like mac os x/i),x=x.replace(/[_\s]/g,".")):r?x=t(/android[ \/-](\d+(\.\d+)*)/i):n.webos?x=t(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):n.blackberry?x=t(/rim\stablet\sos\s(\d+(\.\d+)*)/i):n.bada?x=t(/bada\/(\d+(\.\d+)*)/i):n.tizen&&(x=t(/tizen[\/\s](\d+(\.\d+)*)/i)),x&&(n.osversion=x);var S=x.split(".")[0];
return y||l||"ipad"==o||r&&(3==S||S>=4&&!C)||n.silk?n.tablet=a:(C||"iphone"==o||"ipod"==o||r||d||n.blackberry||n.webos||n.bada)&&(n.mobile=a),n.msedge||n.msie&&n.version>=10||n.yandexbrowser&&n.version>=15||n.vivaldi&&n.version>=1||n.chrome&&n.version>=20||n.samsungBrowser&&n.version>=4||n.firefox&&n.version>=20||n.safari&&n.version>=6||n.opera&&n.version>=10||n.ios&&n.osversion&&n.osversion.split(".")[0]>=6||n.blackberry&&n.version>=10.1||n.chromium&&n.version>=20?n.a=a:n.msie&&n.version<10||n.chrome&&n.version<20||n.firefox&&n.version<20||n.safari&&n.version<6||n.opera&&n.version<10||n.ios&&n.osversion&&n.osversion.split(".")[0]<6||n.chromium&&n.version<20?n.c=a:n.x=a,n}function t(e){return e.split(".").length}function i(e,t){var i,n=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(i=0;i<e.length;i++)n.push(t(e[i]));return n}function n(e){for(var n=Math.max(t(e[0]),t(e[1])),o=i(e,function(e){var o=n-t(e);return e+=new Array(o+1).join(".0"),i(e.split("."),function(e){
return new Array(20-e.length).join("0")+e}).reverse()});--n>=0;){if(o[0][n]>o[1][n])return 1;if(o[0][n]!==o[1][n])return-1;if(0===n)return 0}}function o(t,i,o){var s=r;"string"==typeof i&&(o=i,i=void 0),void 0===i&&(i=!1),o&&(s=e(o));var a=""+s.version;for(var d in t)if(t.hasOwnProperty(d)&&s[d])return n([a,t[d]])<0;return i}function s(e,t,i){return!o(e,t,i)}var a=!0,r=e("undefined"!=typeof navigator?navigator.userAgent||"":"");return r.test=function(e){for(var t=0;t<e.length;++t){var i=e[t];if("string"==typeof i&&i in r)return!0}return!1},r.isUnsupportedBrowser=o,r.compareVersions=n,r.check=s,r._detect=e,r})}),define("shared/browser",["shared/polyfills","shared/browser","third_party/browser"],function(e,t,i){var n=e("third_party/browser");n.version=parseFloat(n.version),i.exports=n}),define("shared/client",["shared/polyfills","settings","shared/browser"],function(e,t,i){var n=e("settings"),o=n.pageIsMobile,s=e("shared/browser"),a=t.DeviceType={ANDROID:0,IOS:1,WEB:2},r=t.getDeviceType=function(){
var e=n.deviceName;return"iphone"==e?a.IOS:"android"==e?a.ANDROID:a.WEB},d=t.isIOSApp=function(){return r()==a.IOS},l=t.isAndroidApp=function(){return r()==a.ANDROID};t.isNativeApp=function(){return d()||l()};var c=t.isMobileWeb=function(){return o&&r()==a.WEB};t.isWKWebView=function(){return d()&&window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.Q?!0:!1},t.isUIWebView=function(){return d()&&!window.webkit};var h=t.isAndroidMobileWeb=function(){return c()&&s.android};t.isIOSMobileWeb=function(){return c()&&s.ios},t.isAndroid=function(){return h()||l()}}),define("shared/jquery",["shared/polyfills","settings","shared/errors","third_party/jquery3","shared/client"],function(e,t,i){var n,o=e("settings"),s=e("shared/errors"),a=e("third_party/jquery3"),r=e("shared/client");o.pageIsMobile&&(n=e("mobile_app2/android_click_hack"));var d=a.fn.offset,l=function(){var e,t=this[0],i={top:0,left:0};return t&&t.nodeType?(e=(t.ownerDocument||document).documentElement,a.contains(e,t)?d.apply(this,arguments):i):i;
},c=function(e){return"click"!=e[0]?e:(r.isIOSApp()&&"fasttouch"==o.clickHandlerType&&(this.is(document)||this.attr("highlightable")||this.attr("highlightable",!0),e[0]="fastTouchClick"),r.isAndroidApp()&&o.osVersion<=4.3&&("function"==typeof e[1]?e[1]=n.rateLimitWrap(e[1]):"function"==typeof e[2]?e[2]=n.rateLimitWrap(e[2]):"function"==typeof e[3]&&(e[3]=n.rateLimitWrap(e[3]))),e)},h=a.fn.on,u=function(e,t,i,n){if("string"!=typeof e)return void s.logJsError("jQuery.on","invalid events argument "+e);if("click"!=e&&-1!=e.indexOf("click"))return void s.logJsError("jQuery.on","bind click events separately "+e);var o=c.call(this,Array.prototype.slice.call(arguments));return h.apply(this,o)},p=a.fn.off,f=function(e,t,i){if(!e)return p.apply(this,arguments);if("click"!=e&&-1!=e.indexOf("click"))return void s.logJsError("jQuery.off","unbind click events separately "+e);var n=c.call(this,Array.prototype.slice.call(arguments));return p.apply(this,n)};o.pageIsMobile?(a.fn.on=u,a.fn.off=f):a.fn.offset=l,
i.exports=a}),define("shared/beforeunload",["shared/polyfills","shared/jquery"],function(e,t,i){var n=e("shared/jquery"),o=[];t.registerHandler=function(e){o.push(e)};var s=function(e){e=e||window.event;for(var t,i=0;i<o.length;i++){var n=o[i].call(o,e);if(n){t=n;break}}return e&&(e.returnValue=t),t};n(window).on("beforeunload",s)}),define("shared/Class",["shared/polyfills"],function(e,t,i){function n(e,t){function i(){if(n||(e.call(l),o(r,t,s),n=!0,t=null),this!==l){var i=this.__init__;i&&i.apply(this,arguments)}}var n,s=d.prototype=e.prototype,r=new d;return i.prototype=r,i.extend=a,r.constructor=i,i}function o(e,t,i){for(var n in t)t.hasOwnProperty(n)&&(e[n]=i?s(n,t,i):t[n])}function s(e,t,i){var n=t[e],o=i[e];return"function"==typeof n&&"function"==typeof o&&n!==o&&r.test(n)?function(){var t=this._super;this._super=i[e];try{return n.apply(this,arguments)}finally{this._super=t}}:n}function a(e){return n(this,e)}var r=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,d=function(){},l={};t.Class=a.call(function(){},{});
}),define("shared/eventemitter",["shared/polyfills","shared/Class","shared/errors"],function(e,t,i){var n=e("shared/Class").Class,o=e("shared/errors");t.EventEmitter=n.extend({on:function(e,t){this.__handlers=this.__handlers||{},this.__handlers[e]=this.__handlers[e]||[],this.__handlers[e].push(t)},off:function(e,t){if(this.__handlers&&this.__handlers[e]){var i=this.__handlers[e].indexOf(t);-1!=i&&this.__handlers[e].splice(i,1)}},once:function(e,t){this.__onceHandlers=this.__onceHandlers||{},this.__onceHandlers[e]=this.__onceHandlers[e]||[],this.__onceHandlers[e].push(t)},trigger:function(e,t){for(var i=this.__handlers&&this.__handlers[e]||[],n=0;n<i.length;n++)try{i[n].apply(null,t||[])}catch(s){o.report(s)}for(var a=this.__onceHandlers&&this.__onceHandlers[e]||[];0!==a.length;)try{a.pop().apply(null,t||[])}catch(s){o.report(s)}}})}),define("shared/w2.context",["shared/polyfills","shared/Class","shared/errors"],function(e,t,i){var n=e("shared/Class").Class,o=e("shared/errors"),s=n.extend({
__init__:function(e){this.value=e,this.handlers={}},bind:function(e,t){this.handlers.hasOwnProperty(t)||(this.handlers[t]=[]),this.handlers[t].push(e)},unbind:function(e){delete this.handlers[e]},trigger:function(){var e=Array.prototype.slice.call(arguments);for(var t in this.handlers)if(this.handlers.hasOwnProperty(t))for(var i=this.handlers[t],n=0;n<i.length;n++)i[n].apply(this,e)},set:function(e){var t=this.value;this.value=e,this.trigger(t,e)},get:function(){return this.value}}),a=t.Context=n.extend({__init__:function(){var e=this.initialProperties();if(!e){var t=["Override initialProperties() in your subclasses to define a list ","of properties that this Context should listen to."].join("");return void o.logJsError("w2.context",t)}this.properties={};for(var i in e)this.properties[i]=new s(e[i])},initialProperties:function(){},on:function(e,t,i){this.assertPropertyName(e),this.properties[e].bind(t,i)},off:function(e){for(var t in this.properties)this.properties[t].unbind(e)},set:function(e,t){
this.assertPropertyName(e),this.properties[e].set(t)},get:function(e){return this.assertPropertyName(e),this.properties[e].get()},assertPropertyName:function(e){if(!this.properties.hasOwnProperty(e)){var t=["Hey, you are trying to access a context property with an invalid ","property name. You can only retrieve property names that are defined ","in the Context initialProperties definition."].join("");o.logJsError("w2.context",t)}}}),r=n.extend({__init__:function(e,t){this._context=e,this._cid=t},on:function(e,t){this._context.on(e,t,this._cid)},off:function(){this._context.off(this._cid)},get:function(e){return this._context.get(e)},set:function(e,t){this._context.set(e,t)}}),d=n.extend({__init__:function(e){this.component=e;var t=this.component.contextConstructor();this._context=t?new t(this.component):null,this._contextProxies=[]},get:function(e){for(var t=0;t<this._contextProxies.length;t++)if(this._contextProxies[t]._context instanceof e)return this._contextProxies[t];for(var i=null,n=this.component;n&&"*ROOT*"!=n.cid;){
var o=n.contextManager._context;if(o instanceof e){i=o;break}var s=n.parent();if(n===s)throw new Error(n+"is its own parent()");n=s}if(!i)return null;var a=new r(i,this.component.cid);return this._contextProxies.push(a),a},unload:function(){for(var e=0;e<this._contextProxies.length;e++)this._contextProxies[e].off()}});t.initComponent=function(e){var t=new d(e);e.contextManager=t,e.getContext=t.get.bind(t)},t.unloadComponent=function(e){e.contextManager&&e.contextManager.unload()},t.ActionBar=a.extend({initialProperties:function(){return{commentsElem:null,loadComments:!1,showComments:!1,feedCommentExpanded:!1,pageFeedCommentsLink:null,feedCommentsPaged:!1,updateSticky:!1,toggleRAD:!1}}}),t.UniversalPageFeedContext=a.extend({initialProperties:function(){return{feedStories:[],impressionLogger:null,readingTimeLogger:null}}}),t.CaptchaInput=a.extend({initialProperties:function(){return{present:!1,sync:null,isCaptchaFilled:!0,captchaResponse:""}}}),t.HoverMenu=a.extend({initialProperties:function(){
return{isShown:!1,hidden:!0}}})}),define("interface/settings",["shared/polyfills","settings"],function(e,t,i){var n=e("settings");t.action=n.action,t.batchedServerCallUrl=n.batchedServerCallUrl,t.clientTrackerTrail=n.clientTrackerTrail,t.componentInspector=n.componentInspector,t.controller=n.controller,t.debug=n.debug,t.enableClientTracker=n.enableClientTracker,t.enableFrameBusting=n.enableFrameBusting,t.interface_strings=n.interface_strings,t.isLoggedIn=n.isLoggedIn,t.logComponentTime=n.logComponentTime,t.pageIsMobile=n.pageIsMobile,t.serverCallUrl=n.serverCallUrl,t.windowId=n.windowId}),define("shared/events/types",["shared/polyfills","shared/util"],function(e,t,i){var n=e("shared/util");t.EventTypes=n.makeEnum(["ADS_MANAGER_TABLE_SORT","ADS_MANAGER_ADD_SUGGESTED_TOPIC","ADS_MANAGER_UPDATE_SUGGESTED_TOPIC","ACTIVATION_NEXT_STEP","ACTIVATION_PROGRESS_BAR_STEP","ANON_LINK_SAVED","ANSWER_COMMENT_SORT_ALL","ANSWER_FEED_INLINE_EXPAND","ANSWER_MODAL_CONTENT_VISIBLE","ANSWER_TOGGLE_EDITOR","ANSWER_VOTE_STATE","ASK_QUESTION_MODAL_SUBMIT","ASK_QUESTION_MODAL_RESULT_CLICK","ASK_QUESTION_MODAL_QUERY_CHANGE","CAROUSEL_CHECK_DISMISS_ALL","CAROUSEL_DISMISS_ALL","COMMENT_ADD","CREDENTIAL_ADDED","CREDENTIAL_DELETED","CREDENTIAL_ADD_FORM_VISIBILITY","CREDENTIAL_CHOSEN","FEED_IMPRESSIONS_DISABLED","FEED_NUM_PIN_TOPICS","FEED_CONTROL_UPDATE","FEED_PAGING_DONE","FILTER_NAV_LIST_UPDATE","INLINE_EDITOR_STATE","INTERACTION_MODE_BANNER_STATE","KNOWS_ABOUT_ADD_TOPIC","KNOWS_ABOUT_REMOVE_TOPIC","LIVENODE_LOADING_SPINNER","LOGIN_UPDATE_FIELDS","LOGIN_USER","LOGOUT_USER","LOOKUP_BAR_ASK_QUESTION","LOOKUP_BAR_QUESTION_DETAILS_STATE","LOOKUP_BAR_SET_ASKING_TARGET","MULTIFEED_BUNDLE_REMOVE","NOTIFS_CLEAR_BADGE","NOTIFS_HIDE_DROPDOWN","NOTIFS_MARK_ALL_READ","NUX_PROGRESS_BAR_STEP","NUX_DIALOG_CLOSE","NUX_DIALOG_NEXT_STEP","NUX_DIALOG_STANDALONE_DONE","NUX_DIALOG_SKIP_NEXT_STEP","NUX_DIALOG_FRIENDS_UPDATE","NETWORK_BETA_LOGIN_FORM_STATE","NETWORK_BETA_WAITLIST_FORM_STATE","NETWORK_INVITE_USER","NETWORK_JOIN_MODAL","PERF_POST_HTML","PILE_ON_REQUEST_MADE","PMSG_SHOW","PROFILE_SWITCH_CONTENT","PROFILE_TOPICS_UPDATED","POST_DISCLAIMER","QTEXT_EXPANDABLE_STATE","QUESTION_BIO_TOPIC_SELECT","QUESTION_CANT_ANSWER_STATE","QUESTION_DELETE_STATE_CHANGE","QUESTION_TOPIC_SELECTION_ADD","QUESTION_VOTE_STATE","QUESTION_EDITING_STATE","READING_LIST_VIEW_STATE","READING_LIST_ITEM_REMOVE","REORDERABLE_LIST_ITEM_UPDATE","REORDERABLE_LIST_TOGGLE_EDIT","REORDERABLE_LIST_ITEM_ACTIVE","SITE_HEADER_SEARCH_FOCUSED","DISCOVER_TOOL_CONFIRMED","TOPICS_GRID_ADD","TOPICS_GRID_REMOVE","TOPICS_GRID_UPDATE_SHOWN","TOPIC_LIST_REMOVE","TOPIC_FAQ_VIEW_MORE","TOPIC_FAQ_HIGHLIGHT_QUESTION","USER_LEADERBOARD_TOGGLE_EDIT","USER_STATS_UNSELECT_ITEMS","USER_STATS_UPDATE_GRAPHS","USER_STATS_UPDATE_ATTRIBUTES","USER_STATS_SHOW","UPLOAD_DIALOG_DROPZONE","UPLOAD_DIALOG_LOADING_STATE","WEBNODE_BEFORE_REMOVE_COMPONENT_METADATA","WEBNODE_COMPONENT_POST_ONLOAD","WEBNODE_COMPONENT_PRE_ONLOAD","WEBNODE_RPC_EXCEPTION","WEBNODE_RPC_RETRY_FAILED","WORDPRESS_CONNECT_SUCCESS","ZAPDOS_WALL_DISMISS"]);
}),define("shared/events/hub",["shared/polyfills","shared/Class","shared/eventemitter","shared/errors","shared/events/types"],function(e,t,i){var n=e("shared/Class").Class,o=e("shared/eventemitter").EventEmitter,s=e("shared/errors"),a=e("shared/events/types"),r=n.extend({__init__:function(){this.reset()},reset:function(){this._emitter=new o,this._allEmitter=new o},_isValidType:function(e){return a.EventTypes[e]?!0:(s.logJsError("Hub","Unknown error type - "+e),!1)},_isValidEvent:function(e){var t=this._isValidType(e.type),i=!!e.payload,n=!!e.scope;return i||s.logJsError("Hub","Event object missing payload - "+e),n||s.logJsError("Hub","Event object missing scope - "+e),t&&i&&n},subscribe:function(e,t){this._isValidType(e)&&this._emitter.on(e,t)},subscribeAll:function(e){this._allEmitter.on("any",e)},unsubscribe:function(e,t){this._isValidType(e)&&this._emitter.off(e,t)},dispatch:function(e){this._isValidEvent(e)&&(this._emitter.trigger(e.type,[e]),this._allEmitter.trigger("any",[e]))}});t.Hub=new r;
}),define("shared/events/scope",["shared/polyfills","shared/Class","shared/core/component"],function(e,t,i){var n=e("shared/Class").Class;t.GLOBAL={contains:function(){return!0},toJSON:function(){return{type:"GlobalScope"}}},t.DOCUMENT={contains:function(){return!0},toJSON:function(){return{type:"DocumentScope"}}},t.ComponentScope=n.extend({__init__:function(t){this.source=t;var i=e("shared/core/component");this.rootParent=i.getRootParent(t)},contains:function(t){var i=e("shared/core/component");return i.isCid(t)?this.rootParent==i.getRootParent(t):!1},toJSON:function(){return{type:"ComponentScope",source:this.source,root:this.rootParent}}})}),define("shared/events/proxy",["shared/polyfills","shared/Class","shared/events/hub","shared/events/scope"],function(e,t,i){var n=e("shared/Class").Class,o=e("shared/events/hub").Hub,s=e("shared/events/scope"),a=n.extend({__init__:function(){this._subscriptions={}},reset:function(){for(var e=Object.keys(this._subscriptions),t=0;t<e.length;t++)this.unsubscribeAll(e[t]);
},subscribe:function(e,t,i){var n=function(e){e.scope.contains(i)&&t(e)};this._subscriptions[i]=this._subscriptions[i]||[],this._subscriptions[i].push([e,n]),o.subscribe(e,n)},unsubscribeAll:function(e){var t=this._subscriptions[e];if(t){for(var i=0;i<t.length;i++){var n=t[i],s=n[0],a=n[1];o.unsubscribe(s,a)}delete this._subscriptions[e]}},dispatch:function(e,t){e.scope||(e.scope=this.defaultScope(e.type,t)),o.dispatch(e)},defaultScope:function(e,t){return null}}),r=a.extend({defaultScope:function(e,t){return s.GLOBAL}}),d=a.extend({defaultScope:function(e,t){return s.DOCUMENT}}),l=a.extend({defaultScope:function(e,t){return new s.ComponentScope(t)}});t.Global=new r,t.Document=new d,t.Component=new l}),define("shared/events/helpers",["shared/polyfills","shared/events/types","shared/events/scope"],function(e,t,i){var n=e("shared/events/types").EventTypes,o=e("shared/events/scope");t.addAnswerUpvote=function(e){return{type:n.ANSWER_VOTE_STATE,payload:{aid:e,state:"upvoted"},scope:o.GLOBAL
}},t.addAnswerDownvote=function(e){return{type:n.ANSWER_VOTE_STATE,payload:{aid:e,state:"downvoted"},scope:o.GLOBAL}},t.removeAnswerDownvote=t.removeAnswerUpvote=function(e){return{type:n.ANSWER_VOTE_STATE,payload:{aid:e,state:null},scope:o.GLOBAL}},t.addQuestionDownvote=function(e){return{type:n.QUESTION_VOTE_STATE,payload:{qid:e,state:"downvoted"},scope:o.GLOBAL}},t.removeQuestionDownvote=function(e){return{type:n.QUESTION_VOTE_STATE,payload:{qid:e,state:null},scope:o.GLOBAL}},t.addQuestionCantAnswer=function(e){return{type:n.QUESTION_CANT_ANSWER_STATE,payload:{qid:e,state:"passed"},scope:o.GLOBAL}},t.removeQuestionCantAnswer=function(e){return{type:n.QUESTION_CANT_ANSWER_STATE,payload:{qid:e,state:null},scope:o.GLOBAL}},t.changeQuestionDeletionState=function(e){return{type:n.QUESTION_DELETE_STATE_CHANGE,payload:{qid:e},scope:o.GLOBAL}},t.inlineEditorCancel=function(e,t){return{type:n.INLINE_EDITOR_STATE,payload:{oid:t,contentType:e,state:"cancel"}}},t.inlineEditorEdit=function(e,t){return{
type:n.INLINE_EDITOR_STATE,payload:{oid:t,contentType:e,state:"edit"}}},t.inlineEditorLoad=function(e,t){return{type:n.INLINE_EDITOR_STATE,payload:{oid:t,contentType:e,state:"load"}}},t.inlineEditorSubmit=function(e,t){return{type:n.INLINE_EDITOR_STATE,payload:{oid:t,contentType:e,state:"submit"}}},t.inlineEditorSubmitted=function(e,t){return{type:n.INLINE_EDITOR_STATE,payload:{oid:t,contentType:e,state:"submitted"}}},t.inlineEditorDisclaimer=function(e,t){return{type:n.INLINE_EDITOR_STATE,payload:{oid:t,contentType:e,state:"disclaimer"}}},t.inlineEditorToggle=function(e,t){return{type:n.INLINE_EDITOR_STATE,payload:{oid:t,contentType:e,state:"toggle"}}},t.loginUser=function(e){return{type:n.LOGIN_USER,payload:{pmsg:e},scope:o.GLOBAL}},t.logoutUser=function(){return{type:n.LOGOUT_USER,payload:{},scope:o.GLOBAL}}}),define("shared/events/index",["shared/polyfills","shared/events/index","shared/events/types","shared/events/proxy","shared/events/hub","shared/events/scope","shared/events/helpers"],function(e,t,i){
var n=e("shared/events/types"),o=e("shared/events/proxy"),s=e("shared/events/hub"),a=e("shared/events/scope"),r=e("shared/events/helpers");t.Types=n.EventTypes,t.GlobalProxy=o.Global,t.DocumentProxy=o.Document,t.Hub=s.Hub,t.ComponentProxy=o.Component,t.scope=a,t.helpers=r}),define("shared/siteuri",["shared/polyfills","settings","shared/Class"],function(e,t,i){function n(e){this.message=this.errorType+": "+e}function o(e){return"http:"==e.substring(0,5)?"https:"+e.substring(5):e}function s(e){var t=e.match(l);if(!t)return!1;var i=t[1],n=t[2],o=r();if("www."+n!=o){if("www"!=i&&i&&"www."+i+"."+n==o){var s=e.replace("://","://www.").match(l);if(s)return s}return!1}return t}var a=e("settings");n.prototype=new Error,n.prototype.errorType="SiteURIError",n.prototype.constructor="SiteURIError",t.SiteURIError=n;var r=function(e,t){var i;return i=t?"quora.com":a.subdomain_suffix||"quora.com",e?e+"."+i:"www."+i};t.netlocForSubdomainName=r;var d=function(e,t){return"http://"+r(e,t)+"/"};t.baseUrlForSubdomainName=d;
var l=/https?:\/\/(?:([^.\/]+)\.)?((?:[^.\/]+\.)*quora\.com(?::[0-9]*)?)(\/.*)?/,c=function(e){return s(e)!==!1};t.isSiteAbsoluteUrl=c;var h=function(e){return"/"==e[0]};t.isSiteRelativeUrl=h;var u=function(e){return c(e)||h(e)};t.isSiteUrl=u;var p=function(e,t){return new f(e,t)};t.URI=p;var f=e("shared/Class").Class.extend({__init__:function(e,t){e instanceof f&&(e=e.unicode());var i,o=s(e),r=t&&t.subdomainName||null,d=t&&t.secure||!1;if(o){if(r)throw new n("subdomain context should not be set for absolute url, url = "+e+", subdomain = "+r);r=o[1],"www"==r&&(r=null),i=o[3]||"",""===i&&(i="/"),"https"==e.substring(0,5)&&(d=!0)}else i=e;if("/"!=i[0])throw new n("invalid site uri input "+e);return this.relativeUrl=i,this.subdomainName=r,this.subdomainName||(this.subdomainName=a.subdomain_of_network),this.isSecure=d,this},unicode:function(e){if(a.force_use_absolute_links)return this.absolute(e);var t=this.relativeUrl;return(this.subdomainName||a.subdomain_name)&&(t=d(this.subdomainName,e)+t.substring(1),
"/"==t.charAt(t.length-1)&&(t=t.substring(0,t.length-1))),this.isSecure&&(t=o(t)),t},absolute:function(e){var t=d(this.subdomainName,e),i=t+this.relativeUrl.substring(1);return this.isSecure&&(i=o(i)),i},secure:function(e){return o(this.absolute(e))}});t.SiteURI=f}),define("shared/qlocal_storage",["shared/polyfills","interface/settings","shared/client"],function(e,t,i){function n(){try{if(window.localStorage)return!0}catch(e){return!1}return!1}var o=e("interface/settings").pageIsMobile,s=e("shared/client"),a=null;o&&(a=e("mobile_app2/qlocalstorage")),t.storageAvailable=function(){return n()?!0:a&&s.isNativeApp()?!0:!1},t.setItem=function(e,t){if(n())try{window.localStorage.setItem(e,t)}catch(i){if("NS_ERROR_FILE_CORRUPTED"===i.name)return;throw i}else a&&s.isNativeApp()&&a.setItem(e,t)},t.getItem=function(e,t){if(n()){var i=window.localStorage.getItem(e);t(i)}else a&&s.isNativeApp()&&a.getItem(e,function(e){e.success&&t(e.value)})}}),define("shared/window_manager",["shared/polyfills","shared/jquery","shared/util"],function(e,t,i){
var n=e("shared/jquery"),o=e("shared/util");t.catchRedirectCallback=null;var s=function(e){return/https?:\/\/[a-z.0-9_\.\-]*quora\.com/i.test(e)},a=t.getDomain=function(){return window.location.protocol+"//"+window.location.host+"/"};t.getPathName=function(){return decodeURI(window.location.pathname)};var r=t.getURL=function(){return decodeURI(window.location.href)},d=t.getHash=function(){return window.location.hash},l=t.replaceURL=function(e){window.history&&window.history.replaceState&&window.history.replaceState(window.history.state,null,e)};t.isInHash=function(e){var t=d();if("#"==t.substr(0,1)){t=t.replace("%23","-");for(var i=t.substring(1).split("-"),n=0;n<i.length;n++)if(i[n]==e)return!0}return!1};var c=function(e){for(var t={},i=e.split("&"),n=0;n<i.length;n++){var o=i[n],s=o.split("=");t[s[0]]=decodeURIComponent(s[1])}return t};t.parseURLParamsMulti=function(e){e||(e=window.location.search.substring(1));for(var t={},i=e.split("&"),n=0;n<i.length;n++){var o=i[n],s=o.split("=");s[0].length>0&&(s[0]in t||(t[s[0]]=[]),
t[s[0]].push(decodeURIComponent(s[1])))}return t};var h=t.parseURLParams=function(e){return e||(e=window.location.search.substring(1)),0===e.length?{}:c(e)};t.parseParams=function(e){var t={};if(e){var i=e.split("?");2==i.length&&(t=c(i[1]))}return t},t.isParamInURL=function(e,t){return e in h(t)},t.addParamToURL=function(e,t,i){var n=encodeURIComponent(t)+"="+encodeURIComponent(i);n=-1==e.indexOf("?")?"?"+n:"&"+n;var o=e.indexOf("#");return-1==o?e+n:e.substring(0,o)+n+e.substring(o)},t.getURLParam=function(e){return h()[e]};var u=function(e,t,i,o,s){var a=[];if(i)for(var r in i)if(i.hasOwnProperty(r)&&null!==i[r])if(s===!0&&n.isArray(i[r]))for(var d=0;d<i[r].length;d++)a.push(r+"="+encodeURIComponent(i[r][d]));else a.push(r+"="+encodeURIComponent(i[r]));var l=a.join("&"),c=e+t;return l.length>0&&(c+="?"+l),c+=o},p=function(e,t,i,n){return u(e,t,i,n,!1)},f=t.makeURLMultiParams=function(e,t,i,n){return u(e,t,i,n,!0)},_=t.makeUpdatedURL=function(e){return p(window.location.origin,window.location.pathname,o.extend(h(),e),window.location.hash);
};t.updateURLParams=function(e){var t=_(e);return l(t),t},t.replaceURLParamsMulti=function(e){var t=f(window.location.origin,window.location.pathname,e,window.location.hash);return l(t),t},t.removeURLParam=function(e){var i=h();return i[e]=null,t.updateURLParams(i)},t.getTitle=function(){return document.title},t.setTitle=function(e){document.title=e},t.reload=function(){window.location.reload()};var g=!1;t.isPendingNavigation=function(){return g};var m=function(e){return-1!==e.indexOf("quora://")};t.sameDomainURL=function(e){return e&&("/"==e.charAt(0)||new RegExp("^https?://"+window.location.hostname+"/","i").test(a(e)))};var v=function(e){var t=document.createElement("div");return t.innerHTML="<a></a>",t.firstChild.href=e,t.innerHTML=t.innerHTML,t.firstChild.href};t.navigateTo=function(e){if(""!==e&&"#"!==e&&e!=r()+"#")if(e=v(e),s(e)||m(e)){var i=!0;t.catchRedirectCallback&&(i=t.catchRedirectCallback(e)),i&&(g=!0,window.location=e)}else window.open(e)},t.headerOffset=45,t.actionBarHeight=52,
t.scrollContext=60,t.scrollAndFocus=function(e,i){e-=t.headerOffset,e=Math.max(0,Math.min(n(document).height()-n(window).height(),e));var o=Math.min(500,.5*Math.abs(e-n(document).scrollTop())),s=!1;n("html,body").animate({scrollTop:e},o,"swing",function(){if(!s&&n(i).length){var e=window.scrollX,t=window.scrollY;n(i).focus(),window.scrollTo(e,t),s=!0}})},t.scrollIntoView=function(e){var i=n(e).offset().top,o=i-n(document).scrollTop();(o<t.headerOffset||o>n(window).height())&&t.scrollAndFocus(i)}}),define("shared/logging",["shared/polyfills","shared/qlocal_storage","shared/window_manager","shared/util","shared/core/rpc","gating","settings"],function(e,t,i){function n(){_.messages().length>=f?s():o()}function o(){p||(p=setTimeout(s,h.client_side_batched_logging_interval))}function s(){if(p&&(clearTimeout(p),p=!1),0!==_.messages().length){var e=_.messages();_.clear();var t="";if(h.client_side_batched_logging_use_log_end_point){var i="";i=window.location&&window.location.origin?window.location.origin.split("//")[1].split(".").slice(1).join("."):"quora.com",
t+=window.location.protocol+"//log."+i}t+="/ajax/batched_log_POST";var n=c.rpc(t);u.rpcRetriesEnabled&&n.appFields({maxRetries:1,persistent:!0}),n.xhrFields({withCredentials:!0}).kwargs({messages:e,nid:u.nid}).success(a.bind(this,e)).error(r.bind(this,e)).send()}}function a(){}function r(e){e&&_.concat(e)}e("shared/qlocal_storage");var d=e("shared/window_manager"),l=e("shared/util"),c=e("shared/core/rpc"),h=e("gating"),u=e("settings"),p=!1,f=50;t.log=function(e,t,i){i||(i={});var o={sampleRate:1,sendImmediately:!1,scribeOnly:!1};i=l.extend(o,i),(i.sampleRate<0||i.sampleRate>1)&&(i.sampleRate=1);var a=null;i.scribeOnly?(t.scribe_category=e,a={category:"scribe_only",data:t,time:1e3*Date.now()}):a={category:e,data:t,time:1e3*Date.now()},i.sampleRate>0&&Math.random()<=i.sampleRate&&_.push(a),i.sendImmediately||d.isPendingNavigation()?s():n()};var _={msgBuffer:[],push:function(e){this.msgBuffer.push(e)},messages:function(){return this.msgBuffer},clear:function(){this.msgBuffer=[]},concat:function(e){
this.msgBuffer=this.msgBuffer.concat(e)}}}),define("shared/perf",["shared/polyfills","shared/logging"],function(e,t,i){var n={},o=5e3,s=3e4,a=function(t){delete t.id,e("shared/logging").log("perf/post_e2e",t)},r=function(e){if(!e)throw new Error("This method expects an object describing the action.");var t=e.method;if(t.startsWith("log_")||t.startsWith("record_")||t.startsWith("track_"))return null;if(e.startTime=Date.now(),!e.id){var i=1e3*e.startTime+Math.floor(1e3*Math.random());e.id=i.toString(36)}return n[e.id]=e,e},d=function(e){var t=n[e];t&&(t.duration=Date.now()-t.startTime,delete t.startTime,delete n[e],a(t))};t.startPOST=function(e){return e.type="web",r(e)},t.startUserPerceived=function(e){return e.type="user_perceived",r(e)},t.finishAction=function(e){e&&e.id&&d(e.id)},t.cancelAction=function(e){e&&e.id&&delete n[e.id]};var l=function(){for(var e=Date.now(),t=Object.keys(n),i=0;i<t.length;i++){var o=n[t[i]];e-o.startTime>=s&&(o.timeout=!0,d(o.id))}};setInterval(l,o)}),define("shared/loading",["shared/polyfills","shared/loading","shared/util"],function(e,t,i){
var n=e("shared/util"),o={size:"regular"};t.createLoadingDotsElement=function(e){var t=n.extend(o,e),i=document.createElement("div");i.className="LoadingDots "+t.size;var s=document.createElement("div");s.className="dot first";var a=document.createElement("div");a.className="dot second";var r=document.createElement("div");return r.className="dot third",i.appendChild(s),i.appendChild(a),i.appendChild(r),i}}),define("shared/core/webnode",["shared/polyfills"],function shared_core_webnode(require,exports,module){var setContentHTML=exports.setContentHTML=function(e,t){e.html?e.html(t.html):e.innerHTML=t.html},evaluateContentJS=exports.evaluateContentJS=function(content){var js=content.js?content.js:content;eval(js)};exports.setContent=function(e,t){setContentHTML(e,t),evaluateContentJS(t)}}),define("shared/debounce",["shared/polyfills"],function(e,t,i){var n=function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)};t.debounce=function(e,t,i){function o(){_&&clearTimeout(_),h&&clearTimeout(h),
m=0,h=_=g=void 0}function s(){return Date.now()}function a(t,i){i&&clearTimeout(i),h=_=g=void 0,t&&(m=s(),u=e.apply(f,c),_||h||(c=f=void 0))}function r(){var e=t-(s()-p);0>=e||e>t?a(g,h):_=setTimeout(r,e)}function d(){a(w,_)}function l(){var i,n;if(c=arguments,p=s(),f=this,g=w&&(_||!b),v===!1)i=b&&!_;else{h||b||(m=p);var o=v-(p-m);n=0>=o||o>v,n?(h&&(h=clearTimeout(h)),m=p,u=e.apply(f,c)):h||(h=setTimeout(d,o))}return n&&_?_=clearTimeout(_):_||t===v||(_=setTimeout(r,t)),i&&(n=!0,u=e.apply(f,c)),!n||_||h||(c=f=void 0),u}var c,h,u,p,f,_,g,m=0,v=!1,w=!0;if("function"!=typeof e)throw new Error("Only able to debounce functions.");t=0>t?0:+t||0;var b;return i===!0?(b=!0,w=!1):n(i)&&(b=!!i.leading,v="maxWait"in i&&Math.max(+i.maxWait||0,t),w="trailing"in i?!!i.trailing:w),l.cancel=o,l},t.throttle=function(e,i,o){var s=!0,a=!0;if("function"!=typeof e)throw new Error("Only able to throttle functions.");return n(o)&&(s="leading"in o?!!o.leading:s,a="trailing"in o?!!o.trailing:a),t.debounce(e,i,{leading:s,
maxWait:i,trailing:a})}}),define("shared/rpc_manager",["shared/polyfills","shared/core/rpc","interface/settings","shared/errors","shared/debounce","shared/Class"],function(e,t,i){var n=e("shared/core/rpc"),o=e("interface/settings"),s=e("shared/errors"),a=e("shared/debounce").debounce,r=e("shared/Class").Class.extend({__init__:function(){this._urlToBatchedUrl={},this._pendingRequests={},this._makeBatchRequests={},this._debounceWait=10,this._registerUrlToBatchedUrl(o.serverCallUrl,o.batchedServerCallUrl),this._registerUrlToBatchedUrl("/api/rerender_component_POST","/api/batched_rerender_component_POST")},_registerUrlToBatchedUrl:function(e,t){this._urlToBatchedUrl[e]=t,this._pendingRequests[e]=[],this._makeBatchRequests[e]=this._getBatchRequestFunction(e)},_shouldBatchRequest:function(e){return e._url()in this._urlToBatchedUrl},enqueue:function(e){return this._shouldBatchRequest(e)?(this._pendingRequests[e._url()].push({request:e,data:this._getDataObject(e),success:this._getSuccessCallback(e),
error:this._getErrorCallback(e)}),void this._makeBatchRequests[e._url()]()):e.send()},_getDataObject:function(e){var t=e._data();return delete t.formkey,delete t.window_id,delete t.referring_controller,delete t.referring_action,t},_getSuccessCallback:function(e){return function(t){e._successHandler({value:t}),e._completeHandler()}},_getErrorCallback:function(e){return function(){e._beforeErrorHandler.apply(e,arguments),e._error()(),e._completeHandler()}},_getBatchRequestFunction:function(e){var t=this;return a(function(){var i=t._pendingRequests[e];if(t._pendingRequests[e]=[],1===i.length)return void i[0].request.send();var o=i.map(function(e){return e.data}),a=function(e){i.forEach(function(t){t.error(e)})},r=function(e){i.forEach(function(t,i){try{t.success(e[i])}catch(n){s.report(n)}})};n.rpc(t._urlToBatchedUrl[e]).kwargs({requestsData:o}).success(r).error(a).send()},t._debounceWait)}}),d=new r;t.enqueueRequest=function(e){d.enqueue(e)}}),define("shared/dom",["shared/polyfills","shared/jquery","shared/browser"],function(e,t,i){
function n(e){if(!e||!e.parentNode)return!1;var t=e.getAttribute("id");e.setAttribute("id",a);var i=!!document.getElementById(a);return t?e.setAttribute("id",t):e.removeAttribute("id"),i}var o=e("shared/jquery"),s=e("shared/browser"),a=(new Date).toString(16),r=!1;t.getScrollbarWidth=function(){var e=document.createElement("p");e.style.width="100%",e.style.height="200px";var t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.appendChild(e),document.body.appendChild(t);var i=e.offsetWidth;t.style.overflow="scroll";var n=e.offsetWidth;return i==n&&(n=t.clientWidth),document.body.removeChild(t),i-n},t.anchor=function(e,t){if(e=o(e),r||e.length<1)return e;r=!0;var i=[],s=o(window).scrollTop(),a=o(window).scrollLeft();i.length=e.length;for(var d=0;e[d];++d)i[d]=[e[d],o(e[d]).offset().top-s];var l=function(){for(var e,t,s,d={},l=0,c=[void 0,-1];t=i[l++];)n(t[0])&&(e=o(t[0]).offset().top-t[1],
s=d[e]=(d[e]||0)+1,c[1]<s&&(c=[e,s]));-1!=c[1]&&window.scrollTo(a,Math.round(c[0],0)),r=!1};return t?l:(setTimeout(l,10),e)},t.addAnimationClass=function(e,t,i){function n(){for(var e=0;e<l.length;e++){var t=r.css(l[e]);if(t)return t}}function a(e){if(!e)return!1;var t=e.originalEvent.animationName;return t+d}var r=o(e);if(s.msie&&s.version<=9)return i(),r;var d="W2_css_animation",l=["-webkit-animation-name","-moz-animation-name","-o-animation-name","-ms-animation-name"];r.addClass(t),r.on("oanimationend animationend webkitAnimationEnd MSAnimationEnd",function(e){r.trigger(a(e))});var c=n()+d;return r.on(c,function(){r.off(c),r.removeClass(t),i()}),r}}),define("shared/viewport",["shared/polyfills","interface/settings","shared/dom","shared/jquery"],function(e,t,i){var n=e("interface/settings").pageIsMobile,o=e("shared/dom"),s=e("shared/jquery"),a=function(e){var t=e.getBoundingClientRect(),i=0==t.bottom&&0==t.right&&0==t.top&&0==t.left;return i},r=function(e){if(a(e))return!1;var t=e.offsetTop;
e.offsetParent&&(t+=e.offsetParent.offsetTop,e.offsetParent.offsetParent&&(t+=e.offsetParent.offsetParent.offsetTop));var i=e.getBoundingClientRect(),n=window.innerHeight,o=window.innerWidth,s=window.pageYOffset>=t+e.offsetHeight,r=window.pageYOffset+n<=t,d=i.left>=0&&i.right<=o;return!s&&!r&&d},d=function(e){if(a(e))return!1;var t=e.getBoundingClientRect(),i=window.innerWidth||document.documentElement.clientWidth,n=window.innerHeight||document.documentElement.clientHeight,o=function(e,t){return document.elementFromPoint(e,t)};return t.right<0||t.bottom<0||t.left>i||t.top>n?!1:e.contains(o(t.left,t.top))||e.contains(o(t.right,t.top))||e.contains(o(t.right,t.bottom))||e.contains(o(t.left,t.bottom))};t.isElementInViewport=function(e){return e?n?r(e):d(e):!1};var l=null;t.siteHeaderHeight=function(){return null===l&&(l=n?s(".Header .fixed_header").height():s(".SiteHeader").height()),l},t.setPageScroll=function(e){var t=s("body"),i=s(".SiteHeader"),n=o.getScrollbarWidth();e?(t.removeClass("modal_prevent_scroll"),
t.css("padding-right",0),i.css("padding-right",0)):(t.addClass("modal_prevent_scroll"),t.css("padding-right",n+"px"),i.css("padding-right",n+"px"))}}),define("tchannel_up",["shared/polyfills","shared/jquery","w2.livenode","gating"],function(e,t,i){function n(e){new Function(e).call(window)}var o=e("shared/jquery"),s=e("w2.livenode"),a=e("gating").cchannel_websockets,r=!1;t.stop=function(){r=!0},t.start=function(e,t,i,d,l,c){function h(){return(+new Date).toString(16)+Math.random().toString(16).split(".").pop()}function u(e){function t(e,t){return function(o){if(t){window[n]=null;try{delete window[n]}catch(s){}}-1!==a&&(clearTimeout(a),a=-1,e(o),i.parentNode&&i.parentNode.removeChild(i))}}var i=document.createElement("script"),n=e.callback="jsonp"+h(),s=t(g),a=setTimeout(s,7e4),r=document.body;window[n]=t(_,!0),i.charset="utf-8",i.src=w+o.param(e),i.addEventListener?(i.addEventListener("load",s,!1),i.addEventListener("error",s,!1)):i.attachEvent&&i.attachEvent("onreadystatechange",function d(){
/loaded|complete/.test(i.readyState)&&s(),i.detachEvent("onreadystatechange",d)}),r.insertBefore(i,r.firstChild)}function p(n){clearTimeout(v);var o={min_seq:e,channel:t,hash:i};k>0&&(o.timeout=k),v=setTimeout(function(){a?f(o):u(o)},n||10)}function f(e){var t=new window.WebSocket(w+o.param(e));t.onmessage=function(e){_(JSON.parse(e.data))},t.onclose=g}function _(e){y||(s.reportPageRegainedConnection(),y=!0);try{m(e)}catch(t){return void s.reportPageNeedsReload("tchannel_error")}b=500,a||p()}function g(e){C||(b=Math.min(2*b,3e4),b>=1e4&&y&&(s.reportPageLostConnection(),y=!1),p(b))}function m(t){if(window.log&&window.log.enabled&&window.log("tchannel_up.newMessages","Response:",t),t.error)throw t.error;var i=t.messages;if(i){e=t.min_seq;for(var n=0;n<i.length;++n)L(i[n])}}var v,w,b=500,y=!0,C=!1,k=2e3,x=0;if(c)w=window.location.protocol+"//"+c;else{var S,E=".tch.",T=a?"/ws_updates?":"/updates?";S=a?"https:"===window.location.protocol?"wss:":"ws:":window.location.protocol;var $="tch"+(Math.floor(1e6*Math.random())+1)+E+l;
w=S+"//"+$+"/up/"+d+T}var L=function(){function e(){if(!r){var e=i.next;return e&&(window.log&&window.log.enabled&&window.log("tchannel_up.enqueue","Evaluating:",e.js),n(e.js),delete i.next,delete e.js,i=e),e}}function t(){setTimeout(function(){for(var i=+new Date;e();)if(new Date-i>100)return t()},10)}var i={},o=i;return function(e){o=o.next={js:e},i.next===o&&t()}}();o(window).on("beforeunload",function(){C=!0}),o(window).on("load",function(){setTimeout(function(){k=0},x),p(20)})}}),define("fx",["shared/polyfills","shared/jquery","shared/util"],function(e,t,i){var n=e("shared/jquery"),o=e("shared/util"),s={duration:400,easing:""},a=function(e,t){var i=!1;e.one("webkitTransitionEnd transitionEnd",function(){i=!0});var n=function(){i||e.trigger("transitionEnd")};setTimeout(n,t)},r=function(e){e.each(function(){this.offsetHeight})},d=function(e,t,i){i=o.extend({},s,i);var n="all "+i.duration+"ms "+i.easing;t.webkitTransition=n,t.mozTransition=n,t.transition=n;var r=o.once(function(){e.dequeue(),
i.complete&&i.complete.apply(e)});e.queue(function(){e.one("webkitTransitionEnd transitionEnd",r),a(e),e.css(t)})},l=function(e,t,i,o){e=n(e),e.css(t),r(e),d(e,i,{duration:o||s.duration})};t.highlight=function(e,t){l(e,{backgroundColor:"#ffff99"},{backgroundColor:"transparent"},t)},t.fadeIn=function(e,t){l(e,{opacity:0},{opacity:1},t)}}),define("w2.livenode",["shared/polyfills","shared/jquery","webnode2","shared/core/webnode","shared/events/index","shared/core/component","shared/log","shared/logging","shared/browser","shared/dom","settings","shared/errors","shared/viewport","tchannel_up","fx"],function(e,t,i){function n(e){var t,i={};return g("#"+e+" [w2cid]").each(function(e,n){t=n.getAttribute("w2cid"),i[t]=n}),i}function o(e){var t={};return g.each(e,function(e,i){if(!(i.domid in t)){var o=n(i.domid);t[i.domid]=o}}),t}function s(e){var t=m.interactionMode._changedComponents[e];return t&&t!=m.interactionMode._states.OFF}function a(e,t,i){var n=o(e);try{g.each(e,function(e,i){var o=n[i.domid];
"update_data"!=i.type&&"insert_node"!=i.type&&g.each(o,function(e,n){if(s(e)){if(!t)throw console.log("throwing blocking_interaction_mode cid="+e+" on optype = "+i.type),console.log("affected node:"),console.log(o[e]),new Error("blocking_interaction_mode");console.log("forcing override on live update conflict with cid="+e+" on optype = "+i.type)}})})}catch(a){if("blocking_interaction_mode"==a.message)return console.log("Calling startBlocking from checkForConflicts"),m.interactionMode.startBlocking(),I.interactionDelayedLivedepOperations.push({data:e,textStatus:i}),!1;throw a}return!0}function r(e,t,i){32e3>M?(D=setTimeout(d,M),M*=2):(clearTimeout(D),D=null,_("failed_sync_livedeps"))}function d(){D&&(clearTimeout(D),D=null);var e=[window.location.protocol,"//",window.location.host,"/check_livedeps/index?window_id=",S.windowId,"&random=",Math.random()].join("");g.ajax({type:"GET",url:e,error:r})}function l(e){m.interactionMode.resumeUpdates();var t=Math.random(),i={};return i._lm_transaction_id=t,
i._lm_window_id=S.windowId,void 0===e?B[t]=1:B[t]={optimisticUpdate:e},u(),{transactionId:t,data:i}}function c(e,t){delete B[e],I.requiredVersion=Math.max(t,I.requiredVersion),u()}function h(e){I.currentVersion=e,f()}function u(){var e,t=0,i=0;for(e in B)i++,B[e].optimisticUpdate&&t++;I.pendingMutationCount=i,I.optimisticUpdateMutationCount=t,f()}function p(){$.stop()}function f(){window.log&&y.enabled&&y("w2.livenode.checkLoadingStatus","Pending mutation count:",I.pendingMutationCount,", current version",I.currentVersion,", required version",I.requiredVersion);var e=I.pendingMutationCount>I.optimisticUpdateMutationCount,t=I.currentVersion<I.requiredVersion;w.GlobalProxy.dispatch({type:w.Types.LIVENODE_LOADING_SPINNER,payload:{show:e||t}})}function _(e,t){if(t=t||{},console.log("Page requires reload "+t),!O){var i={error:"reportPageNeedsReload",uid:S.uid,window_id:S.windowId,url:window.location.href,error_type:e,debug_info:t},n="lost_group"!==e;C.log("livenode_error",i,{scribeOnly:!0,sendImmediately:n
}),O=!0}S.isLoggedIn&&(m.Error&&m.Error.hide(),m.fallbackToPostReloadMode(),m.interactionMode.$id("@message").html("<a href='javascript:window.location.reload();'>"+A.please_refresh+"</a>"),console.log("Calling startBlocking from reportPageNeedsReload"),m.interactionMode.startBlocking())}window.console||(window.console={}),window.console.log||(window.console.log=function(){});var g=e("shared/jquery"),m=e("webnode2"),v=e("shared/core/webnode"),w=e("shared/events/index"),b=e("shared/core/component"),y=e("shared/log").log,C=e("shared/logging"),k=e("shared/browser"),x=e("shared/dom"),S=e("settings"),E=e("shared/errors"),T=e("shared/viewport"),$=e("tchannel_up"),L=e("fx"),A=S.interface_strings,D=null,I={interactionDelayedLivedepOperations:[],pendingMutationCount:0,optimisticUpdateMutationCount:0,currentVersion:0,requiredVersion:0},M=1e3,O=!1,N={},R={};w.DocumentProxy.subscribe(w.Types.WEBNODE_BEFORE_REMOVE_COMPONENT_METADATA,function(e){var t=e.payload.cid;t&&(N[t]=b._hmacs[t],R[b._domids[t]]=b._hmacs[t]);
});var q=function(e,t,i){if(i=i||!1,"error"==e)return console.log("LiveNode error"),void _("livenode_data_error");if(!m.interactionMode||m.interactionMode.isBlocking())return I.interactionDelayedLivedepOperations.push({data:e,textStatus:t}),!1;if(!a(e,i,t))return!1;var n=!k.msie&&g(window).scrollTop()>0;n&&g("div.feed_item_inner").each(function(){T.isElementInViewport(this)&&x.anchor(g(this))}),g.each(e,function(e,t){var i,o,s;switch(window.log&&y.enabled&&y("w2.livenode.onLivedepOperations","Applying",t),g(document).trigger("livenode_op_start",t),t.type){case"set_node":if(t.domid in m._ignoreDomids)break;var a=g("#"+t.domid);if(!a.length)return void _("set_node_missing",{hmac:b._hmacs[t.cid],op_domid:t.domid,op_cid:t.cid});var r=t.transition;if(s=b.getComponentFromElement(a.get(0)),s&&s.force_transition&&(r=s.force_transition),!("cid"in t))return void E.logJsError("w2.livenode","Expected cid in op got: "+JSON.stringify(t));switch(b.unloadComponent(t.cid),v.setContent(a,t.content),r.type){
case"none":break;case"fade_in":L.fadeIn(a,2e3)}break;case"insert_node":if(t.domid in m._ignoreDomids)break;if(i=document.getElementById(t.domid),!i)return void _("insert_node_missing",{parent_hmac:b._hmacs[t.parent_cid],op_domid:t.domid,op_parent_cid:t.parent_cid});var d=document.createElement("DIV");if(v.setContentHTML(d,t.content),1!=d.childNodes.length)return console.log("error: append must give a single node"),void _("invalid_append");var l=d.childNodes[0],c=l.id;if(l.style.display="none",i.childNodes.length==t.position?i.appendChild(l):i.insertBefore(l,i.childNodes[t.position]),v.evaluateContentJS(t.content),o=b._components[t.parent_cid],o&&o.onInsertNode&&o.onInsertNode(t,c),"none"==t.transition.type)break;if("scroll"==t.transition.type){l.style.display="",l.scrollIntoView(!1);break}if(n||"fade_in"==t.transition.type){g("#"+c).fadeIn(500);break}l.style.display="none",g("#"+c).fadeIn(1e3);break;case"delete_node":if(t.domid in m._ignoreDomids)break;if(i=document.getElementById(t.domid),
!i)return void _("delete_node_missing",{op_domid:t.domid,op_parent_cid:t.parent_cid});if(!b._parents[t.parent_cid])return void _("delete_node_missing_component",{op_parent_cid:t.parent_cid});var h=i.childNodes[t.position];if(h.id!=t.child_domid)return void _("delete_node_wrong_child",{parent_hmac:b._hmacs[t.parent_cid],node_id:h.id,op_child_domid:t.child_domid});o=b._components[t.parent_cid],o&&o.onDeleteNode&&o.onDeleteNode(t,h.id),b.unloadComponent(t.child_cid),g("#"+h.id).remove();break;case"update_data":if(t.cid in m._ignoreCids)break;if(!b._parents[t.cid])return void _("update_data_missing_component",{op_cid:t.cid,op_parent_cid:t.parent_cid});s=b._components[t.cid],s&&s.onUpdate&&s.onUpdate(t.data);break;case"error":return console.log("livedep error: "+t.error),void _("livenode_error",{op_error:t.error});default:_("invalid_op_type",{op_type:t.type})}}),g(document).trigger("livenode_finish_operations")},B={};t.reportPageRegainedConnection=function(){m.Error.hide()},t.reportPageLostConnection=function(){
m.Error.show(A.trying_to_regain)},t.syncLivedeps=d,t.startMutation=l,t.onLivedepOperations=q,t.reportPageNeedsReload=_,t.setCurrentVersion=h,t.mutationDoneAfterVersion=c,t.stopLiveUpdates=p,t.state=I}),define("actions",["shared/polyfills","shared/util","shared/log","shared/logging"],function e(t,i,n){function o(){c>=h&&(s(),c=0)}function s(){d.enabled&&d("e2e.gc","GC started.");var t=(new Date).getTime(),i=[];for(var n in e){var o=e[n];t-o.startTime>u&&(i.push(o),delete e[n])}d.enabled&&d("e2e.gc","Collected actions:",i)}function a(e){if(e.mustReport){if(delete e.mustReport,d.enabled){var t=e.endTime-e.startTime,i=e.serverTime/1e3;d("e2e.reportActionData","Metric:",t,"Server time:",i,"Details:",e)}l.log("action_data",{data:e})}}var r=t("shared/util"),d=t("shared/log").log,l=t("shared/logging"),e={},c=0,h=100,u=6e5;i.startAction=function(t){if(null===t||"undefined"==typeof t)throw new Error("This method expects an object describing the action.");return t.startTime=(new Date).getTime(),t.id=(1e3*t.startTime+Math.floor(1e3*Math.random())).toString(36),
e[t.id]=t,d.enabled&&d("e2e.startAction",t),c++,o(),t},i.startOrUpdateAction=function(t,n){return t&&e[t]?i.updateAction(t,n):i.startAction(n)},i.getAction=function(t){return e[t]},i.updateAction=function(t,i){if(void 0===i)throw new Error("This method expects an object describing the update.");var n=e[t];return void 0===n?null:r.extend(n,i)},i.finishAction=function(t,i){var n=e[t];return void 0===n?null:(i&&r.extend(n,i),n.endTime=(new Date).getTime(),delete e[t],d.enabled&&d("e2e.finishAction",n),a(n),n)}}),define("shared/core/rpc",["shared/polyfills","shared/errors","shared/events/index","shared/util","shared/perf","settings","shared/loading","shared/w2.timing","shared/jquery","shared/core/component","shared/core/webnode","gating","shared/client","shared/rpc_manager","shared/window_manager","shared/Class","w2.livenode","webnode2","w2.errors","actions"],function shared_core_rpc(require,exports,module){var errors=require("shared/errors"),events=require("shared/events/index"),util=require("shared/util"),perf=require("shared/perf"),settings=require("settings"),loading=require("shared/loading"),w2_timing=require("shared/w2.timing"),$=require("shared/jquery"),coreComponent=require("shared/core/component"),coreWebnode=require("shared/core/webnode"),gating=require("gating"),sharedClient=require("shared/client"),rpc_manager=require("shared/rpc_manager"),window_manager=require("shared/window_manager"),Class=require("shared/Class").Class,pageIsMobile=settings.pageIsMobile,livenode,actions,W2,w2Errors,client,messages;
pageIsMobile?(client=require("mobile_app2/client"),messages=require("mobile_app2/messages")):(livenode=require("w2.livenode"),W2=require("webnode2"),w2Errors=require("w2.errors"),actions=require("actions"));var rpcsToRetry={},_atLeastOneServerCallIsSent=!1;events.GlobalProxy.subscribe(events.Types.WEBNODE_RPC_RETRY_FAILED,function(e){var t=rpcsToRetry[e.payload.requestId];t&&(t(),delete rpcsToRetry[e.payload.requestId])});var RPC=Class.extend({__init__:function(){this.__data={args:[],kwargs:{}},this.__success=null,this.__error=null,this.__contentFor=null,this.__url=null,this.__exceptionCatchAll=null,this.__name=null,this.__liveMutation=!1,this.__inLiveMutation=!1,this.__optimisticUpdate=!1,this.__creationTime=Date.now(),pageIsMobile||(this.__isRelatedToUserAction=w2Errors.canBeRelatedToUserAction())},args:function(){return this.__data.args=Array.prototype.slice.call(arguments),this},kwargs:function(e){return this.__data.kwargs=util.extend({},e),this},url:function(e){return this.__url=e,
this},_url:function(){return this.__url},_xhrFields:function(){return this.__xhrFields},xhrFields:function(e){return this.__xhrFields=e,this},_appFields:function(){return this.__appFields},appFields:function(e){return this.__appFields=e,this},success:function(e){return this.__success=e,this},error:function(e){return this.__error=e,this},_error:function(){return this.__error||this._defaultErrorHandler},_defaultErrorHandler:function(e,t,i){if(!pageIsMobile&&(settings.debug||Math.random()<.1)){var n={statusCode:e.status,status:t,error:i,name:this.__name},o="Unhandled xhr error: "+JSON.stringify(n);errors.logJsError("coreRpc",o)}},except:function(e,t){switch(arguments.length){case 1:this.__exceptionCatchAll=e;break;case 2:if("string"!=typeof e)return void errors.logJsError("coreRpc","pattern should be a string, got: "+typeof e);this.__exceptionPatterns[e]=t;break;default:var i=Array.prototype.slice.call(arguments);errors.logJsError("coreRpc","Invalid arguments to except: %s"%JSON.stringify(i));
}return this},contentFor:function(e,t){if(t=t||{},!t.parentCid){if(!this._component)return void errors.logJsError("contentFor","parentCid not specified for non component rpc.");t.parentCid=this._component.cid}return e instanceof $&&(e=e.get(0)),t=util.extend(t,{element:e}),pageIsMobile||t.useLoadingSpinner||t.useLoadingSpinner===!1||(t.useLoadingSpinner=!0),this.__contentFor=t,this},sendJsData:function(e){return this._sendJsData=!!e,this},liveMutate:function(e){return pageIsMobile||(this.__liveMutation=!0,e=e||{},void 0===e.optimisticUpdate?this.__optimisticUpdate=!1:this.__optimisticUpdate=e.optimisticUpdate),this},disableDefaultUserPerceivedLogging:function(){return this._disableDefaultUserPerceivedLogging=!0,this},sendOnlyOnce:function(){return this._onlyOnce(),this.send()},send:function(e){var t=e&&e.batched;return gating.batched_server_calls&&t?void rpc_manager.enqueueRequest(this):this._send()},_send:function(){var e=settings.subdomain_name||"www",t=this._url();if(sharedClient.isNativeApp()&&(t.startsWith("http://")||t.startsWith("https://"))){
var i=util.getLocation(t),n=i.hostname,o=n.indexOf(settings.subdomain_suffix);e=n.substr(0,o-1)||"www",t=i.pathname}pageIsMobile||(this.__liveMutation&&(this.__inLiveMutation=!0,this.__liveMutationInfo=livenode.startMutation(this.__optimisticUpdate)),this.__contentFor&&this.__contentFor.useLoadingSpinner&&(this.__contentForLoadingTimeout=setTimeout(function(){W2.forgetContents($(this.__contentFor.element));var e=document.createElement("div");e.className="__contentfor_loading_dots",e.appendChild(loading.createLoadingDotsElement()),this.__contentFor.element.appendChild(e),this.__contentForLoadingDots=e}.bind(this),150)));var s={post:this._data(),url:t,subdomain:e};if(atLeastOneServerCallIsSent()||(s.post.__first_server_call=!0,updateAtLeastOneServerCallIsSent()),this._beforeSendHandler(),this.__onlyOnce){if(this._isSimilarServerCallActive())return this;this._component.activeServerCalls[this.__vcon_method]=1}var a=this._successHandler.bind(this),r=this._error().bind(this),d=this._completeHandler.bind(this);
if(pageIsMobile)s.callbackId=client.registerCallback(function(e){e.success?e.response&&a(e.response):r(),d()}),s.post.__mobile_page=!0,sharedClient.isMobileWeb()&&this._xhrFields()?s.xhrFields=this._xhrFields():sharedClient.isNativeApp()&&this._appFields()&&(s.appFields=this._appFields()),messages.send("webnodeServerCall",s);else{this.__startTime=w2_timing.getTime(),s.dataType="json",s.type="POST",s.xhrFields=this._xhrFields();var l=this._beforeErrorHandler.bind(this);s.success=a,s.error=function(e,t,i){try{l.apply(this,arguments)}finally{r.apply(this,arguments)}},s.complete=d,s.data=s.post,$.ajax(s)}},_beforeSendHandler:function(){this.__vcon&&(this._action=perf.startPOST({vcon:this.__vcon,method:this.__vcon_method}),this._disableDefaultUserPerceivedLogging||(this._userPerceivedAction=perf.startUserPerceived({vcon:this.__vcon,method:this.__vcon_method})))},_beforeErrorHandler:function(e,t,i){this.__contentFor&&this.__contentFor.useLoadingSpinner&&this.__contentForLoadingDots&&this.__contentFor.element.removeChild(this.__contentForLoadingDots),
pageIsMobile||w2Errors.reportAjaxError(e,t,i,this.__isRelatedToUserAction,this.__creationTime)},_completeHandler:function(){if(this.__startTime&&w2_timing.logRequestTime(this.__name,this.__startTime),this._action&&(perf.finishAction(this._action),this._action=null),!this._disableDefaultUserPerceivedLogging&&this._userPerceivedAction&&(perf.finishAction(this._userPerceivedAction),this._userPerceivedAction=null),this.__onlyOnce&&this._isSimilarServerCallActive()&&delete this._component.activeServerCalls[this.__vcon_method],this.__contentForLoadingTimeout&&clearTimeout(this.__contentForLoadingTimeout),!pageIsMobile&&this.__inLiveMutation){if(this.__liveMutationInfo){var e=this.__liveMutationInfo.transactionId;e&&livenode.mutationDoneAfterVersion(e,0)}this.__inLiveMutation=!1}},_successHandler:function(response){if(response.pmsg)if(pageIsMobile){var html=response.pmsg.html,fragment=util.documentFragmentFromString(html),container=document.getElementById("pmsg_container");container?container.appendChild(fragment):document.body.appendChild(fragment),
eval(response.pmsg.js)}else events.DocumentProxy.dispatch({type:events.Types.PMSG_SHOW,payload:{content:response.pmsg,fadeOut:!0}});if(response.exception)return void this._handleException(response);if(this.__contentFor){var element=$(this.__contentFor.element);if(pageIsMobile||W2.forgetContents(element),document.body.contains(element.get(0)))if(pageIsMobile&&this.__contentFor.inPlace){var wrapper=document.createElement("div");wrapper.innerHTML=response.value.html,element.replaceWith(wrapper),coreWebnode.evaluateContentJS(response.value)}else coreWebnode.setContent(element,response.value);pageIsMobile||$(document).trigger("rpc_content_for_done",{opts:this.__contentFor,value:response.value})}this.__success&&this.__success(response.value),this.__liveMutation&&"post_reload"==settings.pageMode&&window_manager.reload(),sharedClient.isAndroidApp()&&client.buildNumber>=1163||response.dirtied_depkeys&&messages.send("broadcastAllWebViews",{messageName:"reloadDirtiedDepkeys",data:{dirtied_depkeys:response.dirtied_depkeys
}}),response.post_perf_html&&events.DocumentProxy.dispatch({type:events.Types.PERF_POST_HTML,payload:{html:response.post_perf_html,js:response.post_perf_js}})},_onlyOnce:function(){return this._component.activeServerCalls||(this._component.activeServerCalls={}),this.__onlyOnce=!0,this},_invokeExceptionCallback:function(e){var t=this.__exceptionPatterns[e.exception.type];return t?t(e.exception,e,this):this.__exceptionCatchAll?void this.__exceptionCatchAll(e.exception,e,this):!0},_handleException:function(e){var t=this._invokeExceptionCallback(e);if(t){var i=settings.request_id;events.GlobalProxy.dispatch({type:events.Types.WEBNODE_RPC_EXCEPTION,payload:{exceptionType:e.exception.type,requestId:i}}),rpcsToRetry[i]=this.send.bind(this)}},_data:function(){settings.formkey||errors.logJsError("coreRpc","formkey not set -- can't send request securely.");var e;try{e=JSON.stringify(this.__data,function(e,t){return void 0===t?null:t})}catch(t){errors.logJsError("coreRpc","Can't JSON encode arguments to server call."),
e=JSON.stringify({error:"Can't JSON encode arguments to server call."})}var i={json:e,formkey:settings.formkey,postkey:settings.postkey,window_id:settings.windowId,referring_controller:settings.controller,referring_action:settings.action};if(this.__contentFor&&(i.parent_cid=this.__contentFor.parentCid,!pageIsMobile)){var n=this.__contentFor.element,o=coreComponent.getLiveChildren(i.parent_cid),s=o.filter(function(e){return n.contains(document.getElementById(e))});i.parent_domid=coreComponent.getLiveParent(i.parent_cid),i.domids_to_remove=JSON.stringify(s)}if(!pageIsMobile&&this.__liveMutation&&util.extend(i,this.__liveMutationInfo.data),this.__vcon&&(i.__vcon_json=JSON.stringify(this.__vcon),i.__vcon_method=this.__vcon_method,!pageIsMobile)){var a=actions.startOrUpdateAction(i.__e2e_action_id,{url:this.__url,vcon:this.__vcon,method:this.__vcon_method,args:i.args,kwargs:i.kwargs});i.__e2e_action_id=a.id}return this._component&&(this._sendJsData&&(i.js_init=JSON.stringify(this._component.__js_init)),
i.__metadata=JSON.stringify(flushMetadata(this._component))),i},_isSimilarServerCallActive:function(){return this._component.activeServerCalls?this.__vcon_method in this._component.activeServerCalls:!1}});exports.rpc=function(e){return(new RPC).url(e)},exports.ServerCall=RPC.extend({__init__:function(e,t,i){this._super(),this.__vcon=e,this.__vcon_method=t,this.__name=this.__vcon+"."+this.__vcon_method,this.__exceptionPatterns={state_expired:this._stateExpired.bind(this)},this.url(settings.serverCallUrl),this._component=i,this._sendJsData=!0,this._action=null,this._disableDefaultUserPerceivedLogging=!1,this._userPerceivedAction=null},_stateExpired:function(){pageIsMobile?messages.send("showAlert",{title:settings.interface_strings.page_out_of_date,message:settings.interface_strings.please_refresh},function(e){1==e.buttonIndex&&messages.send("reload")}):livenode.reportPageNeedsReload("livenode_state_expired")}});var metadataBuffer={},metadataCallbacks=[];exports.addMetadataCallback=function(e){
metadataCallbacks.push(e)};var flushMetadata=function(e){var t=e.cid,i=t in metadataBuffer?metadataBuffer[t]:{};delete metadataBuffer[t];for(var n=0;n<metadataCallbacks.length;n++)metadataCallbacks[n](i,e);return i},atLeastOneServerCallIsSent=exports.atLeastOneServerCallIsSent=function(){return _atLeastOneServerCallIsSent},updateAtLeastOneServerCallIsSent=function(){_atLeastOneServerCallIsSent=!0}}),define("shared/cookies",["shared/polyfills","shared/util","shared/w2.context","settings","shared/logging"],function(e,t,i){var n,o=e("shared/util"),s=e("shared/w2.context"),a=e("settings"),r=a.cookiePrefix,d=a.pageIsMobile,l=".quora.com",c=function(){c.called||(c.called=!0,e("shared/logging").log.apply(this,arguments))};d&&(n=e("mobile_app2/messages"));var h=function(e){return o.extend({expires:1825,path:"/",domain:l},e)},u=t.setCookie=function(e,i,o,s){if(o=h(o),d){var a={name:e,options:o};null!=i&&(a.value=i),n.send("setCookie",a,s)}else t.setCookieOnDocument(e,i,o)};t.getCookie=function(e,i){
return d?void n.send("retrieveCookie",{name:e},i):t.getCookieOnDocument(e)},t.setCookieOnDocument=function(e,t,i){i=h(i),e=r+"-"+e;var n,o=i.document||document,s=i.path?"; path="+i.path:"",a=i.domain?"; domain="+i.domain:"",d=i.secure?"; secure":"",l="";null===t&&(t="",i.expires=-1),i.expires&&"number"==typeof i.expires&&(n=new Date,n.setTime(n.getTime()+24*i.expires*60*60*1e3),l="; expires="+n.toUTCString()),i.expires instanceof Date&&(l="; expires="+i.expires.toUTCString()),o.cookie=[e,"=",encodeURIComponent(t),l,s,a,d].join("")},t.getCookieOnDocument=function(e){e=r+"-"+e;var t,i,n,o=document;if(o.cookie&&""!==o.cookie)for(t=o.cookie.split(";"),n=0;n<t.length;n++)if(i=t[n].trim(),i.startsWith(e+"="))return decodeURIComponent(i.substring(e.length+1))};var p=function(e){var t,i,n="="+encodeURIComponent(e),o='="'+encodeURIComponent(e)+'"';if(document.cookie)for(t=document.cookie.split(";"),i=0;i<t.length;i++)if(t[i].endsWith(n)||t[i].endsWith(o))return!0;return!1},f=t.setMessage=function(e,t,i,n){
var o=document,s=o.cookie.length,r=o.cookie.split(";").length;if(n=h(n),s>2400||r>50){var l={key:e,args:t,size:s,count:r,cookie:o.cookie};return void c("cookie_message_errors",l,{scribeOnly:!0})}var f=Math.floor(4294967296*Math.random()),_=JSON.stringify({key:e,args:t}),g=["qm",f,a.nid].join("-");d&&(_=btoa(_)),p(_)||u(g,_,n,i)};t.setQfeedLog=function(e,t){var i,n=e.getDvar("feed_story_hash"),o=e.getDvar("paged_list_hash"),a=e.getDvar("enable_feed_logging"),r=e.getDvar("feed_story_initial"),l=e.getDvar("feed_ty"),c=e.getDvar("feed_page"),h=e.getDvar("page_data"),u=e.getDvar("focus_ty"),p=e.getDvar("feed_story_inner_position"),_=e.getDvar("bundle_position"),g=e.getDvar("feed_story_position");if((!d||a)&&n){if(null===l&&(l=0),r||(r=!1),d&&null===g){var m=e.getContext(s.UniversalPageFeedContext),v=m.get("impressionLogger");if(!v)return;g=v.getPositionFromPagedListHash(o)}g=null===g?0:g,p=null===p?0:p,i=[9,n,g,r,t,l,c,h,u,p,_],f("qfl",i)}},t.setTlog=function(e){a.trail&&e&&f("tlog",[a.trail,e]);
},t.setQueryLog=function(e,t){var i=e.getDvar("query_id"),n=e.getDvar("index");null!==i&&(null===n&&(n=0),f("qlch",[i,{type:t,index:n}]))},t.setScreenSizeCookie=function(){var e=window.screen.width,t=window.screen.height;u("screen_size",e+"x"+t)}}),define("shared/loadjs",["shared/polyfills","shared/util","shared/onload"],function(e,t,i){var n=e("shared/util"),o=e("shared/onload");t.loadJS=function(e,t){var i=document.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onerror=window.Q.retryScriptTag.bind(null,i),t&&(i.onload=i.onreadystatechange=n.once(t));var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(i,o)};var s=function(e){var t=document.createElement("object");t.data=e,t.type="application/javascript",t.width=0,t.height=0,document.body.appendChild(t)};t.lazyPrefetchJS=function(e){o.execAfterLoadDelayed(function(){s(e)})}}),define("shared/facebook",["shared/polyfills","shared/loadjs","shared/util","shared/onload","shared/client","settings"],function(e,t,i){
var n=e("shared/loadjs").loadJS,o=e("shared/util"),s=e("shared/onload"),a=e("shared/client"),r=e("settings"),d=!1,l=[],c=o.once(function(){if(!r.pageIsMobile||!a.isNativeApp()){var e=r.fbLanguageCode,t="//connect.facebook.net/"+e+"/sdk.js",i=r.fbAppId;window.fbAsyncInit=function(){for(FB.init({appId:i,oauth:!0,xfbml:!1,version:"v2.4"}),d=!0;l.length;)l.pop().call()},n(t)}}),h=t.onInit=function(e){d?e():(s.execAfterLoadDelayed(c),l.push(e))};t.isLoaded=function(){return d},t.load=function(){h(function(){})};var u=null,p=t.updatePermissions=function(e){FB.api("/me/permissions",function(t){t.data&&t.data.length>0?(u=t.data,e&&e(!0,t.data)):e&&e(!1,null)})};t.asyncUpdatePermissions=function(){null===u&&h(function(){FB.getLoginStatus(function(e){"connected"==e.status&&p()})})},t._disconnect=function(){FB.getLoginStatus(function(e){e.authReponse?FB.api({method:"auth.revokeAuthorization"},function(e){e?console.log("Successfully disconnected"):console.error("Disconnection failed")},console.error):console.warn("Already not connected");
})};var f=t.hasPermission=function(e){return u&&1==u[e]};t.requestPermissions=function(e,t){var i=function(e){return e.split(",").every(f)};i(e)?t(!0):FB.login(function(n){"connected"===n.status?p(function(n,o){t(n&&i(e))}):t(!1)},{scope:e})};var _=function(){return d?FB.getAuthResponse():null};t.getAccessToken=function(){var e=_();return e?e.accessToken:null},t.getExpiresIn=function(){var e=_();return e?e.expiresIn:null},t.getFbUid=function(){var e=_();return e?e.userID:null}}),define("unified_view/mobile_overlays",["shared/polyfills","shared/core/component","shared/client","interface/settings","shared/errors","shared/jquery"],function(e,t,i){var n,o,s=e("shared/core/component").Component,a=e("shared/core/component"),r=e("shared/client"),d=e("interface/settings").pageIsMobile,l=e("shared/errors"),c=e("shared/jquery");d&&(n=e("mobile_app2/messages"),o=e("mobile_app2/client"));var h,u,p=s.extend({$getContainer:function(){return this.$id("@container")},$getContent:function(){return this.$id("@content");
},show:function(){var e=this;if(!this.isShown){this.isShown=!0,this._closeListener=this.close.bind(this),n.send("addHash",{hash:this._getHashName(),onRemove:this._closeListener}),window.onpopstate=function(t){var i=document.location.hash.substr(1);i&&i.length>0&&i!=e._getHashName()&&"action_sheet"!=i&&e.close()},this.modalBackground=document.createElement("div"),this.modalBackground.className="modal_bg";var t=this.$getContainer().css("z-index");this.modalBackground.style.zIndex=t-1,document.body.insertBefore(this.modalBackground,document.body.firstChild),c(this.modalBackground).on("click",function(){window.history.back()}),this.$getContainer().removeClass("hidden"),this.$getContainer().addClass(this._getOpenAnimation()),this.$getContent().scrollTop(0),this._fixHeight(),r.isIOSMobileWeb()?this._lockScrollOnIOS():document.body.style.overflowY="hidden",this._resizeListener=this._fixHeight.bind(this),window.addEventListener("resize",this._resizeListener)}},close:function(){if(this.isShown){
if(this.isShown=!1,this.$getContainer().addClass("hidden"),window.removeEventListener("popstate",this._closeListener),window.removeEventListener("resize",this._resizeListener),r.isIOSMobileWeb()){var e=this.$getContent().get(0);e.removeEventListener("touchstart",this._handleTouchStart),e.removeEventListener("touchmove",this._handleTouchMove),window.removeEventListener("scroll",this._iOSScrollHack),document.body.removeEventListener("touchmove",this._cancelTouch)}else document.body.style.overflowY="scroll";document.body.removeChild(this.modalBackground),this.onClose&&this.onClose(),this._clearPageAction()}},setOnClose:function(e){this.onClose=e},setRightTextButton:function(e){var t=this.$id("@navigation_button");t.removeClass("hidden"),t.removeClass("has_badge"),t.toggleClass("is_disabled",e.disabled),t.text(e.title);var i=this.$id("@header_action_buttons");i&&i.addClass("hidden");var n=e.callback;t.on("click",function(){n()})},setRightIconButtons:function(e){this.hideRightButtons();var t=this.$id("@header_action_buttons");
t.removeClass("hidden");for(var i=0;i<e.length;i++){var n=e[i],s="@right_icon_button_"+i,a=this.$id(s);a.removeClass("hidden"),a.toggleClass("is_disabled",n.disabled),a.text(o.getIconChar(n.iconName));var r=n.callback;a.on("click",function(){r()})}},hideRightButtons:function(){var e=this.$id("@navigation_button");e.toggleClass("hidden",!0);for(var t=0;2>t;t++){var i="@right_icon_button_"+t;this.$id(i).addClass("hidden")}},_fixHeight:function(){var e;e=!this._height||this._height>window.innerHeight?window.innerHeight:this._height;var t=this.$id("@action_view_header").height();this.$getContainer().height(e),this.$getContent().height(e-t);var i=window.scrollY+(window.innerHeight-e);this.$getContainer().css("top",i+"px")},_lockScrollOnIOS:function(){var e=this.$getContent().get(0),t=this;t.startScroll=window.scrollY,this._handleTouchStart=function(e){t.allowUp=this.scrollTop>0,t.allowDown=this.scrollTop<this.scrollHeight-this.clientHeight,t.slideBeginY=e.pageY},e.addEventListener("touchstart",this._handleTouchStart),
this._handleTouchMove=function(e){var i=e.pageY>t.slideBeginY,n=e.pageY<t.slideBeginY;t.slideBeginY=e.pageY,i&&t.allowUp||n&&t.allowDown?e.stopPropagation():e.preventDefault()},e.addEventListener("touchmove",this._handleTouchMove),this._cancelTouch=function(e){e.preventDefault()},document.body.addEventListener("touchmove",this._cancelTouch),this._iOSScrollHack=function(e){window.scrollTo(window.scrollX,t.startScroll)},window.addEventListener("scroll",this._iOSScrollHack)}});t.ModalOverlay=p.extend({onLoad:function(){var e=this;u=e;var t=e.$id("@close_button");t.on("click",function(){window.history.back()})},_clearPageAction:function(){this.hideRightButtons()},_getOpenAnimation:function(){return"modal-open"},_getHashName:function(){return"modal"}}),t.ActionViewOverlay=p.extend({onLoad:function(){var e=this;h=e;var t=e.$id("@close_button");t.on("click",function(){window.history.back()})},_clearPageAction:function(){this.hideRightButtons(),this.setTitle("")},_getOpenAnimation:function(){return"action-view-slide-in";
},_getHashName:function(){return"actionView"},setTitle:function(e){this.$id("@title").text(e)},setHeight:function(e){this._height=e,this._fixHeight()}}),t.getActionViewOverlay=function(){return h},t.getModalOverlay=function(){return u},t.isOverlayShown=function(){var e=!1;return[h,u].forEach(function(t){e|=t&&t.isShown}),e};var f=t.setPageAction=function(e){g[m]=e;var t;if(h.isShown)t=h,e.title&&t.setTitle(e.title);else{if(!u.isShown)return;t=u}e.rightTextButton&&t.setRightTextButton(e.rightTextButton),e.rightIconButtons&&t.setRightIconButtons(e.rightIconButtons)},_=0;t.moveElementToDiv=function(e,t){var i=document.createElement("div"),n="_movedElement_"+_++;i.id=n,e.parentElement&&e.parentElement.replaceChild(i,e),t.appendChild(e),e.setAttribute("_markerId",n)},t.moveElementBack=function(e){var t=e.getAttribute("_markerId"),i=document.getElementById(t);i?(i.parentElement.replaceChild(e,i),e.setAttribute("_markerId",void 0)):e.parentElement.removeChild(e)};var g={},m=-1,v={};t.registerComponent=function(e,t){
var i=v[e];void 0===i&&(i=[],v[e]=i),t.cid!=e&&i.push(t)},t.deregisterComponent=function(e,t){var i=v[e];if(i){var n=i.indexOf(t);n>-1&&i.splice(n,1)}},t.executeOnLoadForPrefetchedContent=function(e){var t=e.cid,i=v[t];m=t;var n=e.getDvar("prefetchedContentRootCid");if(n){e.setDvar("prefetchedContentRootCid",void 0);try{a.onLoad(i,!1)}catch(o){l.report(o)}}else{var s=g[t];s&&f(s)}}}),define("shared/resource_timing",["shared/polyfills"],function(e,t,i){var n=["name","initiatorType","connectStart","connectEnd","domainLookupStart","domainLookupEnd","duration","fetchStart","redirectEnd","redirectStart","requestStart","responseEnd","responseStart","secureConnectionStart","startTime","workerStart","transferSize","encodedBodySize","decodedBodySize","entryType"];t.getResourceTimingInformation=function(){var e=[],t=window.performance;if(t&&t.getEntriesByType)for(var i=t.getEntriesByType("resource"),o=0;o<i.length;o++){for(var s=i[o],a={},r=0;r<n.length;r++){var d=n[r];d in s&&(a[d]=s[d])}e.push(a);
}return e}}),define("third_party/timing",["shared/polyfills"],function(e,t,i){!function(e){"use strict";e.timing=e.timing||{getTimes:function(t){var i=e.performance||e.webkitPerformance||e.msPerformance||e.mozPerformance;if(void 0===i)return!1;var n=i.timing,o={};if(t=t||{},n){if(t&&!t.simple)for(var s in n)n.hasOwnProperty(s)&&(o[s]=n[s]);if(void 0===o.firstPaint){var a=0;e.chrome&&e.chrome.loadTimes?(a=1e3*e.chrome.loadTimes().firstPaintTime,o.firstPaintTime=a-1e3*e.chrome.loadTimes().startLoadTime):"number"==typeof e.performance.timing.msFirstPaint&&(a=e.performance.timing.msFirstPaint,o.firstPaintTime=a-e.performance.timing.navigationStart),t&&!t.simple&&(o.firstPaint=a)}o.loadTime=n.loadEventEnd-n.fetchStart,o.domReadyTime=n.domComplete-n.domInteractive,o.readyStart=n.fetchStart-n.navigationStart,o.redirectTime=n.redirectEnd-n.redirectStart,o.appcacheTime=n.domainLookupStart-n.fetchStart,o.unloadEventTime=n.unloadEventEnd-n.unloadEventStart,o.lookupDomainTime=n.domainLookupEnd-n.domainLookupStart,
o.connectTime=n.connectEnd-n.connectStart,o.requestTime=n.responseEnd-n.requestStart,o.initDomTreeTime=n.domInteractive-n.responseEnd,o.loadEventTime=n.loadEventEnd-n.loadEventStart}return o},printTable:function(e){var t={},i=this.getTimes(e)||{};Object.keys(i).sort().forEach(function(e){t[e]={ms:i[e],s:+(i[e]/1e3).toFixed(2)}}),console.table(t)},printSimpleTable:function(){this.printTable({simple:!0})}}}(this)}),define("shared/paint_timing",["shared/polyfills","third_party/timing"],function(e,t,i){e("third_party/timing"),t.getPaintTimingInformation=function(){return window.timing.getTimes()}}),define("shared/e2e",["shared/polyfills","shared/util","shared/log","shared/logging","settings","shared/w2.timing","shared/resource_timing","shared/client","shared/paint_timing"],function(e,t,i){var n=e("shared/util"),o=e("shared/log").log,s=e("shared/logging"),a=e("settings"),r=e("shared/w2.timing"),d=a.pageIsMobile,l=e,c=e("shared/resource_timing"),h=e("shared/client"),u=e("shared/paint_timing"),p=!1,f=!1,_=null,g=null,m=null,v="desktop";
t.NATIVE_PERF_SAMPLE_RATE=.01;var w=!1;t.maybeReportPrefetchedData=function(){w=!0,window.performance.timing.loadEventEnd>0&&S()},d&&(v="mobile",_=e("mobile_app2/client"),_.registerMessageHandler("networkStatusLog",function(e){s.log("mobile_app2_client_perf",e,{scribeOnly:!0})}),_.registerMessageHandler("logPerformanceData",function(e){"web_view_page_ready"==e.measurement&&void 0===e.error&&k({native_first_paint:e.duration,network_class:a.networkClass})})),t.reportPageData=function(e){if(null!==e&&e.mustReport){delete e.mustReport;var t=r.timing,i={};for(var o in t)"components"!==o&&"_components"!==o&&(i[o]=t[o]);g=n.extend(e,{win_perf:{path:window.location.pathname,revision:a.revision,request_id:a.request_id,controller:a.controller,action:a.action,server_time:t.server_time,total_worker_time:t.total_worker_time,window_id:t.window_id,is_css_inlined:t.is_css_inlined,is_early_js_inlined:t.is_early_js_inlined,experiments:t.experiments},w2_timing:i,paint_timing:u.getPaintTimingInformation()}),
y()}};var b=function(){return window.performance&&window.performance.timing},y=function(){return b()&&0===window.performance.timing.loadEventEnd?void setTimeout(y,250):void C()},C=function(){if(b()){var e={},t=r.timing;for(var i in window.performance.timing){var n=window.performance.timing[i];"number"==typeof n&&(e[i]=n)}if(g.win_perf.timing=e,a.componentInspector){var o=l("w2.inspector");o.isRequestTimeSlowerThanStandard()&&(g.slow_load={platform:v,user_agent:window.navigator.userAgent,path:window.location.pathname,controller:a.controller,action:a.action,window_id:t.window_id,page_time:t.page,request_time:t.request,load_time:e.loadEventStart-e.navigationStart})}}else g.win_perf.timing={};r.stop(),p=!0,x()},k=function(e){m=e,x()},x=function(){d?S():E()},S=function(){var e=!1;h.isMobileWeb()&&p&&(e=!0),!b()&&m&&(e=!0),p&&g&&m&&(e=!0),h.isNativeApp()&&a.isPagePrefetched&&!w&&(e=!1),e&&E()},E=function(){if(!f){f=!0;var e=n.extend(g||{},m||{});h.isIOSApp()&&a.buildNumber>=706&&a.fauxE2ETimeIncrement>0&&"native_first_paint"in e&&(e.native_first_paint-=e.native_first_paint*a.fauxE2ETimeIncrement/100),
setTimeout(function(){if(e.resource_timing=c.getResourceTimingInformation(),!d&&o.enabled){var t=g.win_perf.timing,i=t.loadEventStart-t.navigationStart,n=e.win_perf.server_time;o("e2e.reportPageData","Metric:",i,"Server time:",n,"Details:",g)}s.log("perf/get_e2e",e,{sampleRate:.2})},100),d&&setTimeout(function(){for(var e=[],t=c.getResourceTimingInformation(),i=0;i<t.length;i++){var n=t[i];e.push({name:n.name,encodedBodySize:n.encodedBodySize,decodedBodySize:n.decodedBodySize,entryType:n.entryType,transferSize:n.transferSize})}s.log("perf_bandwidth_usage",{bandwidthUsage:e},{scribeOnly:!0,sampleRate:.05})},6e4),a.componentInspector||(delete r.timing.components,delete r.timing._components)}}}),define("video",["shared/polyfills","shared/jquery"],function(e,t,i){var n=e("shared/jquery");t.handleVideosBeforeSelectionHidden=function(e){e.find(".qtext_embed").each(function(t,i){e.find("iframe")&&n(i).parent().empty()})},t.stopAllVideos=function(e){e.find(".qtext_embed").each(function(e,t){n(t).find("iframe").each(function(e,t){
var i=n(t).attr("src");i&&-1!==i.indexOf("autoplay=1")&&(i=i.replace("autoplay=1","autoplay=0")),n(t).attr("src",i)})})}}),define("shared/keyboard_event_handler",["shared/polyfills","shared/jquery"],function(e,t,i){var n=e("shared/jquery"),o=[];t.push=function(e){o.push(e)},t.remove=function(e){var t=o.indexOf(e);t>-1&&o.splice(t,1)},n(document).on("keydown",function(e){for(var t=o.length-1;t>=0;t--){var i=o[t](e);if(0==i||e.isDefaultPrevented())return}})}),define("w2.modal",["shared/polyfills","shared/core/component","shared/jquery","shared/Class","webnode2","video","shared/logging","shared/dom","shared/viewport","shared/debounce","shared/keyboard_event_handler"],function(e,t,i){var n=e("shared/core/component"),o=e("shared/jquery"),s=e("shared/Class").Class,a=e("webnode2"),r=e("video"),d=e("shared/logging").log,l=e("shared/dom"),c=e("shared/viewport"),h=e("shared/core/component").getAllDvars,u=e("shared/debounce").debounce,p=e("shared/keyboard_event_handler"),f=[],_=function(e){f.push(e);
},g=function(e){var t=f.indexOf(e);t>-1&&f.splice(t,1)},m=function(){return f[f.length-1]},v=0,w=function(){return v++},b=1e3,y=t.ModalBase=s.extend({__init__:function(e,t){this.opener=e,this.opts=o.extend({args:[],kwargs:{},closeOnEscape:!0,closeOnBackgroundClick:!0,closeOnScroll:!1,showFixedCloseButton:!1,customOverlayClass:null,errorCallback:null},t),this._modalId=w(),this._cid="*modal*_"+this._modalId,this.$container=o("#__w2_modal_container_"),this._initModal(),this._fetchStarted=!1,this._fetchCompleted=!1,this._fetchStartTime=0,this._isOpen=!1,this._firstOpenTime=0},_initModal:function(){var e=document.createElement("div");e.id="#__w2_modal_overlay_"+this._modalId,e.className="modal_overlay hidden",this.opts.customOverlayClass&&e.classList.add(this.opts.customOverlayClass),this.$container.append(e),this.$overlay=o(e);var t=document.createElement("div");if(t.id="#__w2_modal_wrapper_"+this._modalId,t.className="modal_wrapper",t.tabIndex=-1,e.appendChild(t),this.$contentWrapper=o(t),
this.opts.showFixedCloseButton){var i=document.createElement("a");i.id="#__w2_modal_close_"+this._modalId,i.className="modal_fixed_close hidden",e.appendChild(i),this.$closeButton=o(i)}},_bindHandlers:function(){this.opts.closeOnEscape&&this.bindKeyboardHotkeys(),this.opts.closeOnBackgroundClick&&this.bindBackgroundClickDismissHandler(),this.opts.showFixedCloseButton&&this.bindCloseButton()},_unbindHandlers:function(){this.opts.closeOnEscape&&p.remove(this.escKeyHandler),this.opts.closeOnBackgroundClick&&this.$overlay.off("click.modalOverlay"),this.opts.closeOnScroll&&this.unbindCloseOnScroll(),this.opts.showFixedCloseButton&&this.$closeButton.off()},_open:function(){this._isOpen=!0,_(this),this._bindHandlers(),c.setPageScroll(!1),this.$overlay.removeClass("hidden"),this.opts.showFixedCloseButton&&this.$closeButton.removeClass("hidden"),this.$contentWrapper.focus(),this._fetchCompleted&&this.onContentVisible()},fetch:function(e){if(!this._fetchStarted){this.$contentWrapper.addClass("loading_overlay"),
this._fetchStarted=!0,this._fetchStartTime=Date.now();var t=this,i=this.opener.serverCall(e);i.args.apply(i,t.opts.args).kwargs(t.opts.kwargs).error(function(){t._fetchStarted=!1,n.unloadComponent(t._cid),t.close()}).success(function(){t.onFetchSuccess()}).contentFor(this.$contentWrapper,{parentCid:this._cid}),this.opts.errorCallback&&i.error(this.opts.errorCallback),i.send()}},onFetchSuccess:function(){this.opener.__modal__=this;var e=n._safeGetComponentByCID(this._cid);e.__opener__=this.opener,e.__modal__=this,n._components[this._cid]=e;var t={};t[this._cid]="*ROOT*",n.addParents(t),e.setDvar("__modal__",this._cid);var i=n._allChildren[this._cid][0],o=n._safeGetComponentByCID(i),s=h(this.opener);delete s.__modal__,o.__dvars__=s,"feed_desktop_modal"===this.opts.customOverlayClass&&d("web_modal_loading_time",{fetch_start_time:this._fetchStartTime,fetch_finish_time:Date.now(),first_open_time:this._firstOpenTime},{sampleRate:.01}),this.$contentWrapper.height()>b&&this.$contentWrapper.addClass("tall"),
this.$contentWrapper.removeClass("loading_overlay"),this._fetchCompleted=!0,this._isOpen&&this.onContentVisible()},onContentVisible:function(){this.opts.closeOnScroll&&this.bindCloseOnScroll()},load:function(e){return this._open(),this._fetchStarted||this.fetch(e),0===this._firstOpenTime&&(this._firstOpenTime=Date.now()),this},_teardownContent:function(){},close:function(e,t){if(this._isOpen){this._isOpen=!1,g(this),r.stopAllVideos(this.$contentWrapper),this.opts.showFixedCloseButton&&this.$closeButton.addClass("hidden");var i=this,n=function(){i.$overlay.addClass("hidden"),m()||(i.opts.closeOnScroll?i._reenableScrollAfterClose():t?setTimeout(function(){c.setPageScroll(!0)},t):c.setPageScroll(!0)),i._unbindHandlers(),i._teardownContent()};e?n():l.addAnimationClass(i.$overlay,"closing",n)}},bindCloseButton:function(){var e=this;e.$closeButton.on("click",function(t){t.stopPropagation(),e._isOpen&&e.close()})},_closeOnScrollThreshold:function(){var e=this.$contentWrapper.outerHeight();return Math.max(e-.33*window.innerHeight,2*e/3);
},bindCloseOnScroll:function(){var e=this;e._setupScrollClose||(e._setupScrollClose=u(function(){e.$contentWrapper.css("margin-bottom",window.innerHeight);var t=e._closeOnScrollThreshold();e.$overlay.scrollTop()>t&&e.$overlay.scrollTop(t)},50)),e._checkScrollClose||(e._checkScrollClose=u(function(){e.$overlay.scrollTop()>e._closeOnScrollThreshold()&&e.close()},50)),e._reenableScrollAfterClose||(e._reenableScrollAfterClose=u(function(){m()||(c.setPageScroll(!0),o(window).off("wheel",e._reenableScrollAfterClose))},100)),e.$overlay.scrollTop(0),e._setupScrollClose(),o(window).on("resize",e._setupScrollClose),e.$overlay.on("scroll",e._checkScrollClose),o(window).on("wheel",e._reenableScrollAfterClose)},unbindCloseOnScroll:function(){o(window).off("resize",this._setupScrollClose),this.$overlay.off("scroll",this._checkScrollClose)},bindKeyboardHotkeys:function(){var e=this;e.escKeyHandler=function(t){27==t.keyCode&&e._isOpen&&e===m()&&e.close()},p.push(e.escKeyHandler)},bindBackgroundClickDismissHandler:function(){
var e=this;e.$overlay.on("click.modalOverlay",function(t){t.target==this&&!e._isScrollBarClicked(t)&&e._isOpen&&(t.stopPropagation(),e.close())})},_isScrollBarClicked:function(e){var t=l.getScrollbarWidth();return window.innerWidth-e.clientX<t?!0:!1}}),C=t.Modal=y.extend({_initModal:function(){this.$contentWrapper=o("#__w2_modal_wrapper_"),this.$overlay=o("#__w2_modal_overlay_"),this.$closeButton=o("#__w2_modal_close_")},_teardownContent:function(){a.forgetContents(this.$contentWrapper),n.unloadComponent(this._cid),this.$contentWrapper.html(""),this.$overlay.off(),this.opts.showFixedCloseButton&&this.$closeButton.off()}});t.ModalWithCallBacks=C.extend({_onCloseCallBack:null,_onSubmitCallBack:null,onCloseCallBack:function(e){return this._onCloseCallBack=e,this},executeOnCloseCallBack:function(){this._onCloseCallBack&&this._onCloseCallBack()},onSubmitCallBack:function(e){return this._onSubmitCallBack=e,this},executeOnSubmitCallBack:function(){this._onSubmitCallBack&&this._onSubmitCallBack.apply(null,arguments);
}}),C.openerFor=function(e){var t=e.getDvar("__modal__"),i=n._safeGetComponentByCID(t);return i&&i.__opener__},C.modalFor=function(e){var t=e.getDvar("__modal__"),i=n._safeGetComponentByCID(t),o=i&&i.__modal__;return o||(o=m()),o}}),define("shared/modal",["shared/polyfills","settings","shared/errors","shared/core/component","shared/eventemitter","shared/util","shared/client","shared/Class","w2.modal"],function(e,t,i){var n,o,s,a,r,d,l,c=e("settings"),h=c.pageIsMobile,u=e("shared/errors"),p=e("shared/core/component"),f=e("shared/eventemitter"),_=e("shared/util"),g=e("shared/client"),m=e("shared/Class").Class;h?(o=e("mobile_app2/client"),s=e("mobile_app2/messages"),d=e("mobile_app2/modals"),l=e("mobile_app2/web_app_shim/modal"),a=e("mobile_app2/action_view"),n=e("mobile_app2/web_app_shim/hash_handler")):r=e("w2.modal");var v={},w=function(e){var t;return h?g.isMobileWeb()&&(t=l.openerCid(e)):t=r.Modal.openerFor(e).cid,v[t]};t.handleClose=function(e){var t;(!h||g.isMobileWeb())&&(t=w(e),t.handleClose()),
h?(p.unloadComponent(e.cid),g.isNativeApp()?(s.send("dismiss"),o.broadcastMessageToWebViews("handleModalClose")):l.dismissActiveModal()):t.innerModalInstance().close()},t.handleSubmit=function(e,t){if(!h||g.isMobileWeb()){var i=w(e);return void i.handleSubmit(t)}o.broadcastMessageToWebViews("handleModalSubmit",t)},t.fromComponent=function(e){return new b(e)};var b=m.extend({__init__:function(e){this.component=e,this.emitter=new f.EventEmitter,v[this.component.cid]=this,this.__kwargs={},this.__webOnlyOptions=null,this.__loaded=!1,this.__fromServerCall=!1,this.__method=null,this.__vcon=null,this.__fromElement=!1,this.__element=null},innerModalInstance:function(){if(g.isNativeApp())return void u.logJsError("shared/modal","Trying to getModalInstance on native");if(!this.__modal){var e={kwargs:this.__kwargs};h?this.__modal=new l.Modal(this.component,e):(e=_.extend(this.__webOnlyOptions||{},e),this.__modal=new r.ModalWithCallBacks(this.component,e))}return this.__modal},load:function(){return this.__loaded?this:(this.__loaded=!0,
h?g.isNativeApp():this.innerModalInstance().fetch(this.__method),this)},show:function(){if(this.load(),h)if(this.__fromElement)this.__kwargs.useActionView?a.showFromComponent(this.__element,this.component,this.__kwargs.height,this.__kwargs.url,this.__kwargs.title):d.showFromComponent(this.__element,this.component,this.__kwargs.url);else if(g.isNativeApp()){var e=this.handleSubmit.bind(this),t=this.handleClose.bind(this);o.registerOneTimeMessageHandler("handleModalSubmit",e),o.registerOneTimeMessageHandler("handleModalClose",t),this.onUnload(function(){o.removeOneTimeMessageHandler("handleModalSubmit",e),o.removeOneTimeMessageHandler("handleModalClose",t)}),d.showFromServerCall(this.component,this.__vcon,this.__method,this.__kwargs)}else n.initComponent(this),this.innerModalInstance().load(this.__method),this._addHashMobileWeb();else this.innerModalInstance().load(this.__method);return this},_addHashMobileWeb:function(){if(!g.isMobileWeb()){var e=0,t=window.location.hash;if(t){var i=t.split("-");
if(i.length>1){var o=parseInt(i[1])||0;e=o+1}}t="mwebmodal-"+e,n.addHash(this,t,function(){l.dismissActiveModal()})}},unload:function(){this.emitter.trigger("unload"),v[this.component.cid]=null,g.isMobileWeb()&&n.checkAndDeleteHash(this)},onUnload:function(e){return this.emitter.on("unload",e),this},fromElement:function(e,t){return h||u.logJsError("shared/modal","fromElement only supported in mobile."),this.__fromServerCall&&u.logJsError("shared/modal","Used both fromElement and fromServerCall."),this.__fromElement=!0,this.__element=e,this.__kwargs=t,this},fromServerCall:function(e,t){return this.__fromElement&&u.logJsError("shared/modal","Used both fromElement and fromServerCall."),this.__fromServerCall=!0,this.__vcon=e,this.__method=t,this},kwargs:function(e){return this.__kwargs=e,this},webOnlyOptions:function(e){return this.__webOnlyOptions=e,this},onSubmit:function(e){return this.emitter.on("submit",e),this},onClose:function(e){return this.emitter.on("close",e),this},handleClose:function(){
this.emitter.trigger("close"),this.unload()},handleSubmit:function(e){g.isMobileWeb()&&n.checkAndDeleteHash(this),this.emitter.trigger("submit",[e])}})}),define("shared/core/component",["shared/polyfills","shared/Class","shared/w2.timing","shared/eventemitter","shared/jquery","shared/w2.context","shared/util","interface/settings","shared/errors","shared/events/index","shared/log","gating","shared/client","unified_view/mobile_overlays","shared/modal","shared/core/rpc"],function(e,t,i){var n=e("shared/Class").Class,o=e("shared/w2.timing"),s=e("shared/eventemitter").EventEmitter,a=e("shared/jquery"),r=e("shared/w2.context"),d=e("shared/util"),l=e("interface/settings"),c=l.pageIsMobile,h=e("shared/errors"),u=e("shared/events/index"),p=e("shared/log").log,f=e("gating"),_=e("shared/client"),g={},m={},v={},w={},b={},y={},C={},k={},x={};t._parents=g,t._components=m,t._allChildren=v,t._children=w,t._hmacs=b,t._domids=y,t._domidToCid=C,t._debugInfo=k,t._unloaded=x;var S=t.addParents=function(e){var t,i,n,o;
for(t=Object.keys(e),o=0;o<t.length;o++)i=t[o],n=e[i],g[i]=n,n in v||(v[n]=[]),v[n].push(i),i in w||(w[i]={})},E=function(e){var t,i,n;for(t=Object.keys(e),i=0;i<t.length;i++)n=t[i],b[n]=e[n]},T=function(e){var t,i,n;for(t=Object.keys(e),i=0;i<t.length;i++)n=t[i],n in w||(w[n]={}),d.extend(w[n],e[n])},$=function(e){var t,i,n,o;for(t=Object.keys(e),i=0;i<t.length;i++)n=t[i],o=e[n],y[n]=o,C[o]=n},L=t.addDebugInfo=function(e){var t,i,n;for(t=Object.keys(e),i=0;i<t.length;i++)n=t[i],k[n]=e[n],o.timing._components&&(n in o.timing._components||(o.timing._components[n]={}),o.timing._components[n].addDebugInfo=Date.now())};t.addComponentMetadata=function(e){var t=e.parents,i=e.children,n=e.domids,o=e.hmacs;S(t),E(o),T(i),$(n),"debugInfo"in e&&L(e.debugInfo)},t.registerComponents=function(e){return e.forEach(function(e){m[e.cid]=e}),e};var A=t._safeGetComponentByCID=function(e){var t;return e?(t=m[e],t?t:B(e)):null};t.isCid=function(e){return e&&!!m[e]},t.getLiveDomId=function(e){return y[e]},t.getLiveDomElement=function(e){
return e in y?document.getElementById(y[e]):void 0},t.getComponentFromElement=function(e){for(;e&&!(e.id in C);)e=e.parentNode;return e&&A(C[e.id])};var D=t.getLiveParent=function(e){return e in y?y[e]:e in g?D(g[e]):""};t.getLiveParentDomElement=function(e){return document.getElementById(D(e))},t.getLiveChildren=function(e){var t,i,n;if(t=v[e],i=[],t)for(n=0;n<t.length;n++)t[n]in y&&i.push(y[t[n]]);return i};var I=t.onLoadComponent=function(t,i){if(c){var n=t.getDvar("prefetchedContentRootCid");if(n){var s;if(s=e(_.isNativeApp()||f.force_mobile_app_feed_modals?"mobile_app2/page_cloner":"unified_view/mobile_overlays"),s.registerComponent(n,t),t.whenUnloaded(function(){s.deregisterComponent(n,t)}),n!=t.cid)return}}var a,r=!!o.timing.components,d=t.cid;r&&(a=Date.now());try{t.onLoad(i),c&&e("mobile_app2/broadcast").registerComponentListeners(t),t._flushOnLoadCallbacks()}catch(l){d=t.cid;var h=t.vcon();h&&(l.message=l.message+" ("+d+" "+h+")"),e("shared/errors").report(l)}r&&(o.timing.components[d]||(o.timing.components[d]={}),
o.timing.components[d].l=Date.now()-a)},M=t.removeComponentMetadata=function(e){u.DocumentProxy.dispatch({type:u.Types.WEBNODE_BEFORE_REMOVE_COMPONENT_METADATA,payload:{cid:e}});var t=m[e],i=g[e],n=t&&t.cname;if(i&&n){var o=w[i];o&&o[n]==e&&delete o[n]}if(i){var s=v[i];if(s){var a=s.indexOf(e);a>-1&&s.splice(a,1)}}delete v[e],delete w[e],delete m[e],delete k[e],delete C[y[e]],delete y[e],delete b[e],delete g[e]},O=t.unloadComponent=function(e){try{p("core.component","unloadComponent(",e,")");var t=m[e];t&&(t.onUnload(),t._flushOnUnloadCallbacks(),r.unloadComponent(t));var i=v[e]||[];i=i.slice(),i.forEach(function(e){O(e)}),M(e),u.ComponentProxy.unsubscribeAll(e)}catch(n){h.report(n)}finally{x[e]=!0}},N=!1;t.isOnLoadRunning=function(){return N},t.beforeOnLoad=function(){o.logTime("preOnLoad"),(l.logComponentTime||l.debug||l.componentInspector)&&(o.timing.components={},o.timing._components={}),u.DocumentProxy.dispatch({type:u.Types.WEBNODE_COMPONENT_PRE_ONLOAD,payload:{}})},t.afterOnLoad=function(){
o.logTime("postOnLoad"),o.logTime("pageInteractive"),u.DocumentProxy.dispatch({type:u.Types.WEBNODE_COMPONENT_POST_ONLOAD,payload:{}})},t.registerBeforeOnLoadCallback=function(e){u.DocumentProxy.subscribe(u.Types.WEBNODE_COMPONENT_PRE_ONLOAD,e)},t.registerAfterOnLoadCallback=function(e){u.DocumentProxy.subscribe(u.Types.WEBNODE_COMPONENT_POST_ONLOAD,e)},t.onLoad=function(e,t){N=!0;for(var i=0;i<e.length;i++)r.initComponent(e[i]);for(var n=0;n<e.length;n++)I(e[n],t);return!c&&window.clearHandlers&&window.clearHandlers(),N=!1,e},t.getRootParent=function(e){if(!m[e])return null;for(var t=e;t&&!t.startsWith("*");)t=g[t];return t},t.getAllDvars=function(e){for(var t,i={},n=e,o={};n;){if(n.cid in o){var s="Broke parent loop",a=n.vcon();a&&(s+=" ("+n.cid+" "+a+")"),h.logJsError("getAllDvars",s);break}t=d.extend({},n.__dvars__),i=d.extend(t,i),o[n.cid]=!0,n=n.parent()}return i},t.newComponent=function(e,t,i,n,o,s){if(e)return new e(i,n,o,s);throw P("JS class specified by js_init not found: "+t);
};var R=t.Component=n.extend({__init__:function(t,i,n,o){this.cid=t,this.cname=i,this.__js_init=n,this.__onloaded=!1;var s=b[this.cid];this.__vcon=s?s.split(":"):null,this.__emitter=null,this.init(n),c&&o&&o.rerenderRace&&e("mobile_app2/broadcast").rerenderComponent(t)},init:function(e){d.isPlainObject(e)&&d.extend(this,e)},onLoad:function(e){},onUnload:function(){},contextConstructor:function(){},child:function(e){var t=w[this.cid],i=t?t[e]:null;return A(i)},children:function(){var e=v[this.cid]||[];return e.map(function(e){return A(e)})},parent:function(){return A(g[this.cid])},setDvar:function(e,t){this.__dvars__=this.__dvars__||{},this.__dvars__[e]=t},getDvar:function(e){if(this.__dvars__=this.__dvars__||{},e in this.__dvars__)return this.__dvars__[e];for(var t,i=this.cid;i;)if(i=g[i],t=m[i])return t.getDvar(e);return null},vcon:function(){var e=this.__vcon;if(!e)return null;if(1===e.length)return e;switch(e[0]){case"cls":case"hmac":return e;case"live":return e.slice(2)}return null},
__maybeCreateEmitter:function(){this.__emitter||(this.__emitter=new s)},whenOnLoaded:function(e){return this.__onloaded?void e():(this.__maybeCreateEmitter(),void this.__emitter.on("onload",e))},whenUnloaded:function(e){this.__maybeCreateEmitter(),this.__emitter.on("unload",e)},_flushOnLoadCallbacks:function(){this.__emitter&&this.__emitter.trigger("onload"),this.__onloaded=!0},_flushOnUnloadCallbacks:function(){this.__emitter&&this.__emitter.trigger("unload")},_my:function(){return"__w2_"+this.cid+"_"},ge:function(e){return document.getElementById(e.replace("@",this._my()))},createModal:function(t){var i=e("shared/modal"),n=i.fromComponent(this);if(t){var o=this.vcon();if(!o)throw new Error("Invalid vcon for component: "+this.cid);n.fromServerCall(o,t)}return n},emitEvent:function(e){u.ComponentProxy.dispatch(e,this.cid)},handleEvent:function(e,t){u.ComponentProxy.subscribe(e,t,this.cid)},$id:function(e){if("@"!=e[0])throw new Error("Expect id to begin with @. Got: "+e);return e=e.replace("@",this._my()),
a("#"+e)},serverCall:function(t){var i=this.vcon();if(i){var n=e("shared/core/rpc");return new n.ServerCall(i,t,this)}}}),q=R.extend({__init__:function(e){this._super(e,null,{},{}),this.isVirtual=!0,r.initComponent(this)}}),B=t.makeVirtualComponent=function(e){return new q(e)},P=function(e,t){this.message=this.errorType+": "+e,t&&(this.message+=" <cid="+t+">")};P.prototype=new Error,P.prototype.errorType="ComponentError",P.prototype.constructor=P}),define("webnode2",["shared/polyfills","shared/errors","settings","shared/core/component"],function(e,t,i){var n=e("shared/errors"),o=e("settings"),s=e("shared/core/component"),a=t._liveDepInfo={},r=t._ignoreDomids={},d=t._ignoreCids={};t.addLiveDepInfo=function(e){for(var t=Object.keys(e),i=t.length,n=0;i>n;++n){var o=t[n];a[o]=e[o]}},t.interactionMode=null,t.Error=null,t.assertUnloaded=function(e){e in s._unloaded||n.logJsError("webnode2","Cid was not unloaded: "+e)},t.fallbackToPostReloadMode=function(){o.pageMode="post_reload"},t.forgetContents=function(e){
e.find("*").map(function(){var e=s._domidToCid[this.id];e&&(r[this.id]=1,d[e]=1)})}}),define("w2.errors",["shared/polyfills","shared/log","webnode2","shared/jquery","settings"],function(e,t,i){function n(e,t,i,n,s){var r=0===e.status;if(r)return void setTimeout(function(){if(!a()){var e=f.interface_strings.connection_problem;o(e+" ")}},1e3);if(h.enabled&&h("w2.errors.reportAjaxError","Error:",e.status,i,", XHR: ",e),void 0!==s){var d=(new Date).getTime()-s;d>c&&(n=!1)}n&&o()}function o(e){u.Error&&u.Error.show(e)}function s(e){_++,setTimeout(function(){_--},e)}function a(){return 0!==_}function r(e){g++,setTimeout(function(){g--},e)}function d(){return 0!==g}var l=2e3,c=50,h=e("shared/log").log,u=e("webnode2"),p=e("shared/jquery"),f=e("settings"),_=0,g=0;p(window).on("unload.w2errors beforeunload.w2errors",function(){h.enabled&&h("w2.errors.unload","window.beforeunload event is raised."),s(l)}),p(document).on("mouseup.w2errors mousedown.w2errors keyup.w2errors keydown.w2errors keypress.w2errors",function(){
r(c)}),t.reportAjaxError=n,t.showError=o,t.canBeRelatedToUserAction=d,t.beginCanBeRelatedToUserActionBlock=r}),define("visibility",["shared/polyfills"],function(e,t,i){t.getFrameElement=function(){try{var e=window.frameElement;return e.getAttribute("className"),e}catch(t){return null}}}),define("tooltip",["shared/polyfills","shared/Class","shared/util","shared/jquery"],function(e,t,i){var n=e("shared/Class").Class,o=e("shared/util"),s=e("shared/jquery");t.attach=function(e,t,i){var n=new a(e,t,i);return n.bindHover()};var a=n.extend({__init__:function(e,t,i){this.$elem=s(e),this.text=t,this.options=o.extend({delay:75,direction:"top",align:"center",container_class:"document",vertical_offset:0,attach_to_body:!1},i)},updateText:function(e){return this.text=e,this},closeAll:function(){return clearTimeout(this.timer),this.timer=null,this.$tooltip=null,s(".tooltip_parent").removeClass("tooltip_parent"),s(".tooltip").remove(),this},render:function(){this.closeAll(),this._renderTooltipElem(),this._positionTooltip();
var e=this;return this.timer=setTimeout(function(){e.$tooltip.show()},this.options.delay),this},bindHover:function(){return this.$elem.on("mouseenter",this.render.bind(this)),this.$elem.on("mouseleave",this.closeAll.bind(this)),this},_shouldRenderTooltipBelow:function(){var e=this.$elem.offset(),t=50;if("document"==this.options.container_class)return e.top<t||"bottom"==this.options.direction;var i=s("."+this.options.container_class).offset();return e.top-i.top<t||"bottom"==this.options.direction},_renderTooltipElem:function(){var e=s("<span>").text(this.text),t=s("<div>").addClass("tooltip_contents"),i=s("<div>").addClass("tooltip");t.addClass(this._shouldRenderTooltipBelow()?"nub_top":"nub_bottom"),t.addClass("nub_"+this.options.align),t.append(e),i.append(t),this.$tooltip=i},_positionTooltip:function(){this.$tooltip.appendTo(this.options.attach_to_body?s("body"):this.$elem),this.$elem.addClass("tooltip_parent"),this.$tooltip.css("display","block");var e=this.$tooltip.find(".tooltip_contents").outerWidth();
this.$tooltip.css("display","none");var t=this.$tooltip.height()+5,i=this.$elem.offset(),n=this.$elem.height(),o=this.$elem.outerWidth(),a=this._shouldRenderTooltipBelow(),r=parseInt(this.$elem.css("line-height"),10),d=this.$elem.is("a")&&this.$elem.text()&&n-5>r;this.options.attach_to_body&&a?this.$tooltip.css("top",i.top+t+"px"):this.options.attach_to_body?this.$tooltip.css("top",i.top-t+"px"):a?this.$tooltip.css("top",n+5-this.options.vertical_offset+"px"):this.$tooltip.css("top",-1*t-this.options.vertical_offset+"px");var l=d?"right":this.options.align;if(this.options.attach_to_body)if("center"==l){var c=i.left+(o-e)/2;this.$tooltip.css("left",c+"px")}else"right"==l?this.$tooltip.css("left",i.left+o-e+"px"):this.$tooltip.css("left",i.left+"px");else"center"==l?this.$tooltip.css("left",(o-e)/2+"px"):"right"==l?this.$tooltip.css("right","0"):this.$tooltip.css("left","-16px")}})}),define("qtext",["shared/polyfills","shared/jquery","tooltip"],function(e,t,i){var n=e("shared/jquery"),o=e("tooltip");
t.init=function(){n(document).on("mouseover","a[data-qt-tooltip]",function(e){var t=n(this);return t.attr("data-tooltip")?!1:(t.attr("data-tooltip","attached"),o.attach(t,t.attr("data-qt-tooltip"),{attach_to_body:!0}),setTimeout(function(){t.trigger("mouseenter")},10),!1)})}}),define("init",["shared/polyfills","shared/log","shared/window_manager","shared/onload","shared/events/index","visibility","shared/jquery","qtext"],function(e,t,i){var n=e("shared/log").log,o=e("shared/window_manager"),s=e("shared/onload"),a=e("shared/events/index"),r=e("visibility"),d=e("shared/jquery");window.console=window.console||n.console;var l=function(){var e=r.getFrameElement();if(e&&"true"===e.getAttribute("autoresize")){var t=d(document),i=t.width(),n=t.height();d(e).width(i).height(n)}};window.addEventListener("resize",l),d(document).ready(l),e("qtext").init(),a.GlobalProxy.subscribe(a.Types.LOGOUT_USER,function(){o.reload()}),s.execAfterLoadDelayed(function(){d(document).on("fire_facebook_conversion_pixel",function(e,t){
var i=new Image(1,1);i.src="https://www.facebook.com/offsite_event.php?id="+t+"&amp;value=0.01&amp;currency=USD"})})}),define("shared/mathjax",["shared/polyfills","interface/settings"],function(e,t,i){var n=e("interface/settings"),o=t.processClass="render_latex",s=t.ignoreClass="ignore_latex";t.requestMathJs=function(){if(!window.MathJax||!MathJax.Hub){var e=function(){var e="https://cdn.mathjax.org/mathjax/2.6-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe",i=t(),n=document.createElement("script");n.type="text/javascript",n.appendChild(document.createTextNode(i));var o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src=e;var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(n,s),s.parentNode.insertBefore(o,s)},t=function(){var e={showMathMenu:!1,messageStyle:"none",errorSettings:i(),"HTML-CSS":a(),tex2jax:r(),TeX:d(),"fast-preview":{disabled:!0}};return"window.MathJax = "+JSON.stringify(e)+";"},i=function(){return{style:{color:"#000000",
"font-style":"normal"}}},a=function(){return{linebreaks:{automatic:!0,width:"container"},EqnChunk:n.pageIsMobile?10:150,EqnChunkDelay:n.pageIsMobile?100:20}},r=function(){return{inlineMath:[["[math]","[/math]"]],displayMath:[],ignoreClass:"edit_latex|qtext_editor_content|"+s,processClass:o,preview:"none"}},d=function(){return{noUndefined:{attributes:{mathcolor:"red"}},Macros:{C:"{\\mathbb{C}}",N:"{\\mathbb{N}}",O:"{\\emptyset}",Q:"{\\mathbb{Q}}",R:"{\\mathbb{R}}",Z:"{\\mathbb{Z}}"}}};e()}}}),define("shared/activity_metrics",["shared/polyfills","shared/logging","shared/debounce"],function(e,t,i){function n(e){var t={eventType:e,time:1e3*Date.now(),path:window.location.href};s.log("activity_metrics",t)}function o(e){var t=n.bind(null,e);window.addEventListener(e,a(t,r,{trailing:!1}),!0)}var s=e("shared/logging"),a=e("shared/debounce").throttle,r=6e4;t.init=function(){o("scroll"),o("click"),o("keyup")}}),define("shared/client_tracker",["shared/polyfills","shared/client_tracker","shared/Class","shared/w2.context","shared/core/rpc","shared/cookies","shared/util","shared/window_manager","shared/core/component","shared/jquery","interface/settings","shared/logging"],function(e,t,i){
var n,o=e("shared/Class").Class,s=e("shared/w2.context"),a=e("shared/core/rpc"),r=e("shared/cookies"),d=e("shared/util"),l=e("shared/window_manager"),c=e("shared/core/component"),h=e("shared/jquery"),u=e("interface/settings"),p=u.pageIsMobile,f=u.enableClientTracker;p&&(n=e("mobile_app2/click_handlers"));var _,g=o.extend({__init__:function(){this.trail=u.clientTrackerTrail,this.started=!1},start:function(){f&&(this.started||(this.started=!0,p?n.safeClickHandler(document,this.setFeedTrail.bind(this),{handlesClick:!1,capture:!0}):h(document).on("mousedown",this.setFeedTrail.bind(this)),a.addMetadataCallback(this.addFeedMetadata.bind(this))))},track:function(t,i,n){f&&(i=d.extend({},i),this.addFeedMetadata(i,n),i.action=t,e("shared/logging").log("ctrkr",i))},addFeedMetadata:function(e,t){var i=this.feedDataFromComponent(t);i&&(e.qfl2=i),this.trail&&this.trail.qfl2&&(e["qfl2-t"]=this.trail.qfl2)},feedDataFromComponent:function(e){if(!c.isOnLoadRunning()){var t=e.getDvar("enable_feed_logging");
if(!p||t){var i=e.getDvar("feed_story_hash");if(i){var n=e.getDvar("feed_ty");n=null!==n?n:0;var o=e.getDvar("paged_list_hash"),a=e.getDvar("feed_story_position");if(p&&null===a){var r=e.getContext(s.UniversalPageFeedContext),d=r.get("impressionLogger");if(!d)return;a=d.getPositionFromPagedListHash(o)}a=null===a?0:a;var l=e.getDvar("feed_story_initial")||!1,h=e.getDvar("feed_page"),u=e.getDvar("page_data"),f=e.getDvar("focus_ty"),_=e.getDvar("feed_story_inner_position");_=null===_?0:_;var g=e.getDvar("bundle_position");return[9,i,a,l,"_ctkr",n,h,u,f,_,g]}}}},setFeedTrail:function(e){for(var t=e.target,i=l.getDomain();t;){if("A"==t.tagName){var n=t.getAttribute("href");if(n&&n.startsWith("/"))break;if(n&&n.startsWith(i)){n=n.slice(i.length-1);break}}t=t.parentElement}if(t){var o=c.getComponentFromElement(t);if(o){var s=this.feedDataFromComponent(o);if(s){var a={path:n,expires:1};r.setMessage("ctrkr",{qfl2:s},null,a)}}}}}),m=t.init=function(){_=new g,_.start()};t.track=function(){_||m(),_.track.apply(_,arguments);
}}),define("shared/frame_busting",["shared/polyfills","interface/settings","shared/log"],function(e,t,i){var n=e("interface/settings"),o=e("shared/log");t.check=function(){if(n.enableFrameBusting){var e=!1;try{e=!/\.quora\.com$/i.test(window.top.location.host)}catch(t){e=!0}e&&""+window.top.location!=""+window.location&&(window.top.location=window.location,o&&o.enabled&&o("frame_busting","Updating window.location."))}}}),define("shared/links_logger",["shared/polyfills","shared/links","shared/logging","shared/siteuri"],function(e,t,i){var n=e("shared/links"),o=e("shared/logging"),s=e("shared/siteuri"),a=function(e){s.isSiteUrl(e)||o.log("link_click",{url:e,current_url:window.location.href})};n.onLinkClick(a)}),define("shared/service_worker_init",["shared/polyfills","settings","shared/window_manager","shared/log","shared/onload"],function(e,t,i){var n=e("settings"),o=e("shared/window_manager"),s=e("shared/log").log.bind("serviceWorker"),a=e("shared/onload"),r=o.getDomain()+"static/_pkg/sw.js",d=function(){
return n.useServiceWorkers&&"serviceWorker"in window.navigator?!0:!1},l=function(){"serviceWorker"in window.navigator&&window.navigator.serviceWorker.getRegistrations&&window.navigator.serviceWorker.getRegistrations().then(function(e){for(var t=0;t<e.length;++t)e[t].unregister()})},c=function(){return d()?(s("Registering Service Worker..."),void window.navigator.serviceWorker.register(r,{scope:"/"}).then(function(e){s("Successfully registered!",e)})["catch"](function(e){s("Unsuccessfully registered...",e)})):void l()};a.execAfterLoad(c)}),define("third_party/insertion_query",["shared/polyfills"],function(e,t,i){t.insertionQ=function(){"use strict";function e(e,t){var n,o="insQ_"+a++,s=function(e){(e.animationName===o||e[d]===o)&&(i(e.target)||t(e.target))};n=document.createElement("style"),n.innerHTML="@"+l+"keyframes "+o+" {  from {  outline: 1px solid transparent  } to {  outline: 0px solid transparent }  }\n"+e+" { animation-duration: 0.001s; animation-name: "+o+"; "+l+"animation-duration: 0.001s; "+l+"animation-name: "+o+";  } ",
document.head.appendChild(n);var r=setTimeout(function(){document.addEventListener("animationstart",s,!1),document.addEventListener("MSAnimationStart",s,!1),document.addEventListener("webkitAnimationStart",s,!1)},p.timeout);return{destroy:function(){clearTimeout(r),n&&(document.head.removeChild(n),n=null),document.removeEventListener("animationstart",s),document.removeEventListener("MSAnimationStart",s),document.removeEventListener("webkitAnimationStart",s)}}}function t(e){e.QinsQ=!0}function i(e){return p.strictlyNew&&e.QinsQ===!0}function n(e){return i(e.parentNode)?e:n(e.parentNode)}function o(e){for(t(e),e=e.firstChild;e;e=e.nextSibling)void 0!==e&&1===e.nodeType&&o(e)}function s(s,a){var r=[],d=function(){var e;return function(){clearTimeout(e),e=setTimeout(function(){r.forEach(o),a(r),r=[]},10)}}();return e(s,function(e){if(!i(e)){t(e);var o=n(e);r.indexOf(o)<0&&r.push(o),d()}})}var a=100,r=!1,d="animationName",l="",c="Webkit Moz O ms Khtml".split(" "),h="",u=document.createElement("div"),p={
strictlyNew:!0,timeout:20};if(u.style.animationName&&(r=!0),r===!1)for(var f=0;f<c.length;f++)if(void 0!==u.style[c[f]+"AnimationName"]){h=c[f],d=h+"AnimationName",l="-"+h.toLowerCase()+"-",r=!0;break}var _=function(t){return r&&t.match(/[^{}]/)?(p.strictlyNew&&o(document.body),{every:function(i){return e(t,i)},summary:function(e){return s(t,e)}}):!1};return _.config=function(e){for(var t in e)e.hasOwnProperty(t)&&(p[t]=e[t])},_}()}),define("shared/lazy_load_images",["shared/polyfills","third_party/insertion_query","shared/onload"],function(e,t,i){function n(e){e.getAttribute("data-src")&&(e.setAttribute("src",e.getAttribute("data-src")),e.removeAttribute("data-src"),e.addEventListener("load",function(){e.style.opacity=1;var t=e.previousElementSibling;t&&t.classList.contains("qtext_image_placeholder")&&setTimeout(function(){t.style.visibility="hidden"},1e3)}))}function o(){for(var e=document.querySelectorAll("img[data-src]"),t=0;t<e.length;t++)n(e[t])}function s(){o(),d.insertionQ("img").every(function(e){
n(e)}),setInterval(o,c)}function a(e){if(e.getAttribute("data-src")){var t=new Image;t.src=e.getAttribute("data-src");var i=e.getAttribute("width"),n=e.getAttribute("height"),o=e.getContext("2d");t.addEventListener("load",function(){o.drawImage(t,0,0,i,n)},!1)}}function r(){var e=document.querySelectorAll("canvas[data-src]");d.insertionQ("canvas[data-src]").every(function(e){a(e)}),[].forEach.call(e,a)}var d=e("third_party/insertion_query"),l=e("shared/onload"),c=2e3;r(),l.execAfterLoad(s)}),define("shared/init",["shared/polyfills","shared/events/index","shared/cookies","shared/onload","shared/mathjax","shared/client","shared/activity_metrics","shared/client_tracker","shared/frame_busting","shared/links_logger","shared/service_worker_init","shared/lazy_load_images"],function(e,t,i){var n=e("shared/events/index"),o=e("shared/cookies"),s=e("shared/onload"),a=e("shared/mathjax"),r=e("shared/client");e("shared/activity_metrics").init(),e("shared/client_tracker").init(),e("shared/frame_busting").check(),
e("shared/links_logger"),e("shared/service_worker_init"),e("shared/lazy_load_images"),n.DocumentProxy.subscribe(n.Types.WEBNODE_RPC_EXCEPTION,function(e){"network_membership_required"==e.payload.exceptionType&&(window.location="/join")}),r.isNativeApp()||o.setCookie("tz",(new Date).getTimezoneOffset(),{path:"/"}),s.execAfterLoadDelayed(function(){window.require.prefetchAll()}),s.execAfterLoad(a.requestMathJs)}),define("app/view/activation/facebook",["shared/polyfills","shared/core/component","shared/onload","shared/facebook"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/onload"),s=e("shared/facebook");t.FacebookPageLikeButton=n.extend({onLoad:function(){var e=this;o.execAfterLoadDelayed(function(){s.onInit(function(){window.FB.XFBML.parse(e.$id("@button").get(0)),window.FB.Event.subscribe("edge.create",function(){e.serverCall("page_liked").liveMutate().send()}),window.FB.Event.subscribe("edge.remove",function(){e.serverCall("page_unliked").liveMutate().send()});
})})}}),t.FacebookPageLikePrompt=n.extend({hide:function(){this.$id("@fb_page_like_prompt").addClass("hidden")}}),t.FacebookPageLikePromptDismiss=n.extend({onLoad:function(){this.$id("@dismiss").click(this.dismiss.bind(this))},dismiss:function(e){return e.preventDefault(),this.parent().hide(),this.serverCall("dismiss").liveMutate().send(),!1}}),t.FacebookConnect=n.extend({onLoad:function(){var e=this;this.$id("@dismiss").click(function(){return e.serverCall("dismiss_facebook_connect").liveMutate().success(function(){e.$id("@facebook_connect").fadeOut(300)}).send(),!1})}})}),define("app/view/activation/progress",["shared/polyfills","shared/core/component","shared/events/index"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/events/index");t.ProgressBar=n.extend({onLoad:function(){var e=this;0===e.getMaxWidth()?setTimeout(function(){e.initialize()},1):e.initialize(),this.handleEvent(o.Types.ACTIVATION_PROGRESS_BAR_STEP,function(t){t.payload.step&&e.update(t.payload.step);
})},getMaxWidth:function(){return this.$id("@progress_bar_wrapper").width()},initialize:function(){this.$id("@progress_bar").css({width:this.getWidth()})},getWidth:function(){var e=this.getMaxWidth(),t=this.curr/this.total*e;return Math.min(e,t)},update:function(e){this.curr=e,this.$id("@progress_bar").animate({width:this.getWidth()})}}),t.ProgressBarBeacon=n.extend({onLoad:function(){this.emitEvent({type:o.Types.ACTIVATION_PROGRESS_BAR_STEP,payload:{step:this.curr}})}})}),define("app/view/share/connect",["shared/polyfills","shared/core/component","shared/jquery","shared/siteuri"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/jquery"),s=e("shared/siteuri").URI,a=t.socialConnectorBase={connectLinkedin:function(e){var t=this;o(document).one("linkedin_oauth_approved."+t.cid,function(i,n){t.serverCall("connect_linkedin").kwargs({li_uid:n}).liveMutate().send(),e&&e()});var i=s("/linkedin_/oauth_window");window.open(i.unicode(),"_BLANK","height=365,width=600")},connectTwitter:function(e){
var t=this;o(document).one("twitter_oauth_approved."+t.cid,function(i,n){var o=n.accessToken,s=n.userData;t.serverCall("connect_twitter").kwargs({access_token_key:o.key,screen_name:s.twitter_screen_name,tw_uid:s.twitter_uid,"protected":s["protected"]}).liveMutate().send(),e&&e()});var i=s("/twitter/oauth_window");window.open(i.unicode(),"_BLANK","height=558,width=800")},connectTumblr:function(e){var t=this;o(document).one("tumblr_oauth_approved."+t.cid,function(i,n){t.serverCall("connect_tumblr").kwargs({url:n}).liveMutate().success(function(i){"OK"!=i?alert(t.tumlbr_failure_message):e&&e()}).send()}),window.open("/tumblr_/oauth_window","_BLANK","height=500,width=600")}};t.SocialConnector=n.extend(a)}),define("app/view/activation/twitter",["shared/polyfills","app/view/share/connect","shared/core/component"],function(e,t,i){var n=e("app/view/share/connect").SocialConnector,o=e("shared/core/component").Component;t.TwitterConnect=o.extend({onLoad:function(){var e=this;this.$id("@twitter_disconnect_button").click(function(){
return e.serverCall("twitter_disconnect").liveMutate().send(),!1}),this.$id("@dismiss").click(function(){return e.serverCall("dismiss_twitter_connect").liveMutate().success(function(){e.$id("@twitter_connect").fadeOut(300)}).send(),!1})}}),t.TwitterConnectButton=n.extend({onLoad:function(){var e=this;this.$id("@twitter_connect_button").click(function(){e.serverCall("on_connect_button_press").send(),e.connectTwitter()})}})}),define("w2.dialog",["shared/polyfills","shared/core/component","shared/jquery","shared/Class","webnode2","settings"],function(e,t,i){var n=e("shared/core/component"),o=e("shared/jquery"),s=e("shared/Class").Class,a=e("webnode2"),r=e("settings").interface_strings,d=t.Dialog=s.extend({__init__:function(e,t){this.opener&&this.opener(e),d._dialogCounter+=1,this._dialogId=d._dialogCounter,this._dialogOuter="#__w2_dialog_outer_"+this._dialogId,this._dialogContainerId="#__w2_dialog_container_"+this._dialogId,this._cid="*dialog*_"+this._dialogId,d._instance=this,this._title=null,
this._buttons=[],this._ok=null,this._cancel=null,this.opts=o.extend({closeOnEscape:!0,closeOnClickOut:!1,sortButtons:!0,focusOK:!1,dialogClass:"",verticalOffset:150,showXButton:!1,hideDialog:!1},t),this._opened=!1,this._containsComponent=!1,this._content=null,this.opts.html&&(this._content=this.opts.html)},opt:function(e,t){return this.opts[e]=t,this},ok:function(e,t){return"string"==typeof e&&(t=e,e=null),this._ok=e,t!==!1&&this.addButton(new c(this,t,null)),this},cancel:function(e,t,i){return"string"==typeof e&&(t=e,e=null),this._cancel=e,t!==!1&&(i?this.addButton(new u(this,t,null)):this.addButton(new h(this,t,null))),this},button:function(e,t,i){return this.addButton(new l(this,t,e,i))},title:function(e){if(this._opened)throw new Error("Can't set the title for a dialog once it has been opened.");return this._title=e,this},setTitle:function(e){e&&o("#__w2_dialog_title_"+this._dialogId).text(e)},addButton:function(e){if(this._opened)throw new Error("Can't add a button to a dialog once it has been opened");
return this._buttons.push(e),this},opener:function(e){return this._opener=e,this},open_:function(){if(this._opened)return this;this._createDOMElements();var e=n._safeGetComponentByCID(this._cid);n._components[this._cid]=e;var t={};t[this._cid]="*ROOT*",n.addParents(t);var i=function(e){this.opts.closeOnEscape&&27==e.keyCode&&(this.cancel_(),e.stopPropagation())};if(o(document).on("keydown.__w2_dialog_"+this._dialogId,i.bind(this)),this.opts.closeOnClickOut){var s=this._dialogOuter;o(document).on("click",s,function(e){e.stopPropagation()});var a=function(e){this.cancel_(),e.stopPropagation()};o(document).on("click",":not("+s+","+s+" *)",a.bind(this))}return this._opened=!0,"function"==typeof this._open&&this._open.apply(this,arguments),this},cancel_:function(e){var t=!0;"function"==typeof this._cancel&&this._cancel(this._callbackArg(e))===!1&&(t=!1),t&&this.close_()},_callbackArg:function(e){var t=n._safeGetComponentByCID(this._cid),i={dialog:this,dialogWrapper:t,button:e};return this._containsComponent&&(i.dialogComponent=t.child("__dialog__")),
i},ok_:function(e){var t=!0;return"function"==typeof this._ok&&this._ok(this._callbackArg(e))===!1&&(t=!1),t&&this.close_(),t},close_:function(){if(!this._opened)return this;o(document).off(".__w2_dialog_"+this._dialogId),a.forgetContents(o(this._dialogOuter)),n.unloadComponent(this._cid),o(this._dialogOuter).remove(),this._opened=!1,"function"==typeof this._close&&this._close.apply(this,arguments);var e=this._dialogOuter;return o(document).off("click",e),o(document).off("click",":not("+e+","+e+" *)"),this},open:function(e){return this._open=e,this},close:function(e){return this._close=e,this},html:function(e){return this._content=e,this.open_()},text:function(e){return this.html(e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"))},_createDOMElements:function(){var e=this.opts.width||470,t="dialog";this.opts.hideDialog&&(t="");var i,n=o("<div />").attr("id","__w2_dialog_outer_"+this._dialogId).addClass(t).addClass("w4").addClass(this.opts.dialogClass);this._title?(i=o("<div />").addClass("dialog_wrapper").append(o("<h2 />").attr("id","__w2_dialog_title_"+this._dialogId).addClass("dialog_header").addClass("dialog_frame").text(this._title)),
this._content&&i.append(o("<div />").addClass("dialog_frame").addClass("dialog_contents").addClass("dialog_body").html(this._content))):i=o("<div />").addClass("dialog_component").addClass("dialog_wrapper").addClass("dialog_body").html(this._content),this.opts.showXButton&&i.append(o("<a />").attr("href","#").addClass("remove").click(this.cancel_.bind(this)).click(function(){return!1})),this._buttons.length&&i.append(o("<div />").addClass("dialog_frame").addClass("dialog_buttons").append(this._buttonsDOM()));var s=o(window).width(),a=o(window).scrollTop(),r=e,d=s-r,l=d/2;if(a=this.opts.verticalOffset,o(window).height()<600&&(a=o(window).scrollTop(),i.css("position","static")),i.css("width",e-10+"px"),n.append(i).css("top",a+"px").css("left",this.opts.left||l-15+"px").css("width",e+10+"px").appendTo(o(document.body)),this.opts.focusOK)for(var c=this._buttons.length-1;c;c--){var h=this._buttons[c];if("submit"==h._type){o("#__w2_dialog_button_"+this._dialogId+"_"+c).focus();break}}},checkDialogPosition:function(){
var e=o(this._dialogOuter),t=e.offset().top,i=t+e.outerHeight(!0),n=o(window),s=n.scrollTop()+n.height();if(i>s){var a=this.opts.verticalOffset,r=n.scrollTop()+a+e.outerHeight(!0);r>s&&(a=10),e.css("top",a+"px")}this._checkContentOverflow()},_checkContentOverflow:function(){var e=this,t=o(window),i=t.scrollTop()+t.height(),n=o(e._dialogContainerId),s=n.offset().top,a=n.outerHeight(!0),r=s+a;if(r>i){var d=r-i,l=a-d;n.css({"overflow-y":"scroll",height:l})}},_buttonDOM:function(e,t){e._index=t;var i=o("<a />").addClass("dialog_button").text(e._text).click(e.click_.bind(e)).click(function(){return!1}).attr("href","#").attr("id","__w2_dialog_button_"+this._dialogId+"_"+t);switch(e._type){case"submit":i.addClass("submit_button");break;case"link":case"cancel":i.addClass("cancel");break;default:i.addClass("action_button")}return i},_buttonsDOM:function(){var e=o("<div />");this.opts.sortButtons&&this._buttons.sort(function(e,t){return e._priority-t._priority});for(var t=this._buttons.length-1;t>=0;t--){
var i=this._buttons[t];e.append(this._buttonDOM(i,t))}return e.addClass("dialog_buttons_contents")},_loadingHTML:function(){return'<div id="__w2_dialog_container_'+this._dialogId+'"></div>'},load:function(e,t){t=o.extend({args:[],kwargs:{},showImmediately:!0,showOnLoad:!0},t),this._content=this._loadingHTML(),this.open_();var i=function(){this._opener.__dialog__=this;var e=n._safeGetComponentByCID(this._cid);e.__opener__=this._opener,e.__dialog__=this,e.setDvar("__dialog__",this._cid),n._children[this._cid].__dialog__=n._allChildren[this._cid][0],this._containsComponent=!0,this.checkDialogPosition()},s=this._opener.serverCall(e);return s.args.apply(s,this.opts.args).kwargs(t.kwargs).success(i.bind(this)).contentFor(o(this._dialogContainerId),{parentCid:this._cid}),this.opts.error&&s.error.apply(this,this.opts.error),this.opts.except&&s.except.apply(this,this.opts.except),s.send(),this}});d.openerFor=function(e){var t=e.getDvar("__dialog__"),i=n._safeGetComponentByCID(t);return i&&i.__opener__;
},d.dialogFor=function(e){var t=e.getDvar("__dialog__"),i=n._safeGetComponentByCID(t);return i&&i.__dialog__},d._dialogCounter||(d._dialogCounter=0),d._instance||(d._instance=null);var l=s.extend({__init__:function(e,t,i,n){this._dialog=e,this._text=t,this._callback=i,this._opts=n||{},this._priority=50,this._type="action"},text:function(e){this._text=e},callback:function(e){this._callback=e},click_:function(){var e=!0;"function"==typeof this._callback&&this._callback.call(this._dialog,this._dialog._callbackArg(this))===!1&&(e=!1),e&&this._dialog.close_()}}),c=l.extend({__init__:function(e,t,i,n){var s=this;n=o.extend({style:"ok_button"},n),this._super(e,t||"OK",function(){var e=!0;return"function"==typeof i&&i.call(s,s._dialog._callbackArg(s))===!1&&(e=!1),e?s._dialog.ok_.call(s._dialog,s):e},n),this._priority=75,this._type="submit"}}),h=l.extend({__init__:function(e,t,i,n){var s=this;n=o.extend({style:"cancel_button"},n),this._super(e,t||r.cancel,function(){var e=!0;"function"==typeof i&&i.call(s,s._dialog._callbackArg(s))===!1&&(e=!1),
e&&s._dialog.cancel_.call(s._dialog,s)},n),this._priority=25,this._type="link"}}),u=h.extend({__init__:function(e,t,i,n){this._super(e,t,i,n),this._type="action"}});t.createDialog=function(e,t){return new d(e,t)}}),define("shared/action_log",["shared/polyfills","settings","shared/util","shared/jquery","interface/settings","shared/viewport","shared/cookies","shared/logging","shared/debounce","shared/core/component"],function(e,t,i){function n(e){b.log("action_log",e)}function o(e){k[e.cid]&&(e.impression_target&&n(e.impression_target),delete k[e.cid])}function s(e,t,i,n){w.setMessage("alog",[e,t,i,n])}function a(e,t){t&&s(e,t,null,null)}function r(e,t){var i=f.actionTrail;i&&s(e,null,t,i)}function d(e){if(k[e.cid]=e,!m){var t=_.firstScrollingParent(e.$id("@actionable").get(0)),i=t.id||"body",n=t===document.body?document:t;E[i]||(E[i]=!0,g(n).on("scroll",$)),c()}}function l(e){delete k[e.cid]}function c(){S&&clearTimeout(S),S=setTimeout($,x)}function h(e,t){e&&r(e,t)}var u,p,f=e("settings"),_=e("shared/util"),g=e("shared/jquery"),m=e("interface/settings").pageIsMobile,v=e("shared/viewport"),w=e("shared/cookies"),b=e("shared/logging"),y=e("shared/debounce").debounce,C=e("shared/core/component").Component,k={},x=500,S=null,E={},T=0;
m&&(u=e("mobile_app2/client"),p=e("mobile_app2/util")),t.logPrimaryAction=a,t.logSecondaryAction=r;var $=y(function(){for(var e in k){var t=k[e];v.isElementInViewport(t.$id("@actionable").get(0))&&o(t)}},x);t.ActionableComponent=C.extend({onLoad:function(){d(this),m?this._handleOnLoadMobile():this._handleOnLoadDesktop()},_handleOnLoadMobile:function(){var e,t,i=this,n=i.$id("@actionable a"),o=function(e){return function(t){var n=e.getAttribute("action_mousedown")||e.getAttribute("action_click");t.stopActionLogging||i.processAction(n),e.getAttribute("action_stop_propagation")&&(t.stopActionLogging=!0)}};if(i.setDvar("impression_target",i.impression_target),n)for(t=0;t<n.length;++t)e=n[t],p.safeClickHandler(e,o(e))},_handleOnLoadDesktop:function(){var e=this;this.$id("@actionable").on("mousedown","[action_mousedown]",function(t){var i=t.originalEvent||t;i.stopActionLogging||e.processAction(g(this).attr("action_mousedown"),g(this).attr("action_target")),g(this).attr("action_stop_propagation")&&(i.stopActionLogging=!0);
}),this.$id("@actionable").on("click","[action_click]",function(t){var i=t.originalEvent||t;i.stopActionLogging||e.processAction(g(this).attr("action_click"),g(this).attr("action_target")),g(this).attr("action_stop_propagation")&&(i.stopActionLogging=!0)})},sendActions:function(){m||this.serverCall("send_actions").send()},processAction:function(e){var t=this;o(t),e&&(a(e,t.impression_target),t.actionCallback(e))},actionCallback:function(e){},onUnload:function(){m||l(this)}}),t.registerActionLogClickHandlers=function(){m&&p.safeClickHandler(document,function(e){var t=u.touchableTarget(e.target);if(!t||t===document)return!0;var i=t.getAttribute("action_mousedown")||t.getAttribute("action_click");if(!i)return!0;var n=t.getAttribute("action_target");return h(i,n),!0},{handlesClick:!1,capture:!0})},t.findActionableComponentsInViewport=function(){m&&u.handleMessage("tick")},t.findFeedItemsInViewport=function(){},m?u.registerMessageHandler("tick",function(){var e=+new Date;if(!(T+x>e)){T=e;for(var t in k){
var i=k[t];if(i&&i.impression_target){var n=i.$id("@actionable").get(0);n&&v.isElementInViewport(n)&&o(i)}}}}):(g(document).on("mousedown","[action_mousedown]",function(e){var t=g(e.currentTarget).attr("action_mousedown"),i=g(e.currentTarget).attr("action_target");h(t,i)}),g(document).on("click","[action_click]",function(e){var t=g(e.currentTarget).attr("action_click"),i=g(e.currentTarget).attr("action_target");h(t,i)}))}),define("view/inline_editor",["shared/polyfills","shared/core/component","shared/jquery","webnode2","shared/events/index","shared/cookies","shared/debounce","w2.dialog","settings","shared/beforeunload","shared/action_log"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/jquery"),s=e("webnode2"),a=e("shared/core/component"),r=e("shared/events/index"),d=e("shared/cookies"),l=e("shared/debounce").debounce,c=e("w2.dialog"),h=e("settings"),u=e("shared/beforeunload"),p=h.interface_strings,f=e("shared/action_log").logSecondaryAction;t.InlineEditor=n.extend({
onLoad:function(){var e=this;e.editor=e.child("editor"),e.input_obj=e.$id("@"+e.input),e.input_button="inline_editor_submit",e.input_button_obj=e.$id("@"+e.input_button),e.editorShown=e.show_editor,e.should_toggle_on_submit=!0,e.draft_space&&(e.draft_button="inline_editor_save_draft",e.draft_button_obj=e.$id("@"+e.draft_button)),e.toggle_callback=null,e.locked=!1,e.$id("@inline_editor_link").click(function(){return e.onEditLinkClick(),!1}),e.$id("@inline_editor_cancel").click(function(){return e.content_type?e.emitEvent(r.helpers.inlineEditorCancel(e.content_type,e.id)):e.cancelEditor(),!1}),e.registerEditorCallbacks(),e.$id("@inline_editor_create_link").click(function(){return e.content_type?e.emitEvent(r.helpers.inlineEditorEdit(e.content_type,e.id)):e.toggle_editor(),!1}),e.submitHandler(),e.initDraftHandlers(),e.focus_onload&&e.focusInput(),e.typing_area&&e.editor.setTypingStateCallback(function(t){e.serverCall("typing").kwargs({area:e.typing_area,state:t}).send(),e.input_button_obj.text(e.submit_text);
}),e.input_obj.is("[maxlength]")&&e.input_obj.on("keyup",function(){var e=o(this).attr("maxlength"),t=o(this).val();t.length>e&&o(this).val(t.slice(0,e))}),e.content_type&&e.whenOnLoaded(function(){e.emitEvent(r.helpers.inlineEditorLoad(e.content_type,e.id))})},registerEditorCallbacks:function(){var e=this;this.handleEvent(r.Types.INLINE_EDITOR_STATE,function(t){t.payload.contentType==e.content_type&&t.payload.oid==e.id&&("cancel"==t.payload.state?e.cancelEditor():"edit"==t.payload.state?e.onEditLinkClick():"disclaimer"==t.payload.state&&e.updateDisclaimer())})},onEditLinkClick:function(){this.editorShown||this.toggle_editor()},updateDisclaimer:function(){var e=this.child("metadata"),t=e&&e.child("disclaimer");""===this.disclaimer_update||"remove"===this.disclaimer_update?(this.disclaimer_update="attach",t.$id("@item").removeClass("hidden")):(this.disclaimer_update="remove",t.$id("@item").addClass("hidden"))},initDraftHandlers:function(){this.draft_space&&(this.initEditorFocusCallback(),
this.initDraftButtonClickCallback(),this.initMeaningfulChangeCallback(),this.initBeforeUnloadCallback(),this._latestSavedState=null)},initBeforeUnloadCallback:function(){u.registerHandler(this.beforeUnload.bind(this))},beforeUnload:function(){return this.hasUnsavedContent()?this.unsaved_content_msg:void 0},initSavedState:function(){this._latestSavedState||(this._latestSavedState=this.get_value())},updateSavedState:function(e){this._latestSavedState=e},hasUnsavedContent:function(){return this.cid in a._unloaded?!1:this._latestSavedState?this.editor.isOnlyWhiteSpace()&&0===this._latestSavedState.sections.length?!1:this.editor.hasChanged(this._latestSavedState):!1},initEditorFocusCallback:function(){var e=this;this.editor.setFocusCallback(function(){e.initSavedState(),e.$id("@inline_editor_save_draft").removeClass("hidden")})},initDraftButtonClickCallback:function(){var e=this;this.draft_button_obj.click(function(t){t.preventDefault(),e.save_draft(!0)})},initMeaningfulChangeCallback:function(){
var e=l(this.save_draft.bind(this,!1),750,{maxWait:1e4,leading:!0});this.editor.setMeaningfulChangeCallback(e)},cancelEditor:function(){this.typing_area&&this.editor.stopTyping(),this.editorShown&&this.toggle_editor()},isEditorEmpty:function(){var e=this.getEditor();return e?e.isOnlyWhiteSpace():!1},getEditor:function(){return this.editor},submitHandler:function(){var e=this;this.input_button_obj.click(function(){return e.trigger_request(),!1})},get_value:function(){return this.is_qtext?this.editor.serialize():this.input_obj.val()},save_draft:function(e){var t=this,i=this.getSaveDraftMethod(e),n=this.getSaveDraftKwargs(),o=this.serverCall(i).kwargs(n);e&&(o.liveMutate(),s.interactionMode.isBlocking()&&s.fallbackToPostReloadMode()),this.logSaveDraft(),o.success(function(){t.updateSavedState(n.content)}),o.send()},logSaveDraft:function(){},getSaveDraftMethod:function(e){return e?"save_draft":"save_draft_auto"},getSaveDraftKwargs:function(){return{content:this.get_value(),window_id:h.windowId,
draft_space:this.draft_space}},server_call_method:"edit",_get_kwargs:function(){return{id:this.id,input:this.get_value()}},trigger_request:function(){return this.typing_area&&this.editor.stopTyping(),this.locked?!1:(this.locked=!0,void(this.require_comment?this.showConfirmationDialog():this.okToSubmitRequest()?(this.is_qtext&&this.editor.disable(),this.invokeEditServerCall(this._get_kwargs())):(this.is_qtext&&this.editor.focus(),this.locked=!1)))},trigger_cancel:function(){this.$id("@inline_editor_cancel").click()},okToSubmitRequest:function(){return!this.require_value||this.require_value&&!this.editor.isOnlyWhiteSpace()},invokeEditServerCall:function(e){var t=this,i=function(){t.locked=!1};o(document).on("login_cancelled",i),this.content_type&&this.emitEvent(r.helpers.inlineEditorSubmit(this.content_type,this.id)),d.setTlog(t.tlog_data());var n=t.getLoggedAction();n&&f(n,null),t.input_button_obj.addClass("disabled");var s=function(e){t.locked=!1,t.input_button_obj.removeClass("disabled"),
t.editor.enable(),o(document).off("login_cancelled",i)},a=function(){s()};t.serverCall(t.server_call_method).kwargs(e).success(function(i){t.updateSavedState(e.input),t.ajax_callback(i),s()}).error(a).except(a).liveMutate().send()},tlog_data:function(){return null},getLoggedAction:function(){return null},ajax_callback:function(e){this.content_type&&this.emitEvent(r.helpers.inlineEditorSubmitted(this.content_type,this.id)),this.should_toggle_on_submit&&this.toggle_editor()},focusInput:function(){var e=this;e.is_qtext?e.editor.focus():e.input_obj.focus()},setToggleCallback:function(e){if(this.toggle_callback){var t=this.toggle_callback;this.toggle_callback=function(){t(),e()}}else this.toggle_callback=e},toggle_editor:function(){if(this.editorShown=!this.editorShown,this.$id("@inline_editor_content").find(".qtext_embed").each(function(e,t){o(t).addClass("thumbnail").empty()}),this.$id("@inline_editor_content").toggleClass("hidden"),this.$id("@inline_editor_form").toggleClass("hidden"),this.is_qtext&&this.$id("@inline_editor_form").is(":visible")){
var e=this.child("editor");e&&e.focus()}this.toggle_callback&&this.toggle_callback()},showConfirmationDialog:function(){var e=this,t=this.input_button_obj.text();this._dialog=c.createDialog(this).title(this.confirm_text).cancel(function(){e.locked=!1},p.cancel).ok(function(){var t=arguments[0].dialogComponent,i=t.child("editor");if(i.isOnlyWhiteSpace())return!1;var n=e._get_kwargs();n.comment=i.serialize(),e.invokeEditServerCall(n),e._dialog.close_()},t).load("comment_dialog")}}),t.InlineEditCommentDialog=n.extend({onLoad:function(){this.child("editor").focus()}}),t.DraftStatus=n.extend({onLoad:function(){var e=this;e.$id("@draft_status_clear").on("click",function(){return e.createModal("load_clear_draft_confirmation").kwargs({draft_space:e.draft_space}).onSubmit(function(){e.clearDraftCallback()}).show(),!1})},clearDraftCallback:function(){}}),t.BoardDraftStatus=t.DraftStatus.extend({clearDraftCallback:function(){window.location.reload()}})}),define("view/modal",["shared/polyfills","shared/core/component","shared/errors","shared/debounce","shared/util","shared/viewport","w2.modal"],function(e,t,i){
var n=e("shared/core/component").Component,o=e("shared/errors"),s=e("shared/debounce").debounce,a=e("shared/util"),r=e("shared/viewport"),d=e("w2.modal"),l=t.Base=n.extend({onLoad:function(){var e=this;e.close_button=this.$id("@close_button"),e.cancel_button=this.$id("@cancel_button"),e.submit_button=this.$id("@submit_button"),e.close_button.on("click",function(t){e.onClose(),t.preventDefault()}),e.cancel_button.on("click",function(t){e.onCancel(),t.preventDefault()}),e.submit_button.on("click",function(t){e.onSubmit(),t.preventDefault()})},_closeModal:function(){d.Modal.modalFor(this).close()},onClose:function(){this._closeModal()},onCancel:function(){this._closeModal()},onSubmit:function(){this.submitDisabled||this._closeModal()},disableSubmit:function(){this.submitDisabled=!0,this.submit_button.addClass("action_disabled")},enableSubmit:function(){this.submitDisabled=!1,this.submit_button.removeClass("action_disabled")}});t.MultiStep=l.extend({onLoad:function(){if(this.stepCallbacks=this.getCallBacks(),
this.onLoadInit(),this._super.apply(this,arguments),this._bindEventHandlers(),!this.key)return void o.logJsError("modal.MultiStep","Please set a data key in python js_data");if(!this.stepCallbacks){var e=["Sub classes should override getCallBacks() and have it return a ","list of methods supported by each modal steps."].join("");return void o.logJsError("modal.MultiStep",e)}return this.data_cache?void 0:void o.logJsError("modal.MultiStep","Please define a data storage variable in python")},onLoadInit:function(){var e=this.m("init");"function"==typeof e&&e()},getCallBacks:function(){},_bindEventHandlers:function(){var e=this.m("eventHandlers");"function"==typeof e&&e();var t=this;this.$id("@back_button").on("click",function(){t.onBack()})},m:function(e){return this.stepCallbacks[this.key][e]},onSubmit:function(){var e=this.m("onSubmit");return"function"==typeof e?void e():void(this.submitDisabled||this._loadNext())},onBack:function(){var e=this.m("onBack");return"function"==typeof e?void e():void this.loadPrev();
},isLastStep:function(){var e=this.m("isLastStep");return e?e:!1},_loadNext:function(){var e=this;if(e.isLastStep())e.serverCall("last_step").kwargs({data_set:{data_cache:this.persistData()}}).success(function(t){e._closeModal()}).send();else{var t=new d.ModalWithCallBacks(e,{kwargs:{data_set:{data_cache:this.persistData()}}});t.load("load_next_modal"),t.onCloseCallBack(function(){e._closeModal()})}},loadPrev:function(){var e=this,t=new d.ModalWithCallBacks(e,{kwargs:{data_set:{data_cache:this.persistData()}}});t.load("load_previous_modal"),t.onCloseCallBack(function(){e._closeModal()})},_getStepData:function(){var e=this.m("getStepData");if("function"==typeof e){var t=e();if(!t){var i=["Hey! we noticed that you defined a getStepData() method in ","your code but its not returning any value that is to be ","persisted for this modal step. To fix this error, either ","delete getStepData() definition or return a data that you ","want to be persisted for: "+this.key].join("");return void o.logJsError("modal.MultiStep",i);
}var n=this.data_cache[this.key];return a.extend(n,t)}return null},persistData:function(){return this.data_cache[this.key]=this._getStepData(),this.data_cache},_closeModal:function(){d.Modal.modalFor(this).executeOnCloseCallBack(),this._super.apply(this,arguments)}}),t.ToggleModal=l.extend({onLoad:function(){this.is_modal?(this._super.apply(this,arguments),this.onLoadModal()):this.onLoadInline()},onLoadModal:function(){},onLoadInline:function(){this.$inlineElem=this.$id(this.inline_wrapper),this.initModal(),this.should_prefetch&&(this.fetched=!1,this.bindInViewPort(this.$inlineElem,this.fetchModal.bind(this)));var e=this;e.$inlineElem.on("click",function(t){e._shouldIgnoreClick(t)||e.handleClick(t)})},initModal:function(){this._modal=new d.ModalBase(this,{kwargs:{serialized_args:this.serialized_args}})},showModal:function(){this._modal.load("load_modal")},fetchModal:function(){this.fetched||(this.fetched=!0,this._modal.fetch("load_modal"))},isModalOpen:function(){return this._modal?this._modal._isOpen:!1;
},bindInViewPort:function(e,t){if(r.isElementInViewport(e.get(0)))t();else{var i={leading:!0},n=s(function(){r.isElementInViewport(e.get(0))&&(t(),window.removeEventListener("scroll",n))},50,i);window.addEventListener("scroll",n)}},_shouldIgnoreClick:function(e){for(var t=e.target,i=this.$inlineElem.get(0);t&&t!==i;){if("A"==t.tagName&&!t.classList.contains("more_link"))return!0;if(t.getAttribute("contenteditable")||t.classList.contains("editor_toolbar"))return!0;if(t.classList.contains("RequestAnswersDrawer","is_active"))return!0;if(t.classList.contains("action_bar_comments","threaded_comments"))return!0;t=t.parentNode}return!1},handleClick:function(e){e.preventDefault(),this.showModal()}})}),define("view/dialog",["shared/polyfills","shared/core/component","shared/jquery","tooltip","w2.dialog"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/jquery"),s=e("tooltip"),a=e("w2.dialog"),r=a.Dialog;t.Dialog=n.extend({onLoad:function(){var e=this;this.successCallback=null,
this.ok2Submit=!0,this.submitted=!1,this.$id("@submit").click(function(t){e.submit(),t.preventDefault()}),this.$id("@cancel").click(function(t){e.close(),t.preventDefault()})},submit:function(){this.request()},request:function(){var e=this.getPars();!this.submitted&&e&&this.ok2Submit&&(this.submitted=!0,this.submitServerCall(e))},getPars:function(){return{}},setSetup:function(e){var t=this;e.each(function(e,i){t.options[e]=i})},setSuccessCallback:function(e){this.successCallback=e},close:function(){o("#generic_dialog").length?o("#generic_dialog").remove():r.dialogFor(this).close_()},submitServerCall:function(e){var t=this;this.serverCall("dialog_submit_controller").liveMutate().kwargs(e).success(function(e){t.successCallback&&t.successCallback(e),t.close()}).send()}}),t.AddCommentDialog=t.Dialog.extend({onLoad:function(){this._super.apply(this,arguments),this.editor=this.child("editor"),this.editor.focus()},getPars:function(){return this.comment_required&&this.editor.isOnlyWhiteSpace()?!1:{
comment:this.editor.serialize()}}}),t.DialogLink=n.extend({onLoad:function(){var e=this;this.tooltip&&s.attach(this.$id("@link"),this.tooltip),this.$id("@link").click(function(t){e.click(),t.preventDefault()})},containsNonLatinCodepoints:function(e){return/[^\u0000-\u00ff]/.test(e)},addOption:function(e,t){t&&this.containsNonLatinCodepoints(JSON.stringify(t))&&(t=window.unescape(encodeURIComponent(t))),this.options[e]=t},click:function(){a.createDialog(this).load("get_dialog",{kwargs:{ty:this.type,object_id:this.object_id,options:this.options}})},triggerClick:function(e){o.each(e,this.addOption.bind(this)),this.click()}})}),define("shared/keystrokes",["shared/polyfills"],function(e,t,i){function n(e,t){for(var i=0,n=o.length;n>i;++i)o[i].trigger(e,t)}var o=[];document.addEventListener("keydown",function(e){e.target&&!e.target.getAttribute("contenteditable")&&"INPUT"!==e.target.nodeName&&n(e.keyCode||e.charCode,e)});var s=function(e,t){this.codes=e,this.matchHandler=t,this.position=0};s.prototype.trigger=function(e,t){
e===this.codes[this.position]?this.position+=1:this.position=0,this.position===this.codes.length&&(this.matchHandler(t),this.position=0)},t.on=function(e,t){e="number"==typeof e?[e]:e.slice(0),o.push(new s(e,t))}}),define("app/view/admin",["shared/polyfills","shared/core/component","shared/jquery","tooltip","view/inline_editor","view/modal","view/dialog","w2.dialog","shared/window_manager","shared/keystrokes","settings"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/jquery"),s=e("tooltip"),a=e("view/inline_editor").InlineEditor,r=e("view/modal").Base,d=e("view/dialog"),l=e("w2.dialog"),c=e("shared/window_manager"),h=e("shared/keystrokes"),u=e("settings").interface_strings;t.AdminLogItemView=n.extend({onLoad:function(){var e=this;this.$id("@view").click(function(t){e.$id("@details").toggleClass("hidden"),t.preventDefault()}),this.$id("@item").hover(function(){e.$id("@item").addClass("hover"),e.$id("@buttons").removeClass("hidden")},function(){e.$id("@item").removeClass("hover"),
e.$id("@buttons").addClass("hidden")}),s.attach(this.$id("@remove"),this.hide_title),this.$id("@remove").click(function(t){l.createDialog(e).title(e.hide_title).cancel(null,u.cancel).ok(function(){e.serverCall("hide_log_item").send()},e.hide_title).html(e.hide_message),t.preventDefault()})}}),t.AdminMode=n.extend({toggle:function(){this.serverCall("toggle").liveMutate().send()},onLoad:function(){function e(e){t.toggle(),e.preventDefault()}var t=this;t.$id("@toggle").click(e),t.listen&&h.on([81,49,81,49],e)}}),t.AdminModeListener=n.extend({toggle:function(){this.serverCall("toggle").liveMutate().send()},onLoad:function(e){function t(){i.toggle(),e.preventDefault()}var i=this;h.on([81,49,81,49],t)}}),t.NicknameInlineEditor=a.extend({onLoad:function(){this._super.apply(this,arguments),"#editname"==c.getHash().substr(0,9)&&this.toggle_editor()}}),t.RemoveInboxMessagesLink=n.extend({onLoad:function(){var e=this;this.$id("@delete").click(function(t){l.createDialog(e).title(e.delete_messages_title).cancel(null,u.cancel).ok(function(){
e.serverCall("delete_messages").liveMutate().send()},e.delete_messages_title).html(e.delete_messages_message),t.preventDefault()})}}),t.AdminRemoveUserPhoto=n.extend({onLoad:function(e){var t=this;this.$id("@remove_photo_link").click(function(e){l.createDialog(t).title(t.remove_profile_photo).cancel().ok(function(e){var i=e.dialogComponent.child("editor").serialize();t.serverCall("remove_photo").kwargs({comment:i}).liveMutate().send()},t.remove_photo).load("remove_photo_dialog"),o("#admin_remove_profile_photo_comment").focus(),e.preventDefault()})}}),t.FlagNameLink=n.extend({onLoad:function(){var e=this;this.$id("@show_flag_name_modal").click(function(t){t.preventDefault(),e.createModal("flag_modal").kwargs({uid:e.uid,resolved:e.resolved}).show()})}}),t.ResolveNameLink=n.extend({onLoad:function(){var e=this;this.$id("@show_resolve_name_modal").click(function(t){t.preventDefault(),e.createModal("verify_modal").kwargs({uid:e.uid}).show()})}}),t.ResolveNameModal=r.extend({onSubmit:function(){
var e=this;this.serverCall("resolve_name").liveMutate().success(function(){e._closeModal()}).send()}}),t.FlagNameModal=r.extend({onSubmit:function(){var e=this;this.serverCall("flag_name").liveMutate().success(function(){e._closeModal()}).send()}}),t.BanRemoveLink=n.extend({onLoad:function(){var e=this;e.$id("@ban_remove_link").click(function(t){t.preventDefault(),e.createModal("ban_remove_modal").kwargs({location:e.location,uids_to_ban_remove:e.uids_to_ban_remove,use_safe_ban:e.use_safe_ban}).show()})}}),t.BanRemoveModal=r.extend({onLoad:function(){this._super.apply(this,arguments),this.child("editor").focus()},onSubmit:function(){var e=this,t=e.child("editor");if(t.isOnlyWhiteSpace())return e.$id("@required_comment_warning").removeClass("hidden"),void t.focus();var i=t.serialize(),n=this.$id("@revert_edits").is(":checked"),o=this.$id("@mark_as_verified_spammer").is(":checked"),s=this.$id("@remove_votes").is(":checked"),a=function(t){return e.$id("@"+t).prop("checked")};return e.serverCall("ban_remove_all_users").kwargs({
comment:i,revert_edits:n,mark_as_verified_spammer:o,remove_votes:s,uids_to_ban_remove:e.uids_to_ban_remove.filter(a)}).liveMutate().success(function(){e._closeModal()}).send(),!1}}),t.SendMessageLinkBase=n.extend({onLoad:function(){var e=this;this.$id("@modal_link").on("click",function(t){t.preventDefault(),e.createModal("load_inner").kwargs({recipient_uid:e.recipient_uid}).show()})}}),t.SendMessageModalBase=r.extend({onSubmit:function(){var e=this,t=e.child("editor").serialize();e.serverCall("submit").kwargs({msg:t}).liveMutate().success(function(){e._closeModal()}).send()}}),t.BanUserDialog=d.AddCommentDialog.extend({getPars:function(){var e=this._super.apply(this,arguments);return e&&(e.removeMessages=this.$id("@checkbox").prop("checked")),e}}),t.AdminMessageDialog=d.Dialog.extend({onLoad:function(){this._super.apply(this,arguments),this.editor=this.child("editor"),this.editor.focus()},getPars:function(){return this.editor.isOnlyWhiteSpace()?!1:{msg:this.editor.serialize()}}})}),define("shared/toast",["shared/polyfills","shared/Class","interface/settings","shared/client","shared/jquery"],function(e,t,i){
var n=e("shared/Class").Class,o=e("interface/settings"),s=e("shared/client"),a=o.interface_strings,r=o.pageIsMobile,d=e("shared/jquery"),l=null,c=t.Toast={show:function(){if(null!==l&&l.close(),l=this,this.closeTimeout=setTimeout(this.close.bind(this),3e3),r&&s.isUIWebView()){var e=this.$container.get(0),t=document.documentElement.clientHeight-window.innerHeight;t>0&&e&&(e.style.paddingBottom=t+"px")}},close:function(){clearTimeout(this.closeTimeout),l=null,0!==this.$container.length&&(this.$container.addClass("animate_out"),this.$container.css("paddingBottom",""),setTimeout(this.cleanup.bind(this),1e3))},cleanup:function(){var e=this.$container.get(0);e.parentNode&&e.parentNode.removeChild(e)}},h=n.extend(c).extend({__init__:function(e,t){this.additionalClasses=t||[],this.message=e,this.$container=d(this.render())},render:function(){var e=document.getElementById("pmsg_container");e||(e=document.createElement("div"),e.id="pmsg_container",document.body.appendChild(e)),e.className="PMsgContainer";
var t=document.createElement("div");t.className=["PMsg"].concat(this.additionalClasses).join(" "),e.appendChild(t);var i=document.createElement("div");return i.className="contents",d(i).text(this.message),t.appendChild(i),t}});t.show=function(e){var t=new h(e);t.show()};var u=t.showError=function(e){var t=new h(e,["PMsgError"]);t.show()};t.showPleaseTryAgainError=function(){u(a.please_try_again)}}),define("unified_view/toggle",["shared/polyfills","shared/core/component","shared/errors","shared/debounce","shared/toast","interface/settings","shared/perf","shared/viewport"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/errors"),s=e("shared/debounce").debounce,a=e("shared/toast"),r=e("interface/settings").pageIsMobile,d=e("shared/perf"),l=e("shared/viewport");t.ToggleBase=n.extend({onLoad:function(){this._userPerceivedAction=null,this.fetchCalled=!1,this.fetchCompleted=!1,this.switchCompleted=!1,this.switchPending=!1,this.$fetchInto=this.$id(this.fetch_into),this.$switchShow=this.optional$id(this.switch_show),
this.$switchHide=this.optional$id(this.switch_hide),this.$loadingShow=this.optional$id(this.loading_show),this.$loadingHide=this.optional$id(this.loading_hide),this.$fetchOnElem=this.fetch_on.length>1?this.$id(this.fetch_on[1]):this.$switchHide,this.$switchOnElem=this.switch_on.length>1?this.$id(this.switch_on[1]):this.$switchHide,this.bindFetch(),this.handleSwitch(),this.fetchCompleted||this.$fetchInto||o.logJsError("Toggle","$fetchInto undefined but fetch is not completed.")},optional$id:function(e){return e?this.$id(e):null},bindFetch:function(){switch(this.fetch_on[0]){case"request":this.fetchCalled=!0,this.fetchCompleted=!0;break;case"load":this.fetch();break;case"js":break;case"view":case"hover":case"click":var e=this.fetch_on[0];if(!this.$fetchOnElem)return void o.logJsError("Toggle","$fetchOnElem undefined for view/hover/click triggers.");"hover"==e?this.bindHover(this.$fetchOnElem,this.fetch.bind(this)):"view"==e?this.bindInViewPort(this.$fetchOnElem,this.fetch.bind(this)):this.bindClick(this.$fetchOnElem,this.fetch.bind(this));
break;default:throw new Error("Invalid fetch trigger specified "+this.fetch_on)}},handleSwitch:function(){switch(this.switch_on[0]){case"request":this.fetchCalled=!0,this.fetchCompleted=!0,this.switchCompleted=!0;break;case"load":this.triggerSwitch();break;case"js":break;case"view":case"hover":case"click":var e=this.switch_on[0];if(!this.$switchOnElem)return void o.logJsError("Toggle","$switchOnElem undefined for view/hover/click triggers.");"hover"==e?this.bindHover(this.$switchOnElem,this.triggerSwitch.bind(this)):"view"==e?this.bindInViewPort(this.$switchOnElem,this.triggerSwitch.bind(this)):this.bindClick(this.$switchOnElem,this.triggerSwitch.bind(this));break;default:throw new Error("Invalid show trigger specified "+this.switch_on)}},fetch:function(){this.fetchCalled||(this.fetchCalled=!0,this.serverCall("fetch_toggled_component").kwargs({serialized_args:this.serialized_args}).disableDefaultUserPerceivedLogging().sendJsData(!1).contentFor(this.$fetchInto.get(0)).success(this.onFetched.bind(this)).error(this.onFetchError.bind(this)).send({
batched:!0}))},onFetchError:function(){this.switchPending&&"click"==this.switch_on[0]&&a.showPleaseTryAgainError(),this.switchPending=!1,this.fetchCalled=!1,this.exitLoadingState()},onFetched:function(){this.fetchCompleted=!0,this.switchPending&&(this.switchPending=!1,this.triggerSwitch())},enterLoadingState:function(){this.$loadingShow&&this.$loadingShow.removeClass("hidden"),this.$loadingHide&&this.$loadingHide.addClass("hidden")},exitLoadingState:function(){this.$loadingShow&&this.$loadingShow.addClass("hidden")},actualSwitch:function(){this.switchCompleted||(this.switchCompleted=!0,this.$switchShow&&this.$switchShow.toggleClass("hidden"),this.$switchHide&&this.$switchHide.toggleClass("hidden"))},triggerSwitch:function(){this.switchStart(),this.fetch(),this.fetchCompleted?(this.exitLoadingState(),this.actualSwitch(),this.switchEnd()):(this.switchPending=!0,this.enterLoadingState())},switchStart:function(){this.log_switch_time&&(this._userPerceivedAction=d.startUserPerceived({vcon:this.__vcon,
method:"fetch_toggled_component"}))},switchEnd:function(){this.log_switch_time&&(this.log_switch_time=!1,this._userPerceivedAction&&(d.finishAction(this._userPerceivedAction),this._userPerceivedAction=null))},_isLinkedAnchorTag:function(e){return"A"==e.tagName&&e.getAttribute("href")&&"#"!=e.getAttribute("href")},bindClick:function(e,t){var i=this;e.on("click",function(n){for(var o=n.target;o&&o!=e.get(0);){if(i._isLinkedAnchorTag(o))return;o=o.parentElement}n.preventDefault(),t()})},bindHover:function(e,t){r?this.bindInViewPort(e,t):e.on("mouseenter",t)},bindInViewPort:function(e,t){if(l.isElementInViewport(e.get(0)))t();else{var i={leading:!0},n=s(function(){l.isElementInViewport(e.get(0))&&(t(),window.removeEventListener("scroll",n))},50,i);window.addEventListener("scroll",n)}}})}),define("app/view/ads",["shared/polyfills","shared/action_log","shared/jquery","shared/events/index","unified_view/toggle","shared/core/component","shared/keystrokes"],function(e,t,i){var n=e("shared/action_log").ActionableComponent,o=e("shared/jquery"),s=e("shared/events/index"),a=e("unified_view/toggle"),r=e("shared/core/component").Component;
t.TextAd=n.extend({onLoad:function(){this._super.apply(this,arguments);var e=this;o(document).ready(function(){setTimeout(function(){(0===e.$id("@wrapper").width()||0===e.$id("@wrapper").height())&&e.serverCall("log_blocked_impression").send()},100)})},actionCallback:function(){this._super.apply(this,arguments),this.serverCall("flush_action_log").send()}}),t.AdLink=r.extend({onLoad:function(){var e=this;e._super.apply(this,arguments);var t=e.$id("@link");t.on("mousedown",function(){t.attr("href",e.redirect_url)})}}),t.FeedInlineExpandAdToggle=a.ToggleBase.extend({onLoad:function(){this._super.apply(this,arguments);var e=this;e.handleEvent(s.Types.ANSWER_FEED_INLINE_EXPAND,function(t){t.payload.aid==e.aid&&e.triggerSwitch()})}}),t.AdsDebugToggle=r.extend({onLoad:function(){this._state=!1,this.setupKeyboardShortcut()},toggle:function(){var e,t=this,i=document.getElementsByClassName("ads_debug_info");if(t._state)for(t._state=!1,e=0;e<i.length;e++)i[e].style.display="none";else for(t._state=!0,
e=0;e<i.length;e++)i[e].style.display="block"},setupKeyboardShortcut:function(){e("shared/keystrokes").on([65,68,83,65,68,83],this.toggle.bind(this))}})}),define("view/fixable2",["shared/polyfills","shared/jquery","shared/browser","shared/util"],function(e,t,i){function n(){return y.mobile||y.tablet}function o(e,t){if(("object"!=typeof t||null===t)&&(t={}),!n()||t.enable_mobile){var i=_(t.header)||document.querySelector(".SiteHeader"),o=_(t.footer)||null,d=i&&i.offsetHeight||0,l=i&&w(i).top||0,h={winHeight:x.innerHeight,winWidth:x.innerWidth,winScroll:document.body.scrollTop,scrollingDown:!0,elPosition:window.getComputedStyle(e).position,elTop:parseInt(window.getComputedStyle(e).top),elWidth:e.offsetWidth,topSpacing:0};t=C.extend({scroll_dep:!1,height_dep:!0,width_dep:!0,header:i,footer:o,extra_top_spacing:t.extra_top_spacing||0,extra_bottom_spacing:t.extra_bottom_spacing||0,min_scroll:a(e,i,h.winScroll),max_scroll:r(e,i,o,h.winScroll),min_height:e.offsetHeight+d+l-h.winScroll,min_width:h.elWidth,
sticky_release:!0,custom_trigger:null,enable_mobile:!1,min_scroll_callback:null,max_scroll_callback:null,responsive_width:!1},t),t.min_scroll-=t.extra_top_spacing,t.max_scroll-=t.extra_top_spacing+t.extra_bottom_spacing,h.topSpacing=w(e).top-t.min_scroll-parseInt(window.getComputedStyle(e)["margin-top"]),c(e,t,h),k.push(new s(e,t,h))}}function s(e,t,i){this.el=e||null,this.options=t||{},this.state=i||{}}function a(e,t,i){var n=w(e).top,o=t&&t.offsetHeight||0,s=(t&&w(t).top||0)-i,a=parseInt(window.getComputedStyle(e)["margin-top"]);return n-o-s-a}function r(e,t,i,n){var o=i&&w(i).top||0,s=w(e).top,r=e.offsetHeight,d=parseInt(window.getComputedStyle(e)["margin-bottom"]);return a(e,t,n)+o-s-r-d}function d(e){var t={scrollTop:document.body.scrollTop,height:x.innerHeight,width:x.innerWidth};T||requestAnimationFrame(l.bind(null,e,t)),T=!0}function l(e,t){var i=e.type;k.filter(function(e){return"w2.fixable.trigger"===i?e.getDependencies().custom:e.getDependencies()[i]}).forEach(function(i){var n=i.state.winScroll;
C.extend(i.state,{winScroll:t.scrollTop,winHeight:t.height,winWidth:t.width,customTop:e.top||i.state.customTop||null}),i.state.scrollingDown=i.state.winScroll>n,c(i.el,i.options,i.state)}),T=!1}function c(e,t,i){h(e,t,i)?u(e,t,i):p(e,t,i)}function h(e,t,i){if("none"===window.getComputedStyle(e).display)return!1;var n=!0;return null!==t.custom_trigger?n=t.custom_trigger(t,i):t.scroll_dep&&(n=$.scroll(t,i)),n&&(t.height_dep&&(n=$.height(t,i)),t.width_dep&&(n=n&&$.width(t,i))),n}function u(e,t,i){if(!e.classList.contains("fixable_fixed")){var n,o=i.topSpacing;i.elWidth=e.offsetWidth,m(e),null!==t.custom_trigger&&null!==i.customTop?(o=i.customTop,i.customTop=null):t.scroll_dep||(o=w(e).top+parseInt(window.getComputedStyle(e)["margin-top"])),e.style.top=o+"px",e.style.position="fixed",e.style.width=t.responsive_width?"100%":i.elWidth+"px",e.classList.add("fixable_fixed");try{n=new window.Event("w2.fixable.fixed")}catch(s){n=document.createEvent("Event"),n.initEvent("w2.fixable.fixed",!0,!0)}
e.dispatchEvent(n)}}function p(e,t,i){var n;if(e.classList.contains("fixable_fixed")){null!==t.custom_trigger&&(i.customTop=parseInt(window.getComputedStyle(e).top)),i.scrollingDown&&null===t.custom_trigger&&t.sticky_release?(e.style.top=t.max_scroll-t.min_scroll+"px",e.style.position="relative"):(e.style.top=i.elTop+"px",e.style.position=i.elPosition,v(e)),e.classList.remove("fixable_fixed");try{n=new window.Event("w2.fixable.unfixed")}catch(o){n=document.createEvent("Event"),n.initEvent("w2.fixable.unfixed",!0,!0)}e.dispatchEvent(n)}}function f(e){for(var t=0,i=k.length;i>t;t++)if(e===k[t].el)return t;return-1}function _(e){if(b&&e instanceof b){if(e.length>=2)throw new Error("Error in makeFixable(): getDomNode must only have a single element. (check the fixable element, header, and footer, are not collections)");return e[0]}return e}function g(e){var t=document.createElement("div"),i=window.getComputedStyle(e);return t.classList.add("fixable_clone"),t.style.height=e.offsetHeight+"px",
t.style.width=e.offsetWidth+"px",t.style["margin-top"]=i["margin-top"],t.style["margin-right"]=i["margin-right"],t.style["margin-bottom"]=i["margin-bottom"],t.style["margin-left"]=i["margin-left"],t}function m(e){var t=g(e),i=e.parentNode;return i.replaceChild(t,e),t.appendChild(e),t}function v(e){var t=e.parentNode.parentNode;return t.replaceChild(e,e.parentNode),e}function w(e){var t=e.getBoundingClientRect();return{top:t.top+document.body.scrollTop,left:t.left+document.body.scrollLeft}}var b=e("shared/jquery"),y=e("shared/browser"),C=e("shared/util"),k=[],x=window,S=document,E=["resize","scroll","w2.fixable.trigger"],T=!1,$={height:function(e,t){return t.winHeight>=e.min_height},width:function(e,t){return t.winWidth>=e.min_width},scroll:function(e,t){if(e.min_scroll>=0&&(e.min_scroll_callback||e.max_scroll_callback)){var i=e.min_scroll;e.min_scroll_callback&&(i=e.min_scroll_callback());var n=e.max_scroll;return e.max_scroll_callback&&(n=e.max_scroll_callback()),t.winScroll<=n&&i<=t.winScroll;
}return e.min_scroll>=0&&e.max_scroll>=0?e.min_scroll<=t.winScroll&&t.winScroll<=e.max_scroll:e.min_scroll>=0?t.winScroll>=e.min_scroll:e.max_scroll>=0?t.winScroll<=e.max_scroll:!1}},L=function(e,t){if(e=_(e),!e)throw new Error("No element given for makeFixable");return-1===f(e)?(o(e,t),E.forEach(function(e){"resize"===e&&(x.removeEventListener(e,d),x.addEventListener(e,d)),S.removeEventListener(e,d),S.addEventListener(e,d)}),e):void 0},A=function(e){if(e=_(e),!e)throw new Error("No element given for removeFixable");var t,i=f(e);return i>-1&&(t=k.splice(i,1)[0],t.el.style.top=t.state.elTop+"px",t.el.style.position=t.state.elPosition,t.el.classList.remove("fixable_fixed")),k.length<=0&&E.forEach(function(e){S.removeEventListener(e,d),x.removeEventListener(e,d)}),e},D=function(e,t,i){function n(){if(!e||!t)return!1;var n,o=e.offsetHeight,s=document.body.scrollTop+window.innerHeight,a=w(t).top+o+i.top,r=e.parentNode;return n=r.classList.contains("fixable_clone")?w(r).top+o-i.bottom:w(e).top+o-i.bottom,
s>=a&&n>=s}e=_(e),t=_(t),i=i||{},i.top=i.top||0,i.bottom=i.bottom||0,L(e,{scroll_dep:!0,custom_trigger:n}),e.addEventListener("w2.fixable.fixed",function(){this.style.top="auto",this.style.bottom=0})},I=function(e,t){var i,n=e.length;for(i=0;n-1>i;i++)L(e[i],C.extend(t,{scroll_dep:!0,footer:e[i+1]}));L(e[i],C.extend(t,{scroll_dep:!0,footer:t&&t.footer||null}))};s.prototype.getDependencies=function(){return{resize:this.options.height_dep||this.options.width_dep,scroll:this.options.scroll_dep,custom:null!==this.options.custom_trigger}},t.makeFixable=L,t.removeFixable=A,t.makeBottomFixable=D,t.makeStackedFixables=I}),define("simscroll",["shared/polyfills"],function(e,t,i){function n(e,t,i,n,o){return[e,!!t,!!i,!!n,!!o].join(" ")}function o(e){var t=e.keyCode||e.charCode,i=Math.round(r.clientHeight-100);switch(n(t,e.shiftKey,e.ctrlKey,e.altKey,e.metaKey)){case d:window.scrollBy(0,-a);break;case l:window.scrollBy(0,a);break;case c:case h:window.scrollBy(0,-i);break;case u:case p:window.scrollBy(0,i);
break;default:return!1}return s=!0,!0}var s,a=50,r=document.documentElement,d=n(38),l=n(40),c=n(33),h=n(32,!0),u=n(32),p=n(34);document.addEventListener&&document.addEventListener("keypress",function(e){var t=e.originalTarget||e.target;s||t!==r&&t!==document.body||!o(e)||(e.preventDefault(),e.stopPropagation()),s=!1},!1),t.maybeSimulateScroll=o,t.cancelSimulatedScroll=function(){s=!0}}),define("third_party/autosize",["shared/polyfills"],function(e,t,i){!function(e,n){if("function"==typeof define&&define.amd)define(["exports","module"],n);else if("undefined"!=typeof t&&"undefined"!=typeof i)n(t,i);else{var o={exports:{}};n(o.exports,o),e.autosize=o.exports}}(this,function(e,t){"use strict";function i(e){function t(){var t=window.getComputedStyle(e,null);u=t.overflowY,"vertical"===t.resize?e.style.resize="none":"both"===t.resize&&(e.style.resize="horizontal"),h="content-box"===t.boxSizing?-(parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)):parseFloat(t.borderTopWidth)+parseFloat(t.borderBottomWidth),
isNaN(h)&&(h=0),o()}function i(t){var i=e.style.width;e.style.width="0px",e.offsetWidth,e.style.width=i,u=t,c&&(e.style.overflowY=t),n()}function n(){var t=window.pageYOffset,i=document.body.scrollTop,n=e.style.height;e.style.height="auto";var o=e.scrollHeight+h;return 0===e.scrollHeight?void(e.style.height=n):(e.style.height=o+"px",p=e.clientWidth,document.documentElement.scrollTop=t,void(document.body.scrollTop=i))}function o(){var t=e.style.height;n();var o=window.getComputedStyle(e,null);if(o.height!==e.style.height||"hidden"!==u&&i("hidden"),t!==e.style.height){var s=document.createEvent("Event");s.initEvent("autosize:resized",!0,!1),e.dispatchEvent(s)}}var a=void 0===arguments[1]?{}:arguments[1],r=a.setOverflowX,d=void 0===r?!0:r,l=a.setOverflowY,c=void 0===l?!0:l;if(e&&e.nodeName&&"TEXTAREA"===e.nodeName&&!s.has(e)){var h=null,u=null,p=e.clientWidth,f=function(){e.clientWidth!==p&&o()},_=function(t){window.removeEventListener("resize",f),e.removeEventListener("input",o),e.removeEventListener("keyup",o),
e.removeEventListener("autosize:destroy",_),s["delete"](e),Object.keys(t).forEach(function(i){e.style[i]=t[i]})}.bind(e,{height:e.style.height,resize:e.style.resize,overflowY:e.style.overflowY,overflowX:e.style.overflowX,wordWrap:e.style.wordWrap});e.addEventListener("autosize:destroy",_),"onpropertychange"in e&&"oninput"in e&&e.addEventListener("keyup",o),window.addEventListener("resize",f),e.addEventListener("input",o),e.addEventListener("autosize:update",o),s.add(e),d&&(e.style.overflowX="hidden",e.style.wordWrap="break-word"),t()}}function n(e){if(e&&e.nodeName&&"TEXTAREA"===e.nodeName){var t=document.createEvent("Event");t.initEvent("autosize:destroy",!0,!1),e.dispatchEvent(t)}}function o(e){if(e&&e.nodeName&&"TEXTAREA"===e.nodeName){var t=document.createEvent("Event");t.initEvent("autosize:update",!0,!1),e.dispatchEvent(t)}}var s="function"==typeof Set?new Set:function(){var e=[];return{has:function(t){return Boolean(e.indexOf(t)>-1)},add:function(t){e.push(t)},"delete":function(t){
e.splice(e.indexOf(t),1)}}}(),a=null;"undefined"==typeof window||"function"!=typeof window.getComputedStyle?(a=function(e){return e},a.destroy=function(e){return e},a.update=function(e){return e}):(a=function(e,t){return e&&Array.prototype.forEach.call(e.length?e:[e],function(e){return i(e,t)}),e},a.destroy=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],n),e},a.update=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],o),e}),t.exports=a})}),define("view/selector",["shared/polyfills","webnode2","shared/core/webnode","shared/jquery","simscroll","shared/window_manager","third_party/autosize","shared/logging","shared/core/component"],function(e,t,i){var n=e("webnode2"),o=e("shared/core/webnode"),s=e("shared/jquery"),a=e("simscroll"),r=e("shared/window_manager"),d=e("third_party/autosize"),l=e("shared/logging"),c=e("shared/core/component"),h=c.Component;t.Selector=h.extend({onLoad:function(){function e(e){if("keydown"===e.type){var t=i.child("results");if(t){
var n=t.getSelectedResult();null===n&&i.allow_no_selection?i.submit():n&&i.onResultSelected(n,!1,t.$selectedItemElem)}else i.submit()}}function t(t){if(i.shouldSimScroll&&"keydown"==t.type){if(!i.query&&a.maybeSimulateScroll(t))return!1;if(!i.query&&39==t.which)return void i.$input.blur()}switch(t.which){case 13:t.preventDefault(),e(t);break;case 27:i.selectorFocusOutHandler();break;case 38:i.handleUpDownArrowKey(t,-1);break;case 40:i.handleUpDownArrowKey(t,1);break;default:var n=i.$input.val();n!==i.query&&i._setQuery(n)}}var i=this;i._busy=!1,i._resultsLastUpdated=Date.now(),i.$input=i.$id("@input"),i.$results_container=i.$id("@results_container"),i.$results=i.$id("@results"),i.$empty_input_prompt=i.$id("@empty_input_prompt"),i.$spinner=i.$id("@spinner"),i.$wrapper=i.$id("@wrapper"),i.shouldSimScroll=!1,i.hasAutoSized=!1,i.query=i.$input.val(),i.has_updated_result=!1,i.inputIsFocused=!1,i.$input.change(t).keydown(t).keyup(t).focus(i.inputFocusHandler.bind(i)).blur(i.inputBlurHandler.bind(i)),
i.$wrapper.focusout(function(){i.wrapperFocusoutHandler()}),i.$wrapper.focusin(function(){i.wrapperFocusinHandler()})},handleUpDownArrowKey:function(e,t){if(e.preventDefault(),"keydown"===e.type){var i=this.child("results");i&&i.moveSelection(t)}},inputFocusHandler:function(){this.inputIsFocused=!0,this.has_updated_result||(this.has_updated_result=!0,this.updateResults()),this.is_textarea&&!this.hasAutoSized&&(d(this.$input),this.hasAutoSized=!0),this.showResults(!0),this.length_limit&&this.child("counter").show()},inputBlurHandler:function(){this.inputIsFocused=!1,this.length_limit&&this.child("counter").hide()},selectorFocusOutHandler:function(){this.showResults(!1),this.$input.blur()},wrapperFocusoutHandler:function(){this.showResults(!1)},wrapperFocusinHandler:function(){this.focus()},setQuery:function(e){var t=this.$input[0].selectionStart,i=this.$input[0].selectionEnd;this.$input.val(e),this.$input[0].setSelectionRange(t,i),this._setQuery(e)},queryDidChange:function(){},resultsDidChange:function(){},
onResultSelected:function(e,t,i){this.beforeSelectResultCallback&&this.beforeSelectResultCallback(e,t,i),this.resultWasSelected(e,t,i),this.afterResultWasSelectedCallback&&this.afterResultWasSelectedCallback(e,t,i)},resultWasSelected:function(e,t,i){},submit:function(){},shouldShowEmptyInputPrompt:function(){return!(this.show_results_for_empty_query||this.query&&0!==this.query.trim().length)},adjustResultContainerContent:function(){this.shouldShowEmptyInputPrompt()?(this.$results.addClass("hidden"),this.$empty_input_prompt.removeClass("hidden")):(this.$results.removeClass("hidden"),this.$empty_input_prompt.addClass("hidden")),this.preventOverflow()},showResults:function(e){e?(this.$results_container.removeClass("hidden"),this.adjustResultContainerContent()):this.$results_container.addClass("hidden")},preventOverflow:function(){this.$results_container.removeClass("inverted"),this.$results_container.css({"overflow-y":"auto",height:"auto"});var e,t=this.$results_container.offset().top,i=this.$results_container.outerHeight(!0),n=t+i,o=s(window).scrollTop()+r.headerOffset,a=s(window).scrollTop()+s(window).height(),d=a-t,l=t-o;
l>500&&200>d?(this.$results_container.addClass("inverted"),e=o-this.$results_container.offset().top):e=n-a,e>0&&this.$results_container.css({"overflow-y":"scroll",height:i-e})},getExtraKwargs:function(){return{}},updateResults:function(){var e=this;if(e.isBusy()||e.shouldShowEmptyInputPrompt())return void e.adjustResultContainerContent();var t=Date.now(),i={query:e.query,parent_cid:e.cid,parent_domid:c.getLiveParent(e.cid)},n=e.$results.get(0),o=c.getLiveChildren(e.cid),s=o.filter(function(e){return n.contains(document.getElementById(e))});i.domids_to_remove=JSON.stringify(s);var a=e.getExtraKwargs();for(var r in a)a.hasOwnProperty(r)&&(i[r]=a[r]);e.setBusy(!0),e.serverCall("results_content_for").kwargs(i).success(function(i){e.maybeUpdateResults(i,t),e.resultsServerCallHandler.call(e)}).except(e.resultsServerCallHandler.bind(e)).error(e.resultsServerCallHandler.bind(e)).send()},maybeUpdateResults:function(e,t){if(t>this._resultsLastUpdated){this._resultsLastUpdated=t;var i=this.$results.get(0);
n.forgetContents(s(i)),o.setContent(s(i),e)}},resultsServerCallHandler:function(){this.setBusy(!1),this.$input.is(":focus")&&""!==this.$input.val()&&this.showResults(!0),this.child("results").query!==this.$input.val()&&this.updateResults()},isBusy:function(){return this._busy},setBusy:function(e){function t(){return!i._busy&&i._spinner}var i=this;if(i._busy=e,i._lastBusyUpdate=Date.now(),i._busy&&!i._spinner){i.$spinner.removeClass("hidden"),i._spinner=!0;var n=i._lastBusyUpdate;setTimeout(function(){i._busy&&i._lastBusyUpdate===n&&i.resultsServerCallHandler.call(i)},5e3)}else t()&&setTimeout(function(){t()&&(i.$spinner.addClass("hidden"),i._spinner=null)},100)},focus:function(){var e=this.$id("@input");!this.inputIsFocused&&e&&e.focus()},blur:function(){this.$id("@input").blur()},_setQuery:function(e){this.query=e,this.length_limit&&this.child("counter").updateCounter(e.length),this.queryDidChange(),this.updateResults()}}),t.MultiSelector=t.Selector.extend({onLoad:function(){this._super.apply(this,arguments),
this.saved_results=this.saved_results||[]},getExtraKwargs:function(){return{saved_results:this.saved_results}},resultWasSelected:function(e,t,i){this.saved_results.push(e),this.showResults(!1),this.setQuery(""),this.updateDisplayedResults(),this.onSavedResultsChanged()},onSavedResultsChanged:function(){},remove:function(e){this.saved_results.splice(e,1),this.updateDisplayedResults(),this.onSavedResultsChanged()},updateDisplayedResults:function(){var e=this;e.serverCall("saved_results_content_for").contentFor(e.$id("@saved_results"),{useLoadingSpinner:!1}).args(e.saved_results).send()}}),t.MultiSelectorSavedResultList=h.extend({onLoad:function(){for(var e=0;e<this.num_results;e++)this.attachRemoveClickHandler(e)},attachRemoveClickHandler:function(e){var t=this;t.$id("@remove"+e).click(function(){return t.parent().remove(e),!1})}}),t.NavigateToResultUrlSelectorMixin={resultWasSelected:function(e,t){this._super.apply(this,arguments),e.data&&e.data.url&&(t?window.open(e.data.url):r.navigateTo(e.data.url));
}},t.SelectorWithTypeaheadLogMixin={shouldTypeaheadLog:function(e){return!0},resultWasSelected:function(e,t){var i=this.child("results");if(this.shouldTypeaheadLog(e)){var n={data:i.typeahead_log_data,click_index:i.selectedIndex};parseInt(n.click_index)===n.click_index&&n.click_index>=0&&"undefined"!=typeof n.data&&l.log("typeahead",{message:n})}this._super.apply(this,arguments)}},t.SelectorResults=h.extend({onLoad:function(){var e=this;e.allow_no_selection?e.setSelection(-1):e.setSelection(0),e.$id("@wrapper").on("mouseover",".selector_result",function(t){var i=e.getIndexFromResultElementID(this.id);e.setSelection(i)}).on("mousedown",".selector_result",function(e){e.preventDefault()}).on("click",".selector_result",function(t){var i=e.getIndexFromResultElementID(this.id);e.setSelection(i);var n=e.getSelectedResult(),o=t.metaKey||t.ctrlKey;e.parent().onResultSelected(n,o,e.$selectedItemElem)}),e.allow_no_selection&&e.$id("@wrapper").mouseleave(function(t){e.setSelection(-1)}),void 0!=e.parent().resultsDidChange&&e.parent().resultsDidChange();
},getSelectedResult:function(){return-1===this.selectedIndex?null:!this.numResults&&this.allow_no_selection?null:this.results[this.selectedIndex]},setSelection:function(e){if(this.numResults&&!isNaN(parseInt(e)))if(-1===this.selectedIndex||isNaN(parseInt(this.selectedIndex))||this.$id("@result_"+this.selectedIndex).removeClass("selector_highlighted"),(this.allow_no_selection&&-1>e||!this.allow_no_selection&&0>e)&&(e=this.numResults-1),e>this.numResults-1&&(e=this.allow_no_selection?-1:0),-1===e)this.selectedIndex=e,this.$selectedItemElem=null;else{var t=this.$id("@result_"+e);t&&(this.$selectedItemElem=t,this.$selectedItemElem.addClass("selector_highlighted"),this.selectedIndex=e)}},moveSelection:function(e){var t=this.selectedIndex+e;this.setSelection(t)},getIndexFromResultElementID:function(e){var t=e.split("_");return parseInt(t[t.length-1])}}),t.WithServerCallMessageMixin=t.Selector.extend({onLoad:function(){var e=this;e._super.apply(e,arguments),e.$serverMessage=e.$id("@server_message"),
e.pendingServerCallRequest=null,e.serverCallBusy=!1},queryDidChange:function(){this._super.apply(this,arguments),this.showServerMessage(!1)},makeServerCall:function(e){this.pendingServerCallRequest=e,this.isBusy()||this.doServerCall()},hasPendingServerCall:function(){return null!==this.pendingServerCallRequest||this.serverCallBusy},resultsServerCallHandler:function(){var e=this;null!==e.pendingServerCallRequest?e.doServerCall():(e._super.apply(e,arguments),e.showServerMessage(!1))},doServerCall:function(){var e=this;e.setBusy(!0),e.serverCallBusy=!0,e.showServerMessage(!1);var t=function(t,i){e.updateServerMessage(t,i)&&e.showServerMessage(!0),e.serverCallBusy=!1,e.setBusy(!1)};e.pendingServerCallRequest.success(function(e){t(!0,e)}).except(function(e){t(!1,e)}).error(function(){t(!1)}).send(),e.pendingServerCallRequest=null},updateServerMessage:function(e,t){return!1},showServerMessage:function(e){e?this.$serverMessage.removeClass("hidden"):this.$serverMessage.addClass("hidden")}})}),define("app/view/ama",["shared/polyfills","shared/core/component","shared/jquery","view/fixable2","view/selector"],function(e,t,i){
var n=e("shared/core/component").Component,o=e("shared/jquery"),s=e("view/fixable2"),a=e("view/selector").WithServerCallMessageMixin;t.AMAAddQuestionSelector=a.extend({onLoad:function(){var e=this;e._super.apply(e,arguments),e.questionMarkInserted=!1;var t=e.$id("@logged_out_ama_ask");t&&t.on("click",this.triggerSignupWall.bind(this))},triggerSignupWall:function(){this.serverCall("trigger_signup_wall").send()},resultsServerCallHandler:function(){this._super.apply(this,arguments),this.$input.focus()},createNewQuestion:function(){var e=this;e.hasPendingServerCall()||e.makeServerCall(e.serverCall("create_new_question").kwargs({input_text:e.query}).liveMutate())},pickExistingQuestion:function(e){var t=this;t.hasPendingServerCall()||t.makeServerCall(t.serverCall("pick_existing_question").kwargs({qid:e}).liveMutate())},maybeInsertQuestionMark:function(){return"?"===this.query&&this.questionMarkInserted?(this.setQuery(""),void(this.questionMarkInserted=!1)):this.query?void(this.questionMarkInserted||null===this.query.match(/[?]$/)&&(this.questionMarkInserted=!0,
this.setQuery(this.query+"?"))):void(this.questionMarkInserted=!1)},queryDidChange:function(){this._super.apply(this,arguments),this.maybeInsertQuestionMark()},resultWasSelected:function(e){switch(e.ty){case"question":this.pickExistingQuestion(e.data.qid);break;case"create_question":this.createNewQuestion()}},updateServerMessage:function(e,t){if(e)this.setQuery("");else if(t&&t.message)return this.$id("@server_message_title").text(t.message.title),t.message.note&&this.$id("@server_message_note").text(t.message.note),!0;return!1}}),t.AMACoverBar=n.extend({onLoad:function(){this.$id("@question_button").on("click",function(){var e=o(".AMAQuestionAddHeader").offset().top;o("html,body").animate({scrollTop:e-80},"slow"),o(".AMAQuestionAddHeader").find(".selector_input").focus(),o(".AMAQuestionAddHeader").find(".selector_input").addClass("highlighted"),setTimeout(function(){o(".AMAQuestionAddHeader").find(".selector_input").removeClass("highlighted")},750)})}}),t.AmaSessionRightCol=n.extend({onLoad:function(){
var e=this.$id("@ticker").get(0);if(e||(e=this.$id("@upcoming").get(0)),e){var t=16;s.makeFixable(e,{scroll_dep:!0,height_dep:!0,extra_top_spacing:t})}}}),t.AMAWriterStats=n.extend({onLoad:function(){var e=this.$id("@writer_stats").get(0);e&&s.makeFixable(e,{scroll_dep:!0,extra_top_spacing:110})}}),t.AMAMetricGraph=n.extend({onLoad:function(){var e=new Rickshaw.Graph({element:this.$id("@rsgraph").get(0),series:[{color:"steelblue",data:this.series_data}],width:150,height:40,interpolation:"basis",renderer:"line"});e.render()}}),t.FinishSessionButton=n.extend({onLoad:function(){this.$id("@finish_session_button").on("click",this.finishSessionConfirm.bind(this))},finishSessionConfirm:function(){this.createModal("finish_session_confirm").onSubmit(this.finishSession.bind(this)).show()},finishSession:function(){this.serverCall("finish_session").kwargs({ama_id:this.ama_id}).success(this.redirectToSessionPage.bind(this)).send()},redirectToSessionPage:function(){window.location.replace(this.redirect_url);
}})}),define("app/view/ama/self_serve",["shared/polyfills","shared/core/component"],function(e,t,i){var n=e("shared/core/component").Component;t.StartSessionModalLink=n.extend({onLoad:function(){this.$id("@start_session_modal_link").on("click",this.openSessionModal.bind(this))},openSessionModal:function(){this.createModal("open_session_modal").show()}}),t.QuestionA2ARow=n.extend({onLoad:function(){this.$id("@request_button").on("click",this.addRequest.bind(this))},addRequest:function(){this.serverCall("add_request").liveMutate().send(),this.$id("@unrequested_state").addClass("hidden"),this.$id("@requested_state").removeClass("hidden")}})}),define("shared/views",["shared/polyfills","shared/viewport","interface/settings","shared/core/component","shared/log","shared/logging","shared/window_manager","shared/Class"],function(e,t,i){var n,o=e("shared/viewport"),s=e("interface/settings").pageIsMobile,a=e("shared/core/component"),r=e("shared/log").log,d=e("shared/logging"),l=e("shared/window_manager");
s&&(n=e("mobile_app2/client"));var c=e("shared/Class").Class.extend({__init__:function(){var e=this;e.trackedKeys={},e.trackedComponents=[],e.lastCheckTime=0,e.rateLimitMs=400;var t=l.getPathName();t.startsWith("/internal/")||(s?n.registerMessageHandler("tick",function(){e.logViews()}):document.addEventListener("scroll",e.logViews.bind(e)))},addComponentToTrack:function(e){var t=e.view_tracking_key;if(t)this.trackedKeys[t]||(this.trackedKeys[t]=!0,this.trackedComponents.push(e));else if(r&&r.enabled){var i="View tracking key not found for the component. This should be specified in js_data.";r("views",i)}},logViews:function(){var e=Date.now();if(!(e<this.lastCheckTime+this.rateLimitMs)){this.lastCheckTime=e;for(var t=[],i=[],n=0;n<this.trackedComponents.length;n++){var o=this.trackedComponents[n];o&&this.inViewPort(o)&&(t.push(o.view_tracking_key),i.push(o.view_tracking_hash),this.trackedComponents[n]=void 0)}var s={keys:t,hashes:i};t.length&&d.log("object_views",{messages:s}),this.trackedComponents=this.trackedComponents.filter(function(e){
return void 0!==e})}},inViewPort:function(e){var t=a.getLiveDomElement(e.cid);return t?o.isElementInViewport(t):!1}});t.viewsLogger=new c}),define("app/view/answer",["shared/polyfills","shared/core/component","shared/views","shared/events/index"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/views").viewsLogger,s=e("shared/events/index");t.AnswerHeader=n.extend({onLoad:function(){var e=this;this.handleEvent(s.Types.ANSWER_VOTE_STATE,function(t){if(t.payload.aid==e.aid){var i="upvoted"==t.payload.state;e.$id("@credibility_fact_no_vote").toggleClass("hidden",i),e.$id("@credibility_fact_upvoted").toggleClass("hidden",!i)}})}}),t.ToggledAnswerHeader=n.extend({onLoad:function(){var e=this;this.toggled=!1,this.handleEvent(s.Types.INLINE_EDITOR_STATE,function(t){t.payload.contentType==e.contentType&&t.payload.oid==e.oid&&("cancel"==t.payload.state?e.performCancel():"edit"==t.payload.state?e.updateState(!0):"submit"==t.payload.state?e.updateState(!1):"submitted"==t.payload.state?e.updateState(!1):"toggle"==t.payload.state&&e.updateState(!e.toggled));
})},updateState:function(e){setTimeout(this._updateState.bind(this,e),0)},_updateState:function(e){this.toggled=e,this.toggled?this.performEdit():this.performCancel()},performEdit:function(){this.$id("@read_mode_header").addClass("hidden"),this.$id("@edit_mode_header").removeClass("hidden")},performCancel:function(){this.$id("@read_mode_header").removeClass("hidden"),this.$id("@edit_mode_header").addClass("hidden")}}),t.AnswerListItem=n.extend({onLoad:function(){o.addComponentToTrack(this);var e=this;e.answerFeedbackLoaded=!1,e.handleEvent(s.Types.ANSWER_VOTE_STATE,function(t){t.payload.aid==e.aid&&("downvoted"==t.payload.state?e.showAnswerDownvoteFeedback():e.hideAnswerDownvoteFeedback())})},showAnswerDownvoteFeedback:function(){var e=this;e.$id("@item").addClass("hidden"),e.$id("@answer_feedback").removeClass("hidden"),e.answerFeedbackLoaded===!1&&e.serverCall("load_downvote_feedback").contentFor(e.$id("@answer_feedback")).success(function(){e.answerFeedbackLoaded=!0}).send()},hideAnswerDownvoteFeedback:function(){
this.$id("@item").removeClass("hidden"),this.$id("@answer_feedback").addClass("hidden")}})}),define("app/view/answer_wiki",["shared/polyfills","shared/jquery","view/inline_editor"],function(e,t,i){var n=e("shared/jquery"),o=e("view/inline_editor").InlineEditor;t.CreateAnswerWikiInlineEditor=o.extend({onLoad:function(){var e=this;this._super.apply(this,arguments),this.$id("@inline_editor_cancel").click(function(){return e.hideEditor(),!1})},trigger_request:function(){return this._super.apply(this,arguments),this.isEditorEmpty()&&this.hideEditor(),!1},hideEditor:function(){this.toggle_editor(),n("#answer_wiki").addClass("hidden")},_get_kwargs:function(){return{qid:this.id,input:this.get_value()}}}),t.AnswerWikiInlineEditor=o.extend({_get_kwargs:function(){var e="";this.has_comment&&!this.child("comment_editor").isOnlyWhiteSpace()&&(e=this.child("comment_editor").serialize());var t,i=this.$id("@notif");return t=i&&i.prop("checked")?1:0,{qid:this.id,input:this.get_value(),sugg_exists:this.sugg_exists,
comment:e,notif:t}}})}),define("app/view/ask",["shared/polyfills","shared/jquery","shared/window_manager","view/selector"],function(e,t,i){var n=e("shared/jquery"),o=e("shared/window_manager"),s=e("view/selector").WithServerCallMessageMixin;t.AskSelector=s.extend({onLoad:function(){var e=this;e._super.apply(e,arguments),e.questionMarkInserted=!1,e.$headerNav=e.parent().$id("@nav"),e.$contentWrapper=n(".ContentWrapper"),e.$id("@ask_button").click(function(t){e.addQuestion()}),e.$input.focus(function(t){e.$headerNav.fadeTo(400,.4)}),e.$input.blur(function(t){e.$headerNav.fadeTo(400,1),e.$contentWrapper.fadeTo(400,1)}),e.$input.val().length>0&&(e.$input.focus(),e.updateResults())},addQuestion:function(){var e=this;e.hasPendingServerCall()||e.makeServerCall(e.serverCall("add_question").kwargs({input_text:e.query}))},maybeInsertQuestionMark:function(){return"?"===this.query&&this.questionMarkInserted?(this.setQuery(""),void(this.questionMarkInserted=!1)):this.query?void(this.questionMarkInserted||null===this.query.match(/[?]$/)&&(this.questionMarkInserted=!0,
this.setQuery(this.query+"?"))):void(this.questionMarkInserted=!1)},queryDidChange:function(){this._super.apply(this,arguments),this.maybeInsertQuestionMark()},resultsDidChange:function(){var e=this.child("results").numResults>0?.4:1;this.$contentWrapper.fadeTo(400,e)},resultWasSelected:function(e){switch(e.ty){case"question":o.navigateTo(e.data.url);break;case"ask_question":this.addQuestion()}},updateServerMessage:function(e,t){if(e)t.url&&o.navigateTo(t.url);else if(t&&t.message)return this.$id("@server_message_title").text(t.message.title),t.message.note&&this.$id("@server_message_note").text(t.message.note),!0;return!1}})}),define("app/view/board",["shared/polyfills","shared/core/component","shared/cookies"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/cookies");t.BoardNameLink=n.extend({onLoad:function(e){var t=this;this.$id("@link").mousedown(function(){o.setQfeedLog(t,"BoardClickthrough"),o.setQueryLog(t,"BoardClickthrough")})}})}),define("app/view/board/blog",["shared/polyfills","shared/core/component","shared/jquery"],function(e,t,i){
var n=e("shared/core/component").Component,o=e("shared/jquery");t.CreateBlog=n.extend({onLoad:function(){var e=this;this.submitted=!1,this.$id("@name").focus(),this.$id("@fake_editor").click(function(){return e.$id("@fake_editor_row").hide(),e.$id("@editor_row").show(),e.child("editor").focus(),!1}),this.$id("@create").click(function(){var t=o.trim(e.$id("@name").val()),i=e.child("subdomain").getInput().val();if(t?e.$id("@name").removeClass("input_validation_error"):(e.$id("@name").addClass("input_validation_error"),e.$id("@name").focus()),i?e.child("subdomain").getInput().removeClass("input_validation_error"):(e.child("subdomain").getInput().addClass("input_validation_error"),t&&e.child("subdomain").getInput().focus()),i&&t&&e.child("subdomain").urlIsOK&&!e.submitted){e.$id("@create").addClass("submit_button_disabled"),e.submitted=!0;var n=e.child("editor").serialize();e.disable(),e.serverCall("create").kwargs({name:t,description:n,url:i,topics:""}).success(function(e){e&&(document.location=e);
}).liveMutate().send()}return!1})},disable:function(){this.child("editor").disable()}})}),define("app/view/board/create_box",["shared/polyfills","shared/core/component","settings","w2.dialog","shared/facebook","view/inline_editor","view/selector"],function(e,t,i){var n=e("shared/core/component").Component,o=e("settings"),s=e("w2.dialog").Dialog,a=e("shared/facebook"),r=e("view/inline_editor").InlineEditor,d=e("view/selector").MultiSelector;t.BoardCreatePostBox=n.extend({onLoad:function(){var e=this.child("title_box"),t=this.child("editor");e.whenOnLoaded(function(){e.setMeaningfulChangeCallback(function(){t.save_draft(!1)})}),t.whenOnLoaded(function(){t.setTitleBox(e)})}}),t.BoardCreatePostTitleBox=n.extend({onLoad:function(){this.editor=this.child("title_editor");var e=this;this.$id("@fake_editor").click(function(){return e.toggle_editor(),!1})},isOnlyWhiteSpace:function(){return this.editor.isOnlyWhiteSpace()},disableEditor:function(){this.editor.disable()},clearEditor:function(){this.editor.clear();
},serialize:function(){return this.editor.serialize()},setMeaningfulChangeCallback:function(e){this.editor.setMeaningfulChangeCallback(e)},toggle_editor:function(){this.$id("@fake_editor_row").hide(),this.$id("@editor_row").show(),this.$id("@editor_row .qtext_editor_content").focus()},titleRequired:function(){this.$id("@title_required").show()},titleRequiredReset:function(){this.$id("@title_required").hide()}}),t.CreateBoardPostEditor=r.extend({onLoad:function(){var e=this;if(this._super.apply(this,arguments),this.$id("@remove_via").click(function(){return e.$id("@via_text").hide(),e.$id("@via").remove(),!1}),this.seenUrls={},this.$id("@fake_editor").click(this.showEditor.bind(this)),this.saved_seen_urls)for(var t=0;t<this.saved_seen_urls.length;t++)this.seenUrls[this.saved_seen_urls[t]]=!0;this.titleBox=null;var i=this.child("topic_selector");i&&i.whenOnSavedResultsChanged(function(t){e._topics=t})},setTitleBox:function(e){this.titleBox=e},showEditor:function(){this.$id("@content").show(),
this.editor.focus()},submitHandler:function(){var e=this;this.input_button_obj.click(function(){if(!e.editor.isOnlyWhiteSpace()||null!==e.preview||e.id){if(e.titleBox){if(e.titleBox.titleRequiredReset(),e.titleBox.isOnlyWhiteSpace())return e.titleBox.toggle_editor(),e.titleBox.titleRequired(),!1;e.titleBox.disableEditor()}e.editor.disable(),e.trigger_request()}return!1})},removeUrl:function(){this.$id("@preview_url").html(""),this.$id("@preview_url_section, #@link_editor_buttons").hide(),this.$id("@remove_url").hide(),this.preview=null,this.editor.focus()},reset:function(){this.titleBox&&this.titleBox.clearEditor(),this.editor.enable(),this.editor.clear(!0),this.$id("@preview_url_section, #@link_editor_buttons").hide(),this.$id("@remove_url").hide(),this.seenUrls={},this.removeUrl(),this.draft_space&&(this.draft_space.draft_id=null)},cancelEditor:function(){this.canSaveDraft()&&null!==this.draft_space.draft_id&&this.save_draft(!1),this.closeDialog()},reportSuccess:function(){},ajax_callback:function(e){
if(this.redirect_on_post&&e)document.location=e;else{if(this.is_dialog)return this.reportSuccess(),void this.closeDialog();this.reset()}},closeDialog:function(){s.dialogFor(this).close_()},getBid:function(){return this.bid?this.bid:null},getBoardName:function(){return null},getVia:function(){return this.$id("@via")?this.$id("@via").val():null},getIsSubmission:function(){return this.is_submission},setIsSubmission:function(e){this.is_submission=e},getLinkURL:function(){var e=this.getLinkPreview();return e?e.url:null},getLinkPreview:function(){return this.preview?this.child("link_editor").getPreviewLinkInfo():null},getTitle:function(){return this.titleBox?this.titleBox.serialize():null},getSeenUrlsAsArray:function(){var e=[];for(var t in this.seenUrls)e.push(t);return e},getLoggedAction:function(){return"PostAdd"},canSaveDraft:function(){return this.draft_space&&!this.save_draft_disabled},enableSaveDraft:function(){this.save_draft_disabled=!1},disableSaveDraft:function(){this.save_draft_disabled=!0;
},onClearDraft:function(){this.reset()},save_draft:function(e){var t=this;if(this.canSaveDraft()){this.disableSaveDraft();var i=e?"save_draft":"save_draft_auto",n=this._get_kwargs();n.window_id=o.windowId,n.target=this.target,n.url=this.url,n.seen_urls=this.getSeenUrlsAsArray();var s=this.serverCall(i).kwargs(n).success(function(e){t.enableSaveDraft(),t.draft_space&&t.draft_space.draft_id!=e&&(t.draft_space.draft_id=e),t.updateSavedState(n.description)}).error(this.enableSaveDraft.bind(this));e&&s.liveMutate(),s.send()}},_get_kwargs:function(){return{draft_space:this.draft_space,bid:this.getBid(),object_id:this.id,name:this.getBoardName(),description:this.get_value(),title:this.getTitle(),link_url:this.getLinkURL(),preview:this.getLinkPreview(),via:this.getVia(),topics:this._topics||[],is_submission:this.getIsSubmission(),fb_uid:a.getFbUid(),fb_access_token:a.getAccessToken(),fb_expires:a.getExpiresIn()}}}),t.BoardTopicMultiSelector=d.extend({whenOnSavedResultsChanged:function(e){this._onSavedResultsChanged=e;
},onSavedResultsChanged:function(){this._onSavedResultsChanged&&this._onSavedResultsChanged(this.saved_results)}})}),define("app/view/board/follow_invite",["shared/polyfills","shared/core/component","w2.dialog","settings"],function(e,t,i){var n=e("shared/core/component").Component,o=e("w2.dialog"),s=e("settings").interface_strings;t.FollowInviteEmailButton=n.extend({onLoad:function(){var e=this;this.$id("@invite").click(function(){return e.setEmailTo(e.email),!1})},setEmailTo:function(e){var t=this;this._dialog=o.createDialog(this).title(null).cancel(null,s.cancel).ok(function(i){var n=i.dialogComponent,o=n.getMessage(),s=n.getSubject(),a=n.name;t.serverCall("invite_to_follow").kwargs({name:a,email:e,msg:o,subject:s}).liveMutate().success(function(){t._dialog.close_()}).send()},this.invite_text).load("invite_dialog",{kwargs:{email:e}})}}),t.InviteToFollowDialogContents=n.extend({onLoad:function(){this.child("msg").focus()},getMessage:function(){return this.child("msg").serialize()},getSubject:function(){
return this.child("subject").serialize()}})}),define("app/view/board/view_tracker",["shared/polyfills","shared/core/component","shared/jquery","shared/viewport"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/core/component"),s=e("shared/jquery"),a=e("shared/viewport");t.instance=null,t.BoardItemViewTracker=n.extend({init:function(){t.instance=this,this.all_board_item_ids={},this.reported_board_item_ids={},this.last_report_time=+new Date,this.rate_limit_ms=3e3},onLoad:function(){var e=this.report.bind(this);document.addEventListener("mousemove",e),document.addEventListener("keypress",e),document.addEventListener("scroll",e)},addBoardItem:function(e,t){this.all_board_item_ids[e]=t},removeBoardItem:function(e,t){delete this.all_board_item_ids[e]},isBoardItemVisible:function(e){var t=o._domids[e];if(!t)return!1;var i=document.getElementById(t);if(!i)return!1;var n=s(i);return a.isElementInViewport(n.children("div:first").get(0))?!1:n.is(":visible")?!0:!1},report:function(){
var e=+new Date;if(!(e<this.last_report_time+this.rate_limit_ms)){this.last_report_time=e;var t=[];for(var i in this.all_board_item_ids){var n=this.all_board_item_ids[i];void 0===this.reported_board_item_ids[n]&&this.isBoardItemVisible(i)&&(t.push(n),this.reported_board_item_ids[n]=!0)}t.length>0&&this.serverCall("report").kwargs({board_item_ids:t}).send()}}})}),define("app/view/board/item",["shared/polyfills","shared/core/component","shared/cookies","app/view/board/view_tracker","view/inline_editor","shared/views"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/cookies"),s=e("app/view/board/view_tracker"),a=e("view/inline_editor").InlineEditor,r=e("shared/views").viewsLogger;t.BoardItemTimestamp=n.extend({onLoad:function(e){var t=this;t.$id("@link").mousedown(function(){o.setQfeedLog(t,"BoardItemClickthrough"),o.setQueryLog(t,"BoardItemClickthrough")})}}),t.BoardItemTitle=n.extend({onLoad:function(e){var t=this;t.$id("@link").mousedown(function(){o.setQfeedLog(t,"BoardItemClickthrough"),
o.setQueryLog(t,"BoardItemClickthrough")})}}),t.LinkBoardItemView=n.extend({onLoad:function(){this._super.apply(this,arguments);var e=this;e.$id("@edit").click(function(){return e.showEditor(),!1}),e.$id("@item").hover(function(t){e.$id("@item").addClass("hover")},function(t){e.$id("@item").removeClass("hover")})},showEditor:function(){this.child("description").child("editor").toggle_editor()}}),t.LinkBoardItemDescriptionInlineEditor=a.extend({_get_kwargs:function(){return{input:this.get_value(),preview:this.child("link_editor").getPreviewLinkInfo()}}}),t.BoardListItem=n.extend({onLoad:function(){s.instance&&s.instance.addBoardItem(this.cid,this.board_item_id)},onUnload:function(){s.instance&&s.instance.removeBoardItem(this.cid,this.board_item_id)}}),t.BoardItem=n.extend({onLoad:function(){r.addComponentToTrack(this)}})}),define("app/view/board/settings",["shared/polyfills","shared/core/component","view/selector"],function(e,t,i){var n=e("shared/core/component").Component,o=e("view/selector").Selector;
t.BlogSubdomainInput=n.extend({onLoad:function(){var e=this;this.urlIsOK=!1,this.$id("@url").on("keyup",function(t){e.checkURL()}),this.$id("@update").click(function(){return e.updateURL(),!1})},checkURL:function(){var e=this,t=this.$id("@url").val();this.serverCall("check_url").kwargs({url:t}).success(function(t){t===!0?e.urlAvailable():t===!1?e.urlNotAvailable():e.urlEmpty()}).error(this.urlNotAvailable.bind(this)).send()},getInput:function(){return this.$id("@url")},urlEmpty:function(){this.urlAvailable(),this.urlIsOK=!1,this.bid&&this.$id("@button").hide()},urlAvailable:function(){this.urlIsOK=!0,this.$id("@domain_unavailable").hide(),this.$id("@url").removeClass("input_validation_error"),this.bid&&this.$id("@button").show()},urlNotAvailable:function(){this.urlIsOK=!1,this.$id("@domain_unavailable").show(),this.$id("@url").addClass("input_validation_error"),this.bid&&this.$id("@button").hide()},updateURL:function(){var e=this.$id("@url").val();return e&&this.serverCall("register_choice").kwargs({
url:e}).success(function(){window.location.reload(!0)}).liveMutate().send(),!1}}),t.BoardParticipantSelector=o.extend({resultWasSelected:function(e){var t=this;this.serverCall("add").kwargs({bid:this.metadata.bid,target_uid:e.data.uid}).success(function(){t.setQuery(""),t.focus()}).liveMutate().send()}})}),define("app/view/board/submission",["shared/polyfills","shared/core/component","w2.dialog","settings"],function(e,t,i){var n=e("shared/core/component").Component,o=e("w2.dialog"),s=e("settings").interface_strings;t.RejectSubmission=n.extend({onLoad:function(){var e=this;this.$id("@link").click(function(){return e._dialog=o.createDialog(e).title(e.title).cancel(null,s.cancel).ok(function(t){var i=t.dialogComponent,n=i.child("comment").serialize();e.serverCall("reject").kwargs({comment:n}).liveMutate().send()},e.button_text).load("comment_dialog"),!1})}}),t.SubmissionView=n.extend({onLoad:function(e){var t=this;this.$id("@item").hover(function(e){t.$id("@delete").show(),t.$id("@item").addClass("hover");
},function(e){t.$id("@delete").hide(),t.$id("@item").removeClass("hover")}),this.$id("@update_accept").click(function(){return t.request("update_accept"),!1}),this.$id("@update").click(function(){return t.request("update"),!1}),this.$id("@edit").click(function(){return t.toggle(),!1}),this.$id("@cancel").click(function(){return t.toggle(),!1})},getNewPreview:function(){return null},request:function(e){var t=this.child("description").serialize(),i=this.child("title").serialize(),n=this.getNewPreview();this.serverCall(e).kwargs({new_description:t,new_title:i,new_preview:n}).liveMutate().send()},toggle:function(){this.$id("@editor").toggle(),this.$id("@content").toggle()}}),t.RejectSubmissionDialogContents=n.extend({onLoad:function(){var e=this;this.$id("@link").click(function(){return e.$id("@comment").toggle(),e.child("comment").focus(),!1})}})}),define("shared/upload",["shared/polyfills","settings"],function(e,t,i){var n=e("settings");t.uploadData=function(e,t,i,o){var s=new window.FormData;
s.append("formkey",n.formkey);for(var a=Object.keys(e),r=0;r<a.length;r++)s.append(a[r],e[a[r]]);for(var d=0;d<t.length;d++)s.append("file",t[d]);var l=new XMLHttpRequest;l.onreadystatechange=function(){if(4==l.readyState){200!=l.status&&o();var e=JSON.parse(l.response);e.success?i(e):o(e)}},l.open("POST","/_/imgupload/upload_POST",!0),l.send(s)}}),define("view/upload",["shared/polyfills","shared/core/component","w2.dialog","shared/jquery","shared/events/index","shared/browser","shared/upload","shared/facebook","shared/loading"],function(e,t,i){var n=e("shared/core/component").Component,o=e("w2.dialog").Dialog,s=e("shared/jquery"),a=e("shared/events/index"),r=e("shared/browser"),d=e("shared/upload"),l=e("shared/facebook"),c=e("shared/loading"),h=r.msie&&r.version<=9;t.UploadDialogContents=n.extend({onLoad:function(){var e=this;if(this.child("upload_form").success(this.uploadSuccess.bind(this)).failure(this.uploadFailure.bind(this)),h)return this.$id("@drop_zone").removeClass("drop_zone"),
this.child("drag_and_drop_form").$id("@drag_and_drop_form").addClass("hidden"),!1;if(this.inlineUploadForm=this.child("upload_web"),this.inlineUploadForm&&(this.inlineUploadForm.setContentForTarget(this.$id("@iframe")),this.inlineUploadForm.setShowPhotoChoiceCallback(function(){e.disableDropZone(),e.onShowInlinePhotoChoice()})),this.handleEvent(a.Types.UPLOAD_DIALOG_DROPZONE,function(t){t.payload.enabled?e.enableDropZone():e.disableDropZone()}),this.child("drag_and_drop_form")){e.addBodyDragoverListener();var t=function(t){t.stopPropagation(),t.preventDefault(),t.originalEvent.dataTransfer.dropEffect="copy",e.child("drag_and_drop_form").$id("@form_title").addClass("drag_and_hover"),e.$id("@drop_zone").addClass("drag_and_hover")},i=function(t){t.stopPropagation(),t.preventDefault(),e.child("drag_and_drop_form").$id("@form_title").removeClass("drag_and_hover"),e.$id("@drop_zone").removeClass("drag_and_hover")};this.child("drag_and_drop_form").setDropZone(this.$id("@drop_zone"),t,i),this.child("drag_and_drop_form").success(this.uploadSuccess.bind(this)).failure(this.uploadFailure.bind(this));
}},disableDropZone:function(){this.$id("@drop_zone").addClass("disabled"),this.child("drag_and_drop_form").$id("@form_title").addClass("disabled")},enableDropZone:function(){this.$id("@drop_zone").removeClass("disabled"),this.child("drag_and_drop_form").$id("@form_title").remove("disabled")},onUnload:function(){this.removeBodyDragoverListener()},removeBodyDragoverListener:function(){s("document, body").off(".uploadDialog")},addBodyDragoverListener:function(){s("document, body").on({"dragenter.uploadDialog":function(e){e.stopPropagation(),e.preventDefault();var t=e.originalEvent.dataTransfer;t.effectAllowed=t.dropEffect="none"},"dragover.uploadDialog":function(e){e.stopPropagation(),e.preventDefault();var t=e.originalEvent.dataTransfer;t.effectAllowed=t.dropEffect="none"}})},uploadSuccess:function(){},uploadFailure:function(){s(".drop_zone").removeClass("drag_and_hover"),this.child("drag_and_drop_form").$id("@form_title").removeClass("drag_and_hover"),this.child("upload_form").hideSpinner();
},onShowInlinePhotoChoice:function(){this.child("drag_and_drop_form").$id("@form_title").text(this.click_best_text),s("h3").removeClass("drag_and_hover"),this.$id("@drop_zone").removeClass("drag_and_hover")}}),t.UploadBaseForm=n.extend({onUpload:function(e){return e&&!e.success?(e.message&&alert(e.message),void(this._failureCallback&&this._failureCallback(e))):void(this._successCallback&&this._successCallback(e))},success:function(e){return this._successCallback=e,this},failure:function(e){return this._failureCallback=e,this},_uploadFiles:function(e){var t=this,i=this.$id("@form").get(0);if(h)return s(document).one("quora_file_upload",function(e,i){t.onUpload(i)}),void i.submit();var n={};s.each(i,function(e,t){"hidden"==t.type&&(n[t.name]=t.value)});var o=this.onUpload.bind(this);d.uploadData(n,e,o,o)}}),t.UploadFileForm=t.UploadBaseForm.extend({onLoad:function(){this._super.apply(this,arguments);var e=this;e.file_input=e.$id("@file"),e.file_button=e.$id("@file_button"),e.shouldShowUploadButton=!h&&e.file_button.length,
e.$id("@upload_spinner").append(c.createLoadingDotsElement()),this.handleEvent(a.Types.UPLOAD_DIALOG_LOADING_STATE,function(t){"loading"==t.payload.state?e.showSpinner():e.hideSpinner()}),e.file_input.on("change",function(){var t=e.$id("@file")[0].files;e.showSpinner(),e._uploadFiles(t)}),e.file_button.on("click",function(){e.file_input.click()}),e._showInput()},_showInput:function(){this.shouldShowUploadButton?(this.file_input.addClass("hidden"),this.file_button.removeClass("hidden")):(this.file_button.addClass("hidden"),this.file_input.removeClass("hidden"))},_hideInput:function(){this.file_button.addClass("hidden"),this.file_input.addClass("hidden")},showSpinner:function(){this._hideInput(),this.$id("@upload_spinner").removeClass("hidden"),this.emitEvent({type:a.Types.UPLOAD_DIALOG_DROPZONE,payload:{enabled:!1}})},hideSpinner:function(){this.$id("@upload_spinner").addClass("hidden"),this._showInput(),this.emitEvent({type:a.Types.UPLOAD_DIALOG_DROPZONE,payload:{enabled:!0}})}}),t.DragAndDropForm=t.UploadBaseForm.extend({
setDropZone:function(e,t,i){this.dropZoneElement=e,this.dropZoneElement.on("dragover",t),this.dropZoneElement.on("dragleave",i),this.addDropEventListener()},addDropEventListener:function(){this.dropEventBound||this.dropZoneElement&&(this.onDropListener=this.onDrop.bind(this),this.dropZoneElement[0].addEventListener("drop",this.onDropListener,!1),this.dropEventBound=!0)},removeDropEventListener:function(){this.dropEventBound&&this.dropZoneElement&&(this.dropZoneElement[0].removeEventListener("drop",this.onDropListener),this.dropEventBound=!1)},onUnload:function(){this.removeDropEventListener()},onDrop:function(e){e&&e.dataTransfer&&(e.stopPropagation(),e.preventDefault(),this.emitEvent({type:a.Types.UPLOAD_DIALOG_LOADING_STATE,payload:{state:"loading"}}),this._uploadFiles(e.dataTransfer.files))}}),t.EditPhotoDialogContents=t.UploadDialogContents.extend({onLoad:function(){this._super.apply(this,arguments),this.$id("@from_facebook").on("click",this.fetchFacebookPicture.bind(this));var e=this;
e.addBodyDragoverListener();var t=function(t){t.stopPropagation(),t.preventDefault(),t.originalEvent.dataTransfer.dropEffect="copy",e.child("drag_and_drop_form").$id("@form_title").addClass("drag_and_hover"),e.$id("@drop_zone").addClass("drag_and_hover")},i=function(t){t.stopPropagation(),t.preventDefault(),e.child("drag_and_drop_form").$id("@form_title").removeClass("drag_and_hover"),e.$id("@drop_zone").removeClass("drag_and_hover")};return this.child("drag_and_drop_form").setDropZone(this.$id("@drop_zone"),t,i),this.child("drag_and_drop_form").success(this.uploadSuccess.bind(this)),this.child("upload_form").success(this.uploadSuccess.bind(this)),!1},fetchFacebookPicture:function(){if(this.fb_uid){var e=this;l.onInit(function(){var t="/"+e.fb_uid+"/picture?type=large";window.FB.api(t,function(t){var i=t.data;i&&i.url?(e.$id("@web_upload").addClass("hidden"),e.$id("@from_facebook").addClass("hidden"),e.child("upload_web").$id("@url").addClass("hidden").val(i.url),e.child("upload_web").$id("@download").click(),
e.$id("@web_upload").removeClass("hidden")):alert(e.no_fb_picture_error)})})}},uploadSuccess:function(e){e.need_thumb_selection?this.serverCall("upload").kwargs({target_id:this.target_id,target:this.target}).contentFor(this.$id("@iframe")).success(this.onShowInlinePhotoChoice.bind(this)).send():o.dialogFor(this).close_()}})}),define("app/view/bug_report",["shared/polyfills","shared/core/component","shared/jquery","view/modal","view/upload"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/jquery"),s=e("view/modal").Base,a=e("view/upload");t.BugReportModalLink=n.extend({onLoad:function(){var e=this;this.$id("@send_feedback").on("click",function(t){t.preventDefault(),e.createModal("load_inner").show()})}}),t.BugReportModal=s.extend({onLoad:function(){var e=this;this.child("upload_form").success(this.uploadSuccess.bind(this)).failure(this.uploadFailure.bind(this)),this.$id("@editor").focus(),this.$id("@close_button").click(function(){e._closeModal()}),this.$id("@cancel_button").click(function(){
e._closeModal()}),this.$id("@submit_button").click(function(t){t.preventDefault();var i=e.$id("@editor").val().trim(),n=e.$id("@photo_key").val();return e.serverCall("submit_feedback").kwargs({target:e.target,msg:i,photo_key:n}).success(function(){i&&e._closeModal()}).sendOnlyOnce(),!1})},uploadSuccess:function(e){this.$id("@photo_key").val(e.photo_key),this.serverCall("upload").kwargs({photo_key:e.photo_key,target:this.target}).contentFor(this.$id("@iframe")).send()},uploadFailure:function(){o(".drop_zone").removeClass("drag_and_hover"),this.child("drag_and_drop_form").$id("@form_title").removeClass("drag_and_hover"),this.child("upload_form").hideSpinner()}}),t.BugReportMain=a.UploadDialogContents.extend({onLoad:function(){this._super.apply(this,arguments);var e=this;this.$id("@submit_report").click(function(t){t.preventDefault(),e.$id("@submit_report").prop("disabled",!0);var i,n=e.$id("@subject").val(),s=e.$id("@description").val(),a=e.$id("@photo_key").val(),r=e.$id("@project").val(),d=e.$id("@priorities").val();
return i=r===e.$id("@queue_project").val()?o.map(e.$id("@select_queues input:checked"),function(e){return e.value}):null,e.serverCall("submit_report").kwargs({target:e.target,subject:n,description:s,photo_key:a,project:r,priority:d,queue_types:i}).success(function(e){window.location.reload()}).sendOnlyOnce(),!1}),this.$id("@project").change(function(t){var i=e.$id("@select_queues");o(this).val()===e.$id("@queue_project").val()?i.show():i.hide()})},uploadSuccess:function(e){this.$id("@photo_key").val(e.photo_key),this.serverCall("upload").kwargs({photo_key:e.photo_key,target:this.target}).contentFor(this.$id("@upload_screenshot")).send()}}),t.BugReportTableCell=n.extend({onLoad:function(){var e=this;this.$id("@delete_report").click(function(t){return e.serverCall("delete_report").kwargs({report_id:e.report_id}).success(function(e){window.location.reload()}).send(),!1})}})}),define("app/view/comment",["shared/polyfills","shared/core/component","shared/logging"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/logging");
t.CommentLink=n.extend({onLoad:function(){var e=this,t=e.$id("@view_comment_link");e.hasCheckedTriggeringModal=!1,t.on("click",function(t){o.log("comments_toggled",{comment_type:e.comment_type,object_id:e.object_id})})},maybeTriggerModal:function(){var e=this;e.is_logged_in&&("board_item_id"===e.type||e.hasCheckedTriggeringModal||(e.hasCheckedTriggeringModal=!0,e.serverCall("should_trigger_warning_modal").success(function(t){t&&e.triggerModal()}).send()))},triggerModal:function(){this.createModal("load_modal").show(),this.serverCall("mark_education_modal_seen").send()}})}),define("shared/mathify",["shared/polyfills","shared/jquery"],function(e,t,i){var n=e("shared/jquery");t.iterMaths=function(e,t){return a(e,function(e,i){return i&&t(i,e),""})};var o=function(e,t){return e?"<b>"+e+"</b>":t},s=t.getParts=function(e){for(var t,i,n,o,s,a="\\s\\S",r=new RegExp("\\[math\\](["+a+"]+?)\\[\\/math\\]","g"),d=[],l=0;t=r.exec(e);)i=t[0],n=t[1],o=r.lastIndex,s=o-i.length,l!=s&&d.push([e.slice(l,s)]),
l=o,d.push([i,n]);return l!=e.length&&d.push([e.substr(l)]),d},a=t.mathify=function(e,t){t=t||o;for(var i=s(e),n="",a=0;a<i.length;a++)n+=t.apply(window,i[a]);return n||e};t.renderMath=function(e){e instanceof n&&(e=e.get(0)),window.MathJax&&MathJax.Hub&&MathJax.Hub.Queue(["Typeset",MathJax.Hub,e])}}),define("shared/twitter",["shared/polyfills","shared/onload","shared/util","shared/loadjs"],function(e,t,i){var n=e("shared/onload"),o=e("shared/util"),s=e("shared/loadjs").loadJS,a=!1,r=[],d=o.once(function(){var e=window.twttr={_events:[],ready:function(t){e._events.push(t)}};s("//platform.twitter.com/widgets.js",function(){window.twttr.ready(function(e){for(a=!0;r.length;)r.pop().call()})})});t.onInit=function(e){a?e():(r.push(e),n.execAfterLoadDelayed(d))}}),define("shared/twitter_oembed",["shared/polyfills","shared/core/rpc","shared/twitter","shared/errors"],function(e,t,i){function n(e,t,i){var n=a(e);n?t(n,!1):o(e,function(n){if(n){var o=document.createElement("iframe");o.className="tweet-content",
o.srcdoc=n.html,t(o,!0),s(e,o)}else i(null)},i)}function o(e,t,i){r.rpc("/twitter/get_twitter_oembed_json_POST").kwargs({url:e}).success(function(e){"error"in e?i(e):t(e)}).error(i).send()}function s(e,t){var i=c[e];i?i.push(t):c[e]=[t]}function a(e){for(var t=c[e]||[],i=0;i<t.length;i++){var n=t[i],o=n.getElementsByTagName("twitterwidget");if(!n.isConnected&&o.length>0)return n}return null}var r=e("shared/core/rpc"),d=e("shared/twitter"),l=e("shared/errors"),c={};t.getTweetData=n;var h=t.loadEmbeds=function(e){d.onInit(function(){window.twttr&&window.twttr.widgets?window.twttr.widgets.load(e):l.logJsError("Twitter","Error: Twitter JS initialized but widgets not available")})},u=function(e){d.onInit(function(){window.twttr&&window.twttr.events?window.twttr.events.bind("loaded",e):l.logJsError("Twitter","Error: Twitter JS initialized but events not available")})};t.renderTweetIFrame=function(e){e.onload=function(){var t=e.contentDocument||e.contentWindow.document;u(function(){e.style.height=t.body.scrollHeight+"px";
}),h(t.body)}}}),define("third_party/prettify",["shared/polyfills"],function(e,t,i){!function(){var e=null;window.PR_SHOULD_USE_CONTINUATION=!0,function(){function t(e){function t(e){var t=e.charCodeAt(0);if(92!==t)return t;var i=e.charAt(1);return(t=h[i])?t:i>="0"&&"7">=i?parseInt(e.substring(1),8):"u"===i||"x"===i?parseInt(e.substring(2),16):e.charCodeAt(1)}function i(e){return 32>e?(16>e?"\\x0":"\\x")+e.toString(16):(e=String.fromCharCode(e),"\\"===e||"-"===e||"]"===e||"^"===e?"\\"+e:e)}function n(e){var n=e.substring(1,e.length-1).match(/\\u[\dA-Fa-f]{4}|\\x[\dA-Fa-f]{2}|\\[0-3][0-7]{0,2}|\\[0-7]{1,2}|\\[\S\s]|[^\\]/g),e=[],o="^"===n[0],s=["["];o&&s.push("^");for(var o=o?1:0,a=n.length;a>o;++o){var r=n[o];if(/\\[bdsw]/i.test(r))s.push(r);else{var d,r=t(r);a>o+2&&"-"===n[o+1]?(d=t(n[o+2]),o+=2):d=r,e.push([r,d]),65>d||r>122||(65>d||r>90||e.push([32|Math.max(65,r),32|Math.min(d,90)]),97>d||r>122||e.push([-33&Math.max(97,r),-33&Math.min(d,122)]))}}for(e.sort(function(e,t){return e[0]-t[0]||t[1]-e[1];
}),n=[],a=[],o=0;o<e.length;++o)r=e[o],r[0]<=a[1]+1?a[1]=Math.max(a[1],r[1]):n.push(a=r);for(o=0;o<n.length;++o)r=n[o],s.push(i(r[0])),r[1]>r[0]&&(r[1]+1>r[0]&&s.push("-"),s.push(i(r[1])));return s.push("]"),s.join("")}function o(e){for(var t=e.source.match(/\[(?:[^\\\]]|\\[\S\s])*]|\\u[\dA-Fa-f]{4}|\\x[\dA-Fa-f]{2}|\\\d+|\\[^\dux]|\(\?[!:=]|[()^]|[^()[\\^]+/g),o=t.length,r=[],d=0,l=0;o>d;++d){var c=t[d];"("===c?++l:"\\"===c.charAt(0)&&(c=+c.substring(1))&&(l>=c?r[c]=-1:t[d]=i(c))}for(d=1;d<r.length;++d)-1===r[d]&&(r[d]=++s);for(l=d=0;o>d;++d)c=t[d],"("===c?(++l,r[l]||(t[d]="(?:")):"\\"===c.charAt(0)&&(c=+c.substring(1))&&l>=c&&(t[d]="\\"+r[c]);for(d=0;o>d;++d)"^"===t[d]&&"^"!==t[d+1]&&(t[d]="");if(e.ignoreCase&&a)for(d=0;o>d;++d)c=t[d],e=c.charAt(0),c.length>=2&&"["===e?t[d]=n(c):"\\"!==e&&(t[d]=c.replace(/[A-Za-z]/g,function(e){return e=e.charCodeAt(0),"["+String.fromCharCode(-33&e,32|e)+"]"}));return t.join("")}for(var s=0,a=!1,r=!1,d=0,l=e.length;l>d;++d){var c=e[d];if(c.ignoreCase)r=!0;else if(/[a-z]/i.test(c.source.replace(/\\u[\da-f]{4}|\\x[\da-f]{2}|\\[^UXux]/gi,""))){
a=!0,r=!1;break}}for(var h={b:8,t:9,n:10,v:11,f:12,r:13},u=[],d=0,l=e.length;l>d;++d){if(c=e[d],c.global||c.multiline)throw Error(""+c);u.push("(?:"+o(c)+")")}return RegExp(u.join("|"),r?"gi":"g")}function i(e,t){function i(e){var d=e.nodeType;if(1==d){if(!n.test(e.className)){for(d=e.firstChild;d;d=d.nextSibling)i(d);d=e.nodeName.toLowerCase(),("br"===d||"li"===d)&&(o[r]="\n",a[r<<1]=s++,a[r++<<1|1]=e)}}else(3==d||4==d)&&(d=e.nodeValue,d.length&&(d=t?d.replace(/\r\n?/g,"\n"):d.replace(/[\t\n\r ]+/g," "),o[r]=d,a[r<<1]=s,s+=d.length,a[r++<<1|1]=e))}var n=/(?:^|\s)nocode(?:\s|$)/,o=[],s=0,a=[],r=0;return i(e),{a:o.join("").replace(/\n$/,""),d:a}}function n(e,t,i,n){t&&(e={a:t,e:e},i(e),n.push.apply(n,e.g))}function o(e){for(var t=void 0,i=e.firstChild;i;i=i.nextSibling)var n=i.nodeType,t=1===n?t?e:i:3===n&&y.test(i.nodeValue)?e:t;return t===e?void 0:t}function s(i,o){function s(e){for(var t=e.e,i=[t,"pln"],c=0,h=e.a.match(a)||[],u={},p=0,f=h.length;f>p;++p){var _,g=h[p],m=u[g],v=void 0;if("string"==typeof m)_=!1;else{
var w=r[g.charAt(0)];if(w)v=g.match(w[1]),m=w[0];else{for(_=0;d>_;++_)if(w=o[_],v=g.match(w[1])){m=w[0];break}v||(m="pln")}!(_=m.length>=5&&"lang-"===m.substring(0,5))||v&&"string"==typeof v[1]||(_=!1,m="src"),_||(u[g]=m)}if(w=c,c+=g.length,_){_=v[1];var b=g.indexOf(_),y=b+_.length;v[2]&&(y=g.length-v[2].length,b=y-_.length),m=m.substring(5),n(t+w,g.substring(0,b),s,i),n(t+w+b,_,l(m,_),i),n(t+w+y,g.substring(y),s,i)}else i.push(t+w,m)}e.g=i}var a,r={};!function(){for(var n=i.concat(o),s=[],d={},l=0,c=n.length;c>l;++l){var h=n[l],u=h[3];if(u)for(var p=u.length;--p>=0;)r[u.charAt(p)]=h;h=h[1],u=""+h,d.hasOwnProperty(u)||(s.push(h),d[u]=e)}s.push(/[\S\s]/),a=t(s)}();var d=o.length;return s}function a(t){var i=[],n=[];t.tripleQuotedStrings?i.push(["str",/^(?:'''(?:[^'\\]|\\[\S\s]|''?(?=[^']))*(?:'''|$)|"""(?:[^"\\]|\\[\S\s]|""?(?=[^"]))*(?:"""|$)|'(?:[^'\\]|\\[\S\s])*(?:'|$)|"(?:[^"\\]|\\[\S\s])*(?:"|$))/,e,"'\""]):t.multiLineStrings?i.push(["str",/^(?:'(?:[^'\\]|\\[\S\s])*(?:'|$)|"(?:[^"\\]|\\[\S\s])*(?:"|$)|`(?:[^\\`]|\\[\S\s])*(?:`|$))/,e,"'\"`"]):i.push(["str",/^(?:'(?:[^\n\r'\\]|\\.)*(?:'|$)|"(?:[^\n\r"\\]|\\.)*(?:"|$))/,e,"\"'"]),
t.verbatimStrings&&n.push(["str",/^@"(?:[^"]|"")*(?:"|$)/,e]);var o=t.hashComments;if(o&&(t.cStyleComments?(o>1?i.push(["com",/^#(?:##(?:[^#]|#(?!##))*(?:###|$)|.*)/,e,"#"]):i.push(["com",/^#(?:(?:define|e(?:l|nd)if|else|error|ifn?def|include|line|pragma|undef|warning)\b|[^\n\r]*)/,e,"#"]),n.push(["str",/^<(?:(?:(?:\.\.\/)*|\/?)(?:[\w-]+(?:\/[\w-]+)+)?[\w-]+\.h(?:h|pp|\+\+)?|[a-z]\w*)>/,e])):i.push(["com",/^#[^\n\r]*/,e,"#"])),t.cStyleComments&&(n.push(["com",/^\/\/[^\n\r]*/,e]),n.push(["com",/^\/\*[\S\s]*?(?:\*\/|$)/,e])),o=t.regexLiterals){var a=(o=o>1?"":"\n\r")?".":"[\\S\\s]";n.push(["lang-regex",RegExp("^(?:^^\\.?|[+-]|[!=]=?=?|\\#|%=?|&&?=?|\\(|\\*=?|[+\\-]=|->|\\/=?|::?|<<?=?|>>?>?=?|,|;|\\?|@|\\[|~|{|\\^\\^?=?|\\|\\|?=?|break|case|continue|delete|do|else|finally|instanceof|return|throw|try|typeof)\\s*("+("/(?=[^/*"+o+"])(?:[^/\\x5B\\x5C"+o+"]|\\x5C"+a+"|\\x5B(?:[^\\x5C\\x5D"+o+"]|\\x5C"+a+")*(?:\\x5D|$))+/")+")")])}return(o=t.types)&&n.push(["typ",o]),o=(""+t.keywords).replace(/^ | $/g,""),
o.length&&n.push(["kwd",RegExp("^(?:"+o.replace(/[\s,]+/g,"|")+")\\b"),e]),i.push(["pln",/^\s+/,e," \r\n	 "]),o="^.[^\\s\\w.$@'\"`/\\\\]*",t.regexLiterals&&(o+="(?!s*/)"),n.push(["lit",/^@[$_a-z][\w$@]*/i,e],["typ",/^(?:[@_]?[A-Z]+[a-z][\w$@]*|\w+_t\b)/,e],["pln",/^[$_a-z][\w$@]*/i,e],["lit",/^(?:0x[\da-f]+|(?:\d(?:_\d+)*\d*(?:\.\d*)?|\.\d\+)(?:e[+-]?\d+)?)[a-z]*/i,e,"0123456789"],["pln",/^\\[\S\s]?/,e],["pun",RegExp(o),e]),s(i,n)}function r(e,t,i){function n(e){var t=e.nodeType;if(1!=t||s.test(e.className)){if((3==t||4==t)&&i){var d=e.nodeValue,l=d.match(a);l&&(t=d.substring(0,l.index),e.nodeValue=t,(d=d.substring(l.index+l[0].length))&&e.parentNode.insertBefore(r.createTextNode(d),e.nextSibling),o(e),t||e.parentNode.removeChild(e))}}else if("br"===e.nodeName)o(e),e.parentNode&&e.parentNode.removeChild(e);else for(e=e.firstChild;e;e=e.nextSibling)n(e)}function o(e){function t(e,i){var n=i?e.cloneNode(!1):e,o=e.parentNode;if(o){var o=t(o,1),s=e.nextSibling;o.appendChild(n);for(var a=s;a;a=s)s=a.nextSibling,
o.appendChild(a)}return n}for(;!e.nextSibling;)if(e=e.parentNode,!e)return;for(var i,e=t(e.nextSibling,0);(i=e.parentNode)&&1===i.nodeType;)e=i;l.push(e)}for(var s=/(?:^|\s)nocode(?:\s|$)/,a=/\r\n?|\n/,r=e.ownerDocument,d=r.createElement("li");e.firstChild;)d.appendChild(e.firstChild);for(var l=[d],c=0;c<l.length;++c)n(l[c]);t===(0|t)&&l[0].setAttribute("value",t);var h=r.createElement("ol");h.className="linenums";for(var t=Math.max(0,t-1|0)||0,c=0,u=l.length;u>c;++c)d=l[c],d.className="L"+(c+t)%10,d.firstChild||d.appendChild(r.createTextNode(" ")),h.appendChild(d);e.appendChild(h)}function d(e,t){for(var i=t.length;--i>=0;){var n=t[i];k.hasOwnProperty(n)?h.console&&console.warn("cannot override language handler %s",n):k[n]=e}}function l(e,t){return e&&k.hasOwnProperty(e)||(e=/^\s*</.test(t)?"default-markup":"default-code"),k[e]}function c(e){var t=e.h;try{var n=i(e.c,e.i),o=n.a;e.a=o,e.d=n.d,e.e=0,l(t,o)(e);var s=/\bMSIE\s(\d+)/.exec(navigator.userAgent),s=s&&+s[1]<=8,t=/\n/g,a=e.a,r=a.length,n=0,d=e.d,c=d.length,o=0,u=e.g,p=u.length,f=0;
u[p]=r;var _,g;for(g=_=0;p>g;)u[g]!==u[g+2]?(u[_++]=u[g++],u[_++]=u[g++]):g+=2;for(p=_,g=_=0;p>g;){for(var m=u[g],v=u[g+1],w=g+2;p>=w+2&&u[w+1]===v;)w+=2;u[_++]=m,u[_++]=v,g=w}u.length=_;var b,y=e.c;y&&(b=y.style.display,y.style.display="none");try{for(;c>o;){var C,k=d[o+2]||r,x=u[f+2]||r,w=Math.min(k,x),S=d[o+1];if(1!==S.nodeType&&(C=a.substring(n,w))){s&&(C=C.replace(t,"\r")),S.nodeValue=C;var E=S.ownerDocument,T=E.createElement("span");T.className=u[f+1];var $=S.parentNode;$.replaceChild(T,S),T.appendChild(S),k>n&&(d[o+1]=S=E.createTextNode(a.substring(w,k)),$.insertBefore(S,T.nextSibling))}n=w,n>=k&&(o+=2),n>=x&&(f+=2)}}finally{y&&(y.style.display=b)}}catch(L){h.console&&console.log(L&&L.stack||L)}}var h=window,u=["break,continue,do,else,for,if,return,while"],p=[[u,"auto,case,char,const,default,double,enum,extern,float,goto,inline,int,long,register,short,signed,sizeof,static,struct,switch,typedef,union,unsigned,void,volatile"],"catch,class,delete,false,import,new,operator,private,protected,public,this,throw,true,try,typeof"],f=[p,"alignof,align_union,asm,axiom,bool,concept,concept_map,const_cast,constexpr,decltype,delegate,dynamic_cast,explicit,export,friend,generic,late_check,mutable,namespace,nullptr,property,reinterpret_cast,static_assert,static_cast,template,typeid,typename,using,virtual,where"],_=[p,"abstract,assert,boolean,byte,extends,final,finally,implements,import,instanceof,interface,null,native,package,strictfp,super,synchronized,throws,transient"],g=[p,"abstract,as,base,bool,by,byte,checked,decimal,delegate,descending,dynamic,event,finally,fixed,foreach,from,group,implicit,in,interface,internal,into,is,let,lock,null,object,out,override,orderby,params,partial,readonly,ref,sbyte,sealed,stackalloc,string,select,uint,ulong,unchecked,unsafe,ushort,var,virtual,where"],p=[p,"debugger,eval,export,function,get,null,set,undefined,var,with,Infinity,NaN"],m=[u,"and,as,assert,class,def,del,elif,except,exec,finally,from,global,import,in,is,lambda,nonlocal,not,or,pass,print,raise,try,with,yield,False,True,None"],v=[u,"alias,and,begin,case,class,def,defined,elsif,end,ensure,false,in,module,next,nil,not,or,redo,rescue,retry,self,super,then,true,undef,unless,until,when,yield,BEGIN,END"],w=[u,"as,assert,const,copy,drop,enum,extern,fail,false,fn,impl,let,log,loop,match,mod,move,mut,priv,pub,pure,ref,self,static,struct,true,trait,type,unsafe,use"],u=[u,"case,done,elif,esac,eval,fi,function,in,local,set,then,until"],b=/^(DIR|FILE|vector|(de|priority_)?queue|list|stack|(const_)?iterator|(multi)?(set|map)|bitset|u?(int|float)\d*)\b/,y=/\S/,C=a({
keywords:[f,g,p,"caller,delete,die,do,dump,elsif,eval,exit,foreach,for,goto,if,import,last,local,my,next,no,our,print,package,redo,require,sub,undef,unless,until,use,wantarray,while,BEGIN,END",m,v,u],hashComments:!0,cStyleComments:!0,multiLineStrings:!0,regexLiterals:!0}),k={};d(C,["default-code"]),d(s([],[["pln",/^[^<?]+/],["dec",/^<!\w[^>]*(?:>|$)/],["com",/^<\!--[\S\s]*?(?:--\>|$)/],["lang-",/^<\?([\S\s]+?)(?:\?>|$)/],["lang-",/^<%([\S\s]+?)(?:%>|$)/],["pun",/^(?:<[%?]|[%?]>)/],["lang-",/^<xmp\b[^>]*>([\S\s]+?)<\/xmp\b[^>]*>/i],["lang-js",/^<script\b[^>]*>([\S\s]*?)(<\/script\b[^>]*>)/i],["lang-css",/^<style\b[^>]*>([\S\s]*?)(<\/style\b[^>]*>)/i],["lang-in.tag",/^(<\/?[a-z][^<>]*>)/i]]),["default-markup","htm","html","mxml","xhtml","xml","xsl"]),d(s([["pln",/^\s+/,e," 	\r\n"],["atv",/^(?:"[^"]*"?|'[^']*'?)/,e,"\"'"]],[["tag",/^^<\/?[a-z](?:[\w-.:]*\w)?|\/?>$/i],["atn",/^(?!style[\s=]|on)[a-z](?:[\w:-]*\w)?/i],["lang-uq.val",/^=\s*([^\s"'>]*(?:[^\s"'\/>]|\/(?=\s)))/],["pun",/^[\/<->]+/],["lang-js",/^on\w+\s*=\s*"([^"]+)"/i],["lang-js",/^on\w+\s*=\s*'([^']+)'/i],["lang-js",/^on\w+\s*=\s*([^\s"'>]+)/i],["lang-css",/^style\s*=\s*"([^"]+)"/i],["lang-css",/^style\s*=\s*'([^']+)'/i],["lang-css",/^style\s*=\s*([^\s"'>]+)/i]]),["in.tag"]),
d(s([],[["atv",/^[\S\s]+/]]),["uq.val"]),d(a({keywords:f,hashComments:!0,cStyleComments:!0,types:b}),["c","cc","cpp","cxx","cyc","m"]),d(a({keywords:"null,true,false"}),["json"]),d(a({keywords:g,hashComments:!0,cStyleComments:!0,verbatimStrings:!0,types:b}),["cs"]),d(a({keywords:_,cStyleComments:!0}),["java"]),d(a({keywords:u,hashComments:!0,multiLineStrings:!0}),["bash","bsh","csh","sh"]),d(a({keywords:m,hashComments:!0,multiLineStrings:!0,tripleQuotedStrings:!0}),["cv","py","python"]),d(a({keywords:"caller,delete,die,do,dump,elsif,eval,exit,foreach,for,goto,if,import,last,local,my,next,no,our,print,package,redo,require,sub,undef,unless,until,use,wantarray,while,BEGIN,END",hashComments:!0,multiLineStrings:!0,regexLiterals:2}),["perl","pl","pm"]),d(a({keywords:v,hashComments:!0,multiLineStrings:!0,regexLiterals:!0}),["rb","ruby"]),d(a({keywords:p,cStyleComments:!0,regexLiterals:!0}),["javascript","js"]),d(a({keywords:"all,and,by,catch,class,else,extends,false,finally,for,if,in,is,isnt,loop,new,no,not,null,of,off,on,or,return,super,then,throw,true,try,unless,until,when,while,yes",
hashComments:3,cStyleComments:!0,multilineStrings:!0,tripleQuotedStrings:!0,regexLiterals:!0}),["coffee"]),d(a({keywords:w,cStyleComments:!0,multilineStrings:!0}),["rc","rs","rust"]),d(s([],[["str",/^[\S\s]+/]]),["regex"]);var x=h.PR={createSimpleLexer:s,registerLangHandler:d,sourceDecorator:a,PR_ATTRIB_NAME:"atn",PR_ATTRIB_VALUE:"atv",PR_COMMENT:"com",PR_DECLARATION:"dec",PR_KEYWORD:"kwd",PR_LITERAL:"lit",PR_NOCODE:"nocode",PR_PLAIN:"pln",PR_PUNCTUATION:"pun",PR_SOURCE:"src",PR_STRING:"str",PR_TAG:"tag",PR_TYPE:"typ",prettyPrintOne:h.prettyPrintOne=function(e,t,i){var n=document.createElement("div");return n.innerHTML="<pre>"+e+"</pre>",n=n.firstChild,i&&r(n,i,!0),c({h:t,j:i,c:n,i:1}),n.innerHTML},prettyPrint:h.prettyPrint=function(t,i){function n(){for(var i=h.PR_SHOULD_USE_CONTINUATION?f.now()+250:1/0;g<d.length&&f.now()<i;g++){for(var s=d[g],l=k,u=s;u=u.previousSibling;){var p=u.nodeType,x=(7===p||8===p)&&u.nodeValue;if(x?!/^\??prettify\b/.test(x):3!==p||/\S/.test(u.nodeValue))break;
if(x){l={},x.replace(/\b(\w+)=([\w%+\-.:]+)/g,function(e,t,i){l[t]=i});break}}if(u=s.className,(l!==k||v.test(u))&&!w.test(u)){for(p=!1,x=s.parentNode;x;x=x.parentNode)if(C.test(x.tagName)&&x.className&&v.test(x.className)){p=!0;break}if(!p){if(s.className+=" prettyprinted",p=l.lang,!p){var S,p=u.match(m);!p&&(S=o(s))&&y.test(S.tagName)&&(p=S.className.match(m)),p&&(p=p[1])}if(b.test(s.tagName))x=1;else var x=s.currentStyle,E=a.defaultView,x=(x=x?x.whiteSpace:E&&E.getComputedStyle?E.getComputedStyle(s,e).getPropertyValue("white-space"):0)&&"pre"===x.substring(0,3);E=l.linenums,(E="true"===E||+E)||(E=(E=u.match(/\blinenums\b(?::(\d+))?/))?E[1]&&E[1].length?+E[1]:!0:!1),E&&r(s,E,x),_={h:p,c:s,j:E,i:x},c(_)}}}g<d.length?setTimeout(n,250):"function"==typeof t&&t()}for(var s=i||document.body,a=s.ownerDocument||document,s=[s.getElementsByTagName("pre"),s.getElementsByTagName("code"),s.getElementsByTagName("xmp")],d=[],l=0;l<s.length;++l)for(var u=0,p=s[l].length;p>u;++u)d.push(s[l][u]);var s=e,f=Date;
f.now||(f={now:function(){return+new Date}});var _,g=0,m=/\blang(?:uage)?-([\w.]+)(?!\S)/,v=/\bprettyprint\b/,w=/\bprettyprinted\b/,b=/pre|xmp/i,y=/^code$/i,C=/^(?:pre|code|xmp)$/i,k={};n()}};"function"==typeof define&&define.amd&&define("google-code-prettify",[],function(){return x})}()}()}),define("shared/prettyprint",["shared/polyfills","third_party/prettify"],function(e,t,i){e("third_party/prettify"),t.prettyPrint=window.prettyPrint}),define("shared/qtext",["shared/polyfills","shared/jquery","shared/mathify","shared/twitter_oembed","shared/prettyprint"],function(e,t,i){var n=e("shared/jquery"),o=e("shared/mathify").renderMath,s=e("shared/twitter_oembed").loadEmbeds,a=e("shared/prettyprint").prettyPrint;t.renderQText=function(e){e instanceof n&&(e=e.get(0)),o(e),s(e),a()}}),define("app/view/common",["shared/polyfills","shared/core/component","view/inline_editor","shared/events/index","shared/qtext"],function(e,t,i){var n=e("shared/core/component").Component,o=e("view/inline_editor"),s=e("shared/events/index"),a=o.InlineEditor,r=e("shared/qtext").renderQText;
t.SuggestedEditSaveButton=n.extend({onLoad:function(){var e=this;this.$id("@accept").click(function(){return e.serverCall("publish_edit").liveMutate().send(),!1})}}),t.Content=n.extend({onLoad:function(){this.$content=this.$id("@content"),this.$editor=this.$id("@editor"),this.bindEditorCallbacks(),this.editorFetched=this.editor_loaded,this.editorLoaded=this.editor_loaded,r(this.$content)},toggle:function(e){this.emitEvent({type:s.Types.QTEXT_EXPANDABLE_STATE,payload:{content_type:this.content_type,oid:this.oid}});var t=this.$content.hasClass("hidden");null!=e&&(t=e),t?this.showContent():this.showEditor()},showContent:function(){this.$content.removeClass("hidden"),this.$editor.addClass("hidden")},showEditor:function(){return this.editorLoaded?(this.$content.addClass("hidden"),void this.$editor.removeClass("hidden")):(this.$id("@loading").removeClass("hidden"),void this.fetchEditor())},fetchEditor:function(){var e=this;this.editorFetched||(this.editorFetched=!0,this.serverCall("editor_component").contentFor(this.$editor).success(function(){
e.$id("@loading").addClass("hidden"),e.editorLoaded=!0,e.emitEvent(s.helpers.inlineEditorEdit(e.content_type,e.oid)),e.showEditor()}).send())},bindEditorCallbacks:function(){var e=this;this.handleEvent(s.Types.INLINE_EDITOR_STATE,function(t){t.payload.contentType==e.content_type&&t.payload.oid==e.oid&&("edit"==t.payload.state?e.toggle(!1):"cancel"==t.payload.state?e.toggle(!0):"submitted"==t.payload.state?e.toggle(!0):"toggle"==t.payload.state&&e.toggle())})}});var d=t.SuggestedEditsEditor=a.extend({onLoad:function(){this._super.apply(this,arguments),this.disclaimer_update="",this.answer_attribution_update="";var e=this;this.setToggleCallback(function(){if(e.parent()){var t=e.parent();t.toggleButtons&&t.toggleButtons(),t.$id("@disclaimer").toggle(),t.$id("@nfr").toggle(),t.$id("@answer_attribution").toggle()}e.editorShown&&e.editor.fixEditorButtons()}),e.child("editor").setEditorReadyCallback(function(){e.original_input=e.get_value()})},submitHandler:function(){var e=this;this.input_button_obj.click(function(t){
e.trigger_request(),t.preventDefault()})},okToSubmitRequest:function(){return this.editor.hasChanged(this.original_input)||this.always_submit||""!==this.disclaimer_update||""!==this.answer_attribution_update?this._super.apply(this,arguments):!1},_get_kwargs:function(){var e="";return this.has_comment&&!this.child("comment_editor").isOnlyWhiteSpace()&&(e=this.child("comment_editor").serialize()),{object_id:this.id,input:this.get_value(),sugg_exists:this.sugg_exists,notif:this.$id("@notif").prop("checked")?1:0,comment:e,disclaimer_update:this.disclaimer_update,answer_attribution_update:this.answer_attribution_update,share_values:{}}}});t.AnswerEditor=d.extend({onLoad:function(){this._super.apply(this,arguments),this.answerShareForm=this.child("answer_share_form"),this.editorShare=this.answerShareForm&&this.answerShareForm.child("editor_share")},_get_kwargs:function(){var e=this._super();return this.editorShare&&(e.share_values=this.editorShare.getValues()),e}}),t.PostEditor=d.extend({onLoad:function(){
this._super.apply(this,arguments);var e=this;this.handleEvent(s.Types.POST_DISCLAIMER,function(t){t.payload.pid==e.id&&(e.disclaimer_update=t.payload.state)})}}),t.FeedStoryItem=n.extend({onLoad:function(){var e=this;this.$id("@item").hover(function(){e.$id("@item").addClass("hover")},function(){e.$id("@item").removeClass("hover")}),this.handleEvent(s.Types.QUESTION_CANT_ANSWER_STATE,function(t){if(t.payload.qid==e.qid){var i="passed"==t.payload.state;e.$id("@item").toggleClass("cant_answer",i)}})},getHash:function(){return this.hash}})}),define("app/view/components",["shared/polyfills","shared/core/component","shared/cookies","w2.dialog","shared/jquery","shared/qtext","settings","shared/action_log"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/cookies"),s=e("w2.dialog"),a=e("shared/jquery"),r=e("shared/qtext").renderQText,d=e("settings").interface_strings,l=e("shared/action_log");t.TruncatedQText=n.extend({onLoad:function(e){this.$more=this.$id("@more_link");var t=this.$more.attr("href");
t&&"#"!=t&&this.$id("@truncated").on("click",function(e){e.preventDefault(),window.open(t,"_blank")}),r(this.$id("@truncated"))}}),t.ExpandedQText=n.extend({onLoad:function(){this._super.apply(this,arguments),r(this.$id("@expanded"))}}),t.TruncatePhraseList=n.extend({onLoad:function(){var e=this;e.$id("@view_all_link").click(function(){return e.$id("@partial_phrases").addClass("hidden"),e.$id("@all_phrases").removeClass("hidden"),!1})}});var c=function(e){return"A"==e.target.nodeName||a(e.target).hasClass("qtext_embed")};t.QtextTruncate=n.extend({init:function(){this._super.apply(this,arguments),this.callback=null},onLoad:function(e){var t=this;(t.show_more&&t.was_truncated||t.$id("@more_link").length>0)&&(t.$id("@text_snip").click(function(e){return c(e)?void 0:t.onClick()}),t.$id("@more_link").click(function(){return t.onClick()})),r(this.$id("@text_snip"))},onClick:function(){var e=this;return e.viewMore(),e.callback&&e.callback(),!1},setCallback:function(e){this.callback=e},viewMore:function(){
this.$id("@text_snip").addClass("hidden"),this.$id("@full_text").removeClass("hidden"),r(this.$id("@full_text"))}}),t.SimpleUserRequest=n.extend({onLoad:function(){var e=this;this.$id("@link").click(function(t){e.onClick(),t.preventDefault()})},onClick:function(){this.upvote&&(o.setQfeedLog(this,"BoardItemUpvote"),o.setQueryLog(this,"BoardItemUpvote"),o.setTlog({type:"BoardItemUpvote",board_item_id:this.board_item_id}),l.logSecondaryAction("BoardItemUpvote",{type:"board_item",board_item_id:this.board_item_id})),this.downvote&&(o.setQfeedLog(this,"BoardItemDownvote"),o.setTlog({type:"BoardItemVoteDown",board_item_id:this.board_item_id})),(this.board_follow_button||this.board_request_follow_button)&&(o.setQfeedLog(this,"BoardFollow"),o.setQueryLog(this,"BoardFollow"),o.setTlog({type:"BoardFollow",bid:this.bid}),l.logSecondaryAction("BoardFollow",{type:"board",bid:this.bid})),this.serverCall("request").liveMutate().send()}}),t.SimpleUserRequestConfirm=n.extend({onLoad:function(){var e=this;
this.$id("@link").click(function(){return e._dialog=s.createDialog(e).title(e.title).cancel(null,d.cancel).ok(function(){e.serverCall("request").liveMutate().send()},e.button_text).html(e.confirm_text),!1})}}),t.OrderItemButtons=n.extend({onLoad:function(){var e=this;this.$id("@up").click(function(){return e.serverCall("move_up").liveMutate().send(),!1}),this.$id("@down").click(function(){return e.serverCall("move_down").liveMutate().send(),!1})}}),t.QuestionFooter=n.extend({onLoad:function(){var e=this;e.$id("@link").mousedown(function(){o.setQfeedLog(e,"QuestionClickthrough"),o.setQueryLog(e,"QuestionClickthrough")})}})}),define("shared/google_",["shared/polyfills","shared/loadjs","shared/util","shared/onload"],function(e,t,i){var n=e("shared/loadjs").loadJS,o=e("shared/util"),s=e("shared/onload"),a=!1,r=[],d=o.once(function(){var e="//apis.google.com/js/client:plusone.js?onload=gapiAsyncInit";window.gapiAsyncInit=function(){for(a=!0;r.length;)r.pop().call()},n(e)});t.onInit=function(e){
a?e():(s.execAfterLoadDelayed(d),r.push(e))}}),define("app/view/contact_importer",["shared/polyfills","settings","shared/jquery","shared/events/index","shared/google_","shared/core/component"],function(e,t,i){function n(e,t){var i=!1;return s.each(t,function(t,n){return n.test(e)?void(i=!0):void 0}),i}var o=e("settings"),s=e("shared/jquery"),a=e("shared/events/index"),r=e("shared/google_"),d=e("shared/core/component").Component,l=[/@yahoo\.(ca|cn|co\.id|co\.in|co\.jp|co\.kr|co\.nz|co\.uk|com|com\.ar|com\.au|com\.br|com\.cn|com\.hk|com\.mx|com\.my|com\.ph|com\.sg|com\.tr|com\.tw|com\.vn|de|dk|es|fr|gr|ie|it|no|pl|se)$/,/@ymail\.com$/,/@rocketmail\.com$/],c=[/@gmail\.com$/,/@googlemail\.com$/],h=t.ImportContactsForm=d.extend({isGoogleAppsEmail:!1,shouldLogImpression:!0,onLoad:function(){var e=this;this.isGoogleAppsEmail=this.is_google_apps_email,this.prevEmail=this.getEmail(),s("input[type=submit]").focus(),this.$id("@email").on("keyup",function(){e.prevEmail!=e.getEmail()&&(e.prevEmail=e.getEmail(),
e.validateEmail())}),s("input[type=submit]").on("click",function(){return e.onSubmit()}),this.shouldLogImpression&&this.serverCall("log_impression").kwargs({email:this.getEmail()}).send(),s(document).on("oauth_approved",function(t,i){e.updateAndSubmitForm(i.service,i.accessToken)}),s(document).on("oauth_rejected",function(t,i){e.onOAuthRejected(i.service)})},submitForm:function(){this.$id("@contact_importer_form").submit()},updateAndSubmitForm:function(e,t){this.$id("@service").val(e),this.$id("@access_token").val(t),this.$id("@spinner").show(),this.submitForm()},onOAuthRejected:function(e){},onSubmit:function(){return this.openOAuthDialog(this.getEmail())?!1:!0},getEmail:function(){return s.trim(this.$id("@email").val())},lastTimeoutId:null,validateEmail:function(){var e=this.getEmail();if(!e)return this.onOAuthEmailEntered("empty"),!1;this.lastTimeoutId&&(clearTimeout(this.lastTimeoutId),this.lastTimeoutId=null);var t=n(e,l),i=n(e,c);this.isGoogleAppsEmail=!1,this.isGoogleAppsDomainCheckQueued=!1,
t?this.onOAuthEmailEntered("yahoo"):i?this.onOAuthEmailEntered("gmail"):(this.onUnknownDomainEntered(),this.lastTimeoutId=setTimeout(this.checkGoogleAppsDomain.bind(this),500))},onOAuthEmailEntered:function(e){},onUnknownEmailDomainEntered:function(){},isCheckingGoogleAppsDomain:!1,isGoogleAppsDomainCheckQueued:!1,checkGoogleAppsDomain:function(){if(this.isCheckingGoogleAppsDomain)return void(this.isGoogleAppsDomainCheckQueued=!0);this.isCheckingGoogleAppsDomain=!0;var e=this.getEmail(),t=this;this.serverCall("is_google_apps_domain").kwargs({email:e}).success(function(i){i&&(t.isGoogleAppsEmail=!0),t.onCheckGoogleAppsDomainResponse(e,i),t.isCheckingGoogleAppsDomain=!1,t.isGoogleAppsDomainCheckQueued&&(t.isGoogleAppsDomainCheckQueued=!1,t.checkGoogleAppsDomain())}).send()},onCheckGoogleAppsDomainResponse:function(e,t){},logOAuthAttempt:function(e){this.serverCall("log_contact_importer_oauth_attempt").kwargs({email:e}).send()},onGoogleOAuthCallback:function(e){if(e&&void 0===e.error){var t="google",i=e.access_token;
this.updateAndSubmitForm(t,i)}else this.onOAuthRejected()},openOAuthDialog:function(e){var t=this;return n(e,l)?(t.logOAuthAttempt(e),window.open("/oauth/yahoo","_BLANK","height=400,width=800"),!0):n(e,c)||t.isGoogleAppsEmail?(t.logOAuthAttempt(e),r.onInit(function(){var e={callback:t.onGoogleOAuthCallback.bind(t),clientid:o.googleClientId,cookiepolicy:o.googleCookiePolicy,scope:t.scopes};t.prompt_ota_install&&(e.apppackagename=o.androidAppPackageName),window.gapi.auth.signIn(e)}),!0):!1},getEmailDomain:function(e){return n(e,l)?"yahoo":n(e,c)||this.isGoogleAppsEmail?"google":"other"}}),u=h.extend({onLoad:function(){this._super.apply(this,arguments),this.$id("@contact_importer_form").submit(this.onFormSubmit.bind(this))},onFormSubmit:function(){return!this.child("submit").$id("@import_contacts").is(":disabled")},unsupportedMessageTimeoutId:null,clearUnsupportedMessageTimeout:function(){this.unsupportedMessageTimeoutId&&(clearTimeout(this.unsupportedMessageTimeoutId),this.unsupportedMessageTimeoutId=null);
},onOAuthEmailEntered:function(e){this.$id("@spinner").hide(),this.$id("@email_import_error").hide(),this.$id("@unsupported_domain").hide(),this.$id("@form_error").hide(),this.enableSubmitButton(!0),this.clearUnsupportedMessageTimeout()},onUnknownDomainEntered:function(){this.$id("@spinner").show(),this.$id("@email_import_error").hide(),this.$id("@form_error").hide(),this.enableSubmitButton(!1),this.clearUnsupportedMessageTimeout()},onUnsupportedDomainEntered:function(){this.$id("@spinner").hide(),this.$id("@unsupported_domain").show(),this.$id("@email_import_error").show(),this.enableSubmitButton(!1)},onCheckGoogleAppsDomainResponse:function(e,t){if(this.getEmail()==e)if(t)this.$id("@spinner").hide(),this.$id("@unsupported_domain").hide(),this.enableSubmitButton(!0);else{var i=this;this.unsupportedMessageTimeoutId=setTimeout(function(){i.onUnsupportedDomainEntered()},500)}},enableSubmitButton:function(e){e?this.child("submit").$id("@import_contacts").attr("disabled",!1).removeClass("submit_button_disabled").addClass("follow_button"):this.child("submit").$id("@import_contacts").prop("disabled",!0).addClass("submit_button_disabled").removeClass("follow_button");
}});t.NuxDialogImportContactsForm=u.extend({shouldLogImpression:!1,onLoad:function(){var e=this;e._super.apply(e,arguments),e.$id("@change_email_link").click(function(){return e.$id("@default_email_container").hide(),e.$id("@change_email_container").show(),!1}),"other"==e.getEmailDomain(e.getEmail())&&e.onUnsupportedDomainEntered(),e.$id("@skip").click(function(){return e.serverCall("record_step").kwargs({step_name:"skip_oauth_dialog"}).success(function(){e.emitEvent({type:a.Types.NUX_DIALOG_SKIP_NEXT_STEP,payload:{}})}).send(),!1})},onOAuthRejected:function(e){this.serverCall("record_step").kwargs({step_name:"reject_oauth"}).send()},onSubmit:function(){var e=this._super.apply(this,arguments),t=!e;return t?this.serverCall("record_step").kwargs({step_name:"open_oauth",props:{domain:this.getEmailDomain(this.getEmail())}}).send():this.serverCall("record_step").kwargs({step_name:"invalid_import_domain"}).send(),e},submitForm:function(){var e=this.$id("@service").val(),t=this.$id("@access_token").val();
return this.importContacts(this.getEmail(),e,t),!1},importContacts:function(e,t,i){var n=this;n.$id("@alt_spinner").show(),n.serverCall("import_contacts").kwargs({email:e,service:t,access_token:i}).liveMutate().success(function(){n.emitEvent({type:a.Types.NUX_DIALOG_NEXT_STEP,payload:{}})}).sendOnlyOnce()}})}),define("app/view/draft",["shared/polyfills","shared/core/component","w2.dialog","shared/window_manager"],function(e,t,i){var n=e("shared/core/component").Component,o=e("w2.dialog"),s=e("shared/window_manager");t.ClearDraft=n.extend({onLoad:function(){var e=this;this.$id("@clear_draft").click(function(){return o.createDialog(e).title(e.clear_draft_title).cancel().ok(function(){e.clearDraft()},e.clear_draft_title).text(e.clear_draft_message),!1})},clearDraft:function(){this.serverCall("clear_draft").liveMutate().success(function(){s.reload()}).send()}})}),define("third_party/truncate",["shared/polyfills","shared/jquery"],function(e,t,i){function n(e,t){if(e.innerText)e.innerText=t;else if(e.nodeValue)e.nodeValue=t;else{
if(!e.textContent)return!1;e.textContent=t}}function o(e,t,i,o){var a,r=e.parent();e.remove();var d=i?i.length:0;if(r.contents().length>d)return a=r.contents().eq(-1-d),s(a,t,i,o);var l=r.prev();return a=l.contents().eq(-1),a.length?(n(a[0],a.text()+o.ellipsis),r.remove(),i.length&&l.append(i),!0):!1}function s(e,t,i,s){for(var a,r,l=e[0],c=e.text(),h="",u=0,p=c.length;p>=u;)a=u+(p-u>>1),r=d.trim(c.substr(0,a+1))+s.ellipsis,n(l,r),t.height()>s.maxHeight?p=a-1:(u=a+1,h=h.length>r.length?h:r);return h.length>0?(n(l,h),!0):o(e,t,i,s)}function a(e,t,i,n){var o,r,c=e[0],h=e.contents(),u=0,p=h.length,f=!1;for(e.empty();p>u&&!f;u++)o=h.eq(u),r=o[0],8!==r.nodeType&&(c.appendChild(r),i.length&&(d.inArray(c.tagName.toLowerCase(),l)>=0?e.after(i):e.append(i)),t.height()>n.maxHeight&&(f=3===r.nodeType?s(o,t,i,n):a(o,t,i,n)),!f&&i.length&&i.remove());return f}function r(e,t){this.element=e,this.$element=d(e),this._name="truncate",this._defaults={lineHeight:parseInt(this.$element.css("line-height")),
lines:1,ellipsis:"…",showMore:"",showLess:""},this.options=d.extend({},this._defaults,t),void 0===this.options.maxHeight&&(this.options.maxHeight=parseInt(this.options.lines,10)*parseInt(this.options.lineHeight,10)),this.$clipNode=d(d(this.options.showMore),this.$element),this.original=this.cached=e.innerHTML,this.isTruncated=!1,this.isCollapsed=!0,this.update()}var d=e("shared/jquery"),l=["table","thead","tbody","tfoot","tr","col","colgroup","object","embed","param","ol","ul","dl","blockquote","select","optgroup","option","textarea","script","style"];r.prototype={update:function(e){var t=!this.isCollapsed;e?this.original=this.element.innerHTML=e:this.isCollapsed&&this.element.innerHTML===this.cached&&(this.element.innerHTML=this.original);var i=this.$element.wrapInner("<div/>").children();i.css({border:"none",margin:0,padding:0,width:"auto",height:"auto"}),this.isTruncated=!1,i.height()>this.options.maxHeight?this.isTruncated=a(i,i,this.$clipNode,this.options):this.isCollapsed=!1,i.replaceWith(i.contents()),
this.cached=this.element.innerHTML,t&&(this.element.innerHTML=this.original)},expand:function(){this.isCollapsed&&(this.isCollapsed=!1,this.element.innerHTML=this.isTruncated?this.original+this.options.showLess:this.original)},collapse:function(e){this.isCollapsed||(this.isCollapsed=!0,e=e||!1,e?this.update():this.element.innerHTML=this.cached)}},t.Truncate=r}),define("truncate",["shared/polyfills","third_party/truncate","shared/errors"],function(e,t,i){var n=e("third_party/truncate").Truncate,o=e("shared/errors");t.truncate=function(e,t){return e&&void 0!=e?new n(e,t):void o.logJsError("truncate","elem does not exist")}}),define("app/view/embed",["shared/polyfills","shared/core/component","shared/jquery","tooltip","view/modal","truncate","shared/views"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/jquery"),s=e("tooltip"),a=e("view/modal").Base,r=e("truncate").truncate,d=e("shared/views").viewsLogger;t.EmbedModalLink=n.extend({onLoad:function(){var e=this;this.$id("@modal_link").on("click",function(t){
t.preventDefault(),e.createModal("load_inner").kwargs({aid:e.aid}).show()}),s.attach(this.$id("@embed_disabled"),this.embed_disabled_text)}}),t.EmbedModal=a.extend({onLoad:function(){this._super.apply(this,arguments),this.selectAllOnFocus(this.$id("@code_area")),this.$id("@checkbox").on("click",this.toggleFullAnswer.bind(this))},selectAllOnFocus:function(e){e.focus(function(){var e=o(this);e.select(),window.setTimeout(function(){e.select()},1),e.mouseup(function(){return e.off("mouseup"),!1})})},toggleFullAnswer:function(){this.$id("@full_answer").is(":checked")?(this.$id("@truncated_preview").addClass("hidden"),this.$id("@full_preview").removeClass("hidden"),this.$id("@code_area").val(this.full_answer_code)):(this.$id("@truncated_preview").removeClass("hidden"),this.$id("@full_preview").addClass("hidden"),this.$id("@code_area").val(this.truncated_answer_code))}}),t.AnswerEmbedAnswer=n.extend({onLoad:function(){d.addComponentToTrack(this),d.logViews(),this.embedly&&(r(this.$id("@question_text").get(0),{
lineHeight:"24",lines:3}),r(this.$id("@answer_header").get(0),{lines:1}))}})}),define("app/view/error",["shared/polyfills","webnode2","shared/core/component","shared/w2.context"],function(e,t,i){var n=e("webnode2"),o=e("shared/core/component").Component,s=e("shared/w2.context").CaptchaInput;t.CaptchaForm=o.extend({contextConstructor:function(){return s},onLoad:function(){n.Error.shown=!0,n.Error.hide();var e=this;e.captchaContext=e.getContext(s),e.captchaContext.on("isCaptchaFilled",function(t,i){if(i){var n=e.captchaContext.get("captchaResponse");e.serverCall("verify_captcha").kwargs({captcha_response:n}).success(function(e){e.response&&window.location.reload(!0)}).send()}})}})}),define("view/paged_list",["shared/polyfills","shared/log","shared/jquery","shared/core/component","w2.errors","shared/viewport","shared/onload","shared/eventemitter","shared/window_manager","shared/loading","shared/perf"],function(e,t,i){var n=e("shared/log").log,o=e("shared/jquery"),s=e("shared/core/component").Component,a=e("shared/core/component"),r=e("w2.errors"),d=e("shared/viewport"),l=e("shared/onload"),c=e("shared/eventemitter").EventEmitter,h=e("shared/window_manager"),u=e("shared/loading"),p=e("shared/perf");
t.PagedList=s.extend({init:function(e){this._super.apply(this,arguments),this.model_count=e.initial_count,this.container=window,this.first_hidden_index=0,this.visible_count=0,this.invisible_count=0,this.total_count=0,this.initializeCounts(),this.max_should_show=this.buffer_count,this.hidden_count=0,this.currently_fetching=!1,this.waiting_for_updates=!1,this.waiting_for_updates_from_preload=!1,this.show_hidden_when_done_updating=!1,this.lastGetMoreSucceeded=!0,this.eventEmitter=new c,this.eventEmitter.on("onGetMoreDone",this.maybeUpdateOptimizedPaged),this.retarget_links&&this.retarget(),this.pagingDone=!1,this.userPerceivedAction=null},getFocusedItem:function(){var e=a.getLiveDomId(this.cid),t=o("#"+e+" .pagedlist_item:focus").first();return t.length?t:null},maybeScrollToItem:function(e,t,i){var n=e.height(),s=e.position().top,a=s+n,r=o(document).scrollTop()+h.headerOffset,d=Math.max(0,o(window).height()-(h.headerOffset+h.actionBarHeight+h.scrollContext)),l=r+d;if(!t.length){if(i&&s>=r)return void h.scrollAndFocus(0);
if(!i&&l>=a)return void h.scrollAndFocus(o(document).height());t=e}if(r>a||s>l)return void h.scrollAndFocus(s);var c=i&&s>=r-5||!i&&l+5>=a;c&&(n=t.height(),s=t.position().top,a=s+n);var u=r;if(i)c&&n>d?u=a-d:r>s&&(u=s);else{var p=.25*o(window).height();s>r+p?u=s-p+5:c||(u=r+d)}u=r+Math.max(Math.min(u-r,d),-d),h.scrollAndFocus(u,c&&t)},onMoreButtonClick:function(e){e||r.beginCanBeRelatedToUserActionBlock(100),n&&n.enabled&&n("paged_list.PagedList.onMoreButtonClick",this.cid,"'More...' button clicked",e?"(auto)":"");var t=this.showHiddenAndMaybeGetMore();return t||(this.show_hidden_when_done_updating=!0),this.currently_fetching&&this.showLoading(),this.startUserPerceivedAction(),!1},loadMoreButton:function(){var e=this;this.child("more_button").$id("@more").click(this.onMoreButtonClick.bind(this)),!this.crawler&&this.has_more&&l.execAfterLoadDelayed(function(){setTimeout(e.maybeGetMore.bind(e),50)})},initializeCounts:function(){var e=a.getLiveDomId(this.cid);if(e){var t=document.getElementById(e);
if(t)for(var i=t.childNodes,n=0;n<i.length;n++){var s=o(i[n]),r=s.attr("id");r&&s.hasClass("pagedlist_item")&&(this.first_hidden_index+=1,this.total_count+=1,s.hasClass("pagedlist_invisible")?this.invisible_count+=1:this.visible_count+=1)}}},showHiddenAndMaybeGetMore:function(){return this.showHidden(this.buffer_count),this.maybeGetMore()},showHidden:function(e){var t=0,i=0,n=a.getLiveDomElement(this.cid);if(n){for(var s=n.childNodes,r=!1,d=0;d<s.length;d++){var l=o(s[d]);if(l.hasClass("pagedlist_item")&&l.hasClass("pagedlist_hidden")&&(l.hasClass("pagedlist_invisible")||(t+=1),r||(r=!0),l.removeClass("pagedlist_hidden"),s[d].style.display="",i+=1,t>=e))break}this.visible_count+=t,this.hidden_count-=t,this.first_hidden_index+=i,this.has_more||this.pagingDone||(this.pagingDone=!0,this.onPagingDone()),this.visible_count>this.max_should_show&&(this.max_should_show=this.visible_count),this.eventEmitter.trigger("onShowHidden")}},onPagingDone:function(){},hideLoading:function(){n&&n.enabled&&n("paged_list.PagedList.hideLoading","Hide loading...");
var e=this.child("more_button");e&&(e.$id("@loading").hide(),this.lastGetMoreSucceeded?e.updateAutoClickCapable():e.auto_click_capable=!1,e.maybeEnableOrDisableAutoClick())},showLoading:function(){n&&n.enabled&&n("paged_list.PagedList.showLoading","Show loading...");var e=this.child("more_button");if(e&&this.auto_paged&&!this.crawler){var t=this.child("more_button").$id("@loading");this.spinner||(this.spinner=u.createLoadingDotsElement(),t.append(this.spinner)),t.show()}else e&&e.$id("@loading").show()},hideMoreButton:function(){var e=this.child("more_button");e&&!e.isVirtual&&e.maybeHideButton()},showMoreButton:function(){var e=this.child("more_button");e&&!e.isVirtual&&e.maybeShowButton()},maybeGetMore:function(e){return this.currently_fetching||this.waiting_for_updates||this.waiting_for_updates_from_preload?void 0!==e&&this.total_count<e?(this.eventEmitter.once("onGetMoreDone",this.maybeGetMore.bind(this,e)),!0):!1:(void 0!==e&&this.total_count<e?this.getMore(e):this.visible_count+this.hidden_count>=this.model_count&&this.hidden_count<=this.buffer_count/4?this.getMore():this.hidden_count<=0&&this.hideMoreButton(),
!0)},maybeUpdateOptimizedPaged:function(){this.optimize_for_seo&&(this.model_count>this.offset_count&&(this.model_count-=this.offset_count),this.child("html_nav")&&(this.html_nav_item=a.getLiveDomElement(this.child("html_nav").cid),this.html_nav_item.style.display="block"))},getMore:function(e){return this.currently_fetching=!0,this.waiting_for_updates=!0,this.serverCall("increase_count").kwargs({cid:this.cid,num:void 0!==e?e-this.total_count:this.buffer_count,current:this.model_count}).disableDefaultUserPerceivedLogging().success(this._onGetMoreSuccess.bind(this)).error(this._onGetMoreError.bind(this)).send(),!1},_onGetMoreSuccess:function(){this.lastGetMoreSucceeded=!0,this.currently_fetching=!1,this.waiting_for_updates||(this.hideLoading(),this.show_hidden_when_done_updating&&(this.show_hidden_when_done_updating=!1,this.showHiddenAndMaybeGetMore())),this.eventEmitter.trigger("onGetMoreDone")},_onGetMoreError:function(){var e=this;this.lastGetMoreSucceeded=!1,this.currently_fetching=!1,
setTimeout(function(){e.waiting_for_updates&&e.userPerceivedAction&&(p.finishAction(e.userPerceivedAction),e.userPerceivedAction=null),e.waiting_for_updates=!1,e.hideLoading()},2e3)},onInsertNode:function(e,t){var i=o("#"+t);if(i.hasClass("pagedlist_item")){this.retarget_links&&i.find('a:not([href^="#"])').each(function(){"feed_modal"!=this.target&&o(this).attr("target","_blank")});var n=i.hasClass("pagedlist_invisible");if(this.total_count+=1,e.position>0&&e.position>=this.first_hidden_index)i.addClass("pagedlist_hidden"),e.transition.type="none",n||(this.hidden_count+=1,this.fixed_size_paged_list&&this.first_hidden_index<this.max_should_show?this.showHidden(1):this.showMoreButton());else{i.removeClass("pagedlist_hidden"),i[0].style.display="";var s=!0;if(n)this.invisible_count+=1;else if(this.visible_count+=1,this.fixed_size_paged_list&&this.visible_count>=this.first_hidden_index&&this.first_hidden_index>=this.max_should_show){s=!0;for(var r=a._domids[this.cid],d=document.getElementById(r),l=d.childNodes,c=0,h=0;h<l.length;h++){
var u=o(l[h]);if(u.hasClass("pagedlist_item")&&!u.hasClass("pagedlist_hidden")&&!u.hasClass("pagedlist_invisible")&&(c+=1,c>this.first_hidden_index)){u.addClass("pagedlist_hidden"),l[h].style.display="none",this.hidden_count+=1,this.visible_count-=1,this.showMoreButton();break}}}this.fixed_size_paged_list&&s||(this.first_hidden_index+=1)}}},onDeleteNode:function(e,t){var i=o("#"+t);if(i.hasClass("pagedlist_item")){var n=i.hasClass("pagedlist_invisible");this.total_count-=1,e.position>=this.first_hidden_index?n||(this.hidden_count-=1):(this.first_hidden_index-=1,n?this.invisible_count-=1:(this.visible_count-=1,this.fixed_size_paged_list&&this.showHidden(1)))}},onUpdate:function(e){this.model_count=e.count,this.has_more=e.has_more;var t=this.child("more_button");t&&!t.isVirtual&&(t.maybeEnableOrDisableAutoClick(),this.hidden_count<=0?this.hideMoreButton():this.showMoreButton()),this.auto_paged&&this.waiting_for_updates&&this.finishUserPerceivedAction(),this.waiting_for_updates=!1,this.waiting_for_updates_from_preload=!1,
this.visible_count<this.buffer_count&&this.hidden_count>0&&(this.show_hidden_when_done_updating=!0);var i=!0;this.currently_fetching||(this.hideLoading(),this.show_hidden_when_done_updating&&(this.show_hidden_when_done_updating=!1,this.showHiddenAndMaybeGetMore(),i=!1)),this.eventEmitter.trigger("onGetMoreDone"),i&&this.maybeGetMore()},startUserPerceivedAction:function(){this.userPerceivedAction||(this.userPerceivedAction=p.startUserPerceived({vcon:this.__vcon,method:"increase_count"}))},finishUserPerceivedAction:function(){this.startUserPerceivedAction(),p.finishAction(this.userPerceivedAction),this.userPerceivedAction=null},orderedVisibleChildren:function(){var e,t=a.getLiveDomElement(this.cid),i=t.childNodes,n=[];for(e=0;e<i.length;e++){var s=o(i[e]),r=s.attr("id");r&&s.hasClass("pagedlist_item")&&!s.hasClass("pagedlist_invisible")&&n.push(r)}return n},allOrderedChildren:function(){for(var e=a.getLiveDomElement(this.cid),t=e.childNodes,i=!1,n=[],s=0;s<t.length;s++){var r=o(t[s]),d=r.attr("id");
d&&r.hasClass("pagedlist_item")&&(i||!r.hasClass("pagedlist_invisible"))&&(i=!0,n.push(d))}return n},retarget:function(){o("#"+a.getLiveDomId(this.cid)+" .pagedlist_item").find('a:not([href^="#"])').each(function(){"feed_modal"!=this.target&&o(this).attr("target","_blank")})}}),t.PagedListMoreButton=s.extend({init:function(){this._super.apply(this,arguments),this.last_check_time=0,this.rate_limiter_ms=245,this.auto_click_enabled=!1,this.updateAutoClickCapable()},updateAutoClickCapable:function(){this.auto_click_capable=null!==this.auto_click_period&&this.auto_click_period>0},checkButtonPosition:function(e){if(this.auto_click_capable&&this.parent()){var t=+new Date;if(e||!(t<this.last_check_time+this.rate_limiter_ms)){var i=this.parent().model_count;this.parent().waiting_for_updates&&(i+=this.parent().buffer_count);var n=this.shouldEnableAutoClickFromModelCount(i);this.last_check_time=t;var s=this.$id("@more");if(0!==s.length){var a=this.$id("@sentinel"),r=this.parent().container,l=Math.ceil(o(r).height()),c=!1;
if(d.isElementInViewport(a.get(0)))c=!0,this.parent().auto_paged&&this.parent().startUserPerceivedAction();else{var h=o(r).height()+o(r).scrollTop(),u=h<=o(a).offset().top-l;u||(c=!0)}if(c)return this.parent().currently_fetching||this.parent().waiting_for_updates?(this.parent().showLoading(),void(n&&(this.parent().show_hidden_when_done_updating=!0))):void(n&&this.parent().onMoreButtonClick())}}}},onLoad:function(){var e=this;if(this.parent().loadMoreButton(),this.parent().eventEmitter.on("onShowHidden",function(){e.auto_click_capable&&!e.auto_click_enabled&&e.shouldEnableAutoClickFromModelCount(e.parent().model_count+e.parent().buffer_count)&&e.$id("@more").is(":visible")&&e.maybeHideButton()}),this.auto_click_capable){var t=function(){setTimeout(e.checkButtonPosition.bind(e,!1),125)};this._mousemove_handler=t,this._keypress_handler=t,this._scroll_handler=t,document.addEventListener("mousemove",this._mousemove_handler),document.addEventListener("keypress",this._keypress_handler),document.addEventListener("scroll",this._scroll_handler);
}this.maybeEnableOrDisableAutoClick(),this.auto_click_enabled&&l.execAfterLoadDelayed(function(){setTimeout(e.checkButtonPosition.bind(e,!0),125)})},onUnload:function(){void 0!==this._mousemove_handler&&document.removeEventListener("mousemove",this._mousemove_handler),void 0!==this._keypress_handler&&document.removeEventListener("keypress",this._keypress_handler),void 0!==this._scroll_handler&&document.removeEventListener("scroll",this._scroll_handler)},maybeShowButton:function(){this.auto_click_enabled||this.$id("@more").show()},maybeHideButton:function(){this.$id("@more").hide()},shouldEnableAutoClickFromModelCount:function(e){return e%this.auto_click_period!==0},maybeEnableOrDisableAutoClick:function(){if(!this.auto_click_capable)return void(this.auto_click_enabled=!1);var e=this.shouldEnableAutoClickFromModelCount(this.parent().model_count);e&&!this.auto_click_enabled?(this.auto_click_enabled=!0,this.parent().hideMoreButton()):!e&&this.auto_click_enabled&&(this.auto_click_enabled=!1);
},counterStr:function(){return"PagedList counters: total_count "+this.total_count+", visible_count "+this.visible_count+", invisible_count "+this.invisible_count+", hidden_count "+this.hidden_count+", first_hidden_index "+this.first_hidden_index}})}),define("app/view/home",["shared/polyfills","shared/core/component","shared/jquery","view/fixable2","unified_view/toggle","shared/events/index","shared/viewport","shared/window_manager","shared/logging"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/jquery"),s=e("view/fixable2"),a=e("unified_view/toggle"),r=e("shared/events/index"),d=e("shared/viewport"),l=e("shared/window_manager"),c=e("shared/logging");t.HomeMain=n.extend({onLoad:function(){var e=this.$id("@left_col_inner"),t=this.$id("@left_col");if(t.length>0&&e.length>0){var i=30,n=990;s.makeFixable(e,{scroll_dep:!0,min_height:t.outerHeight()+t.offset().top,min_width:n,extra_top_spacing:i})}}}),t.HomeFeed=n.extend({onLoad:function(){var e=this,t=l.getURL();(-1!=t.indexOf("?qp_story=")||-1!=t.indexOf("?digest_story="))&&(l.replaceURL("/"),
o("#feed_visibility_wrapper").removeClass("invisible")),this.handleEvent(r.Types.FEED_PAGING_DONE,function(){e.child("home_main_feed").triggerSwitch()})}}),t.ContentPageFeed=a.ToggleBase.extend({onLoad:function(){this._super.apply(this,arguments),setTimeout(this.recordImpression.bind(this),0)},recordImpression:function(){d.isElementInViewport(this.$id("@wrapper").get(0))?c.log("funnel_impression",{impression_type:"qp_feed_impression"}):setTimeout(this.recordImpression.bind(this),200)}})}),define("app/view/feed",["shared/polyfills","shared/core/component","shared/jquery","view/fixable2","truncate","shared/window_manager","shared/cookies","shared/events/index","shared/log","shared/logging","shared/viewport","shared/views","gating","shared/action_log","fx","view/paged_list","app/view/home"],function(e,t,i){var n=e("shared/core/component"),o=e("shared/jquery"),s=e("shared/core/component").Component,a=e("view/fixable2"),r=e("truncate").truncate,d=e("shared/window_manager"),l=e("shared/cookies"),c=e("shared/events/index"),h=e("shared/log").log,u=e("shared/logging"),p=e("shared/viewport"),f=e("shared/views").viewsLogger,_=e("gating"),g=e("shared/action_log").ActionableComponent,m=e("fx");
t.UniversalPageFeed=e("view/paged_list").PagedList.extend({init:function(e){this._super.apply(this,arguments),this.pageLoadTime=+new Date,this.viewerUid=e.uid,this.hashPosition={},this.initiallyVisible={},this.firstQueryID=0,this.offset=0,this.firstElement=0,this.needsRefresh=!1,this.num_prefeed_stories=e.num_prefeed_stories,this.bundle_position=e.bundle_position,this.hashImpressions={},this.lastCheckTime=0,this.lastRevealTime=0,this.visibleStorySelectors=[],this.impressionData=[],this.dontLogImpressions=e.dont_log_imp,this.maxImpPos=-1;var t=this;this.handleEvent(c.Types.FEED_IMPRESSIONS_DISABLED,function(e){t.dontLogImpressions=e.payload.disabled}),this.setDvar("feed_story_hash",null),this.setDvar("feed_story_position",null),this.setDvar("feed_story_inner_position",null),this.setDvar("feed_story_initial",null),this.setDvar("feed_ty",e.feed_ty),this.setDvar("feed_page",e.feed_page),this.setDvar("page_data",e.page_data),this.setDvar("focus_ty",e.focus_ty),this.setDvar("bundle_position",e.bundle_position);
},onLoad:function(e){h("feed.UniversalPageFeed.onLoad","start"),this._super.apply(this,arguments);var t=this;if(!this.debug){this.recordImpressions(!0),setInterval(this.recordImpressions.bind(this,!1),t.rate_limiter_ms+500);var i=this.recordImpressions.bind(this,!1,!1);this._mousemove_handler=i,this._keypress_handler=i,this._scroll_handler=i,document.addEventListener("mousemove",this._mousemove_handler),document.addEventListener("keypress",this._keypress_handler),document.addEventListener("scroll",this._scroll_handler)}},onFeedBottomIndicatorClicked:function(){window.location.reload()},onUnload:function(){document.removeEventListener("mousemove",this._mousemove_handler),document.removeEventListener("keypress",this._keypress_handler),document.removeEventListener("scroll",this._scroll_handler),document.removeEventListener("scroll",this._pfPrefetchScrollHandler)},revealStories:function(){setTimeout(function(){o(".reveal_story").removeClass("reveal_story")},1500)},scrollToTop:function(){var e=o(".SiteHeader"),t=0;
e&&(t=e.height());var i=o(n.getLiveDomElement(this.cid)),s=i.prev(".HomeMainFeedHeader")[0],a=0;a=s?s.offsetTop:i[0].offsetTop;var r=30,d=Math.max(2*a,2*window.innerHeight),l=a-t-r;window.scrollTo(0,d),o("html, body").animate({scrollTop:l},700)},bottomIndicatorIsVisible:function(){var e=o(".FeedBottomIndicator");return e&&p.isElementInViewport(e.get(0))},updatePositions:function(e){var t,i,o,s,a=this.children(),r=!1;if(!e){for(s=this.offset,t=0;t<a.length;t++)if(o=a[t],o.getDvar&&o.getDvar("feed_story_hash")==this.firstElement){var d=this.orderedVisibleChildren();for(i=0;i<d.length;i++)d[i]==n.getLiveDomId(o.cid)&&(this.offset=i)}this.offset!=s&&(r=!0)}var l,c,h=this.orderedVisibleChildren();for(this.firstQueryID=0,i=0;i<h.length;i++){l=document.getElementById(h[i]),o=n.getComponentFromElement(l),c=o.$id("@item"),this.firstQueryID<=0&&!c.hasClass("preloaded_pf")&&(this.firstQueryID=o.query_id);var u=i-this.offset+this.num_prefeed_stories,p=o.getHash();this.hashPosition[p]=u}if(e)for(i=0;i<a.length;i++)n.getLiveDomId(a[i].cid)==h[0]&&(this.firstElement=a[i].getDvar("feed_story_hash"));
return r},addImpression:function(e,t){var i=e.getHash();this.hashImpressions[i]=!0,this.impressionData.push({hash:i,initially_visible:this.initiallyVisible.hasOwnProperty(i),position:t,bundle_position:this.bundle_position})},recordImpressions:function(e){if(!this.debug){var t=this,i=+new Date,o=e||this.needsRefresh;if(this.needsRefresh=!1,!(!o&&i<this.lastCheckTime+this.rate_limiter_ms||i<this.lastRevealTime+3e3)){this.lastCheckTime=i,h("feed.UniversalPageFeed.recordImpressions","started, called with",e);var s,a,r=this.children();for(o=this.updatePositions(e)||o,a=0;a<r.length;a++)if(s=r[a],s.getHash&&s.validForLoggingImpression(o)){var d=s.isVisible(),l=s.getHash(),c=this.hashPosition[l];h("feed.UniversalPageFeed.recordImpressions","    firstQueryID:",this.firstQueryID,"    comp.query_id:",s.query_id,"    domid:",n._domids[s.cid],"    inViewport:",d,"    position:",c,"    bundle_position:",this.bundle_position,"    hash:",l),this.hashImpressions[l]||!o&&!d||(h("feed.UniversalPageFeed.recordImpressions","check to see if should reset dvars/record impression"),
o&&(s.setDvar("feed_story_position",c),s.setDvar("feed_story_initial",!0)),d&&(h("feed.UniversalPageFeed.recordImpressions","impression recorded"),e&&(t.initiallyVisible[s.getHash()]=!0),this.addImpression(s,c)))}if(this.impressionData.length>0&&this.viewerUid&&i-this.pageLoadTime>=this.wait_until_log_impression_ms){var p=this.impressionData;if(!this.dontLogImpressions){var f={uid:this.__js_init.uid,focus_ty:this.__js_init.focus_ty,feed_ty:this.__js_init.feed_ty,feed_page:this.__js_init.feed_page,page_data:this.__js_init.page_data};h("feed.UniversalPageFeed.recordImpressions","server call"),u.log("feed_impression",{request_data:p,__js_data__:f}),h("feed.UniversalPageFeed.recordImpressions","server call sent")}for(var g=0;g<this.visibleStorySelectors.length;g++)this.visibleStorySelectors[g].addClass("seen");if(this.visibleStorySelectors=[],this.impressionData=[],_.qfeed_log_impression_debug)for(var m in p)console.log("feed_impression:",JSON.stringify(p[m],null,2))}h("feed.UniversalPageFeed.recordImpressions","end");
}}}}),t.DigestFeed=t.UniversalPageFeed.extend({onPagingDone:function(){this._super.apply(this,arguments),this.emitEvent({type:c.Types.FEED_PAGING_DONE,payload:{}})}}),t.QuestionPageNuxFeed=t.UniversalPageFeed.extend({onPagingDone:function(){this._super.apply(this,arguments),this.emitEvent({type:c.Types.FEED_PAGING_DONE,payload:{}})}}),t.FeedMain=e("app/view/home").HomeMain.extend({onLoad:function(){this._super.apply(this,arguments)}}),t.PinnedFeedMain=e("app/view/home").HomeMain.extend({onLoad:function(){this._super.apply(this,arguments),this.removeQpUrlParam()},removeQpUrlParam:function(){var e=d.getURL(),t=e.indexOf("?qp_story=");-1!=t&&(d.replaceURL(e.substring(0,t)),this.child("pinned_feed").$id("@topic_feed").removeClass("invisible"))}}),t.ExpandableLink=s.extend({onLoad:function(){var e=this;this.$id("@show").click(function(){return e.$id("@inner_tree").show(),e.$id("@show").hide(),!1}),this.$id("@hide").click(function(){return e.$id("@inner_tree").hide(),e.$id("@show").show(),!1});
}}),t.ContentPageFeedStoryItemBase=s.extend({onLoad:function(){var e=this,t="";this.$id("@item .truncated_q_text a.more_link").html(t).removeClass("more_link").removeAttr("id").addClass("read_more").attr("href",this.target_url),this.$id("@item a.lil_button.rate_up").removeAttr("id").attr("href",this.target_url),this.$id("@item .answer_content").css({cursor:"pointer"}),this.$id("@item_overlay").mousedown(function(){return e.serverCall("on_item_click").send(),!1})}}),t.QuestionNumberAnswers=s.extend({onLoad:function(e){var t=this;this.$id("@link").mousedown(function(){l.setQfeedLog(t,"QuestionClickthrough"),l.setQueryLog(t,"QuestionClickthrough")})}}),t.HomepageFeedStoryItem=s.extend({init:function(){function e(){t.alreadySent||(t.alreadySent=!0,l.setMessage("vtc",[t.hash,t.view_tracking_key]),t.allowServerCall&&t.serverCall("dummy_call_nonlivedepped").send())}this._super.apply(this,arguments),this.setDvar("feed_story_hash",this.hash);var t=this;if(t.allowServerCall=!0,t.alreadySent=!1,this.parent().needsRefresh=!0,
this.$id("@item").mousedown(e),o("a",this.$id("@item")).mousedown(function(i){t.allowServerCall=i.target.pathname==window.location.pathname,e()}),this.scroll_to_top){var i=this.$id("@item").offset().top;i-=d.headerOffset+20,window.scroll(0,i),m.highlight(this.$id("@item"),2e3)}t.is_suggestion_story&&this.handleEvent(c.Types.CAROUSEL_DISMISS_ALL,function(e){e.payload.story_oid==t.oid&&t.$id("@item").fadeOut(300,function(){o(this).hide()})})},onLoad:function(){var e=this;e.questionFeedbackLoaded=!1,e.answerFeedbackLoaded=!1,f.addComponentToTrack(e),this.handleEvent(c.Types.ANSWER_VOTE_STATE,function(t){if(t.payload.aid==e.aid){var i="upvoted"==t.payload.state,n="downvoted"==t.payload.state;i?e.showRelatedStories():e.hideRelatedStories(),n?e.showAnswerDownvoteFeedback():e.hideDownvoteFeedback("answer")}}),e.handleEvent(c.Types.QUESTION_VOTE_STATE,function(t){t.payload.qid==e.qid&&("downvoted"==t.payload.state?e.showQuestionDownvoteFeedback():e.hideDownvoteFeedback("question"))}),e.handleEvent(c.Types.QUESTION_CANT_ANSWER_STATE,function(t){
if(t.payload.qid==e.qid){var i="passed"==t.payload.state;e.$id("@item").toggleClass("cant_answer",i)}})},showRelatedStories:function(){if(_.related_stories){var e=this;e.$stories=e.$id("@related_stories"),e.serverCall("load_related_stories").contentFor(e.$stories).success(function(){e.$stories.removeClass("hidden")}).send()}},hideRelatedStories:function(){},scrollFeedbackToViewport:function(){var e=this.$id("@feed_item").offset().top;o(window).scrollTop()>e&&o("html, body").animate({scrollTop:e-80},1e3)},showAnswerDownvoteFeedback:function(){var e=this;e.scrollFeedbackToViewport(),e.$id("@feed_item").addClass("hidden"),e.$id("@answer_feedback").removeClass("hidden"),e.answerFeedbackLoaded===!1&&e.serverCall("load_downvote_feedback").kwargs({feedback_type:"answer"}).contentFor(e.$id("@answer_feedback")).success(function(){e.answerFeedbackLoaded=!0}).send()},showQuestionDownvoteFeedback:function(){var e=this;e.scrollFeedbackToViewport(),e.$id("@feed_item").addClass("hidden"),e.$id("@question_feedback").removeClass("hidden"),
e.questionFeedbackLoaded===!1&&e.serverCall("load_downvote_feedback").kwargs({feedback_type:"question"}).contentFor(e.$id("@question_feedback")).success(function(){e.questionFeedbackLoaded=!0}).send()},hideDownvoteFeedback:function(e){this.$id("@feed_item").removeClass("hidden"),"question"==e?this.$id("@question_feedback").addClass("hidden"):"answer"==e&&this.$id("@answer_feedback").addClass("hidden")},getHash:function(){return this.hash},isVisible:function(){var e=o("#"+n.getLiveParent(this.cid));if(!e.is(":visible"))return!1;var t=this.$id("@item");return!t.hasClass("hidden")&&p.isElementInViewport(e.get(0))},validForLoggingImpression:function(e){var t=n.getLiveParent(this.cid);if(!t)return!1;var i=o("#"+t);return e||i.is(":visible")?!0:!1}}),t.FeedBottomIndicator=s.extend({onLoad:function(){var e=this;this.$id("@feed_bottom").click(function(){e.parent().onFeedBottomIndicatorClicked()})}}),t.InlineFollowSuggestionCard=g.extend({onLoad:function(){this._super.apply(this,arguments),this.setDvar("feed_story_inner_position",this.inner_position);
}}),t.PinnedTopicHeader=s.extend({onLoad:function(){var e=this,t=e.$id("@topic_header"),i=t.height();a.makeFixable(t,{scroll_dep:!0,min_height:i,min_scroll:i+20}),t[0].addEventListener("w2.fixable.fixed",function(){t.css({top:o(".SiteHeader").outerHeight()})})}}),t.AMASuggestionCard=g.extend({onLoad:function(){this._super.apply(this,arguments);var e=this;e.$id("@ama_suggestion_card").on("click",function(){l.setQfeedLog(e,"AMAClickthrough")}),e.is_group_ama?r(e.$id("@ama_suggestion_card .group_name").get(0),{lines:1}):(r(e.$id("@ama_suggestion_card .name").get(0),{lines:1}),r(e.$id("@ama_suggestion_card .sig").get(0),{lines:2}))}})}),define("app/view/feed/ama",["shared/polyfills","shared/core/component","shared/views"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/views").viewsLogger;t.AMAFeedItem=n.extend({onLoad:function(){o.addComponentToTrack(this)}}),t.AMAListItem=n.extend({onLoad:function(){var e=this;e.$id("@item_button").click(function(){e.is_following||e.serverCall("show_pmsg").liveMutate().send(),
e.is_following=!e.is_following})}})}),define("app/view/feed/question",["shared/polyfills","shared/core/component","shared/events/index","shared/util","shared/jquery"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/events/index"),s=e("shared/util").firstScrollingParent,a=e("shared/jquery");t.QuestionStoryEditable=n.extend({onLoad:function(){this.$editorElem=this.getEditor(),this.$storyElem=this.getStory(),this.$hoverElem=this.$storyElem.closest(".hover_highlight");var e=this;this.handleEvent(o.Types.QUESTION_EDITING_STATE,function(t){t.payload.qid==e.qid&&("edit"==t.payload.state?e.openEditor():"request"==t.payload.state?e.closeEditor():"cancel"==t.payload.state&&e.closeEditor())}),this.editor_fetched=!1},getEditor:function(){return this.$id("@question_story_editable")},getStory:function(){return this.$id("@question_story")},loadEditor:function(){this.editor_fetched=!0,this.serverCall("load_editor").contentFor(this.$editorElem).send()},openEditor:function(){var e=s(this.$storyElem.get(0));
e!==document.body&&a(e).scrollTop(0),this.$storyElem.addClass("hidden"),this.$editorElem.removeClass("hidden"),this.$hoverElem&&this.$hoverElem.removeClass("hover_highlight"),this.editor_fetched||this.loadEditor()},closeEditor:function(){this.$editorElem.addClass("hidden"),this.$storyElem.removeClass("hidden"),this.$hoverElem&&this.$hoverElem.addClass("hover_highlight")}}),t.QuestionStoryEditableToggled=n.extend({onLoad:function(){this.$id("@feed_question_update").on("click",this.updateQuestion.bind(this)),this.$id("@feed_question_cancel").on("click",this.closeEditor.bind(this))},updateQuestion:function(){this.emitEvent({type:o.Types.QUESTION_EDITING_STATE,payload:{qid:this.qid,state:"request"}})},closeEditor:function(){this.emitEvent({type:o.Types.QUESTION_EDITING_STATE,payload:{qid:this.qid,state:"cancel"}})}})}),define("app/view/feed/answer",["shared/polyfills","app/view/feed/question"],function(e,t,i){var n=e("app/view/feed/question");t.EditableQuestionAnswerStory=n.QuestionStoryEditable.extend({
getEditor:function(){return this.$id("@question_answer_story_editable")},getStory:function(){return this.$id("@answer_story")}})}),define("app/view/feed/feedback",["shared/polyfills","shared/core/component","shared/events/index"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/events/index");t.Feedback=n.extend({onLoad:function(){var e=this;e.can_undo&&e.$id("@undo").click(function(t){t.preventDefault(),e.undoDownvote(),e.serverCall("undo").liveMutate().error(function(){e.redoDownvote()}).send()})},undoDownvote:function(){"question"==this.type?this.emitEvent(o.helpers.removeQuestionDownvote(this.oid)):"answer"==this.type&&this.emitEvent(o.helpers.removeAnswerDownvote(this.oid))},redoDownvote:function(){"question"==this.type?this.emitEvent(o.helpers.addQuestionDownvote(this.oid)):"answer"==this.type&&this.emitEvent(o.helpers.addAnswerDownvote(this.oid))}})}),define("unified_view/button/abstract",["shared/polyfills","shared/core/component","interface/settings","shared/cookies","shared/perf","shared/client"],function(e,t,i){
var n=e("shared/core/component").Component,o=e("interface/settings"),s=e("shared/cookies"),a=e("shared/perf");t.Button=n.extend({onLoad:function(){if(this._userPerceivedAction=null,!this.disabled){var e=this,t=e.$id("@button");t.on("click",function(t){t.preventDefault(),e.onClick()})}},onClick:function(){this.onPressed()},onPressed:function(){var e=this;e.qfeed_log_press_action&&s.setQfeedLog(e,e.qfeed_log_press_action),this._userPerceivedAction=a.startUserPerceived({vcon:this.__vcon,method:"press"}),this.serverCall("press").disableDefaultUserPerceivedLogging().liveMutate().error(function(){e.switchState(!1)}).send()}}),t.TwoStateButton=t.Button.extend({onClick:function(){this.dirtyURL();var e=this.pressed;e?this.onUnpressed():this.onPressed(),this.switchState(!e)},dirtyURL:function(){var t=this;if(o.pageIsMobile&&t.url_to_dirty&&e("shared/client").isNativeApp()){var i=e("mobile_app2/messages");i.send("removeURLFromCache",{url:t.url_to_dirty})}},switchState:function(e){if(this.pressed!=e&&o.isLoggedIn){
var t=this.$id("@button"),i=this.$id("@text"),n=i.text();if(i.text(this.optimistic_text),this.optimistic_text=n,this.optimistic_count){var s=this.$id("@count");"0"===this.optimistic_count?s.addClass("hidden"):s.removeClass("hidden");var r=s.text();s.text(this.optimistic_count),this.optimistic_count=r}this.pressed?t.removeClass("pressed"):t.addClass("pressed"),this.pressed=e,this._userPerceivedAction&&(a.finishAction(this._userPerceivedAction),this._userPerceivedAction=null)}},onPressedKwargs:function(){return{}},onPressed:function(){var e=this;e.qfeed_log_press_action&&s.setQfeedLog(e,e.qfeed_log_press_action),this._userPerceivedAction=a.startUserPerceived({vcon:this.__vcon,method:"press"});var t=this.onPressedKwargs();this.serverCall("press").disableDefaultUserPerceivedLogging().liveMutate({optimisticUpdate:!0}).kwargs(t).error(function(){e.switchState(!1)}).send()},onUnpressedKwargs:function(){return{}},onUnpressed:function(){var e=this;e.qfeed_log_unpress_action&&s.setQfeedLog(e,e.qfeed_log_unpress_action),
this._userPerceivedAction=a.startUserPerceived({vcon:this.__vcon,method:"unpress"});var t=this.onUnpressedKwargs();this.serverCall("unpress").disableDefaultUserPerceivedLogging().liveMutate({optimisticUpdate:!0}).kwargs(t).error(function(){e.switchState(!0)}).send()}})}),define("unified_view/button/write_answer",["shared/polyfills","interface/settings","shared/events/index","unified_view/button/abstract"],function(e,t,i){var n=e("interface/settings"),o=e("shared/events/index"),s=e("unified_view/button/abstract").Button;t.WriteAnswer=s.extend({onLoad:function(){this.use_answer_draft_page||this._super.apply(this,arguments)},onClick:function(){return this.logged_in?(n.pageIsMobile||this.$id("@button").addClass("disabled"),void this.emitEvent({type:o.Types.ANSWER_TOGGLE_EDITOR,payload:{qid:this.qid,bundle:this.getDvar("__writeMultiFeedBundle")}})):void this.serverCall("force_login").send()}})}),define("app/view/feed/modal",["shared/polyfills","view/modal","unified_view/toggle","shared/events/index","unified_view/button/write_answer","shared/client_tracker","shared/cookies","shared/window_manager","shared/logging","shared/beforeunload","w2.modal"],function(e,t,i){
var n,o=e("view/modal").ToggleModal,s=e("unified_view/toggle").ToggleBase,a=e("shared/events/index"),r=e("unified_view/button/write_answer").WriteAnswer,d=e("shared/client_tracker"),l=e("shared/cookies"),c=e("shared/window_manager"),h=e("shared/logging"),u=e("shared/beforeunload"),p=e("w2.modal");n=c.getURL(),u.registerHandler(function(){c.replaceURL(n)});var f=p.ModalBase.extend({_onCloseCallBack:null,_onContentVisibleCallBack:null,onCloseCallBack:function(e){return this._onCloseCallBack=e,this},close:function(){this._super.apply(this,arguments),this._onCloseCallBack&&this._onCloseCallBack()},onContentVisibleCallBack:function(e){this._onContentVisibleCallBack=e},onContentVisible:function(){this._super.apply(this,arguments),this._onContentVisibleCallBack&&this._onContentVisibleCallBack()}}),_=t.StoryItemToggleModal=o.extend({initModal:function(){this._modal=new f(this,{kwargs:{serialized_args:this.serialized_args},closeOnScroll:this.close_on_scroll,showFixedCloseButton:!0,customOverlayClass:"feed_desktop_modal"
}).onCloseCallBack(this.closeModal.bind(this));var e=this;this.handleEvent(a.Types.QUESTION_EDITING_STATE,function(t){("Answer"==e.obj_type&&t.payload.qid==e.qid||"Question"==e.obj_type&&t.payload.qid==e.obj_id)&&("edit"==t.payload.state?e._disableOpen=!0:("request"==t.payload.state||"cancel"==t.payload.state)&&(e._disableOpen=!1))})},showModal:function(){this._disableOpen||(this._super.apply(this,arguments),this.emitEvent({type:a.Types.FEED_IMPRESSIONS_DISABLED,payload:{disabled:!0}}),this.qfeed_primary_action&&(d.track(this.qfeed_primary_action,null,this),l.setQfeedLog(this,this.qfeed_primary_action)),c.replaceURL(this.story_url),this._logAction("open"))},closeModal:function(){this.emitEvent({type:a.Types.FEED_IMPRESSIONS_DISABLED,payload:{disabled:!1}}),c.replaceURL(n),this._logAction("close")},handleClick:function(e){e.preventDefault(),this.$inlineElem.addClass("read_item"),0!==e.button||e.ctrlKey||e.metaKey||e.shiftKey?window.open(this.story_url,"_blank"):this.onModalClick()},onModalClick:function(){
this.showModal()},_logAction:function(e){h.log("web_modal_reading_time",{action:e,time:Date.now(),object_type:this.obj_type,object_id:this.obj_id,page_type:this.page_type})}});t.AnswerStoryToggleModal=_.extend({onModalClick:function(){this._modal.onContentVisibleCallBack(this.emitModalContentVisibleEvent.bind(this)),this._super.apply(this,arguments)},emitModalContentVisibleEvent:function(){this.emitEvent({type:a.Types.ANSWER_MODAL_CONTENT_VISIBLE,scope:a.scope.GLOBAL,payload:{aid:this.obj_id}})}}),t.AnswerFooterToggle=s.extend({onLoad:function(){this._super.apply(this,arguments);var e=this;e.handleEvent(a.Types.ANSWER_MODAL_CONTENT_VISIBLE,function(t){t.payload.aid==e.aid&&e.triggerSwitch()})}}),t.WriteAnswerButton=r.extend({onLoad:function(){var e=this,t=e.$id("@button");t.on("click",function(t){t.preventDefault(),e.onClick()})},onClick:function(){new f(this,{kwargs:{qid:this.qid,serialized_dvars:this.serialized_dvars},showFixedCloseButton:!0,customOverlayClass:"feed_desktop_modal"}).load("load_modal");
}})}),define("app/view/funnel",["shared/polyfills","shared/core/component"],function(e,t,i){var n=e("shared/core/component").Component;t.FunnelState=n.extend({onLoad:function(){var e=this;e.$id("@show_unstarted").click(function(){e.$id("@unstarted").show(),e.$id("@show_unstarted").hide()}),e.$id("@refresh").click(function(){window.location.reload()})}}),t.ResetFunnelLink=n.extend({onLoad:function(){var e=this;e.$id("@reset").click(function(){e.serverCall("reset_funnel").success(function(){window.location.reload()}).send()})}}),t.ActivateFunnelLink=n.extend({onLoad:function(){var e=this;e.$id("@activate").click(function(){e.serverCall("activate_funnel").liveMutate().send()})}})}),define("app/view/growl",["shared/polyfills","shared/core/component"],function(e,t,i){var n=e("shared/core/component").Component,o=!1;t.GrowlBase=n.extend({onLoad:function(e){var t=this;this.growl=this.$id("@growl"),this.age_sec<(e?1.5:15)&&this.show(!e),this.growl.mouseover(function(e){t.growl.hasClass("fade_out")||(clearTimeout(t.hideTimer),
t.growl.removeClass("fade_out"),t.customMouseOver())}),this.growl.mouseout(function(e){t.hideAfter(1)}),this.hideAfter(this.visible_sec)},show:function(e){var t=this;o&&(e=!1),o=!0,e&&this.growl.addClass("fade_in"),this.growl.removeClass("fade_out").removeClass("hidden"),e&&setTimeout(function(){t.growl.removeClass("fade_in")},200)},hideAfter:function(e){this.hideTimer=setTimeout(this.hide.bind(this),1e3*e)},hide:function(){var e=this;this.growl.addClass("fade_out"),setTimeout(function(){e.growl.hasClass("fade_out")&&(e.growl.addClass("hidden").removeClass("fade_out"),o=!1)},1250)},customMouseOver:function(){}})}),define("app/view/intro_to_quora",["shared/polyfills","shared/jquery","shared/core/component"],function(e,t,i){var n=e("shared/jquery"),o=e("shared/core/component").Component;t.ITQSidebar=o.extend({onLoad:function(){var e=this;e.stepHandler=function(t){e.nextStep(t)},e.introToQuoraSidebar=e.$id("@intro_to_quora_sidebar"),e.activeInstruction=n(".sidebar_step_show"),e.highlight(e.currStep),
e.scrollToStory(e.currStep),e.$id("@close").one("click",function(){e.cancel()}),n("div[sidebar-selector=next_step]").one("click",function(){e.nextStep()}),n("div[sidebar-selector=opt_out]").one("click",function(){e.cancel()}),e.serverCall("log_impression").send()},nextStep:function(){var e=this;e.activeInstruction=e.activeInstruction.next(),0!==e.activeInstruction.length?(e.activeInstruction.prev().hide(0),e.activeInstruction.show(0),e.currStep++,e.highlight(e.currStep),e.scrollToStory(e.currStep),e.serverCall("complete_step").kwargs({step_num:e.currStep}).send()):(e.serverCall("complete_itq").liveMutate().send(),e.close())},highlight:function(e){this.clearHighlight();var t={pinned_topics:{selector:".HomeNavList"},upvote:{selector:".add_upvote"},follow:{selector:".itq_follow"},answer:[{selector:".answer_editor"},{selector:".write_answer"}],ask:{selector:".AddQuestionLookupBarButton",noticeSuffix:"_bottom_left"}};e=e.toString();var i=this.stepMap[e];if(i in t){var o=t[i];Array.isArray(o)||(o=[o]);
for(var s=0;s<o.length;s++){var a=o[s],r="itq_notice_bubble",d=a.selector;"undefined"!=typeof a.noticeSuffix&&(r+=a.noticeSuffix),n(d).addClass(r),n(d).one("click",this.stepHandler)}}"ask"===i&&this.introToQuoraSidebar.addClass("intro_to_quora_sidebar_point_up")},clearHighlight:function(){for(var e=["","_bottom_left","_smaller"],t=0;t<e.length;t++){var i="itq_notice_bubble"+e[t];n("."+i).off("click",this.stepHandler),n("."+i).removeClass(i)}this.introToQuoraSidebar.removeClass("intro_to_quora_sidebar_point_up")},selectStory:function(e){var t={upvote:"a.add_upvote",follow:"a.itq_follow",answer:"a.write_answer"},i=null,o=this.stepMap[e.toString()];if(!(o in t))return null;i=t[o],Array.isArray(i)&&(i=i.join(","));for(var s=n(".pagedlist_item").has(i),a=null,r=0;r<s.length;r++){var d=n(s[r]),l=d.offset().top-n(window).scrollTop();if(l-=n(window).scrollTop()?n(".SiteHeader").height():n(".Feed").offset().top,l>=0)return d;a=d}return a},scrollToStory:function(e){var t=this,i=t.selectStory(e);if(null!==i)if(0===i.prev(".pagedlist_item").length)n("body").animate({
scrollTop:0},1e3);else{var o=i.prev(".pagedlist_item"),s=o.offset().top+o.height()-n(".SiteHeader").height();n("body").animate({scrollTop:s},1e3)}},close:function(){var e=this;e.clearHighlight(),n(".sidebar_title").css("white-space","nowrap"),e.introToQuoraSidebar.animate({opacity:0},1e3),e.introToQuoraSidebar.addClass("hidden")},cancel:function(){this.serverCall("cancel_itq").liveMutate().send(),this.close()}})}),define("shared/youtube",["shared/polyfills","shared/loadjs","shared/util","shared/onload"],function(e,t,i){var n=e("shared/loadjs").loadJS,o=e("shared/util"),s=e("shared/onload"),a=[],r=!1,d=o.once(function(){n("//www.youtube.com/player_api",function(){for(r=!0;a.length;)a.pop().call()})});t.onInit=function(e){r?e():(s.execAfterLoadDelayed(d),a.push(e))}}),define("view/livenode",["shared/polyfills","shared/log","shared/jquery","webnode2","shared/events/index","w2.livenode","shared/core/component","shared/window_manager","shared/loading"],function(e,t,i){var n=e("shared/log").log,o=e("shared/jquery"),s=e("webnode2"),a=e("shared/events/index"),r=e("w2.livenode"),d=e("shared/core/component"),l=d.Component,c=e("shared/window_manager"),h=e("shared/loading");
t.LiveSpinner=l.extend({init:function(){this._super.apply(this,arguments),this.t=null,this.showing=!1;var e=this;this.handleEvent(a.Types.LIVENODE_LOADING_SPINNER,function(t){t.payload.show?e.show():e.hide()})},show:function(){this.showing||(this.showing=!0,this.spinner||(this.spinner=h.createLoadingDotsElement({size:"small"}),this.$id("@spinner").append(this.spinner)),this.$id("@loading").removeClass("fade_out").removeClass("hidden"))},hide:function(){var e=this;this.showing&&(this.showing=!1,this.$id("@loading").addClass("fade_out"),setTimeout(function(){e.$id("@loading").hasClass("fade_out")&&e.$id("@loading").removeClass("fade_out").addClass("hidden")},150))}}),t.ErrorBanner=l.extend({init:function(){var e=this;this._super.apply(this,arguments),s.Error=this,this.shown=!1,this.$id("@hide").click(function(){return e.hide(),!1})},show:function(e){e=e||this.default_text,this.$id("@text").text(e),this.shown||(this.shown=!0,this.emitEvent({type:a.Types.INTERACTION_MODE_BANNER_STATE,payload:{
shown:!0}}),this.$id("@banner").show().addClass("fade_in"),u())},hide:function(){if(this.shown){this.shown=!1,this.emitEvent({type:a.Types.INTERACTION_MODE_BANNER_STATE,payload:{shown:!1}});var e=this;e.$id("@banner").removeClass("fade_in").addClass("fade_out"),setTimeout(function(){e.$id("@banner").hide()},150),p()}}});var u=t.addContentPadding=function(){o(".ContentWrapper").addClass("extra_padding"),o(".NotifHeaderBar").addClass("extra_padding")},p=function(){o(".ContentWrapper").removeClass("extra_padding"),o(".NotifHeaderBar").removeClass("extra_padding")};t.InteractionModeBanner=l.extend({init:function(){this._super.apply(this,arguments),s.interactionMode=this,this._changedComponents={},this._cidToDomId={},this._otherInteractions={},this._states={OFF:0,PENDING:1,ON:2,BLOCKING:3}},onLoad:function(){n&&n.enabled&&n("w2.interaction.InteractionModeBanner.onLoad","onLoad is called on",this),this.resumeUpdates(),this._state=this._states.OFF,this._lastVal=null,this._lastDOMNode=null,this.bindInteractionMode();
},updateStateForLastFocusedDOMElement:function(e){var t;if(!e)return!1;if(this._state==this._states.PENDING)return t=this._getCIDForElement(e),this._lastVal==this._val(e)?(this._changedComponents[t]=this._states.OFF,!1):(this._changedComponents[t]=this._states.ON,this._cidToDomId[t]=this._getLiveDOMIdForElement(e),!0);if(this._state==this._states.ON){t=this._getCIDForElement(e);var i=this._changedComponents[t];return this._lastVal==this._val(e)&&i==this._states.PENDING?(this._changedComponents[t]=this._states.OFF,!1):(this._changedComponents[t]=this._states.ON,this._cidToDomId[t]=this._getLiveDOMIdForElement(e),!0)}return!1},_getLiveDOMIdForElement:function(e){return e.id&&"ld_"==e.id.substr(0,3)?e.id:e.parentNode?this._getLiveDOMIdForElement(e.parentNode):null},_getCIDForElement:function(e){return e&&e.getAttribute?e.getAttribute("w2cid")?e.getAttribute("w2cid"):this._getCIDForElement(e.parentNode):null},isBlocking:function(){return this._state==this._states.BLOCKING},startBlocking:function(){
var e=this;console.log("startBlocking called");var t=[];o.each(this._changedComponents,function(i,n){if(n==e._states.ON||n==e._states.PENDING){var o=d._components[i];o.meaningfulChangeCallback&&!o.draft_space&&t.push(o)}}),this.showBanner(t),u(),this._setBlockingState()},_setBlockingState:function(){this._state=this._states.BLOCKING},bindInteractionMode:function(){var e=this;o(document).on("focus",'[data-group="js-editable"]:not(.ignore_interaction)',function(t){var i=e._getCIDForElement(t.target);if(e._lastVal=e._val(t.target),e._lastDOMNode=t.target,0===r.state.pendingMutationCount)if(e._state==e._states.OFF)e._changedComponents[i]=e._states.PENDING,e._state=e._states.PENDING;else{var n=e._changedComponents[i];n&&n!=e._states.OFF||(e._changedComponents[i]=e._states.PENDING)}}),o(document).on("blur",'[data-group="js-editable"]:not(.ignore_interaction)',function(t){switch(e._state){case e._states.PENDING:e.updateStateForLastFocusedDOMElement(t.target),e._lastVal==e._val(t.target)?e._state=e._states.OFF:e._state=e._states.ON;
break;case e._states.ON:e.updateStateForLastFocusedDOMElement(t.target);break;case e._states.OFF:case e._states.BLOCKING:break;default:console.error("Unknown state of InteractionMode at blur time... weird")}})},_val:function(e){var t=o(e);return t.is(":input")?t.val():t.html()},_setVal:function(e,t){var i=o(e);i.is(":input")?i.val(t):i.html(t)},showBanner:function(e){return this.emitEvent({type:a.Types.INTERACTION_MODE_BANNER_STATE,payload:{shown:!0}}),e.length>0&&(this.$id("@draftable").removeClass("hidden"),this.$id("@not_draftable").addClass("hidden"),this.$id("@resume").click(function(t){return o.each(e,function(e,t){t.meaningfulChangeCallback()}),c.reload(),!1})),this.$id("@banner").show().removeClass("fade_out").addClass("fade_in")},hideBanner:function(){this.emitEvent({type:a.Types.INTERACTION_MODE_BANNER_STATE,payload:{shown:!1}});var e=this;e.$id("@banner").removeClass("fade_in").addClass("fade_out"),setTimeout(function(){e.$id("@banner").hide()},150)},resumeUpdates:function(){
this._state=this._states.OFF,this._changedComponents={},this.hideBanner(),p();for(var e=r.state.interactionDelayedLivedepOperations;e.length>0&&this._state==this._states.OFF;){var t=e.shift();r.onLivedepOperations(t.data,t.textStatus,!0)}}})}),define("app/view/layout",["shared/polyfills","shared/core/component","shared/jquery","shared/youtube","w2.livenode","view/livenode","shared/keystrokes","shared/keyboard_event_handler"],function(e,t,i){function n(e,t){a.each(window.YT.players,function(i,n){n.playerId==t&&(n.state=e.data,n.state==window.YT.PlayerState.PLAYING&&n.onReady&&(n.onReady(n),n.onReady=null))}),e.data==window.YT.PlayerState.PLAYING&&o(t)}function o(e){window.YT&&window.YT.players&&a.each(window.YT.players,function(t,i){i.playerId!=e&&i.player&&a("#"+i.playerId).length&&i.player.pauseVideo()})}var s=e("shared/core/component").Component,a=e("shared/jquery"),r=e("shared/youtube"),d=e("w2.livenode"),l=e("view/livenode").addContentPadding,c=e("shared/keystrokes"),h=e("shared/keyboard_event_handler");
t.QTextImageEnlarger=s.extend({onLoad:function(){var e=this;a(document).on("click",".qtext_image",function(t){e.openModal(t)}),a(document).on("click",".photo_modal_bg, .photo_modal_close",function(){for(var t in e.masters)e.hideModal(e.masters[t])})},getContainer:function(e,t){var i=this;return i.masters={},i.masters[e]||(i.masters[e]=a("<div>").addClass("photo_modal_container").append(a("<div>").addClass("photo_modal_bg")).append(a("<div>").addClass("photo_modal_close")).append(a("<img>").addClass("photo_modal_img").attr("src",e)).append(a("<img>").addClass("photo_modal_img_large").attr("src",t)))},openModal:function(e){function t(){S&&E&&(g.find(".photo_modal_img_large").css("visibility","visible"),g.find(".photo_modal_img").css("visibility","hidden"))}var i=this,n=a(e.target),o=n.attr("src"),s=n.attr("master_src"),r=n.hasClass("zoomable_in"),d=n.parents(".truncated_q_text").length>0,l=n.hasClass("qtext_image_large"),c=d&&!l;if(r&&s&&!c){var u=parseInt(n.attr("master_w")),p=parseInt(n.attr("master_h")),f=a(window).width(),_=a(window).height(),g=i.getContainer(o,s),m=!1;
p>3*_&&p/u>3&&(m=!0),u>f&&(p*=(f-40)/u,u=f-40),p>_&&(u*=(_-40)/p,p=_-40);var v=n.offset().left,w=n.offset().top-a(window).scrollTop(),b=Math.round((f-n.width())/2-v),y=Math.round((_-n.height())/2-w),C=u/n.width();g.find(".photo_modal_img").css("left",v).css("top",w).css("width",n.width()).css("height",n.height()),m&&g.find(".photo_modal_img").css("visibility","hidden"),g.appendTo("body"),n.css("visibility","hidden");var k=a(document).scrollTop();a("body").css({position:"fixed",width:"100%",top:-k});var x=g.find(".photo_modal_close").outerWidth();m?g.find(".photo_modal_close").css("left",(f+parseInt(n.attr("master_w")))/2-x).css("top",(_-p)/2):g.find(".photo_modal_close").css("left",(f+u)/2-x).css("top",(_-p)/2),i.handler=function(e){27==e.keyCode&&(e.preventDefault(),i.hideModal(g))},h.push(i.handler),setTimeout(function(){g.find(".photo_modal_bg, .photo_modal_close").addClass("active"),m?g.find(".photo_modal_bg").css("height",20+parseInt(n.attr("master_h"))):g.find(".photo_modal_img").css("transform","translate3d("+b+"px,"+y+"px,0) scale("+C+")").css("-moz-transform","translate3d("+b+"px,"+y+"px,0) scale("+C+")").css("-ms-transform","translate3d("+b+"px,"+y+"px,0) scale("+C+")").css("-o-transform","translate3d("+b+"px,"+y+"px,0) scale("+C+")").css("-webkit-transform","translate3d("+b+"px,"+y+"px,0) scale("+C+")");
},1);var S=!1,E=!1;setTimeout(function(){E=!0,t()},333),m&&g.css("position","fixed").css("overflow","scroll"),g.find(".photo_modal_img_large").on("load",function(){a(this).css("top",(_-p)/2),m?a(this).css("position","relative").css("left",(f-n.attr("master_w"))/2):a(this).css("left",(f-u)/2).css("width",u).css("height",p),S=!0,t()})}},hideModal:function(e){h.remove(this.handler),e.find(".photo_modal_bg, .photo_modal_close").removeClass("active"),e.find(".photo_modal_img_large").remove(),e.find(".photo_modal_img").css("visibility","visible"),e.find(".photo_modal_img").css("-webkit-transform","translate3d(0,0,0) scale(1)"),e.find(".photo_modal_img").css("-moz-transform","translate3d(0,0,0) scale(1)"),e.find(".photo_modal_img").css("-ms-transform","translate3d(0,0,0) scale(1)"),e.find(".photo_modal_img").css("-o-transform","translate3d(0,0,0) scale(1)"),e.find(".photo_modal_img").css("ms-transform","translate3d(0,0,0) scale(1)"),setTimeout(function(){a(".qtext_image").css("visibility","visible");
var t=Math.abs(parseInt(a("body").css("top")));a("body").css({position:"",width:"",top:""}),t&&a(document).scrollTop(t),e.remove()},333)}}),t.QTextGIFPlayer=s.extend({onLoad:function(e){e&&a(document).click(function(e){var t=a(e.target).parent("[gif-embedded]");if(t){var i=t.attr("gif-embedded"),n=t.attr("background-url");if("false"==t.attr("is-playing")){var o=new Image;o.onload=function(){t.children(".qtext_image").attr("src",i),t.children(".gif_embed_noclick").css("visibility","hidden"),t.attr("is-playing","true")},o.src=i}else t.children(".qtext_image").attr("src",n),t.children(".gif_embed_noclick").css("visibility","visible"),t.attr("is-playing","false")}})}}),t.QTextEmbedEnlarger=s.extend({onLoad:function(e){var t=this;e&&a(document).click(function(e){var i,n=a(e.target);n.attr("data-embed")?i=n.attr("data-embed"):(n=n.parent(),i=n&&n.attr("data-embed")),i&&n.hasClass("thumbnail")&&t.loadEmbed(n,i)})},loadEmbed:function(e,t){window.YT||(window.YT={},window.YT.players=[],window.YT.next_id=0);
var i=this;r.onInit(function(){if(!window.YT.Player)return void setTimeout(i.loadEmbed.bind(i,e,t),100);e.append(t).removeClass("thumbnail");var s="YTPlayer-"+window.YT.next_id++;e.find(":first-child").attr("id",s);var a=new window.YT.Player(s,{events:{onStateChange:function(e){return n(e,s)}}});window.YT.players.push({player:a,playerId:s,state:-1}),o(s)})}}),t.GridGuide=s.extend({onLoad:function(){this.setupKeyboardShortcut()},toggle:function(){this.$id("@grid-guide").is(":visible")?this.$id("@grid-guide").fadeOut(150):this.$id("@grid-guide").fadeIn(150)},setupKeyboardShortcut:function(){c.on([71,82,73,68],this.toggle.bind(this))}}),t.BrowserWarning=s.extend({onLoad:function(){l()}}),t.LogoutNavElement=s.extend({onLoad:function(){var e=this;this.$id("@logout_link").click(function(){return e.$id("@logout_form").submit(),d.stopLiveUpdates(),!1})}})}),define("app/view/link",["shared/polyfills","shared/core/component"],function(e,t,i){var n=e("shared/core/component").Component;t.NewLinkEditor=n.extend({
onLoad:function(){var e=this;this.$id("@link_no_image").click(function(){return e.clearAllSelected(),e.setDisplayType("link_no_image"),e.$id("@link_no_image").addClass("selected"),!1}),this.$id("@link_small_image").click(function(){return e.clearAllSelected(),e.setDisplayType("link_small_image"),e.$id("@link_small_image").addClass("selected"),!1}),this.$id("@link_large_image").click(function(){return e.clearAllSelected(),e.setDisplayType("link_large_image"),e.$id("@link_large_image").addClass("selected"),!1}),this.$id("@remove_url").click(function(){return e.parent().removeUrl(),!1})},clearAllSelected:function(){this.$id("@link_no_image").removeClass("selected"),this.$id("@link_small_image").removeClass("selected"),this.$id("@link_large_image").removeClass("selected")},getPreviewLinkInfo:function(){return this.child("preview").getLinkInfo()},setDisplayType:function(e){var t;t="link_no_image"==e?1:"link_small_image"==e?2:3,this.child("preview").setDisplayType(e,t)}}),t.LinkVideo=n.extend({
onLoad:function(){var e=this;this.$id("@video_wrapper").click(function(){e.parent().playVideo(),e.$id("@video_wrapper .qtext_embed.thumbnail").css("width","100%").css("height","272px")})}}),t.LinkImageEditor=n.extend({onLoad:function(){var e=this;this.index=0,this.$id("@next_photo").click(function(t){return e.cycle_photo(1),!1}),this.$id("@prev_photo").click(function(t){return e.cycle_photo(e.keys_and_sources.length-1),!1}),this.$id("@link").click(function(){e.serverCall("track").send()})},get_image_keys:function(){if(this.keys_and_sources!={}){for(var e=[],t=this.index,i=0,n=this.keys_and_sources.length;n>i;i++,t=(t+1)%n)e.push(this.keys_and_sources[t][0]);return e}return[]},cycle_photo:function(e){var t=this.index;this.index=(t+e)%this.keys_and_sources.length,this.$id("@img").attr("src",this.keys_and_sources[this.index][1])}}),t.LinkTitle=n.extend({onLoad:function(){var e=this;this.$id("@link").click(function(){e.serverCall("track").send()})},getValue:function(){return this.child("editor").get_value();
}}),t.Link=n.extend({getLinkInfo:function(){this.link_info.title=this.child("title").getValue(),this.link_info.snippet=this.child("snippet").child("editor").get_value();var e=this.child("media");return e.editable&&(this.link_info.image_keys=e.get_image_keys()),this.link_info},setDisplayType:function(e,t){this.$id("@link_wrapper").removeClass().addClass(e),this.link_info.display_type=t},playVideo:function(){var e=2;this.link_info.display_type==e&&(this.$id("@image_col").css("float","left"),this.$id("@info_col").css("float","left"),this.$id("@image_col").css("width","100%"),this.$id("@image_and_info").css("display","block"))}})}),define("app/view/linkedin_",["shared/polyfills","shared/core/component","shared/jquery"],function(e,t,i){var n=e("shared/core/component").Component;t.LinkedinCallbackPage=n.extend({onLoad:function(){if(window.opener){var e=window.opener.require("shared/jquery");e(window.opener.document).trigger("linkedin_oauth_approved",this.liUid),window.close()}}})}),define("app/view/login",["shared/polyfills","shared/core/component"],function(e,t,i){
var n=e("shared/core/component").Component;t.LogoutAllSessionsButton=n.extend({onLoad:function(){var e=this;e.$id("@logout").click(function(t){return e.serverCall("logout_all_sessions").liveMutate().send(),!1})}})}),define("app/view/manage",["shared/polyfills","shared/core/component","shared/dom","shared/jquery","view/modal","shared/events/index"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/dom"),s=e("shared/jquery"),a=e("view/modal").Base,r=e("shared/events/index"),d=r.GlobalProxy;t.FeedControlModal=a.extend({onLoad:function(){var e=this;e._super.apply(this,arguments);var t=e.$id("@organize"),i=e.$id("@discover"),n=s("#__w2_modal_overlay_"),o=e.child("feed_control_container").$id("@organize"),a=e.child("feed_control_container").$id("@discover");t.click(function(){t.addClass("selected"),o.removeClass("hidden"),i.removeClass("selected"),a.addClass("hidden")}),i.click(function(){i.addClass("selected"),a.removeClass("hidden"),t.removeClass("selected"),o.addClass("hidden");
}),n.on("mousedown",function(t){t.target!=this||e._isScrollBarClicked(t)||e.maybeRefreshFeed()}),e.serverCall("maybe_complete_zapdos").send(),this._updatedItems={},this.handleEvent(r.Types.FEED_CONTROL_UPDATE,function(t){var i=t.payload.contentRowCid;e._updatedItems[i]?delete e._updatedItems[i]:e._updatedItems[i]=!0})},_isScrollBarClicked:function(e){var t=o.getScrollbarWidth();return window.innerWidth-e.clientX<t?!0:!1},onClose:function(){this.maybeTriggerRefreshFeedButton()},onSubmit:function(){this.maybeTriggerRefreshFeedButton()},onCancel:function(){this.maybeTriggerRefreshFeedButton()},maybeTriggerRefreshFeedButton:function(){this._closeModal(),Object.keys(this._updatedItems).length>0&&d.dispatch({type:r.Types.DISCOVER_TOOL_CONFIRMED,payload:{}})},refreshFeed:function(){var e=this,t=s("#feed_control_update_feed_screen"),i=5500;t.removeClass("hidden"),e.serverCall("refresh_feed").success(function(){setTimeout(t.addClass("hidden"),i)}).error(function(){setTimeout(t.addClass("hidden"),i);
}).liveMutate().send()}}),t.FeedControlModalLink=n.extend({onLoad:function(){var e=this;this.$id("@create_modal_link").on("click",function(){return e.createModal("load_inner").kwargs({default_tab:e.default_tab}).webOnlyOptions({closeOnBackgroundClick:!1}).show(),!1})}}),t.FeedControlContent=n.extend({onLoad:function(){var e=this;e.feed_control_contents={};for(var t in e.content_ids){var i=e.content_ids[t],n="@"+i;e.feed_control_contents[i]={js_id:n,scroll_position:0}}for(var o in e.feed_control_contents){var s=e.feed_control_contents[o],a=e._createOnLinkClicked(o),r=e.child("filter_section").$id(s.js_id);r.click(a.bind(this))}},_createOnLinkClicked:function(e){var t=this;return function(){var i=t.feed_control_contents[t.active_id],n=t.child("filter_section").$id(i.js_id),o=t.$id(i.js_id);i.scroll_position=o.parent().scrollTop(),n.removeClass("selected"),o.addClass("hidden");var s=t.feed_control_contents[e],a=t.child("filter_section").$id(s.js_id),r=t.$id(s.js_id);a.addClass("selected"),
r.removeClass("hidden"),r.parent().scrollTop(s.scroll_position),t.active_id=e}}}),t.FeedControlContentRow=n.extend({onLoad:function(){var e=this;this.$id("@item_button").on("click",function(){e.emitEvent({type:r.Types.FEED_CONTROL_UPDATE,payload:{contentRowCid:e.cid}})})}}),t.FeedControlsPopover=n.extend({hide:function(){this.$id("@popover").addClass("hidden")}}),t.DismissFeedControlsPopoverLink=n.extend({onLoad:function(){var e=this;this.$id("@dismiss_link").on("click",function(){e.parent().hide()})}}),t.DiscoverInlineFeedCallToAction=n.extend({onLoad:function(){var e=this;e.serverCall("log_impression").send(),this.$id("@dismiss_link").on("click",function(){e.serverCall("dismiss").send(),e.$id("@main_card").addClass("hidden")})}})}),define("app/view/messages",["shared/polyfills","shared/core/component","shared/jquery","view/modal"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/jquery"),s=e("view/modal").Base;t.MessagesMain=n.extend({onLoad:function(){var e=this;
e.resizeMessages(),o(window).resize(e.resizeMessages.bind(e)),setTimeout(function(){e.show_old_anon_content_email_modal&&e.createModal("load_inner").show()},20)},resizeMessages:function(){var e=o(window).height()-o(".SiteHeader").height();o(".MessagesMain").height(e-30),o(".MessagesMain").show()}}),t.MessagesThreadDetail=t.MessagesMain.extend({onLoad:function(){this._super.apply(this,arguments);var e=this;e.scrollMessageThreadToHeight(),e.$id("@thread").on("DOMNodeInserted",function(t){t.preventDefault();var i=t.target;o(i.children).is(".ThreadMessage")&&setTimeout(function(){e.scrollMessageThreadToHeight()},10)}),e.isShowingMoreMessages=!1,e.$id("@show").click(function(){e.showMoreClicked()})},scrollMessageThreadToHeight:function(e){e=e||0;var t=this.$id("@thread")[0].scrollHeight-e;o(".thread_list").scrollTop(t)},showMoreClicked:function(){var e=this;this.isShowingMoreMessages=!0,this.serverCall("get_message_count").kwargs({thread_id:this.threadId}).success(function(t){e.messageCount=t,
e.showMoreMessages()}).send()},showMoreMessages:function(){var e=this,t=this.$id("@thread")[0].scrollHeight,i=45;this.shownCount*=2,this.shownCount>this.messageCount&&(this.reachedLastMessage=!0,this.shownCount=this.messageCount),this.serverCall("show_messages").kwargs({thread_id:this.threadId,count:this.shownCount}).contentFor(this.$id("@thread")).success(function(){e.reachedLastMessage&&(e.$id("@more").hide(),t+=i),e.scrollMessageThreadToHeight(t),e.isShowingMoreMessages=!1}).send()}}),t.ComposeMessageModalLink=n.extend({onLoad:function(){var e=this;this.$id("@create_modal_link").on("click",function(t){t.preventDefault(),e.createModal("load_inner").kwargs({to_uid:e.to_uid}).webOnlyOptions({closeOnBackgroundClick:!1}).show()})}}),t.ComposeMessageModal=s.extend({onLoad:function(){var e=this;this._super.apply(this,arguments),this.$id("@change_person").on("click",function(t){e.change(),t.preventDefault()}),this.load()},load:function(){this.object_id&&this.setTo(this.object_id)},getData:function(){
return this.$id("@compose_message_to_uid").val()&&(this.object_id=this.$id("@compose_message_to_uid").val()),!this.object_id||this.child("editor").isOnlyWhiteSpace()?!1:{to_uid:this.object_id,msg:this.child("editor").serialize()}},onSubmit:function(){if(!this.submitDisabled){var e=this,t=e.getData();t!==!1&&this.serverCall("submit_message").kwargs(t).success(function(){e._closeModal()}).send()}},change:function(){this.child("people_selector").setQuery(""),this.$id("@pick_people").removeClass("hidden"),this.$id("@picked_person").addClass("hidden"),this.$id("@to_name").html(""),this.child("people_selector").focus(),this.disableSubmit()},setTo:function(e){isNaN(parseInt(e))||(this.$id("@pick_people").addClass("hidden"),this.$id("@picked_person").removeClass("hidden"),this.$id("@compose_message_to_uid").val(e),this.getName(e),this.enableSubmit())},getName:function(e){var t=this;this.serverCall("get_name").kwargs({to_uid:e}).contentFor(this.$id("@to_name")).success(function(){t.child("editor").focus();
}).send()}}),t.HideMessagesModalLink=n.extend({onLoad:function(){var e=this;this.$id("@create_dialog_link").on("click",function(t){t.preventDefault(),e.createModal("load_inner").kwargs({thread_id:e.thread_id}).show()})}}),t.HideMessagesModal=s.extend({onSubmit:function(){if(!this.submitDisabled){var e=this;this.serverCall("hide_thread").liveMutate().success(function(){e._closeModal(),window.location="/messages"}).send()}}}),t.MarkUnreadModalLink=n.extend({onLoad:function(){var e=this;this.$id("@create_dialog_link").on("click",function(t){t.preventDefault(),e.createModal("load_inner").kwargs({thread_id:e.thread_id}).show()})}}),t.MarkUnreadModal=s.extend({onSubmit:function(){if(!this.submitDisabled){var e=this;this.serverCall("mark_thread_as_unread").liveMutate().success(function(){e._closeModal(),window.location="/messages"}).send()}}})}),define("app/view/moderation/appeal",["shared/polyfills","shared/core/component","shared/jquery","view/modal"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/jquery"),s=e("view/modal").Base;
t.AppealLink=n.extend({onLoad:function(){var e=this;this.$id("@show_appeal_modal").click(function(){return e.showAppealModal(),!1})},showAppealModal:function(){this.createModal("appeal_modal").kwargs({oid:this.oid,transition_id:this.transition_id}).show()}}),t.AppealModal=s.extend({onLoad:function(){this._super.apply(this,arguments),this.$id("@submit_button").addClass("submit_button_disabled");var e=this.$id("@policy_checkbox"),t=this;e.click(function(e){e.currentTarget.checked?t.$id("@appeal_details").removeClass("hidden"):(t.$id("@appeal_details").addClass("hidden"),t.$id("@submit_button").addClass("submit_button_disabled"))}),t.$id("@appeal_type").change(function(){t.$id("@submit_button").removeClass("submit_button_disabled")});var i=this.$id("@answer_tag_details_link"),n=this.$id("@answer_tag_details_content");i.click(function(e){n.hasClass("hidden")?(n.removeClass("hidden"),i.text(t.collapse_details)):(n.addClass("hidden"),i.text(t.show_details))})},onSubmit:function(){this.appeal();
},appeal:function(){var e=this.child("appeal_comment").serialize(),t=o("input:radio:checked").val(),i={comment:e,appeal_type:t};this.serverCall("send_appeal").liveMutate().kwargs(i).success(this._closeModal()).send()}})}),define("app/view/moderation/flag",["shared/polyfills","shared/core/component","shared/jquery","view/modal","shared/events/index"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/jquery"),s=e("view/modal").Base,a=e("shared/events/index");t.AddModerationFlag=n.extend({onLoad:function(){var e=this;e.$id("@show_flag_dialog").on("click",function(t){e.in_menu||(t.preventDefault(),t.stopPropagation()),e.one_click_report?e.serverCall("one_click_report").liveMutate().send():e.showFlagDialog()})},showFlagDialog:function(){this.createModal("flag_modal").kwargs({targets:this.targets}).show()}}),t.AddFlagModal=s.extend({onLoad:function(){var e=this;this._super.apply(this,arguments),this.$id("@show_more_reasons a").click(function(){return e.$id("@show_more_reasons").toggleClass("hidden"),
e.$id("@more_reasons").toggleClass("hidden"),!1}),this.$id("@report_row").on("click","input.flag_input",function(t){e.$id("@report").prop("disabled",!1).removeClass("submit_button_disabled"),e.$id("@comment").removeClass("hidden"),e.child("comment").focus(),e.$id("@required_comment_warning").addClass("hidden"),e.$id("@required_report_reason_warning").addClass("hidden");var i=parseInt(o(t.target).eq(0).val(),10),n=parseInt(e.other_reason_id,10),s=parseInt(e.factually_incorrect_reason_id,10);i==n||i==s?e.$id("@optional_label").addClass("hidden"):e.$id("@optional_label").removeClass("hidden")})},onSubmit:function(){this.report()},report:function(){var e=this,t={flag_reason:this.getFlagReason(),comment:this.child("comment").serialize()};this.flag_info=t;var i=t.flag_reason==this.other_reason_id||t.flag_reason==this.factually_incorrect_reason_id;t.flag_reason?i&&this.child("comment").isOnlyWhiteSpace()?this.$id("@required_comment_warning").removeClass("hidden"):null!==t.flag_reason&&this.serverCall("flag_object").kwargs(t).liveMutate().success(function(t){
e._closeModal(),t&&"/"==t[0]?window.location=t:e.shouldAddDownvote()&&e.addDownvote()}).send():this.$id("@required_report_reason_warning").removeClass("hidden")},shouldAddDownvote:function(){for(var e=0;e<this.skip_downvote_flag_reason_ids.length;++e)if(this.flag_info.flag_reason==this.skip_downvote_flag_reason_ids[e])return!1;return!0},addDownvote:function(){var e=this.targets[0];"answer"===e.type?this.emitEvent(a.helpers.addAnswerDownvote(e.aid)):"question"===e.type&&this.emitEvent(a.helpers.addQuestionDownvote(e.qid))},getFlagReason:function(){return this.$id("@report_row input.flag_input").filter(":checked").val()}}),t.NeedsImprovementButton=n.extend({onLoad:function(){var e=this;e.$id("@add_ni_button").on("click",function(){e.serverCall("add_topic").kwargs({}).liveMutate().send()})}}),t.DismissLink=n.extend({onLoad:function(){var e=this;this.$id("@dismiss").click(function(t){e.dismiss(),t.preventDefault()})},dismiss:function(){this.serverCall("dismiss").liveMutate().send()}}),t.TargetAndReports=n.extend({
onLoad:function(){var e=this;this.$id("@toggle").click(function(t){e.toggleComments(),t.preventDefault()})},toggleComments:function(){this.$id("@reports").toggleClass("hidden")}}),t.LockLink=n.extend({onLoad:function(){var e=this;e.$id("@lock_link").click(function(t){return t.preventDefault(),o(this).hasClass("unlocked")?(e.serverCall("lock_answer").liveMutate().send(),o(this).removeClass("unlocked")):(e.serverCall("unlock_answer").liveMutate().send(),o(this).addClass("unlocked")),!1})}})}),define("view/hover_menu",["shared/polyfills","shared/core/component","shared/jquery","shared/Class","shared/log","shared/onload","shared/perf","shared/w2.context"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/jquery"),s=e("shared/Class").Class,a=e("shared/log").log,r=e("shared/onload"),d=e("shared/perf"),l=e("shared/w2.context");t.HoverMenu=n.extend({contextConstructor:function(){return l.HoverMenu},onLoad:function(e){this.on=this.on||350,this.off=this.off||350,this.st=null,
this.ht=null,this.loaded=this.loaded||this.should_preload_menu,this.loading=!1,this.shown=!1,this.cancelHover=!1,this.load_on_pageload&&e&&this.loadMenu(!0),this.registerClickHandlers(),this.maybeRegisterHoverHandlers(),this.hoverMenuContext=this.getContext(l.HoverMenu),this._userPerceivedAction=null,this.setDvar("hovermenu_parent",this.cid)},registerClickHandlers:function(){var e=this;e.hoverMenuContext=e.getContext(l.HoverMenu),e.hoverMenuContext.on("hidden",function(t,i){i===!0&&(e.cancelHover=!0,e.doHide())}),this.click_open?(this.$id("@link").click(function(t){e.shown?(e.cancelHover=!0,e.doHide()):(e._userPerceivedAction=d.startUserPerceived({vcon:e.__vcon,method:"load_menu"}),e.cancelHover=!1,e.loadMenu(),e.doShow()),t.preventDefault()}),o(document).click(function(t){var i=e.isInvalidCloseTarget(o(t.target));e.shown&&!i&&(e.cancelHover=!0,e.doHide())})):this.$id("@link").click(function(){e.cancelHover=!0,e.doHide()})},isInvalidCloseTarget:function(e){var t=this.$id("@link");return e.is(t)||e.parents(t).is(t)?!0:!1;
},maybeRegisterHoverHandlers:function(){var e=this;this.show_menu&&!this.click_open&&(this.$id("@link").hover(this.show.bind(this),function(){e.hide(),e.cancelHover=!1,e.$id("@link").removeClass("hover")}),this.$id("@menu").hover(this.show.bind(this),this.hide.bind(this)))},setPosition:function(){if(!this.css_positioning){var e=this.$id("@link").outerHeight(),t=this.$id("@link").offset(),i=t,n=o(window).height(),s=275,a=i.top-o(window).scrollTop(),r=s>n-a,d=this.menu_offset_px?this.menu_offset_px:0;if(this.$id("@menu").removeAttr("style"),r?(this.attach_to_body?this.$id("@menu").css("bottom",n-t.top+d+"px"):this.$id("@menu").css("bottom",e+"px"),this.$id("@menu").addClass("hover_menu_above")):(this.attach_to_body?this.$id("@menu").css("top",t.top+e+1+d+"px"):this.$id("@menu").css("top",e+"px"),this.$id("@menu").removeClass("hover_menu_above")),this.attach_to_body){var l=o(window).width(),c=this.$id("@menu").outerWidth(),h=c+i.left,u=i.left,p=this.$id("@link").outerWidth();"right"==this.alignment?this.$id("@menu").css("left",u-c+p+"px"):"center"==this.alignment?this.$id("@menu").css("left",u-c/2+p/2+"px"):h>l?(this.$id("@menu").addClass("right_align"),
this.$id("@menu").css("left",u-c+p+"px")):(this.$id("@menu").css("left",u+"px"),this.$id("@menu").removeClass("right_align"))}}},hide:function(){this._userPerceivedAction&&(d.cancelAction(this._userPerceivedAction),this._userPerceivedAction=null),clearTimeout(this.st),this.ht=setTimeout(this.doHide.bind(this),this.off)},doHide:function(){var e=this;this.shown&&(this.hoverMenuContext.get("hidden")||this.hoverMenuContext.set("hidden",!0),this.hoverMenuContext.set("isShown",!1),this.shown=!1,this.$id("@link").removeClass("hover"),this.$id("@menu").addClass("animate_out"),setTimeout(function(){e.shown||(e.$id("@menu").removeClass("animate_out"),e.$id("@menu").addClass("hidden"))},150))},getKwargs:function(){return this.kwargs?this.kwargs:{}},okToShowHoverMenu:function(){return this.should_show_hover_menu&&0===this.$id("@menu").parents(".hover_menu_contents").length},show:function(){this.okToShowHoverMenu()&&this.showInner()},showInner:function(){this._userPerceivedAction=d.startUserPerceived({
vcon:this.__vcon,method:"load_menu"}),clearTimeout(this.ht),this.st=setTimeout(this.doShow.bind(this),this.on),this.loadMenu(),this.$id("@menu").removeClass("animate_out"),this.$id("@link").addClass("hover")},doShow:function(){this.shown||this.cancelHover||(this.hoverMenuContext.set("isShown",!0),this.hoverMenuContext.set("hidden",!1),this.shown=!0,this.css_positioning||this.movedToBody||!this.attach_to_body||(this.$id("@menu").detach().prependTo(o("body")),this.movedToBody=!0),o(".GrowlNotification").hide(),this.$id("@menu").removeClass("hidden").show(),this.$id("@link").addClass("hover"),this.setPosition(),this.loaded===!0&&this._userPerceivedAction&&(d.finishAction(this._userPerceivedAction),this._userPerceivedAction=null))},loadMenu:function(e){var t=this;void 0===e&&(e=!1);var i=function(){t.loaded||t.loading||(a&&a.enabled&&a("Quora.HoverMenu.loadMenu",t.cid,"is loading, preload =",e),t.loading=!0,t.serverCall("load_menu").kwargs(t.getKwargs()).disableDefaultUserPerceivedLogging().contentFor(t.$id("@menu_contents")).success(function(i){
a&&a.enabled&&a("Quora.HoverMenu.loadMenu",t.cid,"is loaded, preload =",e),t.loaded=!0,t.loading=!1,t.shown===!0&&t._userPerceivedAction&&(d.finishAction(t._userPerceivedAction),t._userPerceivedAction=null)}).except(function(i){a&&a.enabled&&a("Quora.HoverMenu.loadMenu",t.cid,"is failed to load, preload =",e),t.loading=!1}).send())};e?r.execAfterLoadDelayed(function(){i()}):i()}}),t.ToggleableMenu=s.extend({__init__:function(e){if(this.$linkElem=e.$linkElem,this.$menuElem=e.$menuElem,this.loadFunction=e.loadFunction,!(this.$linkElem&&this.$menuElem&&this.loadFunction))throw new Error("Invalid kwargs given: "+e);this.useCssPositioning=e.useCssPositioning||!1,this.shouldAttachToBody=!!e.shouldAttachToBody,this.menuOffsetPx=e.menuOffsetPx||0,this.alignment=e.alignment||"left",this.clickOpen=e.clickOpen||!1,this.showDelayMs=e.showDelayMs||350,this.hideDelayMs=e.hideDelayMs||350,this.appendCssClass=e.appendCssClass||"",this.shown=!1,this.movedToBody=!1,this.cancelHover=!1,this.hideTimeout=null,
this.showTimeout=null,this.registerHoverHandlers(),this.registerClickHandlers(),this.appendClass()},registerHoverHandlers:function(){this.clickOpen||(this.$linkElem.hover(this.showMenuSlow.bind(this),function(){this.hideMenuSlow(),this.cancelHover=!1,this.$linkElem.removeClass("hover")}.bind(this)),this.$menuElem.hover(this.showMenuSlow.bind(this),this.hideMenuSlow.bind(this)))},registerClickHandlers:function(){this.clickOpen?(this.$linkElem.click(this.toggleMenu.bind(this)),o(document).on("click",this.maybeHideMenu.bind(this))):this.$linkElem.click(this.hideMenu.bind(this))},toggleMenu:function(e){e.preventDefault(),this.shown?(this.cancelHover=!0,this.hideMenu()):(this.cancelHover=!1,this.loadFunction(),this.showMenu())},maybeHideMenu:function(e){var t=e.target,i=this.$linkElem.get(0);t!=i&&t.parentNode!=i&&this.hideMenu()},hideMenuSlow:function(){clearTimeout(this.showTimeout),this.hideTimeout=setTimeout(this.hideMenu.bind(this),this.hideDelayMs)},hideMenu:function(){this.shown&&(this.cancelHover=!0,
this.shown=!1,this.$linkElem.removeClass("hover"),this.$menuElem.addClass("animate_out"),setTimeout(function(){this.shown||(this.$menuElem.removeClass("animate_out"),this.$menuElem.addClass("hidden"))}.bind(this),150))},shouldShowMenu:function(){return 0===this.$menuElem.parents(".hover_menu_contents").length},showMenuSlow:function(){this.shouldShowMenu()&&(clearTimeout(this.hideTimeout),this.showTimeout=setTimeout(this.showMenu.bind(this),this.showDelayMs),this.loadFunction(),this.$menuElem.removeClass("animate_out"),this.$linkElem.addClass("hover"))},showMenu:function(){this.shown||this.cancelHover||(this.shown=!0,this.moveMenuToBody(),o(".GrowlNotification").hide(),this.$menuElem.removeClass("hidden").show(),this.$linkElem.addClass("hover"),this.setPosition())},moveMenuToBody:function(){this.useCssPositioning||this.movedToBody||(this.movedToBody=!0,this.shouldAttachToBody?this.$menuElem.detach().prependTo(o("body")):this.$menuElem.detach().prependTo(this.$linkElem))},appendClass:function(){
this.appendCssClass&&this.$menuElem.addClass(this.appendCssClass)},setPosition:function(){if(!this.useCssPositioning){var e=o(window),t=this.$linkElem.outerHeight(),i=this.$linkElem.offset(),n=i,s=e.height(),a=275,r=n.top-e.scrollTop(),d=a>s-r,l=this.$menuElem.outerWidth(),c=this.$linkElem.outerWidth();if(this.$menuElem.removeAttr("style"),d?(this.shouldAttachToBody?this.$menuElem.css("bottom",s-i.top+this.menuOffsetPx+"px"):this.$menuElem.css("bottom",t+"px"),this.$menuElem.addClass("hover_menu_above")):(this.shouldAttachToBody?this.$menuElem.css("top",i.top+t+1+this.menuOffsetPx+"px"):this.$menuElem.css("top",t+"px"),this.$menuElem.removeClass("hover_menu_above")),this.shouldAttachToBody){var h=e.width(),u=l+n.left,p=n.left;if(u>h){var f=u-h;"left"==this.alignment&&(p-=f+10)}"right"==this.alignment?this.$menuElem.css("left",p-l+c+"px"):"center"==this.alignment?this.$menuElem.css("left",p-l/2+c/2+"px"):this.$menuElem.css("left",p+"px")}else"right"==this.alignment?this.$menuElem.css("right",0):"center"==this.alignment?this.$menuElem.css("left",c/2-l/2+"px"):this.$menuElem.css("left",0);
}}})}),define("view/editable_list",["shared/polyfills","shared/core/component","settings"],function(e,t,i){var n=e("shared/core/component").Component,o=e("settings").interface_strings;t.EditableList=n.extend({onLoad:function(){var e=this;e.setEditLink(),setTimeout(function(){e.update()},1),e.initState(),e.bindClickHandler()},setEditLink:function(){this.editLink=this.$id("@edit")},initState:function(){this.editLink.removeClass("hidden")},bindClickHandler:function(){var e=this;this.editLink.click(function(t){t.preventDefault(),e.toggleEdit()})},toggleEdit:function(){this.is_editing=!this.is_editing,this.update()},update:function(){this.is_editing?(this.$id("@wrapper").addClass("is_editing"),this.editLink.text(o.done)):(this.$id("@wrapper").removeClass("is_editing"),this.editLink.text(this.edit_text))}}),t.EditableListItem=n.extend({onLoad:function(){var e=this;this.$id("@remove").click(function(t){e.serverCall("remove").liveMutate().send()})}})}),define("app/view/navigation",["shared/polyfills","shared/core/component","view/fixable2","view/hover_menu","view/editable_list"],function(e,t,i){
var n=e("shared/core/component").Component,o=e("view/fixable2"),s=e("view/hover_menu").HoverMenu,a=e("view/editable_list").EditableList;t.SettingsNavListContents=a.extend({onLoad:function(){this._super.apply(this,arguments),o.makeFixable(this.$id("@wrapper"),{min_width:990})}}),t.HomeNavList=a.extend({setEditLink:function(){this.editLink=this.child("hover_menu").$id("@link")}}),t.HomeNavListHoverMenu=s.extend({isInvalidCloseTarget:function(e){var t=this.$id("@menu"),i=this._super.apply(this,arguments);return i||e.parents().filter(t).length>0||e.hasClass("HomeNavListItem")||e.hasClass("remove_link")?!0:(this.shown&&this.parent().toggleEdit(),!1)},doShow:function(){this._super.apply(this,arguments);var e=this.child("selector");e&&e.focus()}}),t.TrendingTopicsNavListItem=n.extend({onLoad:function(){var e=this;return this.$id("@tid").on("click",function(t){e.metaKey=t.metaKey,e.serverCall("log_click").success(function(){e.metaKey||(window.location.href=e.uri)}).error(function(){e.metaKey||(window.location.href=e.uri);
}).send()}),!1}})}),define("app/view/network/selector",["shared/polyfills","shared/events/index","view/selector"],function(e,t,i){var n=e("shared/events/index"),o=e("view/selector").Selector;t.InvitePeopleSelector=o.extend({onLoad:function(){this._super.apply(this,arguments);var e=this;e.$input.focus(),e.$id("@clear").on("click",function(){e.setQuery("")})},resultWasSelected:function(e){this.emitEvent({type:n.Types.NETWORK_INVITE_USER,payload:{uid:e.data.uid,email:e.data.email}})},queryDidChange:function(){var e=this;e.$input.val().length>0?e.$id("@clear").removeClass("hidden"):e.$id("@clear").addClass("hidden")}})}),define("app/view/notifications",["shared/polyfills","shared/core/component","view/fixable2","shared/events/index","shared/jquery"],function(e,t,i){var n=e("shared/core/component").Component,o=e("view/fixable2"),s=e("shared/events/index"),a=e("shared/jquery");t.NotificationsMain=n.extend({onLoad:function(){o.makeFixable(this.$id("@notifs_nav"),{min_width:990})}}),t.NotificationsClearButton=n.extend({
onLoad:function(){var e=this;this.$id("@clear").on("click",function(t){t.preventDefault();var i=a(".js_notif_dropdown .js_notif_item").length;e.serverCall("mark_as_seen").liveMutate().kwargs({limit:i}).success(function(t){t||e.emitEvent({type:s.Types.NOTIFS_HIDE_DROPDOWN,payload:{}})}).send()})}}),t.MarkAllAsReadLink=n.extend({onLoad:function(){this.$id("@link").on("click",this.markAllRead.bind(this))},markAllRead:function(e){e.preventDefault(),this.emitEvent({type:s.Types.NOTIFS_MARK_ALL_READ,payload:{},scope:s.scope.GLOBAL}),this.$id("@link").toggleClass("hidden"),this.serverCall("request").liveMutate().send()}})}),define("app/view/notifications/base",["shared/polyfills","shared/jquery","shared/events/index","shared/action_log"],function(e,t,i){var n=e("shared/jquery"),o=e("shared/events/index"),s=e("shared/action_log").ActionableComponent;t.NotifBase=s.extend({onLoad:function(){this._super.apply(this,arguments),this.handleEvent(o.Types.NOTIFS_MARK_ALL_READ,this.removeUnseen.bind(this));
var e=this;this.$id("@bad_notif").on("click",function(t){e.markAsIrrelevant()}),this.$id("@notif a").on("click",function(t){"#"==n(this).attr("href")&&t.preventDefault(),e.$id("@notif").hasClass("unseen")&&e.markAsSeen()}),this.actionBar&&this.$id("@content_toggle").on("click",function(t){t.preventDefault(),e.$id("@notif_content").removeClass("hidden"),e.$id("@content_toggle").addClass("hidden")})},removeUnseen:function(){this.$id("@notif").removeClass("unseen")},markAsSeen:function(){var e=this;this.removeUnseen(),this.serverCall("mark_as_seen").liveMutate().success(function(t){t||e.emitEvent({type:o.Types.NOTIFS_HIDE_DROPDOWN,payload:{}})}).send()},removeMarkAsIrrelevant:function(){this.$id("@bad_notif").addClass("hidden")},markAsIrrelevant:function(e){this.removeMarkAsIrrelevant(),this.serverCall("mark_as_irrelevant").liveMutate().send()}})}),define("app/view/notifications/header",["shared/polyfills","shared/core/component","shared/window_manager"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/window_manager");
t.TitleNotificationsCount=n.extend({onLoad:function(e){e||this.setTitle()},setTitle:function(){var e=o.getTitle(),t=e,i="";(this.notif_count||this.inbox_count)&&(i+="(",this.notif_count&&(i+=this.notif_count),this.inbox_count&&(i+="/"+this.inbox_count),i+=") "),t=e.replace(/^\(((\d+)?\/)?\d+\) |/,i),e!=t&&o.setTitle(t)}})}),define("app/view/nux",["shared/polyfills","shared/core/component","shared/events/index"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/events/index");t.HeaderProgressBar=n.extend({onLoad:function(){this.$id("@progress_bar").css({width:this.getWidth()});var e=this;this.handleEvent(o.Types.NUX_PROGRESS_BAR_STEP,function(t){var i=t.payload.step||this.curr;e.update(i)})},getWidth:function(){var e=this.$id("@progress_bar_wrapper"),t=parseInt(e.css("min-width"),10),i=parseInt(e.css("width"),10),n=this.curr/this.total*i;return Math.min(i,Math.max(n,t))},update:function(e){this.curr=e,this.$id("@progress_bar").animate({width:this.getWidth()})}}),t.HeaderProgressBarBeacon=n.extend({
onLoad:function(){this.emitEvent({type:o.Types.NUX_PROGRESS_BAR_STEP,payload:{step:this.curr}})}}),t.InstallChromeExtension=n.extend({onLoad:function(){var e=this;e.$id("@confirm_link").on("click",function(){e.serverCall("confirm_clicked").kwargs({deck_type:e.deck_type}).send()})}})}),define("app/view/nux/dialog",["shared/polyfills","shared/core/component","shared/jquery","shared/events/index","w2.dialog","shared/viewport","shared/logging"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/jquery"),s=e("shared/events/index"),a=e("w2.dialog").Dialog,r=e("shared/viewport"),d=e("shared/logging");t.ModalNuxDialogCloseIndicator=n.extend({onLoad:function(){this.emitEvent({type:s.Types.NUX_DIALOG_CLOSE,payload:{}}),this.emitEvent({type:s.Types.FEED_IMPRESSIONS_DISABLED,payload:{disabled:!1}})}}),t.ModalNuxDialog=n.extend({onLoad:function(e){this.lastStep=null,this.emitEvent({type:s.Types.FEED_IMPRESSIONS_DISABLED,payload:{disabled:!0}}),r.setPageScroll(!1),this.handleEvent(s.Types.NUX_DIALOG_CLOSE,this.hide.bind(this)),
e&&d.log("nux_dialog_impression",{}),o(window).height()<600&&o(".dialog .dialog_wrapper").css("position","static")},hide:function(){this.$id("@modal_nux_wrapper").hide(),r.setPageScroll(!0)}}),t.InternalModalNuxDialogRenderer=t.ModalNuxDialog.extend({onLoad:function(e){var t=this;this.curr_step=this.step_num,o("body").keydown(function(e){37==e.keyCode&&t.curr_step>0?t.changeStep(t.curr_step,--t.curr_step):39==e.keyCode&&t.curr_step<t.num_steps-1&&t.changeStep(t.curr_step,++t.curr_step)}),this.$id("@modal_nux_wrapper .step_name").click(function(){if(!o(this).hasClass("curr_step")){var e=parseInt(o(this).attr("id"));t.changeStep(t.curr_step,e),t.curr_step=e}})},changeStep:function(e,t){this.$id("@modal_nux_wrapper .dialog_wrapper.step_"+e).parent().addClass("hidden"),this.$id("@modal_nux_wrapper .step_name.step_name_"+e).removeClass("curr_step"),this.$id("@modal_nux_wrapper .dialog_wrapper.step_"+t).parent().removeClass("hidden"),this.$id("@modal_nux_wrapper .step_name.step_name_"+t).addClass("curr_step");
}}),t.NuxDialogStep=n.extend({onLoad:function(){this.serverCall("record_step").kwargs({step_name:this.step_name+"_impr"}).send(),this.handleEvent(s.Types.NUX_DIALOG_SKIP_NEXT_STEP,this.skipNextStep.bind(this)),this.handleEvent(s.Types.NUX_DIALOG_NEXT_STEP,this.gotoNextStep.bind(this)),this.handleEvent(s.Types.NUX_DIALOG_STANDALONE_DONE,this.standaloneRefreshFeed.bind(this))},gotoStep:function(e){this.emitEvent({type:s.Types.NUX_PROGRESS_BAR_STEP,payload:{step:e}}),this.serverCall("goto_step").kwargs({step_num:e}).liveMutate().send()},closeDialogAndGoToStep:function(e){e>this.num_steps&&this.closeDialog(),this.gotoStep(e)},closeDialog:function(){this.emitEvent({type:s.Types.NUX_DIALOG_CLOSE,payload:{}})},gotoNextStep:function(){this.closeDialogAndGoToStep(this.step_num+1)},skipNextStep:function(){var e=this.step_num+2;e<=this.num_steps?this.emitEvent({type:s.Types.NUX_PROGRESS_BAR_STEP,payload:{step:this.step_num+1}}):this.emitEvent({type:s.Types.NUX_DIALOG_CLOSE,payload:{}}),this.serverCall("skip_step").kwargs({
step_num:this.step_num+1}).liveMutate().send()},stepUrl:function(e){return"#step="+e},standaloneRefreshFeed:function(){this.serverCall("standalone_refresh_feed").liveMutate().send(),a.dialogFor(this).close_()}}),t.NuxDialogRefreshFeedStep=t.NuxDialogStep.extend({onLoad:function(){var e=this;this._super.apply(this,arguments),this.serverCall("refresh_feed").liveMutate().success(function(){return e.delayed_next_step(),!1}).error(function(){return e.delayed_next_step(),!1}).send()},delayed_next_step:function(){"internal_page"!=this.page_context&&setTimeout(this.gotoNextStep.bind(this),5500)},gotoStep:function(e){this.serverCall("goto_step").kwargs({step_num:e}).send()}});var l=t.NuxDialogContinueButton=n.extend({onLoad:function(){this.$id("@next").on("click",this.onClick.bind(this))},finishStep:function(){this.$id("@next").hasClass("submit_button_disabled")||(this.standalone?this.emitEvent({type:s.Types.NUX_DIALOG_STANDALONE_DONE,payload:{}}):this.emitEvent({type:s.Types.NUX_DIALOG_NEXT_STEP,
payload:{}}))},onClick:function(){return this.finishStep(),!1}});t.NuxDialogInferredFriendsContinueButton=l.extend({onLoad:function(){this._super.apply(this,arguments),this.fuid_map={};for(var e=0;e<this.unchecked_fuids.length;++e)this.fuid_map[this.unchecked_fuids[e]]=!1;for(var t=0;t<this.checked_fuids.length;++t)this.fuid_map[this.checked_fuids[t]]=!0;var i=this;this.handleEvent(s.Types.NUX_DIALOG_FRIENDS_UPDATE,function(e){e.payload.addFriend?i.add(e.payload.addFriend):e.payload.removeFriend?i.remove(e.payload.removeFriend):e.payload.addAll?i.addAll():e.payload.removeAll&&i.removeAll()})},onClick:function(e){e.preventDefault(),this.serverCall("button_clicked").kwargs({fuid_map:this.fuid_map,prechecked_fuids:this.checked_fuids}).success(this.finishStep.bind(this)).error(this.finishStep.bind(this)).send()},add:function(e){this.fuid_map[e]=!0},remove:function(e){this.fuid_map[e]=!1},addAll:function(){for(var e in this.fuid_map)this.add(e)},removeAll:function(){for(var e in this.fuid_map)this.remove(e);
}}),t.NewNuxDialogSkipButton=l.extend({onClick:function(e){e.preventDefault(),this.serverCall("button_clicked").success(this.finishStep.bind(this)).error(this.finishStep.bind(this)).send()}}),t.NuxDialogFollowMinimumTopicsContinueButton=l.extend({onLoad:function(){this._super.apply(this,arguments),this.tids={};var e=this;this.handleEvent(s.Types.TOPICS_GRID_ADD,function(t){t.payload.tid&&(e.tids[t.payload.tid]=!0,e.num_followed+=1,e.updateButton(e.num_followed))}),this.handleEvent(s.Types.TOPICS_GRID_REMOVE,function(t){t.payload.tid&&(delete e.tids[t.payload.tid],e.num_followed-=1,e.updateButton(e.num_followed))})},onClick:function(e){if(e.preventDefault(),this.$id("@next").hasClass("submit_button_disabled"))return!1;var t=Object.keys(this.tids).map(function(e){return parseInt(e,10)});this.serverCall("button_clicked").kwargs({tids:t}).liveMutate().success(this.finishStep.bind(this)).error(this.finishStep.bind(this)).send()},updateButton:function(e){var t=this.min_interests-e;t>=1?this.$id("@next").addClass("submit_button_disabled").text(this.num_topics_texts[t]):this.$id("@next").removeClass("submit_button_disabled").text(this.button_continue_text);
}}),t.DynamicTopicGrid=n.extend({onLoad:function(){var e=this;this.handleEvent(s.Types.TOPICS_GRID_ADD,function(t){t.payload.tid&&e.addTopic(t.payload.tid)}),this.handleEvent(s.Types.TOPICS_GRID_REMOVE,function(t){t.payload.tid&&e.removeTopic(t.payload.tid)}),this.handleEvent(s.Types.TOPICS_GRID_UPDATE_SHOWN,function(t){if(t.payload.tids)for(var i=0;i<t.payload.tids.length;i++)e.shownTids.push(t.payload.tids[i])})},addTopic:function(e){this.followedTids.push(e)},addRow:function(e){this.$id("@more").append('<span class="new_items"></span>');var t=this.$id("@more").children(".new_items").last();this.serverCall("load_row").kwargs({tid:e}).contentFor(t).sendOnlyOnce()},getFollowingCount:function(){return this.followedTids.length},removeTopic:function(e){var t=this.followedTids.indexOf(e);-1!=t&&this.followedTids.splice(t,1)}}),t.DynamicInterestsGrid=t.DynamicTopicGrid.extend({addTopic:function(e){this._super.apply(this,arguments),this.addRow(e),this.serverCall("follow_topic").kwargs({tid:e}).send();
},removeTopic:function(e){this._super.apply(this,arguments),this.serverCall("unfollow_topic").kwargs({tid:e}).send()}}),t.InterestsGridItems=n.extend({onLoad:function(){this.emitEvent({type:s.Types.TOPICS_GRID_UPDATE_SHOWN,payload:{tids:this.new_tids}})}}),t.ExpertiseTopicListItemRemoveButton=n.extend({onLoad:function(){this.$id("@expertise-remove-button").click(this.dismiss.bind(this))},dismiss:function(e){return e.preventDefault(),this.serverCall("remove_expertise_topic").kwargs({tid:this.tid}).liveMutate().send(),!1}}),t.NuxDialogFollowExpertiseContinueButton=t.NuxDialogFollowMinimumTopicsContinueButton.extend({onClick:function(e){e.preventDefault(),this.serverCall("button_clicked").liveMutate().success(this.finishStep.bind(this)).error(this.finishStep.bind(this)).send()}})}),define("app/view/nux/existing_user",["shared/polyfills","shared/core/component"],function(e,t,i){var n=e("shared/core/component").Component;t.ExistingUserNuxSidebar=n.extend({onLoad:function(){this.serverCall("track_impression").send();
}}),t.ExistingUserNuxButton=n.extend({onLoad:function(){this.$id("@existing-user-nux").click(this.initate.bind(this))},initate:function(e){return e.preventDefault(),this.serverCall("start_existing_user_nux").liveMutate().send(),!1}}),t.ExistingUserNuxDismiss=n.extend({onLoad:function(){this.$id("@existing-user-nux-dismiss").click(this.dismiss.bind(this))},dismiss:function(e){return e.preventDefault(),this.serverCall("dismiss_existing_user_nux").liveMutate().send(),!1}})}),define("facebook",["shared/polyfills","shared/facebook","shared/core/component"],function(e,t,i){function n(e,t,i){FB.login(function(n){if("connected"==n.status){var o=n.authResponse;e&&o.userID!=e?i(o.userID):t(o.userID,o.accessToken,o.expiresIn)}},{scope:"publish_actions"})}var o=e("shared/facebook"),s=e("shared/core/component").Component;t.maybePromptToPublish=function(e,t,i){if(!o.isLoaded())return o.asyncUpdatePermissions(),!1;var s=null;return FB.getAuthResponse()&&(s=FB.getAuthResponse().userID),s&&e?s==e?o.hasPermission("publish_actions")?t():n(e,t):i(s):n(e,t,i),
!1};var a=s.extend({onLoad:function(){o.load(),this.$id("@facebook_connect_button").on("click",this.onClickFacebookConnectButton.bind(this))},connect:function(){var e=this;FB.login(function(t){t&&"connected"==t.status?e.onLogin(t.authResponse):e.onLoginFailed()},{scope:this.perms})},onClick:function(){},onLogin:function(e){},onLoginFailed:function(){},onClickFacebookConnectButton:function(){return o.isLoaded()&&(this.connect(),this.onClick()),!1}});t.FacebookConnectButton=a.extend({onLogin:function(e){this._onLogin(e)},_onLogin:function(e){this.serverCall("connect_facebook").kwargs({fb_access_token:e.accessToken,fb_uid:e.userID,expires:e.expiresIn}).liveMutate().send()}})}),define("app/view/nux/find_friends",["shared/polyfills","shared/core/component","w2.dialog","facebook","shared/facebook","shared/events/index","view/paged_list"],function(e,t,i){var n=e("shared/core/component").Component,o=e("w2.dialog").Dialog,s=e("facebook"),a=e("shared/facebook"),r=e("shared/events/index"),d=e("view/paged_list").PagedList;
t.FacebookFindFriendsButton=s.FacebookConnectButton.extend({onLoad:function(){this._super.apply(this,arguments),this.$id("@facebook_follow_button").on("click",this.onClick.bind(this))},onClick:function(){return a.isLoaded()&&(this.serverCall("button_clicked").send(),this.connect()),!1},onLogin:function(e){this.showLoading(),this._super.apply(this,arguments)},closeDialog:function(){this.standalone&&(o.dialogFor(this).close_(),this.parent()&&this.parent().standaloneRefreshFeed())},_onLogin:function(e){var t=this.serverCall("connect_facebook").kwargs({fb_access_token:e.accessToken,fb_uid:e.userID,expires:e.expiresIn});this.live_mutate&&t.liveMutate(),t.success(this.closeDialog.bind(this)).error(this.closeDialog.bind(this)).send()},onLoginFailed:function(){this.serverCall("record_connect_failure").send()},showLoading:function(){this.$id("@normal_text").hide(),this.$id("@loading_text").show(),this.$id("@row").addClass("complete")}}),t.FacebookFindFriendsAndContinueButton=t.FacebookFindFriendsButton.extend({
onLoginFailed:function(){this.standalone?o.dialogFor(this).close_():this.serverCall("login_failed").liveMutate().send(),this.serverCall("record_connect_failure").send()}}),t.PowerUserFacebookFindFriendsAndContinueButton=t.FacebookFindFriendsAndContinueButton.extend({onLoginFailed:function(){o.dialogFor(this).close_(),this.serverCall("record_connect_failure").send()},_onLogin:function(e){this.serverCall("connect_facebook").kwargs({fb_access_token:e.accessToken,fb_uid:e.userID,expires:e.expiresIn}).error(this.closeDialog.bind(this)).send()},closeDialog:function(){o.dialogFor(this).close_()}}),t.FriendFollowIndicatorLink=n.extend({onLoad:function(){this.$toggle=this.$id("@toggle"),this.$toggle.on("click",this.onClick.bind(this)),this.isSelected=this.$toggle.hasClass("selected");var e=this;this.handleEvent(r.Types.NUX_DIALOG_FRIENDS_UPDATE,function(t){t.payload.addAll?e.toggleSelection(!0):t.payload.removeAll&&e.toggleSelection(!1)})},toggleSelection:function(e){this.isSelected=e,this.$toggle.toggleClass("selected",e),
this.$toggle.toggleClass("unselected",!e)},onClick:function(){this.toggleSelection(!this.isSelected),this.isSelected?this.emitEvent({type:r.Types.NUX_DIALOG_FRIENDS_UPDATE,payload:{addFriend:this.fuid}}):this.emitEvent({type:r.Types.NUX_DIALOG_FRIENDS_UPDATE,payload:{removeFriend:this.fuid}})}}),t.FriendToggleCheckbox=n.extend({onLoad:function(){this.checkbox=this.$id("@friend_row").find(":checkbox"),this.checkbox.on("change",this.onChange.bind(this));var e=this;this.$id("@friend_row").on("click",function(){e.checkbox.prop("checked",!e.checkbox.prop("checked")),e.onChange()}),this.handleEvent(r.Types.NUX_DIALOG_FRIENDS_UPDATE,function(t){t.payload.addAll?e.toggleChecked(!0):t.payload.removeAll&&e.toggleChecked(!1)})},toggleChecked:function(e){this.checkbox.prop("checked",e),e?this.$id("@friend_row").find(".follow_button").addClass("unfollow_button").text("✓"):this.$id("@friend_row").find(".follow_button").removeClass("unfollow_button").text(this.follow_text)},onChange:function(){this.toggleChecked(this.checkbox.prop("checked")),
this.checkbox.prop("checked")?this.emitEvent({type:r.Types.NUX_DIALOG_FRIENDS_UPDATE,payload:{addFriend:this.fuid}}):this.emitEvent({type:r.Types.NUX_DIALOG_FRIENDS_UPDATE,payload:{removeFriend:this.fuid}})}}),t.UnfollowedInferredFriendsToggleLink=n.extend({onLoad:function(){this.$id("@add").on("click",this.onAddClick.bind(this)),this.$id("@remove").on("click",this.onRemoveClick.bind(this));var e=this;this.handleEvent(r.Types.NUX_DIALOG_FRIENDS_UPDATE,function(t){t.payload.updateAll&&e.updateFriendsList()})},changeAll:function(e){this.emitEvent({type:r.Types.NUX_DIALOG_FRIENDS_UPDATE,payload:{addAll:e,removeAll:!e}})},updateFriendsList:function(){this.action&&this.changeAll("add_all"==this.action)},onAddClick:function(){this.action="add_all",this.changeAll(!0),this.$id("@add").hide(),this.$id("@remove").show(),this.serverCall("button_clicked").kwargs({button_name:this.action}).send()},onRemoveClick:function(){this.action="remove_all",this.changeAll(!1),this.$id("@add").show(),this.$id("@remove").hide(),
this.serverCall("button_clicked").kwargs({button_name:this.action}).send()}}),t.InferredFriendsList=d.extend({onUpdate:function(e){this._super.apply(this,arguments),this.emitEvent({type:r.Types.NUX_DIALOG_FRIENDS_UPDATE,payload:{updateAll:!0}})}})}),define("app/view/oauth",["shared/polyfills","shared/core/component","shared/jquery"],function(e,t,i){var n=e("shared/core/component").Component;t.OauthCallbackPage=n.extend({onLoad:function(){if(window.opener){var e=window.opener.require("shared/jquery");this.access_token?e(window.opener.document).trigger("oauth_approved",{service:this.service,accessToken:this.access_token}):e(window.opener.document).trigger("oauth_rejected",{service:this.service}),window.close()}else this.$id("@me").text("access token: "+JSON.stringify(this.access_token))}})}),define("app/view/payment/payable",["shared/polyfills","shared/core/component","view/modal"],function(e,t,i){var n=e("shared/core/component").Component,o=e("view/modal").Base;t.BankSettings=n.extend({onLoad:function(){
var e=this;e.$id("@edit").click(function(t){t.preventDefault(),e.createModal("load_edit_bank_modal").show()})}}),t.EditBankModal=o.extend({onSubmit:function(){var e=this;e.child("add_bank_form").submit(function(){e._closeModal()})}})}),define("unified_view/modal",["shared/polyfills","shared/core/component","shared/modal","interface/settings","shared/util","shared/client","w2.modal"],function(e,t,i){var n,o,s,a=e("shared/core/component").Component,r=e("shared/modal"),d=e("interface/settings").pageIsMobile,l=e("shared/util"),c=e("shared/client");d?(o=e("mobile_app2/client"),s=e("mobile_app2/messages")):n=e("w2.modal"),t.ModalBase=a.extend({onLoad:function(){var e=this;this.$id("@close").on("click",function(t){t.preventDefault(),e.onClose()}),this.$id("@cancel").on("click",function(t){t.preventDefault(),e.onClose()}),this.$id("@submit").on("click",function(t){t.preventDefault(),e.onSubmit()}),d?this.onLoadMobile():this.onLoadWeb()},onLoadWeb:function(){var e=n.Modal.modalFor(this);this._originalClose=e.close.bind(e);
var t=this;e.close=l.once(function(){e._isOpen&&t.onClose()})},onLoadMobile:function(){this._initMobileDoneButton(!1),this._initMobileCancelButton()},_initMobileDoneButton:function(e){this.mobile_done_button&&(c.isNativeApp()?this.nativeSetPageAction(e):(this.$nav=this.$id("@nav"),this.$nav.text(this.done_text),this.$nav.addClass("is_done"),this.$nav.removeClass("hidden"),this.$nav.on("click",this._mobileOnSubmit.bind(this))),this.setMobileDoneButtonDisabled(e))},_initMobileCancelButton:function(){c.isNativeApp()&&o.registerOneTimeMessageHandler("closeNavigationButtonPressed",this.onClose.bind(this))},_mobileOnSubmit:function(){this._mobileDisabled||this.onSubmit()},setMobileDoneButtonDisabled:function(e){this._mobileDisabled=e,c.isNativeApp()?this.nativeSetPageAction(e):this.$nav.toggleClass("is_disabled",e)},nativeSetPageAction:function(e){c.isNativeApp()&&s&&s.send("setPageAction",{rightTextButton:{title:this.done_text,disabled:e,callback:this._mobileOnSubmit.bind(this)}})},close:function(){
this._originalClose&&this._originalClose(),r.handleClose(this)},onClose:function(){this.close()},submit:function(e){r.handleSubmit(this,e)},onSubmit:function(e){this.submit(e),this.close()}}),t.FormModal=t.ModalBase.extend({onLoad:function(){var e=this;e._super.apply(e,arguments),e.child("form").registerOnSubmitSuccess(function(){e.registerOnFormSubmitSuccessExtra(),e.submit(),e.close()})},registerOnFormSubmitSuccessExtra:function(){},onSubmit:function(){this.child("form").submitForm()}})}),define("app/view/payment/receivable",["shared/polyfills","shared/core/component","unified_view/modal"],function(e,t,i){var n=e("shared/core/component").Component,o=e("unified_view/modal").ModalBase;t.PaymentSettings=n.extend({onLoad:function(){var e=this,t=e.$id("@change_default"),i=t.find("input:radio");e.$id("@edit").click(function(t){t.preventDefault(),e.createModal("load_edit_card_modal").show()}),i.change(function(){e.serverCall("update_default_card").kwargs({index:i.index(t.find(":checked"))}).send();
})}}),t.EditCardModal=o.extend({onSubmit:function(){var e=this,t=e._super;e.child("add_card_form").submit(function(){t.apply(e,arguments)})}}),t.DeleteCardLink=n.extend({onLoad:function(){var e=this;e.$id("@create_modal_link").on("click",function(t){t.preventDefault(),e.createModal("load_inner").show()})}}),t.DeleteCardConfirmationModal=o.extend({onSubmit:function(){this.serverCall("delete_card").liveMutate().send(),this.close()}}),t.CannotDeleteCardModal=o.extend({onSubmit:function(){this.close()}})}),define("app/view/people_selector",["shared/polyfills","view/selector"],function(e,t,i){var n=e("view/selector").Selector,o=e("view/selector").MultiSelector;t.LegacyPeopleSelector=n.extend({resultWasSelected:function(e){this.parent().setTo(e.data.uid),this.setQuery(""),this.$input.blur()}}),t.PeopleAndSocialContactsMultiSelector=o.extend({whenOnSavedResultsChanged:function(e){this._onSavedResultsChanged=e},onSavedResultsChanged:function(){this._onSavedResultsChanged&&this._onSavedResultsChanged(this.saved_results);
}})}),define("app/view/photo",["shared/polyfills","shared/core/component","w2.dialog","shared/jquery","shared/errors","shared/window_manager"],function(e,t,i){var n=e("shared/core/component").Component,o=e("w2.dialog"),s=e("shared/jquery"),a=e("shared/errors"),r=e("shared/window_manager");t.EditPhotoDialogLink=n.extend({onLoad:function(){var e=this;this.$id("@open_edit_photo").click(function(){return e.editPhoto(),!1}),e.prompt_add_photo&&e.editPhoto()},editPhoto:function(){var e=this;this._dialog||(this._dialog=o.createDialog(this,{showXButton:!0,closeOnClickOut:!0,width:550}).title(this.dialog_title).load("set_dialog_contents").close(function(){e._dialog=null}))}}),t.InlineEditPhotoChoice=n.extend({onLoad:function(){var e=this;this.$id("@choices").on("click",".choose_pic",function(t){var i=s(t.target).attr("choice");return e.serverCall("choose_photo").kwargs({choice:i}).success(function(){e.next_url?r.navigateTo(e.next_url):o.Dialog.dialogFor(e).close_()}).send(),e.$id("@choices").text(e.setting_text),
!1})}}),t.InlineUploadPhotoWeb=n.extend({onLoad:function(){this.$id("@download").on("click",this.onClick.bind(this)),this.$id("@url").on("input",this.onChange.bind(this)),this.downloading=!1},onChange:function(){var e=this.$id("@url").val();this.$id("@download").toggleClass("hidden",!e)},onClick:function(){if(!this.downloading){var e=this.$id("@url").val();if(e){this.downloading=!0;var t=new Image;t.onload=this.downloadImage.bind(this,e),t.onerror=this.downloadImageError.bind(this),t.src=e}}},downloadImageError:function(){this.downloading=!1,alert(this.invalid_image_text),this.$id("@url").val("")},downloadImage:function(e){if(!this._contentForTarget)return void a.logJsError("InlineUploadPhotoWeb","contentFor target not set.");var t=this;this.serverCall("download").kwargs({target_id:this.target_id,target:this.target,url:e}).contentFor(this._contentForTarget).liveMutate().except("image_error",function(e){alert(e.message),o.Dialog.dialogFor(t).close_()}).except("thumbs_already_set",function(){
o.Dialog.dialogFor(t).close_()}).success(this.onShowPhotoChoice.bind(this)).send()},focus:function(){this.$id("@url").focus()},setContentForTarget:function(e){this._contentForTarget=e},setShowPhotoChoiceCallback:function(e){this._showPhotoChoice=e},onShowPhotoChoice:function(){this._showPhotoChoice&&this._showPhotoChoice()}})}),define("view/pmsg",["shared/polyfills","shared/core/component","shared/core/webnode","shared/events/index","shared/jquery"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/core/webnode"),s=e("shared/events/index"),a=e("shared/jquery");t.PMsg=n.extend({onLoad:function(){var e=this;this.$id("@x").click(function(){return e.close(),!1})},close:function(){this.$id("@container").hide(),a(".pmsg_container").hide()}}),t.PMsgContainer=n.extend({onLoad:function(e){var t=a("#layout_header");0!==t.length&&(this.headerHeight=t.outerHeight(),this.mobile||this.$id("@pmsg_container").css("top",this.headerHeight+10)),this.$id("@pmsg_container").html()&&!this.mobile&&(this.$id("@pmsg_container").fadeIn(350),
this.setFadeTimeout(5e3));var i=this;this.handleEvent(s.Types.PMSG_SHOW,function(e){i.setContent(e.payload.content,e.payload.fadeOut)})},setFadeTimeout:function(e){var t=this;this.t=setTimeout(function(){t.$id("@pmsg_container").fadeOut(350)},e)},setContent:function(e,t){var i=this;i.$id("@pmsg_container").hover(function(){clearTimeout(i.t),i.$id("@pmsg_container").stop(),i.$id("@pmsg_container").css("opacity",100)},function(){i.setFadeTimeout(1e3)});var n=function(e){o.setContent(i.$id("@pmsg_container"),e),i.$id("@pmsg_container").fadeIn(350),i.setFadeTimeout(5e3)};return this.$id("@pmsg_container").is(":visible")?(clearTimeout(this.t),this.$id("@pmsg_container").fadeOut(350,function(){n(e)})):n(e),this}})}),define("app/view/pmsg/pmsg",["shared/polyfills","view/pmsg"],function(e,t,i){var n=e("view/pmsg");t.FlagConfirmationPmsg=n.PMsg.extend({onLoad:function(){var e=this;this._super.apply(this,arguments),this.$id("@undo").click(function(t){return e.undo(),!1})},undo:function(){this.serverCall("undo").liveMutate().send();
}})}),define("app/view/post",["shared/polyfills","shared/core/component"],function(e,t,i){var n=e("shared/core/component").Component;t.PostSuggestedEditDiscardButtonInline=n.extend({onLoad:function(){var e=this;this.$id("@submit").click(function(t){e.serverCall("discard_suggested_edit").kwargs({pid:e.pid}).liveMutate().send(),t.preventDefault()})}})}),define("app/view/prize/add_answer",["shared/polyfills","shared/core/component"],function(e,t,i){var n=e("shared/core/component").Component;t.PrizeAnswerEditorCheckbox=n.extend({checked:function(){var e=this.$id("@checkbox");return 0===e.length?void 0:e.is(":checked")},addChangeCallback:function(e){this.$id("@checkbox").change(e)}})}),define("app/view/query/filters",["shared/polyfills","shared/core/component","view/fixable2","view/selector"],function(e,t,i){var n=e("shared/core/component").Component,o=e("view/fixable2"),s=e("view/selector").Selector;t.SearchFilters=n.extend({onLoad:function(){var e=this;o.makeFixable(e.$id("@sidebar_filters"),{
min_height:e.$id("@sidebar_filters").outerHeight()+e.$id("@sidebar_filters").offset().top,min_width:990})}}),t.SearchFilterAuthorSelector=s.extend({resultWasSelected:function(e){this.parent().addFilterToKey(e.data.uid)}}),t.SearchFilterTopicSelector=s.extend({resultWasSelected:function(e){this.parent().addFilterToKey(e.data.topic_routing_name)}})}),define("app/view/query/query",["shared/polyfills","shared/core/component","shared/jquery","w2.dialog","shared/viewport","shared/action_log"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/jquery"),s=e("w2.dialog"),a=e("shared/viewport"),r=e("shared/action_log");t.QueryResult=r.ActionableComponent.extend({onLoad:function(){this._super.apply(this,arguments),this.setDvar("query_id",this.query_id),this.setDvar("index",this.index);var e="_blank";this.compact&&(e="_parent"),this.$id('@title a[href!="#"]').attr("target",e),this.$id('@content a[href!="#"]').attr("target",e),this.checkHighlight(),this.unseen.bound||(document.addEventListener("scroll",this.recordPrivateViews.bind(this)),
setTimeout(this.recordPrivateViews.bind(this),400),this.unseen.bound=!0),this.unseen.items[this.cid]=this,this.view_item=[this.type,this.object_id]},navigateToObject:function(){var e=this.$id("@title a").attr("href");window.open(e,"_parent")},checkHighlight:function(){var e=this.$id("@title").get(0),t=this.$id("@content").get(0);(null==e||null==t||(e.innerHTML+t.innerHTML).indexOf("matched_term")<0)&&this.serverCall("log_highlight_error").send()},unseen:{bound:!1,items:{},lastCheckTime:0,rateLimit:500},recordPrivateViews:function(){var e=+new Date;if(!(e<this.unseen.lastCheckTime+this.unseen.rateLimit)){this.unseen.lastCheckTime=e;var t=[],i=[];for(var n in this.unseen.items){var o=this.unseen.items[n];a.isElementInViewport(o.$id("@item").get(0))&&(t.push(o),i.push(o.view_item),delete this.unseen.items[n])}t.length>0&&t[0].serverCall("log_private_views").kwargs({view_items:i}).send()}}}),t.QueryResultRankingMetadata=n.extend({onLoad:function(){var e=this;this.$id("@metadata").click(function(){
var t=e.$id("@metadata").parent().hasClass("expanded");o(".metadata").parent().removeClass("expanded"),t||e.$id("@metadata").parent().addClass("expanded")})}}),t.QueryResults=n.extend({onLoad:function(){var e=this;this.$id("@create_topic_link").click(function(){return s.createDialog(e).load("create_topic_dialog"),!1})}})}),define("shared/scroll_animation_handler",["shared/polyfills"],function(e,t,i){t.add=function(e,t){var i,n=!1,o=function(){i=e.scrollY,void 0===i&&(i=e.scrollTop),n||requestAnimationFrame(function(){n=!1,t(i)}),n=!0};return e.addEventListener("scroll",o),o(),o}}),define("app/view/question",["shared/polyfills","shared/core/component","view/dialog","w2.dialog","tooltip","shared/jquery","shared/events/index","shared/cookies","shared/window_manager","shared/views","shared/qtext","view/inline_editor","shared/scroll_animation_handler","view/fixable2","shared/logging","shared/action_log","shared/viewport"],function(e,t,i){var n=e("shared/core/component").Component,o=e("view/dialog"),s=e("w2.dialog"),a=e("tooltip"),r=e("shared/jquery"),d=e("shared/events/index"),l=e("shared/cookies"),c=e("shared/window_manager"),h=e("shared/views").viewsLogger,u=e("shared/qtext").renderQText,p=e("view/inline_editor").InlineEditor,f=e("shared/scroll_animation_handler"),_=e("view/fixable2"),g=e("shared/logging"),m=e("shared/action_log").ActionableComponent,v=e("shared/viewport"),w=d.Types,b=t.NewGridQuestionPage=n.extend({
onLoad:function(){var e=this;e.handleEvent(w.QUESTION_DELETE_STATE_CHANGE,function(t){t.payload.qid==e.qid&&c.reload()})}});t.QuestionMain=b.extend({onLoad:function(e){this._super.apply(this,arguments),e&&this.record_impression&&setTimeout(function(){g.log("funnel_impression",{impression_type:"question_page_impression"})},1e3)}}),t.QuestionLink=n.extend({onLoad:function(){var e=this;this.$id("@link").mousedown(function(){l.setQfeedLog(e,"QuestionClickthrough"),l.setQueryLog(e,"QuestionClickthrough")}),u(this.$id("@link"))}}),t.QuestionDetails=n.extend({onLoad:function(){u(this.$id("@text"))}}),t.RelatedQuestionsList=n.extend({onLoad:function(){var e=this,t=!1,i=300;if(this.recordStep(["rq_impression","rq_impression_repeated"]),!this.inline&&!this.is_expanded){var n=e.$id("@related_questions_list").get(0),o=r(".layout_2col_side").height()+r(".SiteHeader").height()+10;if(o-i>r(window).height()&&(t=!0),t){var s=r(n).find(".related_question").slice(8);n&&_.makeFixable(n,{scroll_dep:!0,min_scroll_callback:function(){
return o},min_height:0,footer:r(".first_content_page_feed").get(0)}),f.add(window,function(){window.scrollY>o?s.addClass("hidden"):s.removeClass("hidden")})}else n&&_.makeFixable(n,{scroll_dep:!0,min_height:o,extra_bottom_spacing:80,footer:r(".first_content_page_feed").get(0)})}},recordStep:function(e){g.log("related_question_steps",{steps:e})}}),t.RelatedQuestionLink=m.extend({onLoad:function(){this._super.apply(this,arguments);var e=this;e.$id("@actionable").on("mousedown",function(){e.recordStep("related_question_click")})},recordStep:function(e){this.serverCall("record_step").kwargs({step_name:e}).send()}}),t.QuestionArea=n.extend({onLoad:function(){this._super.apply(this,arguments),this._detailsOverLimit=!1,this._textOverLimit=!1;var e=this;this.handleEvent(d.Types.QUESTION_EDITING_STATE,function(t){t.payload.qid==e.qid&&("edit"==t.payload.state?e.editLinkClicked():"cancel"==t.payload.state?e.cancelLinkClicked():"text_limit"==t.payload.state?e._textOverLimit=t.payload.is_over:"details_limit"==t.payload.state&&(e._detailsOverLimit=t.payload.is_over));
}),e.$id("@question_update").click(function(t){t.preventDefault(),e.emitEvent({type:d.Types.QUESTION_EDITING_STATE,payload:{qid:e.qid,state:"request"}}),e.$id("@details_container").addClass("hidden")}),e.$id("@question_cancel").click(function(t){t.preventDefault(),e.emitEvent({type:d.Types.QUESTION_EDITING_STATE,payload:{qid:e.qid,state:"trigger_cancel"}}),e.$id("@details_container").addClass("hidden")})},editLinkClicked:function(){this.$id("@details_container").removeClass("hidden")},cancelLinkClicked:function(){this.$id("@details_container").addClass("hidden")},updateButton:function(){this.$id("@question_update").toggleClass("disabled",this._textOverLimit||this._detailsOverLimit)}});var y=p.extend({onLoad:function(){this._super.apply(this,arguments);var e=this;this.handleEvent(d.Types.QUESTION_EDITING_STATE,function(t){t.payload.qid==e.id&&("edit"==t.payload.state?e.editorShown||e.toggle_editor():"cancel"==t.payload.state?e.editorShown&&e.toggle_editor():"request"==t.payload.state?e.trigger_request():"trigger_cancel"==t.payload.state&&e.trigger_cancel());
})},onEditLinkClick:function(){this.emitEvent({type:d.Types.QUESTION_EDITING_STATE,payload:{qid:this.id,state:"edit"}})},cancelEditor:function(){this._super.apply(this,arguments),this.emitEvent({type:d.Types.QUESTION_EDITING_STATE,payload:{qid:this.id,state:"cancel"}})}});t.QuestionTextInlineEditor=y.extend({onLoad:function(){this._super.apply(this,arguments);var e=this;this.editor.setLengthChangeCallback(function(t){e.emitEvent({type:d.Types.QUESTION_EDITING_STATE,payload:{qid:e.id,state:"text_limit",is_over:t}})})}}),t.FeedQuestionTextInlineEditor=t.QuestionTextInlineEditor.extend({toggle_editor:function(){}}),t.QuestionDetailsInlineEditor=y.extend({onLoad:function(){this._super.apply(this,arguments);var e=this;this.editor.setLengthChangeCallback(function(t){e.emitEvent({type:d.Types.QUESTION_EDITING_STATE,payload:{qid:e.id,state:"details_limit",is_over:t}})})}}),t.FeedQuestionDetailsInlineEditor=t.QuestionDetailsInlineEditor.extend({toggle_editor:function(){}}),t.QuestionDeleteUndeleteLink=n.extend({
onLoad:function(){var e=this;this.$id("@undelete_question_link").click(function(){return s.createDialog(e).title(e.undelete_title).cancel().ok(function(){e._request("undelete_question")}).text(e.undelete_content),!1})},_request:function(e){var t=this;this.serverCall(e).kwargs({qid:this.qid}).success(function(){t.emitEvent(d.helpers.changeQuestionDeletionState(t.qid))}).liveMutate().send()}}),t.QuestionDeleteDialog=o.AddCommentDialog.extend({onLoad:function(){var e=this;this._super.apply(this,arguments),e.setSuccessCallback(function(){e.emitEvent(d.helpers.changeQuestionDeletionState(e.object_id))})},getPars:function(){return this.comment_required&&this.editor.isOnlyWhiteSpace()?!1:{comment:this.editor.serialize(),review:this.review}}}),t.AnswerActions=n.extend({}),t.AnswerPermaLink=n.extend({onLoad:function(){var e=this;this.$id("@link").mousedown(function(){l.setQfeedLog(e,"AnswerClickthrough"),l.setQueryLog(e,"AnswerClickthrough")}),this.tooltip&&a.attach(this.$id("@link"),this.tooltip);
}}),t.AnswerUndeleteBanner=n.extend({onLoad:function(){var e=this;e.$id("@answer_undelete").on("click",function(t){e.createModal("load_answer_undelete_modal").onSubmit(function(){e.serverCall("unremove_answer").kwargs({aid:e.aid}).liveMutate().send()}).show()})}}),t.AnswerPageViewMoreLink=n.extend({onLoad:function(){var e=this;this.$id("@link").mousedown(function(){l.setQfeedLog(e,"QuestionClickthrough"),l.setQueryLog(e,"QuestionClickthrough")})}}),t.CreateAnswerWikiLink=n.extend({onLoad:function(){this.$id("@create_answer_wiki").click(function(e){r("#answer_wiki").toggleClass("hidden"),e.preventDefault()})}}),t.AnswerListDiv=n.extend({onLoad:function(){this.header_height=r(".SiteHeader").outerHeight(),this.offset=15,this.$id("@answers_anchor").css("top","-"+this.header_height+"px"),"#answers"==window.location.hash&&r(window).scrollTop(this.$id("@answers_anchor").offset().top)},show:function(){this.$id("@collapsed").show()}}),t.QuestionAnswerMain=n.extend({onLoad:function(e){e&&setTimeout(function(){
g.log("funnel_impression",{impression_type:"answer_page_impression"})},1e3),this.recordStep("share_impression")},recordStep:function(e){this.serverCall("record_step").kwargs({step_name:e}).send()}});var C=b;t.QuestionAnswerPageMain=C.extend({onLoad:function(e){var t=this;this._super.apply(this,arguments),t.prompt_topic_bio?t.createModal("credentials_modal").kwargs({aid:t.aid}).show():t.prompt_share_answer&&t.createModal("share_answer_modal").kwargs({aid:t.aid}).show(),e&&setTimeout(function(){g.log("funnel_impression",{impression_type:"answer_page_impression"})},1e3),this.recordStep("share_impression")},recordStep:function(e){this.serverCall("record_step").kwargs({step_name:e}).send()}}),t.AttachDisclaimerLink2=n.extend({onLoad:function(){var e=this;this.$id("@add_disclaimer_link").click(function(){return s.createDialog(e).title(e.create_disclaimer_title).load("set_disclaimer_dialog"),!1})}}),t.AnswerPagedListItem=n.extend({onLoad:function(){h.addComponentToTrack(this)}}),t.RelatedQuestionSectionWrapper=n.extend({
onLoad:function(){var e=this;_.makeFixable(this.$id("@related_question_header"),{scroll_dep:!0,footer:this.$id("@related_question_footer"),min_scroll_callback:function(){var t=e.$id("@related_questions").offset().top,i=e.$id("@related_question_header").height();return t-i-v.siteHeaderHeight()},max_scroll_callback:function(){var t=e.$id("@related_question_footer").offset().top,i=e.$id("@related_question_header").outerHeight();return t-i-v.siteHeaderHeight()}})}})}),define("app/view/share",["shared/polyfills","shared/core/component","shared/twitter","shared/facebook","shared/cookies","tooltip"],function(e,t,i){var n,o=e("shared/core/component").Component,s=e("shared/twitter"),a=e("shared/facebook"),r=e("shared/cookies"),d=e("tooltip"),l=t.ShareAction=o.extend({onLoad:function(){var e=this;e.$id("@share").on("click",function(t){t.preventDefault(),e.createModal("load_modal").kwargs({serialized_share:e.serialized_share,default_tab:e.default_tab,class_name:e.class_name,calling_class:e.calling_class
}).show()})}});t.AutoShowShareAction=l.extend({onLoad:function(){n=this},show:function(e){this.__js_init=e,setTimeout(this.showDialog.bind(this),1500)}}),t.showShareAction=function(e){n&&n.show(e)},t.CopyToClipboardShareLink=o.extend({onLoad:function(){var e=this,t=this.$id("@copy_link");this.tooltip=d.attach(t,this.copy_url,{attach_to_body:!0}),t.click(function(t){t.stopPropagation();var i=document.createElement("textarea");document.body.appendChild(i),i.value=e.copy_url,i.select();var n=document.execCommand("copy");i.remove(),n?e.tooltip.updateText(e.copy_message_success).render().updateText(e.copy_url):(e.$id("@copy_link").addClass("completed"),e.tooltip.updateText(e.copy_message_fail).render())})}}),t.TwitterNetworkShare=o.extend({onLoad:function(){var e=this;s.onInit(function(){window.twttr.events.bind("tweet",function(t){e.isTweeted(t)&&(r.setQfeedLog(e,"ShareTwitter"),r.setTlog({type:"ShareTwitter"}),e.serverCall("record_tweet").send())})})},isTweeted:function(e){var t=this,i=String(e.target.id),n=String(t.cid);
return i.indexOf(n)>-1}}),t.FacebookNetworkShare=o.extend({onLoad:function(){a.load(),this.$id("@share").on("click",this.onClick.bind(this))},onClick:function(){var e=this;return e.is_debugging_mode&&(console.log(e.share_url),console.log(e.target)),window.FB.ui({method:"feed",display:"popup",link:e.share_url},function(t){t&&t.post_id&&(r.setQfeedLog(e,"ShareFacebook"),r.setTlog({type:"ShareFacebook"}),e.serverCall("record_facebook_share").send())}),!1}}),t.FacebookConnectedToDifferentAccount=o.extend({onLoad:function(){a.load(),this.$id("@fb_logout").on("click",this.onClickFbLogout.bind(this)),this.$id("@settings").on("click",this.onClickSettings.bind(this))},show:function(){var e=this;window.FB.api("/me",function(t){t.name&&(e.$id("@fb_unknown_login").hide(),e.$id("@fb_logged_in_name").text(t.name),e.$id("@fb_logged_in_link").show(),e.$id("@fb_logged_in_link").attr("href",t.link))}),this.$id("@fb_different_account").show()},onClickFbLogout:function(){var e=this;return window.FB.logout(function(t){
e.$id("@fb_different_account").hide()}),!1},onClickSettings:function(){this.$id("@fb_different_account").hide()}})}),define("app/view/question/add_answer",["shared/polyfills","shared/core/component","shared/jquery","w2.dialog","view/inline_editor","shared/cookies","shared/window_manager","view/modal","settings","shared/facebook","app/view/share"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/jquery"),s=e("w2.dialog"),a=e("view/inline_editor").InlineEditor,r=e("shared/cookies"),d=e("shared/window_manager"),l=e("view/modal").Base,c=e("settings"),h=c.interface_strings,u=e("shared/facebook"),p=e("app/view/share").showShareAction;t.AnswerAdd=n.extend({onLoad:function(){var e=this;e.$id("@toggle_zen").click(function(){e.toggleZen()}),e.$id("@answer_add").find(".submit_button").click(function(){e.$id("@answer_add").hasClass("is_zen")&&e.toggleZen()});var t=this.child("editor_section").child("editor");t.whenOnLoaded(t.focusEditorInputWhenReady.bind(t))},toggleZen:function(){
function e(e){27==e.keyCode&&t.toggleZen()}var t=this;t.$id("@answer_add").hasClass("is_zen")?(t.serverCall("zen_mode_exited").send(),o(document).off("keyup",e)):(t.serverCall("zen_mode_entered").send(),o(document).keyup(e)),o("body").toggleClass("zen_mode"),t.$id("@answer_add").toggleClass("is_zen"),t.$id("@zen_bg").toggleClass("hidden")}});var f=t.AnswerEditor=a.extend({onLoad:function(){this.editor=this.child("editor"),this.answerShareForm=this.child("answer_share_form"),this.editorShare=this.answerShareForm&&this.answerShareForm.child("editor_share");var e=this;this.editor.prevent_load_drop_zone=!0,this._super.apply(this,arguments),this.disclaimer_update="",this.editor.setFocusCallback(function(){e.focusEditor()}),this.editor.isInteractive()||this.focusEditor(),this.updated_question_modal_shown=!1;var t=this.child("prize_confidentiality_checkbox");void 0!==t.checked()&&(t.checked()||e.$id("@inline_editor_submit").addClass("disabled"),t.addChangeCallback(function(i){t.checked()?e.$id("@inline_editor_submit").removeClass("disabled"):e.$id("@inline_editor_submit").addClass("disabled");
}))},focusEditor:function(){this.editor.support_drag_and_drop_upload&&(this.dragAndDropFormLoaded||(this.dragAndDropFormLoaded=!0,this.editor.loadDragAndDropForm()))},focusEditorInputWhenReady:function(){var e=this;this.editor.setEditorReadyCallback(function(){e.editor.hideFakeEditor()})},showShareWarningDialog:function(){var e,t=this,i=this.editorShare.getValues();i.tw?e=i.fb?this.share_warning_texts.tw_fb:this.share_warning_texts.tw:i.fb&&(e=this.share_warning_texts.fb),this.editorShare.serverCall("warning_dialog_shown").send(),s.createDialog(this.editorShare).title(this.share_warning_dialog_title).cancel(null,h.cancel).ok(function(){t.shouldShowShareWarningDialog=!1,t.input_button_obj.click()},this.share_warning_dialog_ok).html(e)},showAnonAnswerWarningDialog:function(){var e=this;e.createModal("anon_answer_warning").onSubmit(function(){e.shouldShowAnonAnswerWarningDialog=!1,e.serverCall("accept_anon_answer_warning").send(),e.input_button_obj.click()}).show()},submitHandler:function(){
var e=this;this.input_button_obj.click(function(t){if(e.getConfidentialityCheckboxChecked()===!1)return!1;if(e.getEditor()&&e.isEditorEmpty())return!1;var i={};e.editorShare&&(i=e.editorShare.getValues());var n=(i.tw||i.fb)&&e.shouldShowShareWarningDialog;return n?(e.showShareWarningDialog(),!1):e.shouldShowAnonAnswerWarningDialog?(e.showAnonAnswerWarningDialog(),!1):(e.trigger_request(),void t.preventDefault())})},invokeEditServerCall:function(e){var t={};if(this.editorShare&&(t=this.editorShare.getValues()),t.fb&&!u.hasPermission("publish_actions")){var i=this._super,n=this;u.requestPermissions("publish_actions",function(){i.call(n,e)})}else this._super.call(this,e)},ajax_callback:function(e){return e.ans_url&&d.navigateTo(e.ans_url),e&&e.show_updated_question_modal?(this.save_draft(!0),this.createModal("load_changed_modal").kwargs({submit_id:this.input_button_obj.attr("id"),qid:e.qid}).show(),this.updated_question_modal_shown=!0,void(this.locked=!1)):(e.share_data&&e.share_data.autoShowShareDialog&&p(e.share_data),
d.sameDomainURL(e.url)&&d.navigateTo(e.url),this._super.apply(this,arguments))},tlog_data:function(){return{type:"AddAnswer"}},getLoggedAction:function(){return"AnswerAdd"},logSaveDraft:function(){r.setTlog({type:"QuestionSaveDraft",qid:this.id})},_get_kwargs:function(){var e={id:this.id,input:this.get_value(),disclaimer_update:this.disclaimer_update,fb_uid:u.getFbUid(),fb_access_token:u.getAccessToken(),fb_expires:u.getExpiresIn(),updated_question_modal_shown:this.updated_question_modal_shown,prize_confidentiality_checkbox:this.getConfidentialityCheckboxChecked(),prize_opted_into_notifs:this.getOptIntoNotifsCheckboxChecked(),redirect_to_answer_page:this.redirect_to_answer_page};return this.editorShare&&(e.share_values=this.editorShare.getValues()),e},getSaveDraftKwargs:function(){var e=this._super.apply(this,arguments);return e},getConfidentialityCheckboxChecked:function(){return this.child("prize_confidentiality_checkbox").checked()},getOptIntoNotifsCheckboxChecked:function(){return this.child("prize_opt_into_notifs_checkbox").checked();
}});t.AnswerInFeedEditor=f.extend({trigger_request:function(){r.setQfeedLog(this,"AddAnswer"),this._super.apply(this,arguments)},logSaveDraft:function(){r.setQfeedLog(this,"QuestionSaveDraft")},ajax_callback:function(e){this.$id("@inline_editor_form").parents(".answer_editor").addClass("hidden"),this._super.apply(this,arguments)}}),t.AnswerDraftPageEditor=f.extend({onLoad:function(){this._super.apply(this,arguments),this.should_toggle_on_submit=!1,this.editor=this.child("editor"),this.editor.focus()},trigger_request:function(){r.setQfeedLog(this,"AddAnswer"),this._super.apply(this,arguments)},logSaveDraft:function(){r.setQfeedLog(this,"QuestionSaveDraft")}}),t.AnswerEditorMetadataItem=n.extend({onLoad:function(){var e=this,t=this.$id("@toggle");t.click(function(){return e.$id("@item").toggleClass("ghosted"),t.text()===e.show_text?(e.showItem(),t.text(e.hide_text)):(e.hideItem(),t.text(e.show_text)),!1})},showItem:function(){return!1},hideItem:function(){return!1}}),t.ChangedQuestionModal=l.extend({
onSubmit:function(){var e=this;this._closeModal(),o("#"+e.submit_id).click()},onCancel:function(){o(".answer_editor").removeClass("hidden"),this._closeModal()},onClose:function(){o(".answer_editor").removeClass("hidden"),this._closeModal()}})}),define("app/view/question/answer_tag",["shared/polyfills","shared/core/component","tooltip","w2.dialog"],function(e,t,i){var n=e("shared/core/component").Component,o=e("tooltip"),s=e("w2.dialog"),a=s.Dialog;t.AnswerTagAdminActions=n.extend({onLoad:function(){this.enabled||this.$id("@tag_options").addClass("hidden")}}),t.AnswerTagOption=n.extend({onLoad:function(){var e=this;this.$id("@select_tag").click(function(){return e._dialog=s.createDialog(e).title(e.dialog_title).load("add_tag_dialog"),!1})}}),t.AnswerSoftCollapseMenuListItem=n.extend({onLoad:function(){var e=this;e.$id("@toggle_soft_collapse").on("click",function(t){t.preventDefault(),e.serverCall("toggle_soft_collapse").send()})}}),t.AddTagDialog=n.extend({onLoad:function(){var e=this;this.$id("@cancel").click(function(){
return a.dialogFor(e).close_(),!1}),this.$id("@add_tag").click(function(){var t=null;if(e.should_show_editor){var i=e.child("editor");t=i.serialize()}var n=e.$id("@locked").is(":checked");return e.serverCall("add_tag").kwargs({comment:t,lock:n}).liveMutate().success(function(){a.dialogFor(e).close_()}).send(),!1})}}),t.AnswerTag=n.extend({onLoad:function(){var e=this;this.$id("@show_comment").click(function(){return e.$id("@comment").removeClass("hidden"),e.$id("@show_comment").addClass("hidden"),!1}),o.attach(this.$id("@remove"),this.remove_short_text),this.$id("@remove").click(function(){return e._dialog=s.createDialog(e).title(e.remove_text).cancel().ok(function(){var t=arguments[0].dialogComponent,i=t.child("editor").serialize();e.serverCall("remove_tag").kwargs({comment:i}).liveMutate().send()},e.remove_short_text).load("remove_tag_dialog"),!1})}}),t.SoftenAnswerTag=n.extend({onLoad:function(){var e=this;this.$id("@remove").click(function(){return e._dialog=s.createDialog(e).title(e.remove_text).cancel().ok(function(){
var t=arguments[0].dialogComponent,i=t.child("editor").serialize();e.serverCall("remove_tag").kwargs({comment:i}).liveMutate().send()},e.remove_short_text).load("remove_tag_dialog"),!1})}}),t.AnswerCollapsedTag=n.extend({onLoad:function(){var e=this;this.$id("@show_comment").click(function(t){t.preventDefault(),e.$id("@comment").removeClass("hidden"),e.$id("@show_comment").addClass("hidden")})}})}),define("app/view/question/cant_answer",["shared/polyfills","shared/core/component","shared/cookies","shared/events/index","unified_view/modal","shared/perf"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/cookies"),s=e("shared/events/index"),a=e("unified_view/modal").ModalBase,r=e("shared/perf"),d=t.CantAnswerLink=n.extend({onLoad:function(){var e=this,t=this.$id("@cant_answer");t.on("click",function(){return e._userPerceivedAction=r.startUserPerceived({vcon:e.__vcon,method:"mark_as_cant_answer"}),o.setQfeedLog(e,"QuestionPass"),e.emitEvent(s.helpers.addQuestionCantAnswer(e.id)),
e._userPerceivedAction&&(r.finishAction(e._userPerceivedAction),e._userPerceivedAction=null),e.cantAnswer(),!1})},cantAnswer:function(){return this.serverCall("mark_as_cant_answer").disableDefaultUserPerceivedLogging().liveMutate({optimisticUpdate:!0}).send(),!1}});t.AMACantAnswerLink=d.extend({onLoad:function(){var e=this;this.$id("@cant_answer").on("click",function(){return e.cantAnswer(),!1})}}),t.A2ACantAnswerLink=n.extend({onLoad:function(){var e=this;this.$id("@cant_answer").on("click",function(){return e._userPerceivedAction=r.startUserPerceived({vcon:e.__vcon,method:"decline"}),e.emitEvent(s.helpers.addQuestionCantAnswer(e.id)),e._userPerceivedAction&&(r.finishAction(e._userPerceivedAction),e._userPerceivedAction=null),e.decline(),!1})},decline:function(){return this.serverCall("decline").disableDefaultUserPerceivedLogging().liveMutate({optimisticUpdate:!0}).send(),!1}}),t.A2ACantAnswerReasonLink=n.extend({onLoad:function(){var e=this;this.$id("@a2a_cant_answer").on("click",function(){
return e.allow_reason&&e.createModal("decline_modal").show(),!1})}}),t.A2ACantAnswerReasonModal=a.extend({onLoad:function(){this._super.apply(this),this.reason=this.child("editor")},onSubmit:function(){this.serverCall("attach_decline_reason").kwargs({reason:this.reason.serialize()}).liveMutate().send(),this.close()}}),t.UndoCantAnswerLink=n.extend({onLoad:function(){var e=this;this.$id("@undo_cant_answer").on("click",function(){return e.emitEvent(s.helpers.removeQuestionCantAnswer(e.id)),e.undoCantAnswer(),!1})},undoCantAnswer:function(){return this.serverCall("undo_mark_as_cant_answer").liveMutate().send(),!1}})}),define("app/view/question/disclaimer",["shared/polyfills","shared/core/component","shared/events/index","tooltip","w2.dialog"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/events/index"),s=e("tooltip"),a=e("w2.dialog").Dialog;t.AttachDisclaimerToPost=n.extend({onLoad:function(){var e=this;e.$id("@add_disclaimer_link").click(function(){return e.attachDisclaimer(),
!1}),s.attach(e.$id("@remove_button"),e.remove_disclaimer_tooltip),e.$id("@remove_button").click(function(){return e.removeAttachedDisclaimer(),!1})},attachDisclaimer:function(){this.$id("@add_disclaimer_link").toggleClass("hidden"),this.$id("@disclaimer_attached").toggleClass("hidden"),this.emitEvent({type:o.Types.POST_DISCLAIMER,payload:{pid:this.pid,state:"attach"}})},removeAttachedDisclaimer:function(){this.$id("@add_disclaimer_link").toggleClass("hidden"),this.$id("@disclaimer_attached").toggleClass("hidden"),this.emitEvent({type:o.Types.POST_DISCLAIMER,payload:{pid:this.pid,state:"remove"}})}}),t.SetDisclaimerDialog=n.extend({onLoad:function(){var e=this;e.$id("@cancel").click(function(){return a.dialogFor(e).close_(),!1})},showEditor:function(){this.$id("@choose_profession_area").hide(),this.$id("@edit_disclaimer_area").show(),this.child("editor").focusInput(),this.$id("@cancel").hide()},showError:function(){this.$id("@choose_profession_area").hide(),this.$id("@wrong_profession_error").show();
}}),t.DisclaimerIndicateProfession=n.extend({onLoad:function(){var e=this;e.$id("@options").on("click",".profession",function(){return e.parent().showEditor(),!1}),e.$id("@other").on("click",function(){return e.parent().showError(),!1})}})}),define("app/view/site_header/logged_in",["shared/polyfills","shared/core/component","shared/jquery","view/hover_menu","shared/events/index","shared/cookies","shared/w2.context"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/jquery"),s=e("view/hover_menu"),a=e("shared/events/index"),r=e("shared/cookies"),d=e("shared/w2.context");t.LoggedInSiteHeaderContext=d.Context.extend({initialProperties:function(){return{question_query_empty:!0,question_title_over_limit:!1,question_details_over_limit:!1,question_details_is_empty:!0,force_enable_button:null}}}),t.LoggedInSiteHeader=n.extend({contextConstructor:function(){return t.LoggedInSiteHeaderContext},onLoad:function(){var e=this;this.handleEvent(a.Types.SITE_HEADER_SEARCH_FOCUSED,function(t){
e.$id("@header").toggleClass("search_focused",t.payload.focused)})}}),t.FeedNavBadge=n.extend({onLoad:function(){var e=this;e.should_growl&&e.serverCall("send_growl").send()}}),t.NotifsNavBadge=n.extend({onLoad:function(){var e=this;this.handleEvent(a.Types.NOTIFS_CLEAR_BADGE,function(t){e.$id("@badge").addClass("hidden")})}}),t.NotifsNavItemBase=s.HoverMenu.extend({onLoad:function(){this._super.apply(this,arguments);var e=this;this.handleEvent(a.Types.NOTIFS_HIDE_DROPDOWN,function(){e.cancelHover=!0,e.doHide()})},isInvalidCloseTarget:function(e){var t=this.$id("@link"),i=".SiteHeaderHoverMenuContents";return e.is(t)||e.parents(t).is(t)||e.is(i)||0!==e.parents(i).length?!0:!1},doShow:function(){this.emitEvent({type:a.Types.NOTIFS_CLEAR_BADGE,scope:a.scope.GLOBAL,payload:{}}),this.serverCall("clear_badge").send(),this._super.apply(this,arguments)}}),t.NotifsHoverMenuContents=n.extend({onLoad:function(){this.$id("@dropdown").on("DOMMouseScroll mousewheel",function(e){var t=this.scrollTop,i=this.scrollHeight,n="DOMMouseScroll"==e.type?4*e.originalEvent.detail:e.originalEvent.deltaY,s=0>n;
!s&&n>i-o(this).height()-t?(o(this).scrollTop(i),e.preventDefault()):s&&-n>t&&(o(this).scrollTop(0),e.preventDefault())})}}),t.MobileSiteLink=n.extend({onLoad:function(){this.$id("@mobile_link").click(function(){return r.setCookie("m","1"),window.location.reload(!0),!1})}})}),define("app/view/question/lookup_bar",["shared/polyfills","webnode2","shared/core/component","shared/core/webnode","shared/jquery","view/selector","shared/window_manager","shared/events/index","shared/dom","shared/siteuri","shared/cookies","third_party/autosize","app/view/site_header/logged_in"],function(e,t,i){var n=e("webnode2"),o=e("shared/core/component").Component,s=e("shared/core/webnode"),a=e("shared/jquery"),r=e("view/selector").WithServerCallMessageMixin,d=e("shared/window_manager"),l=e("shared/events/index"),c=e("shared/dom"),h=e("shared/siteuri").URI,u=e("shared/cookies"),p=e("third_party/autosize"),f=e("app/view/site_header/logged_in").LoggedInSiteHeaderContext,_=null;t.LookupBarSelector=r.extend({onLoad:function(){
var e=this;_=e,this._super.apply(this,arguments),e.context=e.getContext(f),e.logged_in&&e.context.set("question_query_empty",this.isQueryEmpty()),this.$results_wrapper=this.$id("@results_wrapper"),this.$results_container.removeClass("hidden"),e.displayedRevision=0,e.currentRevision=0,e.currentOutstandingRequests=0,e.lastRevisionNeedsUpdate=!1,e.cache={},e.cacheSize=0,e.focused=!0,e.shouldSimScroll=!0,e.$wrapper=e.$id("@wrapper"),e.shouldHighlightOnFocus=!e.should_autofocus,e.editingQuestionDetails=!1,e.targetType=null,e.targetOid=null,e.adding_followup=!1,a(document).mousedown(function(t){e.$wrapper.is(t.target)||0!==e.$wrapper.has(t.target).length||a(t.target).closest(".SiteHeader.search_focused")[0]||a(t.target).closest(".ClearQuestionDetailsConfirmationModal")[0]?e.$id("@details_wrapper").has(t.target).length>0?e.showResults(!1):(e.shouldSimScroll=!1,e.focused=!0,0!==e.query.trim().length?e.hasResults?e.showResults(!0):e._setQuery(e.$input.val()):e.showResults(!1)):(e.focused=!1,e.setHighlight(!1),
e.showResults(!1),"forced"===e.askMode&&(e.isQueryEmpty()?(e.setAskMode(!1),e.setQuery("")):e.askMode=!0))}),e.$input.click(function(){if(e.shouldHighlightOnFocus||e.setHighlight(!0),e._queryIsPunctation(e.query)&&"forced"===e.askMode){var t=e.opening_question_punctuation.length;e.$input[0].setSelectionRange(t,t)}}),e.askMode=!1,e.showingInterstitial=!1,e.source=null,e.currentSession=0,this.handleEvent(l.Types.LOOKUP_BAR_ASK_QUESTION,function(t){e.ask(t.payload.isPrivate)}),this.handleEvent(l.Types.LOOKUP_BAR_QUESTION_DETAILS_STATE,function(t){"focused"==t.payload.state?e.showResults(!1):"shown"==t.payload.state?(e.$id("@details_wrapper").removeClass("hidden"),e.editingQuestionDetails=!0):"hidden"==t.payload.state&&(e.$id("@details_wrapper").addClass("hidden"),e.editingQuestionDetails=!1,e.$input.focus())})},inputFocusHandler:function(){this._super.apply(this,arguments),this.shouldHighlightOnFocus&&(this.setHighlight(!0),this.isQueryEmpty()||!this.hasResults||this.editingQuestionDetails||this.showResults(!0));
},inputBlurHandler:function(){if(this._super.apply(this,arguments),this.logged_in){var e=this;document.activeElement.id==e.$input.attr("id")||e.focused||(e.setHighlight(!1),e.shouldHighlightOnFocus=!0)}},handleEscKey:function(){this._super.apply(this,arguments),this.logged_in&&this.setHighlight(!1)},capitalize:function(e){return e?e=e.charAt(0).toUpperCase()+e.slice(1):e},setInputVal:function(e,t){var i=this.$input[0].selectionStart,n=this.$input[0].selectionEnd;t&&(i+=t,n+=t),this.$input.val(e),e.length>0&&this.$input[0].setSelectionRange(i,n)},_queryIsPunctation:function(e){return e===this.opening_question_punctuation+this.closing_question_punctuation||e===this.opening_question_punctuation&&e.length>0||e===this.closing_question_punctuation&&e.length>0},_setQuery:function(e,t){var i=this.capitalize(e);if(t||this.askMode&&i!==e){var n="";(e||t)&&-1==e.indexOf(this.opening_question_punctuation)&&(n=this.opening_question_punctuation);var o="";(e||t)&&-1==e.indexOf(this.closing_question_punctuation)&&(o=this.closing_question_punctuation),
e=n+i+o,this.setInputVal(e,n.length)}else this.askMode&&"forced"!==this.askMode&&this._queryIsPunctation(e)&&(e="",this.setInputVal(e));if(this.length_limit&&this.logged_in){var s=e.length>this.length_limit;this.context.set("question_title_over_limit",s)}this._super.apply(this,[e])},addToCache:function(e,t){if(e in this.cache||this.cacheSize++,this.cache[e]=t,this.cacheSize>this.max_cache_size){var i=this.currentRevision+1,n=null;for(var o in this.cache)this.cache[o][1]<i&&(i=this.cache[o][1],n=o);this.cacheSize--,delete this.cache[n]}},updateResults:function(){var e=this;""===e.query&&e.setAskingTarget(null,null);var t=e.query.trim();if("forced"===e.askMode&&(e._queryIsPunctation(t)||""===t))return void e.showInterstitial("ask_question");var i={query:e.query},n=e.getExtraKwargs();for(var o in n)i[o]=n[o];var s=JSON.stringify(i),a=e.currentRevision;if(e.lastRevisionNeedsUpdate=!1,0===t.length)e.displayedRevision=a,e.setAskMode(!1),e.showResults(!1),e.currentSession++;else if(s in e.cache)e.currentOutstandingRequests++,
e.resultsServerCallHandler(a,e.cache[s][0],this.showingInterstitial);else{if(e.query!==i.query)return;if(e.currentOutstandingRequests<e.max_concurrent_requests){i.parent_cid=e.cid,i.selector_id=e.selector_id,e.currentOutstandingRequests++;var r=e.showingInterstitial;e.serverCall("results_content_for").kwargs(i).sendJsData(e.shouldSendJSData).success(function(t){e.resultsServerCallHandler(a,t,s,r)}).except(function(){e.resultsServerCallHandler(a,null,s,r)}).error(function(){e.resultsServerCallHandler(a,null,s,r)}).send()}else e.lastRevisionNeedsUpdate=!0}},getExtraKwargs:function(){return{ask_mode:this.askMode,current_session:this.currentSession}},resultsServerCallHandler:function(e,t,i,o){this.currentOutstandingRequests--,this.hasResults=!0,e<this.displayedRevision||(o&&(this.showingInterstitial=!1,this.$id("@ask_mode_interstitial").addClass("hidden"),this.$id("@results").removeClass("hidden")),null!==t&&(n.forgetContents(this.$results),s.setContent(this.$results,t),this.displayedRevision=e,
this.addToCache(i,[t,e])),this.showResults(!0),this.lastRevisionNeedsUpdate&&this.updateResults())},queryDidChange:function(){this.currentRevision++,this.logged_in&&(this.context.set("question_query_empty",this.isQueryEmpty()),this.context.set("force_enable_button",!0)),this._super.apply(this,arguments),this.is_textarea&&!this.hasAutoSized&&(p(this.$input),this.hasAutoSized=!0)},isQueryEmpty:function(){return""===this.query.trim()||this._queryIsPunctation(this.query.trim())},showResults:function(e){var t=this;e&&t.focused&&!t.isQueryEmpty()?(t.$results_wrapper.removeClass("hidden"),t.$results_wrapper.removeClass("fade_out"),t.setHighlight(!0)):c.addAnimationClass(t.$results_wrapper,"fade_out",function(){t.$results_wrapper.hasClass("hidden")||t.$results_wrapper.addClass("hidden")})},resultWasSelected:function(e,t){var i=this,n=this.child("results").child(e.data.cname);n.processAction(e.data.action_mousedown),"search"===e.ty?i.goToSearch(t):(-1!==e.data.qid&&u.setMessage("look",[e.data.qid,!0]),
i.query.length<140&&u.setCookie("qsu-q",JSON.stringify(i.query),{expires:1}),-1!==e.data.qid&&i.targetType?i.adding_followup||(i.adding_followup=!0,i.serverCall("add_followup").kwargs({qid:e.data.qid,target_type:i.targetType,target_oid:i.targetOid}).success(function(e){t?window.open(e):window.location.href=e,i.adding_followup=!1}).error(function(){i.adding_followup=!1}).send()):t?window.open(e.data.url):window.location.href=e.data.url)},hideInterstitials:function(){this.showingInterstitial=!1,this.$id("@ask_mode_interstitial").addClass("hidden"),this.$id("@results").removeClass("hidden")},showInterstitial:function(e){this.hideInterstitials(),this.showingInterstitial=!0,this.$id("@ask_mode_interstitial").removeClass("hidden"),this.$id("@results").addClass("hidden");var t=this.interstitials[e][0],i=this.interstitials[e][1];this.$id("@interstitial_title").text(t),this.$id("@interstitial_text").text(i)},setHighlight:function(e,t){var i=this.parent().parent().$id("@body_blur");if(e){i.addClass("lookup_bar_modal_overlay"),
i.removeClass("closing"),this.logged_in&&this.context.set("force_enable_button",!0),this.emitEvent({type:l.Types.SITE_HEADER_SEARCH_FOCUSED,payload:{focused:!0}});var n=this.$input.outerWidth();this.$results_wrapper.width(n-2),this.focused=!0}else c.addAnimationClass(i,"closing",function(){i.hasClass("lookup_bar_modal_overlay")&&i.removeClass("lookup_bar_modal_overlay")}),this.emitEvent({type:l.Types.SITE_HEADER_SEARCH_FOCUSED,payload:{focused:!1}}),this.focused=!1;this.nextHighlightCallback&&this.nextHighlightCallback(),this.nextHighlightCallback=t},setAskMode:function(e,t){this.askMode=e,(this.query.trim()||e)&&this._setQuery(this.query.trim(),!0),e&&(this.$input.focus(),t?this.showInterstitial(t):this.query.trim().length>=10&&this.query.split(" ").length>=3?this.showInterstitial("good"):this.showInterstitial("bad"),this.logMiscAction("LookupBarSetAskModeClickthrough"),this.lastRevisionNeedsUpdate=!1,this.focused=!0,this.showResults(!0))},logMiscAction:function(e){var t=this.child("results");
if(t){var i=t.child("search");i&&i.processAction(e)}},submit:function(e){this.logged_in?this.should_go_to_search_on_enter?(this.logMiscAction("LookupBarPressEnterSearch"),this.goToSearch(e)):this.logMiscAction("LookupBarPressEnterNothing"):(this.logMiscAction("LookupBarPressEnterSearch"),this.goToSearch(e))},goToSearch:function(e){if(this.query.trim()){var t=h("/search?q="+encodeURIComponent(this.query).replace(/%20/g,"+")+this.keepFilters);e?window.open(t.unicode()):window.location.href=t.unicode()}},ask:function(e){var t=this;if(!t.hasPendingServerCall()){this.context.set("force_enable_button",!1);var i=t.getQuestionDetails();t.makeServerCall(t.serverCall("add_question").kwargs({input_text:t.query,is_anon:e,question_details:i,source:t.source,target_type:t.targetType,target_oid:t.targetOid}))}},getQuestionDetails:function(){var e=this.child("question_details");return e?e.serialize():""},setSource:function(e){var t=this;t.source=e},updateServerMessage:function(e,t){var i=this;return e?(t.url&&(i.logMiscAction("LookupBarAddQuestionSuccess"),
d.navigateTo(t.url)),!1):"confirm_email"===t.type?(i.createModal("email_confirmation_dialog_contents").onSubmit(function(){i.serverCall("resend_email_confirmation").send()}).show(),!1):(i.logMiscAction("LookupBarAddQuestionFail"),i.context.set("force_enable_button",!0),i.$input.focus(),t&&t.message?(this.$id("@server_message_title").text(t.message.title),t.message.note&&this.$id("@server_message_note").text(t.message.note),!0):!1)},setAskingTarget:function(e,t){this.targetType=e,this.targetOid=t,this.emitEvent({type:l.Types.LOOKUP_BAR_SET_ASKING_TARGET,payload:{isCleared:null==this.targetType}})}}),t.LookupBarSiteHeaderAddQuestion=o.extend({onLoad:function(){var e=this;e.$askButton=e.$id("@submit_question"),e.context=e.getContext(f),e.context.on("question_details_over_limit",function(t,i){e.enableButton(!i)}),e.context.on("question_title_over_limit",function(t,i){e.enableButton(!i)}),e.context.on("force_enable_button",function(t,i){e.enableButton(i)}),e.$askButton.click(function(t){t.preventDefault(),
e.emitEvent({type:l.Types.LOOKUP_BAR_ASK_QUESTION,payload:{isPrivate:e.getIsPrivate()}})}),e.$id("@add_details").click(function(t){t.preventDefault(),e.showQuestionDetailsEditor(!0)}),e.$id("@remove_details").click(function(t){t.preventDefault(),e.context.get("question_details_is_empty")?e.showQuestionDetailsEditor(!1):e.createModal("load_clear_confirmation").onSubmit(function(){e.showQuestionDetailsEditor(!1)}).show()}),this.handleEvent(l.Types.LOOKUP_BAR_SET_ASKING_TARGET,function(t){t.payload.isCleared?e.$id("@anon_checkbox").prop("disabled",!1):(e.$id("@anon_checkbox").prop("checked",!1),e.$id("@anon_checkbox").prop("disabled",!0))})},showQuestionDetailsEditor:function(e){this.emitEvent({type:l.Types.LOOKUP_BAR_QUESTION_DETAILS_STATE,payload:{state:e?"shown":"hidden"}}),e?(this.$id("@add_details").addClass("hidden"),this.$id("@remove_details").removeClass("hidden"),this.emitEvent({type:l.Types.LOOKUP_BAR_QUESTION_DETAILS_STATE,payload:{state:"focused"}})):(this.$id("@remove_details").addClass("hidden"),
this.$id("@add_details").removeClass("hidden"))},getIsPrivate:function(){return this.$id("@anon_checkbox").prop("checked")||!1},enableButton:function(e){this.context.get("question_title_over_limit")||this.context.get("question_details_over_limit")?this.$askButton.addClass("fake_disabled"):this.context.get("question_query_empty")?this.$askButton.addClass("disabled"):e?(this.$askButton.removeClass("disabled"),this.$askButton.removeClass("fake_disabled")):this.$askButton.addClass("disabled")}});var g=[];t.AddQuestionLookupBarButton=o.extend({setAllEnabled:function(e){g.forEach(function(t){t.setEnabled(e)})},setEnabled:function(e){e?this.$id("@dialog_link").removeClass("disabled"):this.$id("@dialog_link").addClass("disabled")},onLoad:function(){var e=this;g.push(e),this.$id("@dialog_link").click(function(){var t=_;t.setAskingTarget(e.targetType,e.targetOid);var i="button";return i=e.source?"answer":"ask_question",t.setAskMode("forced",i),e.setAllEnabled(!1),t.setHighlight(!0,function(){e.setAllEnabled(!0);
}),t.setSource(e.source),e.serverCall("log_click").kwargs({source:e.source}).send(),!1})}})}),define("shared/email",["shared/polyfills"],function(e,t,i){t.isValidEmail=function(){var e="[^\\x0d\\x22\\x5c\\x80-\\xff]",t="[^\\x0d\\x5b-\\x5d\\x80-\\xff]",i="[^\\x00-\\x20\\x22\\x28\\x29\\x2c\\x2e\\x3a-\\x3c\\x3e\\x40\\x5b-\\x5d\\x7f-\\xff]+",n="\\x5c[\\x00-\\x7f]",o="\\x5b("+t+"|"+n+")*\\x5d",s="\\x22("+e+"|"+n+")*\\x22",a=i,r="("+a+"|"+o+")",d="("+i+"|"+s+")",l=r+"(\\x2e"+r+")*",c=d+"(\\x2e"+d+")*",h=c+"\\x40"+l,u="^"+h+"$",p=new RegExp(u);return function(e){return p.test(e)}}()}),define("shared/linkify",["shared/polyfills"],function(e,t,i){t.iterLinks=function(e,t){n(e,{callback:function(e,i){return i&&t(i,e),""}})};var n=t.linkify=function(){var e="[a-z\\d.-]+://",t="(?:(?:[^\\s!@#$%^&*()_=+[\\]{}\\\\|;:'\",.<>/?]+)\\.)+",i="(?:ac|ad|aero|ae|af|ag|ai|al|am|an|ao|aq|arpa|ar|asia|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|biz|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|cat|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|coop|com|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|edu|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gov|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|info|int|in|io|iq|ir|is|it|je|jm|jobs|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mil|mk|ml|mm|mn|mobi|mo|mp|mq|mr|ms|mt|museum|mu|mv|mw|mx|my|mz|name|na|nc|net|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|org|pa|pe|pf|pg|ph|pk|pl|pm|pn|pro|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sy|sz|tc|td|tel|tf|tg|th|tj|tk|tl|tm|tn|to|tp|travel|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|xn--0zwm56d|xn--11b5bs3a9aj6g|xn--80akhbyknj4f|xn--9t4b11yi5a|xn--deba0ad|xn--g6w251d|xn--hgbk6aj7f53bba|xn--hlcj6aya9esc7a|xn--jxalpdlp|xn--kgbechtv|xn--zckzah|ye|yt|yu|za|zm|zw)",n="(?:"+t+i+")",o="(?:[;/][^#?<>\\s\\[\\]]*)?",s="(?:\\?[^#<>\\s]*)?(?:#[^<>\\s]*)?",a="\\b"+e+"[^<>\\s\\[\\]]+",r="\\b"+n+o+s+"(?!\\w)",d="mailto:",l="(?:"+d+")?[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@"+n+s+"(?!\\w)",c=new RegExp("(?:"+a+"|"+r+"|"+l+")","ig"),h=new RegExp("^"+e,"i"),u={
"'":"`",">":"<",")":"(","]":"[","}":"{","»":"«","›":"‹"},p={callback:function(e,t){return t?'<a href="'+t+'" title="'+t+'">'+e+"</a>":e},punct_regexp:/(?:[!?.,:;'"]|(?:&|&amp;)(?:lt|gt|quot|apos|raquo|laquo|rsaquo|lsaquo);)$/};return function(e,t){t=t||{};var i,n,o,s,a,r,l,f,_,g,m,v,w="",b=[];for(n in p)void 0===t[n]&&(t[n]=p[n]);for(;i=c.exec(e);)if(o=i[0],r=c.lastIndex,l=r-o.length,!/[\/:]/.test(e.charAt(l-1))){do f=o,v=o.substr(-1),m=u[v],m&&(_=o.match(new RegExp("\\"+m+"(?!$)","g")),g=o.match(new RegExp("\\"+v,"g")),(_?_.length:0)<(g?g.length:0)&&(o=o.substr(0,o.length-1),r--)),t.punct_regexp&&(o=o.replace(t.punct_regexp,function(e){return r-=e.length,""}));while(o.length&&o!==f);s=o,h.test(s)||(s=(-1!==s.indexOf("@")?s.indexOf(d)?d:"":s.indexOf("irc.")?s.indexOf("ftp.")?"http://":"ftp://":"irc://")+s),a!=l&&(b.push([e.slice(a,l)]),a=r),b.push([o,s])}for(b.push([e.substr(a)]),n=0;n<b.length;n++)w+=t.callback.apply(window,b[n]);return w||e}}()}),define("qtext2/util",["shared/polyfills","shared/email","shared/jquery","shared/log","shared/linkify","shared/util"],function(e,t,i){
var n=e("shared/email").isValidEmail,o=e("shared/jquery"),s=e("shared/log").log,a=["keydown","keyup","keypress"],r=e("shared/linkify"),d=/^https?\:\/\//,l=e("shared/util");s.warn=s.warn.bind(s,"qtext2");var c={assert:function(e){if(!e){var t=Array.prototype.slice.call(arguments,1);throw new Error(t)}},create:function(e){return document.createElement(e)},objectIntersection:function(e,t){for(var i=Object.keys(e),n={},o=0;o<i.length;o++){var s=i[o];c.jsonEqual(e[s],t[s])&&(n[s]=e[s])}return n},removeNullValues:function(e){for(var t,i=Object.keys(e),n=0;n<i.length;n++)if(t=i[n],null===e[t])delete e[t];else if("[object Object]"===Object.prototype.toString.call(e[t]))c.removeNullValues(e[t]);else if("[object Array]"===Object.prototype.toString.call(e[t]))for(var o=0;o<e[t].length;o++)c.removeNullValues(e[t][o]);return e},getData:function(e,t){return e.getAttribute("data-"+t)},setData:function(e,t,i){e.setAttribute("data-"+t,i)},removeData:function(e,t){e.removeAttribute("data-"+t)},isTextNode:function(e){
return e&&3==e.nodeType},safeRemoveChild:function(e,t){e?e.parentNode?e.parentNode!=t?s.warn("Tried to remove node from non parent",e,t):t.removeChild(e):s.warn("Node already detached from parent.",e):s.warn("Node is undefined.")},on:function(e,t,i){e=e instanceof Array?e:[e],e.forEach(function(e){t.addEventListener(e,function(t){var n;return-1!=a.indexOf(e)&&(t.which=void 0!==t.charCode?t.charCode:t.keyCode),n=i(t,e),n===!1&&(t.preventDefault(),t.stopPropagation()),n})})},ensureProtocol:function(e){return n(e)?e:(d.test(e)||(e="http://"+e),e)},splitLines:function(e){return e.split(/\n|\r\n?/)},splitByRegex:function(e,t){for(var i,n=[];e;)i=e.match(t),i?(i.index&&n.push({text:e.slice(0,i.index)}),n.push({text:i[0],match:i}),e=e.slice(i.index+i[0].length)):(n.push({text:e}),e="");return n},jsonEqual:function(e,t){var i,n;if(e===t)return!0;if("object"!=typeof e||"object"!=typeof t)return e===t;if(null===e||void 0===e||null===t||void 0===t)return!1;if(typeof e!=typeof t)return!1;if(e instanceof Array){
if(e.length!==t.length)return!1;for(var o=0;o<e.length;o++)if(!c.jsonEqual(e[o],t[o]))return!1;return!0}return i=Object.getOwnPropertyNames(e),n=Object.getOwnPropertyNames(t),i.length!=n.length?!1:i.every(function(i){return c.jsonEqual(e[i],t[i])})},linkify:function(e){var t=[];return r.linkify(e,{callback:function(e,i){0!==e.length&&t.push({text:e,href:i})}}),t},firstScrollingParent:l.firstScrollingParent,getContainerOffset:function(e){var t=o(e).offset(),i=c.firstScrollingParent(e);if(i!==document.body){var n=o(i).offset();t.left+=i.scrollLeft-n.left,t.top+=i.scrollTop-n.top}return t},isAstralSymbol:function(e){return/[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(e)}};t.Util=c}),define("qtext2/quirks",["shared/polyfills","shared/browser"],function(e,t,i){var n=e("shared/browser"),o={usesCompositionEvents:function(){return n.gecko||n.webkit&&n.webkitVersion>532},dragEventContainsFile:function(e){var t=e.dataTransfer;return t?t.files&&t.files.length>0?!0:t.types?t.types.indexOf&&-1!=t.types.indexOf("Files")?!0:t.types.contains&&t.types.contains("application/x-moz-file")?!0:!1:!1:!1;
},insertsPeriodWithDoubleSpace:function(){return n.ios}};t.Quirks=o}),define("qtext2/extension/base",["shared/polyfills","shared/Class"],function(e,t,i){var n=e("shared/Class").Class;t.Extension=n.extend({__init__:function(e){this.doc=e},install:function(){throw new Error("Sub-classes should implement this method.")},destroy:function(){}})}),define("qtext2/extension/link_interaction",["shared/polyfills","qtext2/extension/base","interface/settings","gating"],function(e,t,i){var n=e("qtext2/extension/base").Extension,o=e("interface/settings").pageIsMobile,s=e("gating"),a=t.linkInteractionEnabled=function(){return!o&&s.qtext2_link_interaction};t.LinkInteraction=n.extend({install:function(){a()&&(this._activeLinkSpan=null,this.doc.on("caretMoved",this.onCaretMoved.bind(this)))},onCaretMoved:function(){this._maybeSwitchToolbar()},_maybeSwitchToolbar:function(){this._shouldSwitchToolbar()?this._switchToolbar():this._activeLinkSpan&&this._switchBackToolbar()},_shouldSwitchToolbar:function(){var e=this.doc.caret.start.span;
return this.doc.caret.isCollapsed()&&(e.hasModifier("link")||e.hasModifier("citation"))},_switchToolbar:function(){var e,t=this.doc.caret.start.span;t.hasModifier("link")?e=t.getModifier("link"):t.hasModifier("citation")&&(e=t.getModifier("citation").target),e&&e.url&&this._activeLinkSpan!==t&&(this._activeLinkSpan=t,this.doc.setLinkInputFocus(!1),this.doc.handleCommand("link"))},_switchBackToolbar:function(){this.doc.trigger("focus"),this.doc.setLinkInputFocus(!0),this._activeLinkSpan=null}})}),define("qtext2/ui",["shared/polyfills","shared/Class","qtext2/util","shared/log","qtext2/quirks","qtext2/extension/link_interaction","shared/upload"],function(e,t,i){var n=e("shared/Class").Class,o=e("qtext2/util").Util,s=e("shared/log").log,a=e("qtext2/quirks").Quirks,r=e("qtext2/extension/link_interaction").linkInteractionEnabled,d=e("shared/upload");s=s.bind(s,"qtext2"),t.LinkSelector=n.extend({__init__:function(e){this.editor=e,this.toolbar=e.toolbar,this.active=!1,this.key="",this._onSubmitCallback=null,
this._onCancelCallback=null},isActive:function(){return this.active},show:function(){throw new Error("NotImplemented: Subclasses should override")},hide:function(){this.active=!1,this.key=""},submit:function(){throw new Error("NotImplemented: Subclasses should override")},cancel:function(){throw new Error("NotImplemented: Subclasses should override")},onSubmit:function(e){this._onSubmitCallback=e},onCancel:function(e){this._onCancelCallback=e},getExternalURL:function(e,t,i){this.toolbar&&(this.toolbar.on("linkInput",e),this.toolbar.showBar(0),r()&&this.toolbar.setLinkToolbarStatus(t,i))},getLinkPreview:function(e,t,i){this.editor.serverCall("get_link_preview").kwargs({url:e}).success(t).error(i).send()}}),t.ImageUploader=n.extend({__init__:function(e,t,i,n,o){this.editor=e,this.doc=t,this.$dropZone=i,this.$fileInput=n,this.interface_strings=o,this._dragStartedInDoc=!1,this.initEventHandlers()},_debugEvent:function(e,t){s("dropzone",e,t)},initEventHandlers:function(){o.on("dragenter",this.doc.node,this.onDragEnter.bind(this)),
o.on("dragstart",this.doc.node,this.onDragStart.bind(this)),o.on("dragend",this.doc.node,this.onDragEnd.bind(this)),o.on("paste",this.doc.node,this.onPaste.bind(this)),o.on("drop",this.doc.node,this.onDropInDoc.bind(this)),o.on("dragleave",this.$dropZone,this.onDragLeave.bind(this)),o.on("dragover",this.$dropZone,this.onDragOver.bind(this)),o.on("click",this.$dropZone,this.onClick.bind(this)),o.on("drop",this.$dropZone,this.onDrop.bind(this)),o.on("change",this.$fileInput,this.onChange.bind(this))},onDragEnter:function(e){this._debugEvent("dragenter",e),a.dragEventContainsFile(e)&&(this._dragStartedInDoc||this.showDropZone())},onDragStart:function(e){this._debugEvent("dragstart",e),this._dragStartedInDoc=!0},onDragEnd:function(e){this._debugEvent("dragend",e),this._dragStartedInDoc=!1},onDropInDoc:function(e){this._debugEvent("drop (in doc)",e),this._dragStartedInDoc=!1},onDragLeave:function(e){this._debugEvent("dragleave",e),this.hideDropZone()},onDragOver:function(e){this._debugEvent("dragover",e),
e.preventDefault()},onClick:function(e){this._debugEvent("click",e),this.hideDropZone()},onDrop:function(e){return this._debugEvent("drop",e),e.preventDefault(),e.stopPropagation(),e.dataTransfer?void this.startUpload(e.dataTransfer.files):void this.hideDropZone()},onChange:function(e){this._debugEvent("change",e),this.startUpload(this.$fileInput.files),this.$fileInput.value=null},onPaste:function(e){this._debugEvent("paste",e);var t=e.clipboardData,i=[];if(!t||!t.items)return!1;for(var n=0;n<t.items.length;++n){var o=t.items[n].type;(o.match(/image/i)||o.match(/file/i))&&i.push(t.items[n].getAsFile())}return this.startUpload(i),!1},showDropZone:function(){this.$dropZone.innerHTML=this.interface_strings.drop_images,this.$dropZone.classList.remove("hidden"),this.$dropZone.style.lineHeight=this.doc.node.clientHeight+"px",this.$dropZone.style.top=this.doc.node.offsetTop+"px"},hideDropZone:function(){this.$dropZone.classList.remove("uploading"),this.$dropZone.classList.add("hidden")},showUploading:function(e){
this.showDropZone(),e>1?this.$dropZone.innerHTML=this.interface_strings.uploading_images.replace("{}",e):this.$dropZone.innerHTML=this.interface_strings.uploading_image},_onUpload:function(e){this.doc.insertImages(e.qimg_urls),this.hideDropZone()},_onError:function(e){e&&e.message?alert(e.message):alert(this.interface_strings.upload_error),this.hideDropZone()},startUpload:function(e){return 0===e.length?void this.hideDropZone():(this.showUploading(e.length),void d.uploadData({kind:"qtext"},e,this._onUpload.bind(this),this._onError.bind(this)))},uploadImageUrl:function(e,t){this.editor.serverCall("upload_image_url").kwargs({url:e}).success(t).error(this._onError.bind(this,null)).send()}}),t.PhotoSearch=n.extend({__init__:function(e,t,i,n){this.$searchComponent=t,this.$wrapper=i,this.$searchComponent.setSelectCallback(this.submit.bind(this)),this.$searchComponent.setUploadCallback(this.hide.bind(this)),this.$searchComponent.setUploader(n),this.active=!1},isActive:function(){return this.active;
},fixPosition:function(){var e=this.$wrapper,t=this.$wrapper.parent(),i=6,n=function(){var o=t.find(".editor_toolbar"),s=t.offset().left+t.width()-e.width();"fixed"===o.css("position")?e.css("position","fixed").css("left",s).css("right","auto"):e.css("position","absolute").css("left","auto").css("right",0),e.css("top",parseInt(o.css("top"))+o.height()+i),window.requestAnimationFrame(n)};n()},show:function(){var e=this;e.fixPosition(),e.$wrapper.addClass("animate_in"),setTimeout(function(){e.$wrapper.removeClass("animate_in"),e.$wrapper.addClass("is_shown")},200),e.$searchComponent.makeActive(),e.active=!0},hide:function(){var e=this;e.active=!1,e.$wrapper.addClass("animate_out"),setTimeout(function(){e.$wrapper.removeClass("is_shown"),e.$wrapper.removeClass("animate_out")},200)},toggle:function(){this.active?this.hide():this.show()},submit:function(e){this._onInsertCallback&&this._onInsertCallback(e)},cancel:function(){return this._onCancelCallback?(this._onCancelCallback(),!1):void 0},
onInsert:function(e){this._onInsertCallback=e},onCancel:function(e){this._onCancelCallback=e}})}),define("unified_view/qtext2/editor/mobile",["shared/polyfills","shared/client","interface/settings","unified_view/modal","qtext2/ui","shared/debounce","shared/window_manager"],function(e,t,i){var n,o,s=e("shared/client"),a=e("interface/settings").pageIsMobile,r=e("unified_view/modal").ModalBase,d=e("qtext2/ui"),l=e("shared/debounce").debounce,c=e("shared/window_manager");a&&(n=e("mobile_app2/client"),o=e("mobile_app2/messages")),t.EditorModal=r.extend({onLoad:function(){this._super.apply(this,arguments),n.setNavigationCancelButton(this.cancelButtonText,!1),t.activeEditor=this,s.isNativeApp()&&(o.send("setupEditor",{hasDraft:!!this.has_draft}),o.send("restoreState",{key:this.key})),this._setupEditor()},_setupEditor:function(){var e=this;if(this.editor=this.child("editor"),this.editor.setFocusCallback(function(){t.activeEditor=e}),this.has_draft){var i=l(this.autoSaveDraft.bind(this),750,{maxWait:1e4,
leading:!0});this.editor.setMeaningfulChangeCallback(function(){e.saveState(),i()})}else this.editor.setMeaningfulChangeCallback(this.saveState.bind(this))},focus:function(){this.editor.focus()},getState:function(){return this.editor.serialize()},saveState:function(){s.isNativeApp()&&o.send("saveState",{key:this.key,value:this.getState()})},restoreState:function(e){this.editor.doc.fromJSON(e)},_onDraftSaveSuccess:function(){o.send("draftSaveComplete",{success:!0})},_onDraftSaveError:function(){o.send("draftSaveComplete",{success:!1})},_onDraftClearSuccess:function(){o.send("draftClearComplete",{key:this.key,success:!0})},_onDraftClearError:function(){o.send("draftClearComplete",{key:this.key,success:!1})},_saveDraftServerCall:function(){return this.serverCall("save_draft").kwargs({oid:this.oid,content:this.getState()})},autoSaveDraft:function(){this.saveState(),this._saveDraftServerCall().send()},saveDraft:function(){o.send("showLoadingView"),this.saveState(),this._saveDraftServerCall().success(this._onDraftSaveSuccess.bind(this)).error(this._onDraftSaveError.bind(this)).send();
},clearDraft:function(){o.send("showLoadingView"),this.serverCall("clear_draft").kwargs({oid:this.oid}).success(this._onDraftClearSuccess.bind(this)).error(this._onDraftClearError.bind(this)).send()},onSubmit:function(){var e=this._super.bind(this),t=this;s.isIOSApp()?o.send("showProgressBar"):o.send("showLoadingView");var i;s.isAndroidApp()&&(i=setInterval(function(){t.setMobileDoneButtonDisabled(!0)},30)),this.serverCall("submit").kwargs({oid:this.oid,content:this.getState(),extra_kwargs:this.extra_kwargs}).success(function(n){s.isIOSApp()?o.send("hideProgressBar",{complete:!0}):o.send("hideLoadingView"),s.isAndroidApp()&&(clearInterval(i),t.setMobileDoneButtonDisabled(!1)),n.success&&e(n)}).error(function(){s.isIOSApp()?o.send("hideProgressBar"):o.send("hideLoadingView"),s.isAndroidApp()&&(clearInterval(i),t.setMobileDoneButtonDisabled(!1))}).sendOnlyOnce()}}),t.WriteAnonAnswerModal=t.EditorModal.extend({submit:function(e){e.next_url&&c.navigateTo(e.next_url)}}),t.DualEditorModal=t.EditorModal.extend({
_setupEditor:function(){var e=this;this.title_editor=this.child("title"),this.details_editor=this.child("details"),this.isTitleOverLimit=!1,this.isDetailsOverLimit=!1,this.lastFocusedEditor=null,this.title_editor.setFocusCallback(function(){t.activeEditor=e,e.lastFocusedEditor=e.title_editor}),this.details_editor.setFocusCallback(function(){t.activeEditor=e,e.lastFocusedEditor=e.details_editor}),this.title_editor.setMeaningfulChangeCallback(this.saveState.bind(this)),this.details_editor.setMeaningfulChangeCallback(this.saveState.bind(this)),this.title_length_limit&&this.title_editor.setLengthChangeCallback(function(t){e.isTitleOverLimit=t,e.updateButton()}),this.details_length_limit&&this.details_editor.setLengthChangeCallback(function(t){e.isDetailsOverLimit=t,e.updateButton()})},updateButton:function(){this.setMobileDoneButtonDisabled(this.isTitleOverLimit||this.isDetailsOverLimit)},focus:function(){var e=document.activeElement;this.title_editor.doc.contains(e)||this.details_editor.doc.contains(e)||(null===this.lastFocusedEditor?this.title_editor.focus():this.lastFocusedEditor.focus());
},getState:function(){return{title:this.title_editor.serialize(),details:this.details_editor.serialize()}},restoreState:function(e){this.title_editor.doc.fromJSON(e.title),this.details_editor.doc.fromJSON(e.details)}}),t.LinkSelectorModal=r.extend({onLoad:function(){this._super.apply(this,arguments),o.send("showSearchInput",{searchPlaceholderText:this.interface_strings.search_placeholder,searchFocus:!0,searchCancelButton:!1}),this.cleanUpCallback=this.close.bind(this),n.registerOneTimeMessageHandler("addLinkSelectorPressed",this.cleanUpCallback)},onUnload:function(){n.removeOneTimeMessageHandler("addLinkSelectorPressed",this.cleanUpCallback)}}),t.LinkSelector=d.LinkSelector.extend({__init__:function(e){var t=this;this._super(e),this._handleAddLink=function(e){t.submit(e)}},show:function(e){this.bindAddLinkHandler(),this.toolbar.createModal("load_link_selector").onClose(this.cancel.bind(this)).show(),this.active=!0,this.key=e||""},bindAddLinkHandler:function(){n.removeOneTimeMessageHandler("addLinkSelectorPressed",this._handleAddLink),
n.registerOneTimeMessageHandler("addLinkSelectorPressed",this._handleAddLink)},cleanUpModal:function(){s.isMobileWeb()&&this.isActive()&&o.send("hideSearchInput")},submit:function(e){this._onSubmitCallback&&this._onSubmitCallback({text:e.text,url:e.url})},cancel:function(){this._onCancelCallback&&setTimeout(this._onCancelCallback.bind(this,this.key),0)},hide:function(){this.cleanUpModal(),this._super()}}),t.activeEditor=null}),define("unified_view/qtext2/editor",["shared/polyfills","shared/core/component","shared/Class","qtext2/util","shared/onload","interface/settings","qtext2/ui","third_party/autosize","unified_view/qtext2/editor/mobile"],function(e,t,i){var n,o=e("shared/core/component").Component,s=e("shared/Class").Class,a=e("qtext2/util").Util,r=e("shared/onload"),d=e("interface/settings"),l=d.pageIsMobile,c=e("qtext2/ui"),h=e("third_party/autosize"),u=c.PhotoSearch;l&&(n=e("unified_view/qtext2/editor/mobile").LinkSelector);var p=c.LinkSelector.extend({__init__:function(e,t,i){var n=this;
this._super(e),this.$selector=t,this.$wrapper=i,this.$selector.afterResultWasSelectedCallback=this.submit.bind(this),this.$selector.setEscKeyDown(function(e){var t=n.key+n.$selector.query;(27==e.keyCode||"@"===t&&(8==e.keyCode||13==e.keyCode))&&(n.cancel(t),e.preventDefault())})},show:function(e,t,i){this.key=e||"";var n=this.$wrapper.parent().get(0),o=a.getContainerOffset(n);t-=o.left,i-=o.top+5,this.$selector.setQuery(""),this.$wrapper.css("position","absolute").css("left",t).css("top",i).removeClass("hidden"),this.active=!0,this.$selector.focus()},hide:function(){this._super(),this.$wrapper.addClass("hidden")},submit:function(e,t,i){this._onSubmitCallback&&this._onSubmitCallback(e.data)},cancel:function(e){return this._onCancelCallback?(this._onCancelCallback(e),!1):void 0}}),f=s.extend({__init__:function(e){this._listeners={},this.$node=e,this.$node.on("blur",this.trigger.bind(this,"blur")),this.$node.on("keydown",this.trigger.bind(this,"keydown")),this.$node.on("keydown",this.trigger.bind(this,"meaningfulChange")),
h(this.$node.get(0))},on:function(e,t){this._listeners[e]=this._listeners[e]||[],this._listeners[e].push(t)},trigger:function(e){this._listeners[e]&&this._listeners[e].forEach(function(e){e()})},focus:function(){this.$node.focus(),this.trigger("focus")},getLength:function(){return this.$node.val().length},isEmpty:function(){return 0===this.getLength()},isOnlyWhiteSpace:function(){return 0==this.$node.val().trim().length},toJSON:function(){return{is_plaintext:!0,text:this.$node.val()}},hasChanged:function(e){return!a.jsonEqual(e,this.toJSON())},disable:function(){this.$node.prop("disabled",!0)},enable:function(){this.$node.prop("disabled",!1)},clear:function(){this.$node.val("")},destroy:function(){this.clear()}});t.Editor=o.extend({onLoad:function(){this._editorReady=!1;var e=this,t=function(){window.require.ensure("qtext2/base",function(){e._onLoad(),e._editorReady=!0})};this.shouldDelayOnLoad()?r.execAfterLoadDelayed(t):t()},shouldDelayOnLoad:function(){var e=d.controller,t=d.action;if(l){
if("modal"==e&&"index"==t)return!1}else if("question"==e&&"draft"==t||"board"==e&&"add"==t)return!1;return!0},_onLoad:function(){this.is_plaintext?this._setupPlainTextEditor():this._setupRichTextEditor(),this._setupEventListeners(),this.counter=this.child("counter"),this.counter&&this.counter.updateCounter(this.doc.getLength()),this.$id("@fake_editor").on("click",this.hideFakeEditor.bind(this))},onUnload:function(){this.doc.destroy()},disabledCommands:function(){return this.disabled_commands},_setupPlainTextEditor:function(){this.doc=new f(this.$id("@doc"))},_setupRichTextEditor:function(){var t=e,i=t("qtext2/base").Doc;if(this.doc=new i(this.content_json),this.toolbar=this.child("toolbar"),this.doc.disableCommands(this.disabledCommands()),l?this.doc.setLinkSelector(new n(this)):(this.doc.setLinkSelector(new p(this,this.child("link_selector"),this.$id("@link_selector_wrapper"))),this.photo_search_enabled&&this.child("photo_search")&&this.doc.setPhotoSearch(new u(this,this.child("photo_search"),this.$id("@photo_search_wrapper"),this.$id("@file")))),
-1==this.disabledCommands().indexOf("image")){var o=new c.ImageUploader(this,this.doc,this.$id("@drop_zone").get(0),this.$id("@file").get(0),this.interface_strings);this.doc.setImageUploader(o)}this.$id("@doc").append(this.doc.node),this.doc.node.setAttribute("placeholder",this.interface_strings.placeholder),this._setupToolbar(),this.focusOnLoad&&(this.focus(),this.focusOnLoad=!1)},_setupToolbar:function(){var e=this;this.toolbar&&(this.toolbar.on("click",function(t){"image"==t?e.photo_search_enabled&&e.child("photo_search")?e.doc.photoSearch.toggle():e.$id("@file").click():"link_hide"==t?e.toolbar.showBar(1):"overflow_show"==t?e.toolbar.showBar(2):"overflow_hide"==t?e.toolbar.showBar(1):e.doc.handleCommand(t)}),this.toolbar.on("imageUpload",function(t){e.doc.insertImages(t)}),this.doc.on("focus",function(){e.toolbar.makeActive(e.doc)}),this.toolbar.makeActive(this.doc))},_setupEventListeners:function(){var e=this;e._onEditorReady&&e._onEditorReady(),this.doc.on("focus",function(){e.counter&&e.counter.show(),
e._onFocus&&e._onFocus(),e.$id("@editor").addClass("focused")}),this.doc.on("blur",function(){e.counter&&e.counter.hide(),e._onBlur&&e._onBlur(),e.$id("@editor").removeClass("focused")}),this.doc.on("meaningfulChange",function(){e._updateCounter(),e.reportMeaningfulChange()}),this._trackTypingState()},_updateCounter:function(){if(this.counter){var e=0;this.doc.children.forEach(function(t){t.children.forEach(function(t){t.hasModifier("math")||(e+=t.getLength())})}),this.counter.updateCounter(e),this._lengthChangeCallback&&this._lengthChangeCallback(e>this.length_limit)}},_trackTypingState:function(){var e,t=this,i=1e4,n=55e3,o=3e3,s="empty",a=0,r=0,d=function(){var l,c,h=(new Date).getTime();t.isOnlyWhiteSpace()||t.typingStopped?l="empty":(l=h-i>a?"paused":"typing",h-n>r&&(c=!0)),l!=s&&(c=!0),c&&t._onTypingStateChange&&(t._onTypingStateChange(l),s=l,r=h),e&&(clearTimeout(e),e=null),("typing"==l||"paused"==l)&&(e=setTimeout(d,o))};this.doc.on("keydown",function(){a=(new Date).getTime(),t.typingStopped=!1,
d()})},setFocusCallback:function(e){this._onFocus=e},setEditorReadyCallback:function(e){return this._editorReady?void e():void(this._onEditorReady=e)},setBlurCallback:function(e){this._onBlur=e},setMeaningfulChangeCallback:function(e){this._onMeaningfulChange=e},reportMeaningfulChange:function(){this._onMeaningfulChange&&this._onMeaningfulChange()},setTypingStateCallback:function(e){this._onTypingStateChange=e},setLengthChangeCallback:function(e){this._lengthChangeCallback=e},isInteractive:function(){return!0},isEmpty:function(){return this.doc.isEmpty()&&!this.doc.linkSelector.isActive()},isOnlyWhiteSpace:function(){return this.doc.isOnlyWhiteSpace()},stopTyping:function(){this.typingStopped=!0},fixEditorButtons:function(){this.toolbar&&this.toolbar.fix()},focus:function(){this.doc?this.doc.focus():this.focusOnLoad=!0},hideFakeEditor:function(){this.$id("@fake_editor").addClass("hidden"),this.$id("@editor").removeClass("hidden"),this.focus(),this.fixEditorButtons()},serialize:function(){
return this.doc.toJSON()},hasChanged:function(e){return this.doc.hasChanged(e)},disable:function(){this.doc.disable(),this.$id("@editor").addClass("disabled")},enable:function(){this.doc.enable(),this.$id("@editor").removeClass("disabled")},clear:function(){this.doc.clear()}})}),define("app/view/question/lookup_bar_details",["shared/polyfills","unified_view/qtext2/editor","shared/events/index","app/view/site_header/logged_in"],function(e,t,i){var n=e("unified_view/qtext2/editor").Editor,o=e("shared/events/index"),s=e("app/view/site_header/logged_in").LoggedInSiteHeaderContext;t.AskBarDetails=n.extend({onLoad:function(){this._super.apply(this,arguments);var e=this;e.context=e.getContext(s),e.setLengthChangeCallback(function(t){e.context.set("question_details_over_limit",t),e.context.set("question_details_is_empty",e.isOnlyWhiteSpace())}),this.handleEvent(o.Types.LOOKUP_BAR_QUESTION_DETAILS_STATE,function(t){"focused"==t.payload.state?e.focus():"hidden"==t.payload.state&&(e.clear(),e.context.set("question_details_is_empty",!0));
})}})}),define("app/view/question/merge/_merge",["shared/polyfills","shared/core/component","shared/jquery"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/jquery");t.QuestionMergeCandidates=n.extend({onLoad:function(){var e=this;e.$insertionEl=e.$id("@insert_candidate"),e.$showAllLinkEl=e.$id("@show_all_link"),e.$showAllLinkEl.click(function(t){t.preventDefault(),e.$id("@candidates .candidate").removeClass("hidden"),e.$showAllLinkEl.addClass("hidden")})},selectQID:function(e){var t,i=this;t=this.improvedFlow?i.$id("@candidates input[type=radio][value="+e+"]"):i.$id("@candidates input[type=checkbox][value="+e+"]"),t.length?t.map(function(){var e=o(this),t=o("label[for='"+e.attr("id")+"']");e.prop("checked",!0),e.change(),t.insertAfter(i.$insertionEl),t.removeClass("hidden")}):i.serverCall("get_checkbox_content").kwargs({qid:e}).contentFor(i.$insertionEl).success(function(){i.$insertionEl.children().map(function(){o(this).insertAfter(i.$insertionEl)})}).send()},getSelectedQIDs:function(){
var e,t=[];return e=this.improvedFlow?"@candidates input[type=radio]:checked:not(:disabled)":"@candidates input[type=checkbox]:checked:not(:disabled)",this.$id(e).map(function(){t.push(parseInt(this.value))}),t}}),t.QuestionMergeCanonicalPicker=n.extend({onLoad:function(){var e=this;e.$radios=e.$id("@picker input[type=radio]"),e.$radios.change(function(t){e.$radios.map(function(){var e=o(this),t=o("label[for='"+e.attr("id")+"']");t.toggleClass("selected",e.is(":checked")),t.toggleClass("not_selected",!e.is(":checked"))})})},getSelectedQID:function(){var e=this.$id("@picker input[type=radio]:checked");return e?parseInt(e.val()):void 0}}),t.OriginallyAnsweredBanner=n.extend({onLoad:function(){var e=this;e.$id("@remove").click(function(t){t.preventDefault(),e.serverCall("remove_banner").liveMutate().send()})}})}),define("app/view/question/merge/modal",["shared/polyfills","shared/window_manager","view/modal","shared/util"],function(e,t,i){var n=e("shared/window_manager"),o=e("view/modal"),s=e("shared/util");
t._QuestionMergeModal=o.MultiStep.extend({onSubmitSuccess:function(e,t,i,o){var s=this,a=25e3,r=1e3;return this.improvedFlow?void n.navigateTo(e):void(a>o?setTimeout(function(){s.serverCall("answer_has_moved").kwargs({qids:t,canonical_qid:i,time_so_far:o+r}).success(function(o){o?s.onSubmitSuccess(e,t,i,o):n.navigateTo(e)}).send()},r):(s.serverCall("log_timeout_before_answers_moved").kwargs({time_taken:o+r}).send(),n.navigateTo(e)))},getCallBacks:function(){var e=this;return{QuestionMergeModalSelectorStep:{getStepData:function(){var t=e.data_cache[e.key],i=e.child("candidates").getSelectedQIDs();return i.push(t.qid),s.extend(t,{selectedQIDs:i})},onSubmit:function(){e.child("candidates").getSelectedQIDs().length&&e._loadNext()}},QuestionMergeModalMultipleLockedStep:{isLastStep:!0,onSubmit:function(){e.disableSubmit();var t=e.data_cache.QuestionMergeModalSelectorStep,i=t.selectedQIDs;e.serverCall("submit").kwargs({qids:i}).success(function(){e._closeModal()}).send()}},QuestionMergeModalCanonicalStep:{
isLastStep:!0,onSubmit:function(){var t=e.child("picker").getSelectedQID(),i=e.data_cache.QuestionMergeModalSelectorStep;if(t){e.disableSubmit();var n=i.selectedQIDs;e.serverCall("submit").kwargs({qids:n,canonical_qid:t}).success(function(i){e.onSubmitSuccess(i,n,t,0)}).liveMutate().send()}}}}}})}),define("app/view/question/merge/selector",["shared/polyfills","view/selector"],function(e,t,i){var n=e("view/selector").Selector;t.QuestionMergeESSelector=n.extend({resultWasSelected:function(e){var t=this;t.parent().child("candidates").selectQID(e.data.qid),t.setQuery("")},getExtraKwargs:function(){return{ignore_qids:this.parent().child("candidates").getSelectedQIDs()}}})}),define("app/view/question/not_helpful",["shared/polyfills","shared/core/component"],function(e,t,i){var n=e("shared/core/component").Component;t.CollapseAnswerLink=n.extend({onLoad:function(){var e=this;this.$id("@undo_not_collapsible").click(function(t){return e.serverCall("undo_not_collapsible").kwargs({aid:e.aid}).liveMutate().send(),
!1}),this.$id("@make_uncollapsible").click(function(t){return e.serverCall("make_uncollapsible").kwargs({aid:e.aid}).liveMutate().send(),!1})}})}),define("app/view/topic_selector",["shared/polyfills","view/selector","w2.dialog"],function(e,t,i){var n=e("view/selector").Selector,o=e("w2.dialog"),s=t.TopicSelector=n.extend({resultWasSelected:function(e,t,i){if("topic"===e.ty)this.topicWasSelected(e.data.tid,e.data.topic_name,t,i,e);else{if("create_topic"!==e.ty)throw Error();this.createTopicWasSelected(e.data.new_topic_name,t,i)}},topicWasSelected:function(e,t,i,n){},createTopicWasSelected:function(e,t,i){}});t.AddTopicSelector=s.extend({showErrorDialog:function(){o.createDialog(this).title(this.dialog_title).ok(null,this.close_button_text).text(this.dialog_message)},topicWasSelected:function(e,t,i,n){this.setQuery(""),this.serverCall("add_topic").kwargs({tid:e}).liveMutate().error(this.showErrorDialog.bind(this)).send()},createTopicWasSelected:function(e,t,i){this.setQuery(""),this.serverCall("create_and_add_topic").kwargs({
new_topic_name:e}).liveMutate().error(this.showErrorDialog.bind(this)).send()}}),t.TopicSelectorForFormField=t.AddTopicSelector.extend({onTopicSelected:function(e){this._onTopicSelectedCallback=e},topicWasSelected:function(e,t,i){this._onTopicSelectedCallback&&this._onTopicSelectedCallback(t,e),this.setQuery("")},createTopicWasSelected:function(e,t){var i=this;i.serverCall("create_and_add_topic").kwargs({new_topic_name:e}).success(function(t){i._onTopicSelectedCallback&&i._onTopicSelectedCallback(e,t),i.setQuery("")}).liveMutate().send()}})}),define("app/view/question/question_add",["shared/polyfills","app/view/topic_selector","shared/events/index"],function(e,t,i){var n=e("app/view/topic_selector").TopicSelector,o=e("shared/events/index");t.AddQuestionTopicTempSelector=n.extend({addIgnoreOid:function(e){e&&this.ignore_tids.push(e)},maybeAddTopic:function(e,t){t&&-1==this.ignore_tids.indexOf(e)&&(this.addIgnoreOid(e),this.emitEvent({type:o.Types.QUESTION_TOPIC_SELECTION_ADD,payload:{editor:this.getDvar("_questionTopicsEditor"),
name:t}}))},topicWasSelected:function(e,t){this.maybeAddTopic(e,t),this.setQuery(""),this.blur()},createTopicWasSelected:function(e){this.maybeAddTopic(null,e),this.setQuery(""),this.blur()}})}),define("app/view/question/suggested_answer",["shared/polyfills","shared/core/component"],function(e,t,i){var n=e("shared/core/component").Component;t.AnswerSuggestedEditDiscardButtonInline=n.extend({onLoad:function(){var e=this;this.$id("@submit").click(function(){return e.serverCall("discard_suggested_edit").kwargs({aid:e.aid}).liveMutate().send(),!1})}})}),define("app/view/question/wanted_answer",["shared/polyfills","shared/core/component","shared/jquery","view/modal","shared/events/index","shared/action_log","view/selector","shared/cookies"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/jquery"),s=e("view/modal").Base,a=e("shared/events/index"),r=e("shared/action_log").ActionableComponent,d=e("view/selector").Selector,l=e("shared/cookies");t.A2AFiltersListContentItem=n.extend({
onLoad:function(){var e=this;e.$id("@filter_item").click(function(t){var i=t.currentTarget;o(".A2AFiltersListContentItem").removeClass("nav_item_selected"),o(i).addClass("nav_item_selected");var n=e.parent().parent().parent().$id("@suggestions_list"),s=e.parent().parent();s.is_editing||(n.addClass("working"),e.serverCall("filtered_list").kwargs({tid:e.tid}).contentFor(n).success(function(){n.removeClass("working")}).send())})}}),t.WantedAnswerSelector=d.extend({onLoad:function(){this._super.apply(this,arguments),this.ignore_uid_select={}},resultWasSelected:function(e,t,i){var n=e.data.uid;if(!this.ignore_uid_select[n]){this.ignore_uid_select[n]=!0,this.updateResultItem(i),l.setQfeedLog(this,"AskToAnswer"),l.setTlog({type:"AskToAnswer",qid:this.qid});var o=function(){delete this.ignore_uid_select[n],this.revertSelectedRow(i)}.bind(this);this.serverCall("ask_to_answer").liveMutate().kwargs({to_uid:n}).success(function(e){"failed"===e.result&&o()}).error(o).send()}},resultsDidChange:function(){
this.ignore_uid_select={}},updateResultItem:function(e){e.children(".name_sig").addClass("hidden"),e.children(".name_sig.is_active").removeClass("hidden"),e.children(".request_button").addClass("is_active")},revertSelectedRow:function(e){e.children(".name_sig.hidden").removeClass("hidden"),e.children(".name_sig.is_active").addClass("hidden"),e.children(".request_button").removeClass("is_active")}}),t.WantedAnswerSuggestions=n.extend({onLoad:function(){this.child("selector").focus()},a2aHeaderCountClicked:function(){this.$id("@a2a_suggestions").hide(),this.$id("@outstanding_requests").show()},a2aHeaderTitleClicked:function(){this.$id("@a2a_suggestions").show(),this.$id("@outstanding_requests").hide()}}),t.AskToAnswerModal=s.extend({a2aHeaderCountClicked:function(){var e=this.child("wanted_answer_suggestions");e.$id("@a2a_suggestions").hide(),e.$id("@outstanding_requests").show()},a2aHeaderTitleClicked:function(){var e=this.child("wanted_answer_suggestions");e.$id("@a2a_suggestions").show(),
e.$id("@outstanding_requests").hide()}}),t.AskToAnswerHeader=n.extend({onLoad:function(){var e=this;this.$id("@title_link").click(function(t){return e.titleClicked(),!1}),this.$id("@count_link").click(function(t){return e.countClicked(),!1})},countClicked:function(){this.$id("@count").toggle(),this.$id("@count_link").toggle(),this.$id("@title").toggle(),this.$id("@title_link").toggle(),this.parent().a2aHeaderCountClicked()},titleClicked:function(){this.$id("@count").toggle(),this.$id("@count_link").toggle(),this.$id("@title").toggle(),this.$id("@title_link").toggle(),this.parent().a2aHeaderTitleClicked()}}),t.AskToAnswerModalLink=n.extend({onLoad:function(){var e=this;this.$id("@create_modal_link").on("click",function(t){t.preventDefault(),e.createModal("load_inner").kwargs({qid:e.qid,a2a_type:e.a2a_type}).show()})}}),t.AskedBy=n.extend({onLoad:function(){var e=this;this.$id("@modal_link").on("click",function(){return e.createModal("load_inner").kwargs({qid:e.qid,to_uid:e.to_uid}).show(),
!1})}}),t.AnswerAttributionSection=n.extend({onLoad:function(){var e=this;this.$id("@modal_link").on("click",function(){return e.createModal("load_inner").kwargs({aid:e.aid,qid:e.qid}).show(),!1})}}),t.WantedAnswerWithCreditQuestionListItem=r.extend({onLoad:function(){var e=this;this._super.apply(this,arguments),this.handleEvent(a.Types.QUESTION_CANT_ANSWER_STATE,function(t){if(t.payload.qid==e.qid){var i="passed"==t.payload.state;e.$id("@item").toggleClass("cant_answer",i)}})}})}),define("app/view/quora_meets_bagel",["shared/polyfills","shared/core/component"],function(e,t,i){var n=e("shared/core/component").Component;t.QMBPage=n.extend({onLoad:function(){var e=this;e.$id("@container").on("click",".qmb_button",function(t){var i=t.target.id;return e.serverCall("take_qmb_action").kwargs({which_action:i}).success(function(){window.location.reload()}).send(),!1})}})}),define("app/view/reading_list",["shared/polyfills","shared/core/component","shared/events/index"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/events/index");
t.MarkAsReadButton=n.extend({onLoad:function(){var e=this;e.$id("@read_later").click(function(t){return t.preventDefault(),e.serverCall("unmark_as_read_later").liveMutate().send(),!1})}}),t.ReadLaterSort=n.extend({onLoad:function(){var e=this,t=e.$id("@new"),i=e.$id("@old");t.click(function(){e.emitEvent({type:o.Types.READING_LIST_VIEW_STATE,payload:{reverse:!1}}),t.removeClass("inactive"),t.addClass("active"),i.removeClass("active"),i.addClass("inactive")}),i.click(function(){e.emitEvent({type:o.Types.READING_LIST_VIEW_STATE,payload:{reverse:!0}}),t.addClass("inactive"),t.removeClass("active"),i.addClass("active"),i.removeClass("inactive")})}}),t.ReadingListContents=n.extend({onLoad:function(){var e=this;this.handleEvent(o.Types.READING_LIST_VIEW_STATE,function(t){"reverse"in t.payload&&e.showSpinner()})},showSpinner:function(){this.$id("@spinner").removeClass("hidden")}}),t.ReadingListMain=n.extend({onLoad:function(){this.emitEvent({type:o.Types.READING_LIST_VIEW_STATE,payload:{reverse:this.reverse_order
}});var e=this;this.handleEvent(o.Types.READING_LIST_VIEW_STATE,function(t){"reverse"in t.payload&&e.updateResults(t.payload.reverse)})},updateURL:function(e){var t="";e&&(t+="&order=desc"),t.length>0&&(t="?"+t.substring(1)),window.history.pushState(null,null,"/bookmarked_answers"+t)},updateResults:function(e){this.updateURL(e);var t=this.$id("@read_later_list");this.$id("@spinner").removeClass("hidden"),t.css("opacity",.5),this.serverCall("load_reading_list").contentFor(t).kwargs({reverse_order:e}).success(function(){t.css("opacity",1)}).send()}})}),define("app/view/settings",["shared/polyfills","shared/core/component","view/inline_editor","shared/events/index","app/view/share/connect","shared/facebook","shared/window_manager","w2.modal","w2.dialog","shared/core/rpc","view/modal","fx"],function(e,t,i){var n=e("shared/core/component").Component,o=e("view/inline_editor").InlineEditor,s=e("shared/events/index"),a=e("app/view/share/connect").SocialConnector,r=e("shared/facebook"),d=e("shared/window_manager"),l=e("w2.modal"),c=e("w2.dialog"),h=c.Dialog,u=e("shared/core/rpc"),p=e("view/modal").Base,f=e("fx");
t.CallbackModal=p.extend({onSubmit:function(){this._super.apply(this,arguments),l.Modal.modalFor(this).executeOnSubmitCallBack()}}),t.SettingsAccountEmailOption=n.extend({onLoad:function(){var e=this;this.$id("@add_another_email_link").click(function(t){return e.$id("@add_another_email_row").toggleClass("hidden"),e.$id("@add_email_input_row").toggleClass("hidden"),e.$id("@new_email").focus(),!1}),this.$id("@add_another_email").click(function(){var t=e.$id("@new_email").val();return t?(e.serverCall("add_email").kwargs({email:t}).liveMutate().send(),!1):!1})}});var _=t.SettingsOption=n.extend({onLoad:function(e){var t=this;if(this.$id("@view_option_link").click(function(){return t.serverCall("check_reauth").success(function(){t.expandOption()}).send(),!1}),this.auto_open_url_hash&&e&&d.getHash().substr(0,30)=="#"+this.auto_open_url_hash){this.expandOption();var i=this.$id("@option_content").css("background-color","#E0E0E0");f.highlight(i,1500)}},expandOption:function(){this.$id("@view_option").toggleClass("hidden"),
this.$id("@option_content").toggleClass("hidden")}});t.AdultSettingsOptionToggle=n.extend({onLoad:function(){var e=this;this.$id("@no_adult_content").click(function(){return e.serverCall("no_adult_content").liveMutate().send(),!1}),this.$id("@allow_adult_content").click(function(){return e.serverCall("allow_adult_content").liveMutate().send(),!1})}}),t.UserDisclaimerDialogEditor=o.extend({onLoad:function(){var e=this;this._super.apply(this,arguments),this.$id("@inline_editor_cancel").click(function(){return h.dialogFor(e).close_(),!1}),this.$id("@inline_editor_submit").click(function(){var t=h.openerFor(e);return"function"===t.attachDisclaimer&&(h.openerFor(e).user_has_set_disclaimer=!0,h.openerFor(e).attachDisclaimer()),h.dialogFor(e).close_(),!1})}}),t.ChangePasswordOption=_.extend({onLoad:function(){this._super.apply(this,arguments),this.clear_passwords=function(){this.$id("@new_password").val(""),this.$id("@confirm_password").val("")};var e=this;this.$id("@change_password_submit").click(function(){
return e.$id("@new_password").val()!==e.$id("@confirm_password").val()?(e.$id("@password_and_confirmation_mismatch").removeClass("hidden"),e.$id("@password_changed").addClass("hidden"),!1):(e.$id("@change_password_error").addClass("hidden"),e.$id("@password_and_confirmation_mismatch").addClass("hidden"),u.rpc("/settings/change_password_POST").kwargs({new_password:e.$id("@new_password").val()}).success(function(t){var i=t[0],n=t[1];e.clear_passwords(),i?e.$id("@password_changed").removeClass("hidden"):(e.$id("@password_changed").addClass("hidden"),e.$id("@change_password_error").removeClass("hidden"),e.$id("@change_password_error").text(n))}).send(),!1)})}}),t.RemoveDisclaimerOption=_.extend({onLoad:function(){var e=this;this._super.apply(this,arguments),this.$id("@remove_disclaimer_submit").click(function(){return e.serverCall("remove_disclaimer").send(),!1})}}),t.BlogConnectDialogContents=n.extend({onLoad:function(){var e=this;this.$id("@form input").on("focus",function(){e.$id("@blog_not_supported").hide();
}),this.$id("@form input").on("keydown",function(t){13==t.keyCode&&e.submitForm()}),this.$id("@url").on("blur",function(){e.$id("@wordpress_login_help").hide();var t=e.$id("@url").val();t.match("wordpress")&&e.$id("@wordpress_login_help").show()}),this.$id("@close").on("click",function(){return h.dialogFor(e).close_(),!1}),this.$id("@connect").click(this.submitForm.bind(this))},submitForm:function(){var e=this,t=this.$id("@url").val(),i=this.$id("@uname").val(),n=this.$id("@pwd").val();t&&i&&n&&this.serverCall("validate_blog").kwargs({url:t,name:i,pwd:n}).liveMutate().success(function(t){var i=t[0],n=t[1];i?(e.emitEvent({type:s.Types.WORDPRESS_CONNECT_SUCCESS,payload:{}}),h.dialogFor(e).close_()):e.$id("@blog_not_supported").show().text(n)}).send()}}),t.WordpressConnect=n.extend({onLoad:function(){this._super.apply(this,arguments),this.$id("@wordpress_connect_button").on("click",this.connectWordpress.bind(this)),this.$id("@wordpress_disconnect_button").on("click",this.disconnectWordpress.bind(this));
},connectWordpress:function(){this._dialog=c.createDialog(this).title(this.dialog_title).close(null).load("set_dialog_contents")},disconnectWordpress:function(){this.serverCall("wordpress_disconnect").liveMutate().send()}}),t.GoogleConnect=n.extend({onLoad:function(){var e=this;this.$id("@google_disconnect_button").click(function(){return e.serverCall("disconnect_google").liveMutate().send(),!1})}}),t.LinkedinConnect=n.extend({onLoad:function(){var e=this;this.$id("@linkedin_disconnect_button").click(function(){return e.serverCall("disconnect_linkedin").liveMutate().send(),!1})}}),t.LinkedinConnectButton=a.extend({onLoad:function(){this.$id("@linkedin_connect_button").click(this.connectLinkedin.bind(this))}}),t.LinkedinPublicProfileLink=n.extend({onLoad:function(){var e=this;this.serverCall("get_profile_info").kwargs({li_uid:this.liUid}).success(function(t){null===t?e.$id("@linkedin_link").text("").attr("href","#"):e.$id("@linkedin_link").text(t.first_name+" "+t.last_name).attr("href",t.url);
}).send()}}),t.ConfirmEmailModal=p.extend({onSubmit:function(){var e=this;e.serverCall("resend_email_confirmation").success(function(){e._closeModal()}).liveMutate().send()}}),t.RemoveEmailModal=p.extend({onSubmit:function(){var e=this;e.serverCall("remove_email").success(function(){e._closeModal()}).liveMutate().send()}}),t.EmailAddressRow=n.extend({onLoad:function(){var e=this;this.$id("@confirm_email").click(function(){return e.createModal("load_inner_confirm_email").kwargs({email:e.email}).show(),!1}),this.$id("@make_primary").click(function(){return e._serverCallHelper("set_primary_email")}),this.$id("@delete_email_icon").click(function(){return e.createModal("load_inner_remove_email").kwargs({email:e.email}).show(),!1})},_serverCallHelper:function(e){return this.serverCall(e).kwargs({email:this.email}).liveMutate().send(),!1}}),t.ResetPassword=n.extend({onLoad:function(){var e=this;this.$id("@reset_email_submit").click(function(t){var i=e.$id("@email_input").val();return i?(e.emailRequest("/settings/send_reset_password_email_POST",i),
!1):!1}),this.$id("@reset_password_form_tag").submit(function(t){var i=e.$id("@reset_password_code").val(),n=e.$id("@new_password").val(),o=e.$id("@confirm_password").val(),s=e.$id("@password_confirmation_mismatch");return e.$id("@reset_password_error").addClass("hidden"),n!==o?(s.removeClass("hidden"),!1):(s.addClass("hidden"),n?(e.passwordRequest("/settings/reset_password_POST",i,n),!1):!1)}),d.replaceURL("/settings/reset_password")},emailRequest:function(e,t){var i=this;return u.rpc(e).kwargs({email:t}).success(function(e){i.$id("@email_input").val(""),i.$id("@reset_email_conf").removeClass("hidden"),i.$id("@reset_email_form").addClass("hidden")}).send(),!1},passwordRequest:function(e,t,i){var n=this;return u.rpc(e).kwargs({code:t,new_password:i}).success(function(e){var t=e[0],i=e[1];t?d.navigateTo("/?__pmsg__=password_changed"):(n.$id("@reset_password_error").removeClass("hidden"),n.$id("@reset_password_error").text(i))}).send(),!1}}),t.MutedRowToggle=n.extend({onLoad:function(){var e=this;
this.$id("@unmute").click(function(){e.serverCall("unmute").kwargs({oid:e.oid}).liveMutate().send()}),this.$id("@mute").click(function(){e.serverCall("mute").kwargs({oid:e.oid}).liveMutate().send()})}}),t.FacebookToggleTimelineLink=n.extend({onLoad:function(){r.load(),this.$id("@enable").on("click",this.onClickEnable.bind(this)),this.$id("@disable").on("click",this.onClickDisable.bind(this))},onEnable:function(e){this.serverCall("enable_timeline").kwargs({fb_access_token:e.accessToken,fb_uid:e.userID,expires:e.expiresIn}).liveMutate().send()},onDisable:function(){this.serverCall("disable_timeline").liveMutate().send()},onLoginFailed:function(){this.$id("@option").prop("checked",!1)},onClickEnable:function(){var e=this;return window.FB.login(function(t){if(t&&"connected"==t.status){var i=t.authResponse;r.updatePermissions(function(t,n){t&&e.hasSpecificPermission(n,"publish_actions")?e.onEnable(i):e.onLoginFailed()})}else e.onLoginFailed()},{scope:"publish_actions"}),!1},hasSpecificPermission:function(e,t){
for(var i=0;i<e.length;i++)if(e[i].permission==t)return"granted"==e[i].status;return!1},onClickDisable:function(){return this.onDisable(),!1}}),t.FacebookAccountConnectedTo=n.extend({onLoad:function(){this.$id("@facebook_disconnect_button").on("click",this.disconnect.bind(this))},disconnect:function(){return this.serverCall("disconnect_facebook").liveMutate().success(function(){r.onInit(function(){window.FB.getLoginStatus(function(){},!0)})}).send(),!1}}),t.OptionLinkBase=n.extend({onLoad:function(){this.$id("@enable").on("click",this.onClickEnable.bind(this)),this.$id("@disable").on("click",this.onClickDisable.bind(this)),this.$id("@hide").on("click",this.onClickHide.bind(this))},onClickEnable:function(){return this.serverCall("toggle_option").kwargs({enabled:!0}).liveMutate().send(),!1},onClickDisable:function(){return this.serverCall("toggle_option").kwargs({enabled:!1}).liveMutate().send(),!1},onClickHide:function(){return this.serverCall("hide").liveMutate().send(),!1}})}),define("app/view/share/form",["shared/polyfills","shared/core/component","app/view/share/connect","tooltip","facebook"],function(e,t,i){
var n=e("shared/core/component").Component,o=e("app/view/share/connect").SocialConnector,s=e("tooltip"),a=e("facebook"),r={_state:{},get:function(e){return this._state[e]},set:function(e,t){this._state[e]=t}},d=o.extend({contextProperty:null,onLoad:function(){var e=this;if(this.list_item=this.$id("@share_checkbox_list_item"),this.checkbox=this.$id("@checkbox"),this.action_link=this.$id("@action_link"),this.message_preview=this.$id("@message_preview"),this.message_preview_text=this.$id("@message_preview_text"),this.label_clickable=this.$id("@label_clickable"),!this.is_disabled){var t=r.get(this.contextProperty);this.list_item.toggleClass("is_not_checked",!t),this.checkbox.prop("checked",t)}this.checkbox.on("change",function(){var t=e.isChecked();return t&&e.needs_action?(e.remedyDisabled(),void e.checkbox.prop("checked",!1)):(e.logCheckboxChangedJS(t),e.list_item.toggleClass("is_not_checked",!t),void r.set(e.contextProperty,t))}),this.label_clickable.on("click",function(){e.checkbox.click();
}),this.action_link.on("click",function(){return e.is_disabled?e.remedyDisabled():e.editText(),!1})},logCheckboxChangedJS:function(e){this.serverCall("log_checkbox_changed_js").kwargs({is_checked:e,share_info:this.share_info}).send()},isChecked:function(){return this.checkbox.prop("checked")},remedyDisabled:function(){},beginEditingText:function(){}}),l=d.extend({contextProperty:"shareToTwitter",remedyDisabled:function(){this.connectTwitter()}});t.ShareCheckboxTwitterCompact=l.extend({onLoad:function(){this._super.apply(this,arguments),s.attach(this.list_item,this.default_text)},remedyDisabled:function(){var e=this;this.connectTwitter(function(){e.checkbox.prop("checked",!0)})}}),t.ShareCheckboxFacebook=d.extend({contextProperty:"shareToFacebook",remedyDisabled:function(){var e=this;a.maybePromptToPublish(e.fbUid,function(t,i,n){e.serverCall("connect_facebook").kwargs({fb_uid:t,access_token:i,expires_secs:n}).liveMutate().send()},function(){e.child("fb_different_account").show()})}}),t.ShareForm=n.extend({
getValues:function(){var e=this.child("checkbox_fb"),t=this.child("checkbox_tw");return{fb:e&&e.isChecked(),tw:t&&t.isChecked()}}}),t.ShareFormMessageEditor=n.extend({onLoad:function(){this.$editor=this.$id("@editor"),this.focus()},focus:function(){this.$editor.focus()},isOnlyWhiteSpace:function(){return""===this.$editor.val().trim()},getText:function(){return this.$editor.val()},serialize:function(){return{html:this.$editor.val(),data:{}}}})}),define("app/view/share/modal",["shared/polyfills","shared/jquery","w2.dialog","w2.modal","shared/events/index","app/view/share/connect","view/modal","shared/window_manager","shared/action_log","shared/cookies"],function(e,t,i){var n=e("shared/jquery"),o=e("w2.dialog"),s=e("w2.modal"),a=e("shared/events/index"),r=e("app/view/share/connect").socialConnectorBase,d=e("view/modal").Base,l=e("shared/window_manager"),c=e("shared/action_log"),h=e("shared/cookies");t.ShareFormModal=d.extend(n.extend({},r,{onLoad:function(){var e=this;e.results=[],e.shortURLCopyField=e.$id("@short_url_copy_field"),
e.linkedinCheckbox=e.$id("@linkedin_checkbox"),e.linkedinConnectLink=e.$id("@linkedin_connect_link"),e.wordpressCheckbox=e.$id("@wordpress_checkbox"),e.wordpressConnectLink=e.$id("@wordpress_connect_link"),e.boardCheckbox=e.$id("@board_checkbox"),e.boardSelectorContainer=e.$id("@board_selector_container"),e.boardSelector=e.child("board_selector"),e.sendCheckbox=e.$id("@send_checkbox"),e.multiSelectorContainer=e.$id("@multi_selector_container"),e.child("selector").whenOnSavedResultsChanged(function(t){e.updateResults(t)}),"function"==typeof window.history.pushState&&(l.isParamInURL("share")||window.history.pushState(null,"",l.addParamToURL(""+window.location,"share","1"))),e.isChecked(e.boardCheckbox)&&e.boardSelectorContainer.show(),e.isChecked(e.sendCheckbox)&&e.multiSelectorContainer.show(),e.linkedinCheckbox.click(function(){return e.isChecked(e.linkedinCheckbox)?e.liUid?void e.enableSubmit():(e.connectLinkedin(e.checkLinkedin.bind(e)),!1):void e.disableSubmitIfNecessary()}),e.linkedinConnectLink.click(function(){
return e.connectLinkedin(e.checkLinkedin.bind(e)),!1}),e.wordpressCheckbox.click(function(){return e.isChecked(e.wordpressCheckbox)?e.wordpressConnected?void e.enableSubmit():void e.connectWordpress():void e.disableSubmitIfNecessary()}),e.wordpressConnectLink.click(function(){return e.connectWordpress(),!1}),e.handleEvent(a.Types.WORDPRESS_CONNECT_SUCCESS,e.checkWordpress.bind(e)),e.boardCheckbox.change(function(){e.isChecked(e.boardCheckbox)?(e.boardSelectorContainer.show(),e.enableSubmit()):(e.boardSelectorContainer.hide(),e.disableSubmitIfNecessary())}),e.sendCheckbox.click(function(){return e.isChecked(e.sendCheckbox)?void e.multiSelectorContainer.show():(e.multiSelectorContainer.hide(),void e.disableSubmitIfNecessary())}),e.shortURLCopyField.click(function(){n(this).select()}),this._super.apply(this,arguments),e.disableSubmitIfNecessary()},onClose:function(){return this._closeModal(),this.originalUrl&&"function"==typeof window.history.pushState&&window.history.pushState(null,"",this.originalUrl),
!1},onSubmit:function(){var e=this;e.boardSelector&&e.boardSelector.selected_board?(e.boardInfo.bid=e.boardSelector.selected_board.bid,e.boardInfo.name=e.boardSelector.selected_board.name,e.boardInfo.is_submission=e.boardSelector.selected_board.is_submission):e.isChecked(e.boardCheckbox)&&e.boardCheckbox.click();var t=e.checkboxValues();if(t.send=e.isChecked(e.sendCheckbox),!e.atLeastOneChecked(t))return e.disableSubmit(),!1;var i=s.Modal.openerFor(e);for(var n in t)if(t[n]===!0){var o="Share"+n[0].toUpperCase()+n.slice(1);h.setQfeedLog(i,o),h.setTlog({type:o})}h.setQueryLog(i,"BoardPost"),c.logSecondaryAction("Share",e.share_target),e.disableSubmit(),e.serverCall("dialog_submit_controller").kwargs({checkboxes:t,message:e.child("message_editor").serialize(),board_info:e.boardInfo,send_recipients:e.results}).success(function(t){e._closeModal()}).error(function(){e._closeModal()}).liveMutate().send()},regexUrl:/((?:https?:\/\/)?[a-zA-Z0-9](?:[-a-zA-Z0-9]*\.)+[a-zA-Z]{2,}(?:\/[^\/\s]+)*\/?)(?:\s|$)/gi,
tweetLength:function(e){if(!e)return 0;var t=e.length,i=[];return e.replace(this.regexUrl,function(e,t){i.push(t)}),t-=i.join("").length,n.each(i,function(e,i){t+=i.match(/https:/)?23:22}),t+=23},checkboxValues:function(){var e=this,t={};return n.each(e.shareChannels,function(){t[this]=e.isChecked(e.$id("@"+this+"_checkbox"))}),t},atLeastOneChecked:function(e){var t=!1;return n.each(e,function(e,i){t=t||i}),t},uncheckAll:function(){var e=this;n.each(e.shareChannels,function(){e.$id("@"+this+"_checkbox").prop("checked",!1)}),e.disableSubmit()},disableSubmitIfNecessary:function(){var e=this.checkboxValues();this.atLeastOneChecked(e)||0!==this.results.length||this.disableSubmit()},connectWordpress:function(){var e=this;e._dialog=o.createDialog(e).title(e.wordpress_connect_title).close().load("connect_wordpress"),this._closeModal()},checkWordpress:function(){this.wordpressCheckbox.prop("checked",!0),this.wordpressCheckbox.prop("disabled",!1),this.wordpressConnectLink.hide(),this.wordpressConnected=!0,
this.enableSubmit()},checkLinkedin:function(){var e=this;e.linkedinCheckbox.prop("checked",!0),e.linkedinCheckbox.prop("disabled",!1),e.linkedinConnectLink.hide(),e.liUid=!0,e.enableSubmit()},updateResults:function(e){this.results=e,this.results.length>0||this.atLeastOneChecked(this.checkboxValues())?this.enableSubmit():this.disableSubmit()},isChecked:function(e){return e.prop("checked")}}))}),define("input_validate",["shared/polyfills","shared/core/component","shared/jquery"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/jquery");t.InputValidator=n.extend({init:function(){this._super.apply(this,arguments),this.isValid=null},onLoad:function(){var e,t=this.input(),i=this;t.on("change blur",function(){var n=t.val();n!==e&&(e=n,i.validate())}),this._managerComponent().__validators=this._managerComponent().__validators||[],this._managerComponent().__validators.push(this)},input:function(){return this.parent().$id(this.id)},_managerComponent:function(){return this.parent();
},validate:function(e){var t=this;e=e||{};var i=this.input().val();if(i){this.hideAllErrors();var n={value:this.input().val()},o=this.additional_kwargs();for(var s in o)n[s]=o[s];this.serverCall("validate").kwargs(n).success(function(i){t.hideAllErrors(),i.valid?(t.isValid=!0,t.hideAllErrors(),t.input().removeClass("error"),"function"==typeof e.valid&&e.valid(i.message)):(t.isValid=!1,i.message&&(t.setWidth(t.$id("@invalid_message")),t.$id("@invalid_message").text(i.message),t.invalidMessage=i.message),t.hideAllErrors(),t.showErrorOnComponent("@validator .invalid"),"function"==typeof e.invalid&&e.invalid(i.message))}).send()}else this.hideAllErrors(),this.isValid=null},additional_kwargs:function(){return{}},populate_if_valid:function(e,t){var i=this;this.serverCall("validate").kwargs({value:e}).success(function(n){n.valid&&(i.isValid=!0,t.val(e))}).send()},setWidth:function(e){var t=parseInt(this.input().width())-4;t>0&&e.css("width",t+"px")},hideAllErrors:function(){this.$id("@validator .invalid").hide(),
this.$id("@validator .valid").hide(),this.input().removeClass("input_validation_error"),o("textarea").removeClass("input_validation_error")},showErrorOnComponent:function(e){this.$id(e).show(),this.input().addClass("input_validation_error"),o("textarea").addClass("input_validation_error")}}),t.InputValidator.validate=function(e,t){t=t||{},e.__validators&&e.__validators.length?e.__validators[0].validate(t):"function"==typeof t.valid&&t.valid()}}),define("shared/recaptcha",["shared/polyfills","settings","shared/util","shared/loadjs","shared/onload"],function(e,t,i){var n=e("settings"),o=e("shared/util"),s=e("shared/loadjs").loadJS,a=e("shared/onload"),r=!1,d=[],l=o.once(function(){var e=["https://www.google.com/recaptcha/api.js?","hl="+n.interfaceLanguage,"&onload=onCaptchaLoadedCallback","&render=explicit"].join("");window.onCaptchaLoadedCallback=function(){for(r=!0;d.length;)d.pop().call()},s(e)});t.onInit=function(e){r?e():(d.push(e),a.execAfterLoadDelayed(l))}}),define("unified_view/signup/_signup",["shared/polyfills","shared/core/component","shared/w2.context","shared/events/index","shared/recaptcha","settings","shared/window_manager","interface/settings","shared/action_log","shared/dom","shared/siteuri","shared/onload","shared/client","shared/cookies"],function(e,t,i){
var n=e("shared/core/component").Component,o=e("shared/w2.context"),s=e("shared/events/index"),a=e("shared/recaptcha"),r=o.CaptchaInput,d=e("settings"),l=d.interface_strings,c=d.isLoggedIn,h=e("shared/window_manager"),u=null,p=e("interface/settings").pageIsMobile,f=e("shared/action_log").ActionableComponent,_=e("shared/action_log").logSecondaryAction,g=e("shared/dom"),m=e("shared/siteuri"),v=e("shared/onload");if(p)var w=e("mobile_app2/client"),b=e("mobile_app2/app/view/common"),y=e("shared/client"),C=e("mobile_app2/messages"),k=e("shared/cookies"),x=e("mobile_app2/app/view/login"),S=x.leaked_password_handler;t.SignupActionableComponent=f;var E=t.SignupContext=o.Context.extend({initialProperties:function(){return{googleOauthData:null,facebookOauthData:null,emailSignupData:null,captchaResponse:"",requiresCaptcha:!1,validators:{},emailSubmitButton:null,loginData:null,showEmailSignup:!1,facebookSignupFlowData:null}}}),T=t.BaseSignupForm=f.extend({contextConstructor:function(){return E},onLoad:function(){
this._super.apply(this,arguments),this.signupContext=this.getContext(E),this.signupContext.on("googleOauthData",this.onGoogleAccountConnected.bind(this)),this.signupContext.on("facebookOauthData",this.onFacebookAccountConnected.bind(this)),this.signupContext.on("emailSignupData",this.onEmailSignupFormFilled.bind(this)),this.loginInProgress=!1},showLoading:function(){p?C.send("showLoadingView"):this.emitEvent({type:s.Types.LIVENODE_LOADING_SPINNER,payload:{show:!0}})},hideLoading:function(){p?C.send("hideLoadingView"):this.emitEvent({type:s.Types.LIVENODE_LOADING_SPINNER,payload:{show:!1}})},setRedirectCookie:function(e){if(e.indexOf("#")>0&&(e=e.substring(0,e.indexOf("#"))),e.indexOf("?")>0){var t=e.split("?"),i=t[1].split("&"),n=["success","access_token","provider","force_dialog"];i=i.filter(function(e){var t=e.split("=")[0];return!n.includes(t)}),e=t[0]+"?"+i.join("&")}k.setCookie("login_redirect_url",e,{expires:1})},clearRedirectCookie:function(){k.setCookie("login_redirect_url")},handleServerCallResponse:function(e){
if(this.hideLoading(),this.loginInProgress=!1,e.success){if("oauth_redirect"==e.next_action)return void(window.location=e.next_url);if(p)this.maybeSwitchNativeSilo(e),e.login_redirect_url&&this.setRedirectCookie(e.login_redirect_url),C.send("loginStateChanged",{isLoggedIn:!0});else switch(e.next_action){case"redirect":h.navigateTo(e.next_url);break;case"refresh":h.reload()}}else if(e.isMissingFbInfo&&this.signupContext.set("facebookSignupFlowData",e.facebookOauthData),e.next_url&&C.send("openURL",{url:e.next_url}),e.error_message&&p&&b.showAlert({title:e.error_message}),"set_password_modal"===e.next_action){var t=e.state_token;v.execAfterLoad(function(){this.createModal("load_unconfirmed_set_password_modal").kwargs({state_token:t}).show()}.bind(this))}},maybeSwitchNativeSilo:function(e){e.subdomain&&e.language?w.updateConfig(e.subdomain,e.language):this.subdomain&&this.language&&w.updateConfig(this.subdomain,this.language)},logSignupSuccessAction:function(e){_(e,this.impression_target)},
onGoogleAccountConnected:function(e,t){if(t){if(this.loginInProgress)return;this.loginInProgress=!0;var i={google_access_token:t.access_token,use_test_signup:t.use_test_signup||!1},n=function(e){this.handleServerCallResponse(e),p&&e.success&&e.next_url?C.send("openURL",{url:e.next_url,target:"nondismissable_modal"}):e.success||(this.loginInProgress=!1,t.onFailure&&t.onFailure(e))};this.serverCall("on_google_account_connected").kwargs(i).success(n.bind(this)).error(function(){this.loginInProgress=!1}.bind(this)).send(),this.showLoading()}},onFacebookAccountConnected:function(e,t){if(t){if(this.loginInProgress)return;this.loginInProgress=!0;var i={fb_uid:t.userID,fb_access_token:t.accessToken||t.access_token,expires:t.expiresIn,use_test_signup:t.use_test_signup||!1},n=function(e){this.handleServerCallResponse(e),p&&e.success&&e.next_url?C.send("openURL",{url:e.next_url,target:"nondismissable_modal"}):e.success||(this.loginInProgress=!1,t.onFailure&&t.onFailure(e))};this.serverCall("on_facebook_account_connected").kwargs(i).success(n.bind(this)).error(function(){
this.loginInProgress=!1}.bind(this)).send(),this.showLoading()}},onEmailSignupFormFilled:function(e,t){function i(e){this.handleServerCallResponse(e),e.success||(this.loginInProgress=!1,t.onFailure&&t.onFailure(),this.signupContext.get("requiresCaptcha")&&a.onInit(function(){grecaptcha.reset()}))}if(!this.loginInProgress){p||this.$id("@email_password_leak_error").hide(),this.loginInProgress=!0;var n=t.name,o=t.email,s=t.password,r=this.signupContext.get("captchaResponse");this.serverCall("on_try_email_signup").kwargs({name:n,email:o,password:s,"g-recaptcha-response":r}).success(i.bind(this)).except("password_leaked",this.passwordLeakHandler.bind(this,o)).error(function(){this.loginInProgress=!1}.bind(this)).send(),this.showLoading()}},passwordLeakHandler:function(e){if(this.loginInProgress=!1,p)S(this.translated_leaked_password_message,this.translated_leaked_password_submit_button_text,e);else{this.hideLoading();var t=this;this.serverCall("load_password_leaked_dialog").kwargs({email:e}).contentFor(this.$id("@email_password_leak_error")).success(function(){
t.$id("@email_password_leak_error").show()}).send()}}});t.HomePageSignupForm=T.extend({onLoad:function(){if(this._super.apply(this,arguments),p)C.send("loginStateChanged",{isLoggedIn:!1}),this.clearRedirectCookie();else{var e=this;this.$id("@continue_with_email").on("click",function(){e.toggleSignupColumn(!0)}),this.$id("@cancel").on("click",function(){e.toggleSignupColumn(!1)}),this.signupContext.set("emailSubmitButton",this.$id("@submit")),this.signupContext.on("loginData",function(e,t){t&&(this.serverCall("record_no_account_found_link").send(),this.toggleSignupColumn(!0))}.bind(this)),this.signupContext.on("facebookSignupFlowData",function(){this.toggleSignupColumn(!0)}.bind(this))}},toggleSignupColumn:function(e){e?(this.$id("@toggled_signup_column").removeClass("hidden"),this.$id("@initial_signup_column").addClass("hidden")):(this.$id("@toggled_signup_column").addClass("hidden"),this.$id("@initial_signup_column").removeClass("hidden"))}}),t.DialogSignupFormMobile=T.extend({onLoad:function(){
if(this._super.apply(this,arguments),this.$id("@login .normal_login .inline_login_form").removeClass("hidden"),this.dismissible){var e=u.hideSignupWall.bind(u);this.$id("@dismiss_button").on("click",e);var t="@outer_modal".replace("@",this._my());this.$id("@outer_modal").on("click",function(i){i.target.id===t&&e()})}p&&this.setRedirectCookie(h.getURL())}}),t.DialogSignupFormWeb=T.extend({onLoad:function(){if(this._super.apply(this,arguments),this.signupContext.set("emailSubmitButton",this.$id("@submit")),this.$id("@login .normal_login .inline_login_form").removeClass("hidden"),this.$id("@bottom_section .login_link").on("click",this.toggleToState.bind(this,"login_state")),this.$id("@bottom_section .email_signup_link").on("click",this.toggleToState.bind(this,"email_signup_state")),this.$id("@bottom_section .social_connect_link").on("click",this.toggleToState.bind(this,"social_signup_state")),this.dismissible){var e=u.hideSignupWall.bind(u);this.$id("@bottom_section .dismiss_link").on("click",e),
this.$id("@close_x").on("click",e),this.$id("@outer_form").on("click",function(t){var i="@outer_form".replace("@",this._my());t.target.id===i&&e()}.bind(this))}this.signupContext.on("loginData",function(e,t){t&&(this.serverCall("record_no_account_found_link").send(),this.toggleToState("email_signup_state"))}.bind(this)),this.signupContext.on("facebookSignupFlowData",function(){this.toggleToState("email_signup_state")}.bind(this))},toggleToState:function(e){if(e!==this.current_state){var t=this.state_toggle_id_map[e],i=this.state_toggle_id_map[this.current_state];i.forEach(function(e){this.$id(e).addClass("hidden")}.bind(this)),t.forEach(function(e){this.$id(e).removeClass("hidden")}.bind(this)),this.current_state=e}}}),t.SignupCaptcha=n.extend({contextConstructor:function(){return r},onLoad:function(){this.signupContext=this.getContext(E),this.captchaContext=this.getContext(r),this.captchaContext.on("captchaResponse",this.onCaptchaResponseChanged.bind(this)),this.signupContext.set("requiresCaptcha",!0);
},onCaptchaResponseChanged:function(e,t){this.signupContext.set("captchaResponse",t)}}),t.EmailSignupFormWeb=n.extend({onLoad:function(){this.signupContext=this.getContext(E),this.registerFormChecks(),this.signupContext.get("emailSubmitButton").on("click",this.onSubmitClicked.bind(this)),this.signupContext.on("loginData",this.onLoginDataReceived.bind(this)),this.signupContext.on("facebookSignupFlowData",function(e,t){this.intermediate_facebook_data=t,t.name&&this.$id("@name").val(t.name),t.email&&this.$id("@email").val(t.email)}.bind(this)),this.initial_name&&this.$id("@name").val(this.initial_name)},onLoginDataReceived:function(e,t){t&&(this.$id("@email").val(t.email),this.$id("@password").val(t.password))},registerFormChecks:function(){var e=this.maybeChangeEmailSubmitButton.bind(this);this.signupContext.on("captchaResponse",e),this.$id("@email").on("keyup",e),this.$id("@name").on("keyup",e),this.$id("@password").on("keyup",e)},shouldEnableEmailSubmitButton:function(){var e=this.$id("@first_name").val();
return""!==this.signupContext.get("captchaResponse")&&this.$id("@email").val()&&e&&this.validatePasswordInJs()},maybeChangeEmailSubmitButton:function(){var e=this.signupContext.get("emailSubmitButton");this.shouldEnableEmailSubmitButton()?(e.prop("disabled",!1),e.removeClass("submit_button_disabled")):(e.prop("disabled",!0),e.addClass("submit_button_disabled"))},getValidator:function(e){return this.signupContext.get("validators")[e]},validateEmailSignupFields:function(){this.getValidator("@first_name").validate(),this.getValidator("@email").validate(),this.getValidator("@password").validate()},validatePasswordInJs:function(){var e=this.$id("@password").val();return e.length<this.minimum_password_length||e.length>this.maximum_password_length?!1:"password"===e.toLowerCase()?!1:!0},onSubmitClicked:function(){if(this.validateEmailSignupFields(),this.maybeChangeEmailSubmitButton(),this.shouldEnableEmailSubmitButton()){var e=this.$id("@first_name").val()+" "+this.$id("@last_name").val();this.signupContext.set("emailSignupData",{
name:e,email:this.$id("@email").val(),password:this.$id("@password").val()})}}}),t.EmailSignupFormMobile=n.extend({onLoad:function(){var e=this;this.signupContext=this.getContext(E),this.enableDoneButton(),w.registerMessageHandler("modalDoneButtonTapped",this.trySignup.bind(this)),this.signupContext.on("requiresCaptcha",function(t,i){!t&&i&&e.disableDoneButton()}),this.signupContext.on("captchaResponse",function(t,i){""!==i?e.enableDoneButton():e.disableDoneButton()}),w.registerOneTimeMessageHandler("pageReadyComplete",function(){this.focusForm(),y.isAndroidApp()&&C.send("showKeyboard")}.bind(this)),this.initial_name&&this.$id("@name").val(this.initial_name)},setDoneButton:function(e){C.send("setPageAction",{rightTextButton:{title:l.done,callback:this.trySignup.bind(this),disabled:e}})},disableDoneButton:function(){this.setDoneButton(!0)},enableDoneButton:function(){this.setDoneButton(!1)},focusForm:function(){this.$id("@name").focus()},onSignupFailure:function(){this.enableDoneButton(),
C.send("hideLoadingView",{}),this.signupContext.get("requiresCaptcha")&&this.disableDoneButton(),this.previousActiveElement?this.previousActiveElement.focus():this.$id("@password").focus()},trySignup:function(){this.disableDoneButton(),C.send("showLoadingView",{}),this.previousActiveElement=document.activeElement,document.activeElement.blur();var e=this.$id("@first_name").val()+" "+this.$id("@last_name").val();this.signupContext.set("emailSignupData",{name:e,email:this.$id("@email").val(),password:this.$id("@password").val(),onFailure:this.onSignupFailure.bind(this)})}}),t.DialogSignupFormWrapper=n.extend({onLoad:function(){u=this,this.signupWallLoaded=!this.dismissible,this.dismissible||this.scrollToTopAndDisableScroll();var e=this;this.handleEvent(s.Types.WEBNODE_RPC_EXCEPTION,function(t){"login_required"==t.payload.exceptionType&&e.loadSignupWall()}),p&&!c&&y.isNativeApp()&&C.send("setPageAction",{rightTextButton:{title:this.sign_in_text,callback:this.loadSignupWall.bind(this)}})},scrollToTopAndDisableScroll:function(){
if(!p){var e=g.getScrollbarWidth(),t=document.getElementsByClassName("SiteHeader")[0];document.body.style.paddingRight=e+"px",t.style.paddingRight=e+"px"}document.body.classList.add("signup_wall_prevent_scroll"),document.body&&document.body.scrollTop&&(document.body.scrollTop=0),document.documentElement&&document.documentElement.scrollTop&&(document.documentElement.scrollTop=0)},loadSignupWall:function(){return m.isSiteAbsoluteUrl(window.top.location.href)?e("settings").isLoggedIn?void this.serverCall("record_attempt_to_load_signup_wall_logged_in").send():void(this.signupWallLoaded?(this.scrollToTopAndDisableScroll(),this.$id("@signup_wall_wrapper").removeClass("hidden")):(this.signupWallLoaded=!0,this.serverCall("load_signup_wall").contentFor(this.$id("@signup_wall_wrapper")).success(this.scrollToTopAndDisableScroll).send())):void 0},hideSignupWall:function(){if(!p){var e=document.getElementsByClassName("SiteHeader")[0];document.body.style.paddingRight=0,e.style.paddingRight=0}this.$id("@signup_wall_wrapper").addClass("hidden"),
document.body.classList.remove("signup_wall_prevent_scroll")}}),t.loadSignupWall=function(){u&&u.loadSignupWall()},t.hideSignupWall=function(){u&&u.hideSignupWall()}}),define("app/view/signup_validation",["shared/polyfills","input_validate","unified_view/signup/_signup"],function(e,t,i){var n=e("input_validate").InputValidator,o=e("unified_view/signup/_signup").SignupContext;t.SignupValidator=n.extend({onLoad:function(){this._super.apply(this,arguments),this.signupContext=this.getContext(o),this.signupContext&&(this.signupContext.get("validators")[this.id]=this)}})}),define("app/view/site_header",["shared/polyfills","shared/core/component","shared/events/index"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/events/index");t.NonMemberSiteHeaderBase=n.extend({onLoad:function(){var e=this;this.handleEvent(o.Types.SITE_HEADER_SEARCH_FOCUSED,function(t){e.$id("@header").toggleClass("search_focused",t.payload.focused)})}})}),define("app/view/site_header/logged_out",["shared/polyfills","shared/core/component","shared/events/index"],function(e,t,i){
var n=e("shared/core/component").Component,o=e("shared/events/index");t.LoggedOutSiteHeader=n.extend({onLoad:function(){var e=this;this.handleEvent(o.Types.SITE_HEADER_SEARCH_FOCUSED,function(t){e.$id("@header").toggleClass("search_focused",t.payload.focused)}),e.$id("@signup").click(function(){return e.serverCall("show_signup_wall_if_not_logged_in").liveMutate().send(),!1}),e.$id("@login").click(function(){return window.loginIntent=!0,e.serverCall("show_signup_wall_if_not_logged_in").liveMutate().send(),!1})}})}),define("app/view/static",["shared/polyfills","shared/core/component","shared/jquery"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/jquery");t.JobsMain=n.extend({onLoad:function(){var e=this;o(".expand_link").click(function(t){t.preventDefault();var i=o(this).attr("id").split("_").pop();e.$id("@expand_"+i).toggleClass("hidden"),o(this).toggleClass("active_section")}),o.easing.easeOutExpo=function(e){return 1-Math.pow(1-e,6)},o(".jobs_listing_button").click(function(t){
t.preventDefault();var i=e.$id("@careers");i.length&&o("html, body").animate({scrollTop:i.offset().top-100},2500,"easeOutExpo")})}}),t.FeedbackTopicSelector=n.extend({onLoad:function(){var e=this;if(e.$id("@topic_selector").on("change",function(t){t.preventDefault();var i=parseInt(o(this).val());e.changeSelectorWithVal(i)}),window.location.search){var t=e.findGetParameter("option");e.$id("@topic_selector option").each(function(){t==o(this).val()&&(e.changeSelectorWithVal(parseInt(t)),e.$id("@topic_selector").val(t))})}},findGetParameter:function(e){var t=null,i=[];return window.location.search.substr(1).split("&").forEach(function(n){i=n.split("="),i[0]===e&&(t=decodeURIComponent(i[1]))}),t},changeSelectorWithVal:function(e){var t=this;t.serverCall("choose_selector").kwargs({feedback_type:e}).contentFor(t.$id("@faq_selector")).send()}}),t.SuggestedFAQ=n.extend({onLoad:function(){var e=this;e.$id("@need_help_button").on("click",function(){o(this).hide(),e.$id("@general_form").removeClass("hidden");
})}}),t.GeneralForm=n.extend({onLoad:function(){var e=this;e.logged_in=this.logged_in,e.clicked=!1,this.child("upload_form").success(this.uploadSuccess.bind(this)).failure(this.uploadFailure.bind(this)),e.$id("@submit_button").on("click",function(t){if(!e.clicked){e.clicked=!0,t.preventDefault(),e.$id("@submit_button").addClass("disabled");var i=e.$id("@name").val(),n=e.$id("@email").val(),o=e.$id("@profile").val(),s=e.$id("@photo_key").val(),a=e.$id("@editor").val(),r=e.$id("@appeal_selector").val(),d=e.$id("@appeal_content").val(),l=document.referrer;e.serverCall("submit_feedback").kwargs({feedback_type:e.feedback_type,msg:a,referrer:l,name:i,email:n,profile:o,photo_key:s,target:e.target,appeal:r,appeal_content:d}).success(function(t){t&&t.redirect?setTimeout(function(){window.location.href="/"},2e3):(e.clicked=!1,e.$id("@submit_button").removeClass("disabled"))}).liveMutate().send()}})},uploadSuccess:function(e){this.$id("@photo_key").val(e.photo_key),this.serverCall("upload").kwargs({
photo_key:e.photo_key,target:this.target}).contentFor(this.$id("@iframe")).send()},uploadFailure:function(){o(".drop_zone").removeClass("drag_and_hover"),this.child("drag_and_drop_form").$id("@form_title").removeClass("drag_and_hover"),this.child("upload_form").hideSpinner()}}),t.JobListingMain=n.extend({onLoad:function(){this.$id("@apply_button").on("click",this.onClickApplyNow.bind(this))},onClickApplyNow:function(){var e=this;if(e.pixel_url){var t=new XMLHttpRequest;t.onreadystatechange=function(){window.location.href=e.apply_url},t.open("GET",e.pixel_url,!0),t.send(null)}else window.location.href=e.apply_url;return!1}})}),define("app/view/suggestions",["shared/polyfills","shared/action_log"],function(e,t,i){var n=e("shared/action_log");t.FollowSuggestionCard=n.ActionableComponent.extend({onLoad:function(){this._super.apply(this,arguments);var e=this,t=!1,i=e.$id("@actionable").parent();i.mouseleave(function(){t===!0&&(i.fadeOut(),e.serverCall("follow").liveMutate().send())}),e.$id("@follow").on("click",function(i){
i.preventDefault(),e.$id("@follow").toggle(),e.$id("@unfollow").toggle(),t=!0}),e.$id("@unfollow").on("click",function(i){i.preventDefault(),e.$id("@follow").toggle(),e.$id("@unfollow").toggle(),t=!1})}})}),define("app/view/survey/question_page",["shared/polyfills","shared/core/component","shared/jquery"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/jquery");t.Survey=n.extend({onLoad:function(){var e=this;e.bindSurveyDismissHandler(),e.bindSurveySubmitHandler(),e.serverCall("show_card").send()},bindSurveySubmitHandler:function(){var e=this;this.$id("@submit_form").on("click",function(){var t=e.$id("@survey_form").find("input[type='radio']:checked").val(),i=o(this).parents(".Survey"),n=e.$id("@response_input").val();"undefined"!=typeof t&&e.serverCall("submit_survey").kwargs({selected_option:t,response_text:n}).success(function(){e.$id("@survey_wrapper").addClass("hidden"),e.$id("@feedback").removeClass("hidden"),i.hide()}).send()})},bindSurveyDismissHandler:function(){
var e=this;this.$id("@dismiss").on("click",function(){e.$id("@survey").fadeOut(800),e.serverCall("dismiss_survey").send()})}})}),define("app/view/thanks",["shared/polyfills","shared/core/component"],function(e,t,i){var n=e("shared/core/component").Component;t.ThanksLink=n.extend({onLoad:function(){var e=this;this.$id("@thanks_link").click(function(){return e.serverCall("send_thanks").liveMutate().send(),!1})}})}),define("app/view/thread",["shared/polyfills","view/inline_editor"],function(e,t,i){var n=e("view/inline_editor").InlineEditor;t.ThreadMessageInlineEditor=n.extend({ajax_callback:function(e){null!==e&&this.editor.clear(),this._latestSavedState=null}})}),define("app/view/threaded_comments",["shared/polyfills","shared/core/component","shared/jquery","settings","shared/debounce","w2.dialog","shared/w2.context","shared/window_manager","shared/qtext","shared/events/index","shared/logging"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/jquery"),s=e("settings"),a=e("shared/debounce").debounce,r=e("w2.dialog"),d=e("shared/w2.context"),l=e("shared/window_manager").isInHash,c=e("shared/qtext").renderQText,h=e("shared/events/index"),u=e("shared/logging"),p=d.Context.extend({
initialProperties:function(){return{expanded:!1,visible:!0,showReplyBox:!1}}});t.TCommentListWrapper=n.extend({onLoad:function(){this.tcommentContext=this.getContext(p),this.isSingleFeedComment()&&(this.actionBarContext=this.getContext(d.ActionBar)),this.moreLink=this.$id("@comment_list_more_link"),this.collapsedLink=this.$id("@collapsed_link"),this.isMoreLinkActive=!0,this.isFirstExpand=!0,this.offset=this.initial_limit,this.moreLink&&this.moreLink.on("click",this.handleMoreLinkClick.bind(this)),this.tcommentContext&&this.tcommentContext.on("expanded",this.handleVisible.bind(this)),this.isSingleFeedComment()&&this.actionBarContext&&this.actionBarContext.set("pageFeedCommentsLink",this.moreLink);var e=this.is_root||this.tcommentContext&&this.tcommentContext.get("expanded");this.handleVisible(null,e)},isSingleFeedComment:function(){return this.is_root&&1==this.initial_limit&&this.feed_comment_id},handleMoreLinkClick:function(){this.isMoreLinkActive&&(this.isMoreLinkActive=!1,this.pageComment());
},handleVisible:function(e,t){this.$id("@comment_list_wrapper").toggleClass("hidden",!t),t&&this.lazy_load_children&&this.loadChildren(),t&&this.$id("@first_level_placeholder").length&&this.loadAllFirstLevel()},pageComment:function(){var e=this;this.moreLink.addClass("hidden"),this.isFirstExpand&&this.isSingleFeedComment()&&u.log("comments_toggled",{comment_type:"answer",object_id:this.object_id}),this.serverCall("page_comment").kwargs({object_id:this.object_id,reply_to_id:this.reply_to_id,level:this.level,offset:this.offset,limit:this.getNextPageLimit(),feed_comment_id:this.feed_comment_id}).success(function(){e.moreLink.removeClass("hidden"),e.isMoreLinkActive=!0,e.offset=e.getNextPageLimit(),(null===e.offset||e.offset>=e.num_children)&&(e.moreLink.addClass("hidden"),e.collapsedLink.removeClass("hidden")),e.isFirstExpand&&e.isSingleFeedComment()&&e.actionBarContext&&(e.actionBarContext.set("feedCommentsPaged",!0),e.actionBarContext.set("showComments",!0)),e.isFirstExpand=!1}).error(function(){
e.moreLink.removeClass("hidden"),e.isMoreLinkActive=!1}).contentFor(this.$id("@comment_list_first_level_placeholder_"+this.offset)).sendOnlyOnce()},getNextPageLimit:function(){return this.isFirstExpand?this.offset+this.offsetStep:this.offset+this.nextOffsetStep},loadChildren:function(){this.lazy_load_children&&(this.lazy_load_children=!1,this.serverCall("load_child_list").kwargs({object_id:this.object_id,reply_to_id:this.reply_to_id,level:this.level}).contentFor(this.$id("@comment_list_placeholder")).send())},loadAllFirstLevel:function(){var e=this;this.first_level_all_loaded||(this.first_level_all_loaded=!0,this.serverCall("load_all_first_level").kwargs({object_id:this.object_id,reply_to_id:this.reply_to_id,level:this.level,feed_comment_id:this.feed_comment_id}).contentFor(this.$id("@first_level_placeholder")).success(function(t){e.$id("@comment_list_more_link").toggleClass("hidden",!1)}).send())}}),t.TComment=n.extend({contextConstructor:function(){return p},parentComment:function(){return this.parent().parent().parent();
},onLoad:function(){this.tcommentContext=this.getContext(p),this.loadReplyBox(),this.$id("@delete_link").on("click",this.deleteComment.bind(this)),this.tcommentContext.on("expanded",this.handleExpand.bind(this)),this.tcommentContext.on("visible",this.handleVisible.bind(this)),this.tcommentContext.set("expanded",this.force_expanded),this.tcommentContext.set("visible",!0),this.expandOnNotif(),c(this.$id("@comment"))},loadReplyBox:function(){this.deleted||this.serverCall("get_reply_box").contentFor(this.$id("@reply_box_wrapper").get(0),{useLoadingSpinner:!1}).send({batched:!0})},addNotifHighlight:function(e){e.addClass("highlighter");var t=!1,i=function(){var t=e.offset().top,i=t+e.height(),n=o(window).scrollTop(),s=n+o(window).height();return i>=n&&s>=t},n=i(),s=function(){t=!0};o(window).scroll(s);var a=setInterval(function(){if(t){var r=i();n&&!r&&(e.removeClass("highlighter"),clearInterval(a),o(window).off("scroll",s)),n=r,t=!1}},500)},expandOnNotif:function(){if(l("comment"+this.id)){
for(var e=this;!e.is_root;)e.tcommentContext.set("expanded",!0),e=e.parentComment();this.addNotifHighlight(this.$id("@comment_highlight_wrapper"))}},deleteComment:function(e){var t=this;e.preventDefault(),r.createDialog(this).title(this.delete_dialog_title).cancel(null,this.delete_dialog_cancel_button_text).ok(function(){t.serverCall("delete_comment").kwargs({cid:t.id,oid:t.object_id}).liveMutate().send()},this.delete_dialog_title).html(this.delete_dialog_message)},handleExpand:function(e,t){this.$id("@comment_inner").toggleClass("expanded",t)},handleVisible:function(e,t){this.$id("@comment").toggleClass("hidden",!t)}}),t.TCommentReplyBox=n.extend({onLoad:function(){var e=this;this.isSubmittingComment=!1,this.editor=this.child("editor"),this.editor&&this.editor.setMeaningfulChangeCallback(a(this.save_draft.bind(this),1e3,{maxWait:6e4})),this.tcommentContext=this.getContext(p),this.tcommentContext.on("showReplyBox",function(t,i){e.$id("@reply_box").toggleClass("hidden",!i),i&&e.maybeFocusEditor();
}),this.$id("@add_comment_link").on("click",function(t){t.preventDefault(),e.addComment()}),this.tcommentContext.set("showReplyBox",!1),this.$id("@reply_box").on("focusout",function(){e.editor.isEmpty()&&e.tcommentContext.set("showReplyBox",!1)})},maybeFocusEditor:function(){var e=this;setTimeout(function(){e.editor&&e.editor.focus()},0)},addComment:function(){var e=this;if(this.tcommentContext.set("showReplyBox",!1),!this.editor.isOnlyWhiteSpace()){var t=this.editor.serialize();this.isSubmittingComment=!0,this.serverCall("add_comment").kwargs({oid:this.object_id,comment:t,reply_to_id:this.reply_to_id}).success(function(t){e.tcommentContext.set("expanded",!0),e.editor.clear(),e.isSubmittingComment=!1}).error(function(){e.isSubmittingComment=!1}).liveMutate().sendOnlyOnce()}},save_draft:function(){this.isSubmittingComment||this.serverCall("save_draft").kwargs({content:this.editor.serialize(),window_id:s.windowId,draft_space:this.draft_space}).send()}}),t.TCommentAddRoot=n.extend({onLoad:function(){
var e=this;this.editor=this.child("editor"),this.editor&&this.editor.setMeaningfulChangeCallback(a(this.save_draft.bind(this),1e3,{maxWait:6e4})),this.isSubmittingComment=!1,this.$addRootLink=this.$id("@add_root_link"),this.$addRootLink.on("click",function(t){t.preventDefault(),e.addComment()})},addComment:function(){var e=this;this.editor.isOnlyWhiteSpace()||(this.isSubmittingComment=!0,this.serverCall("add_comment").kwargs({oid:this.object_id,comment:this.editor.serialize()}).success(function(t){e.editor.clear(),e.isSubmittingComment=!1,e.emitEvent({type:h.Types.COMMENT_ADD,payload:{object_id:e.object_id,comment_type:e.comment_type}})}).error(function(){e.isSubmittingComment=!1}).liveMutate().sendOnlyOnce())},save_draft:function(){this.isSubmittingComment||this.serverCall("save_draft").kwargs({content:this.editor.serialize(),window_id:s.windowId,draft_space:this.draft_space}).send()}}),t.TCommentRepliesCollapsed=n.extend({onLoad:function(){var e=this;this.tcommentContext=this.getContext(p),
this.tcommentContext.on("expanded",function(t,i){e.setHidden(i)}),this.$id("@show_child_link").on("click",function(t){t.preventDefault(),e.tcommentContext.set("expanded",!0)}),this.setHidden(this.tcommentContext.get("expanded"))},setHidden:function(e){this.$id("@show_child_link_wrapper").toggleClass("hidden",e)}}),t.AnswerTCommentRepliesCollapsedInFeed=t.TCommentRepliesCollapsed.extend({onLoad:function(){var e=this;e.actionBarContext=e.getContext(d.ActionBar),e.$id("@show_child_link").on("click",function(t){e.actionBarContext.set("feedCommentExpanded",!0),e.serverCall("load_feed_comments").kwargs({object_id:e.object_id,comment_id:e.id}).contentFor(e.$id("@show_child_link_wrapper")).success(function(){e.$id("@show_child_link_wrapper").addClass("background")}).send(),t.preventDefault()})}}),t.TCommentActionBar=n.extend({onLoad:function(){var e=this;this.tcommentContext=this.getContext(p),this.tcommentContext.on("showReplyBox",function(t,i){e.toggleActionBar(i)}),this.toggleActionBar(e.tcommentContext.get("showReplyBox")),
this.$id("@comment_downvote").on("click",function(t){t.preventDefault(),e.vote(!1,!1)}),this.$id("@comment_upvote").on("click",function(t){t.preventDefault(),e.vote(!0,!1)}),this.$id("@comment_downvote_cancel").on("click",function(t){t.preventDefault(),e.vote(!1,!0)}),this.$id("@comment_upvote_cancel").on("click",function(t){t.preventDefault(),e.vote(!0,!0)}),this.$id("@show_reply_box_link").focus(this.startEditing.bind(this)),this.$id("@show_reply_box_link").on("click",function(t){t.preventDefault(),e.startEditing()}),this.$id("@show_reply_box_link").on("mousedown",function(t){t.preventDefault(),e.startEditing()})},toggleActionBar:function(e){this.$id("@action_bar").toggleClass("hidden",e)},vote:function(e,t){this.serverCall("comment_vote").kwargs({oid:this.object_id,cid:this.id,is_upvote:e,cancel:t}).liveMutate().sendOnlyOnce()},startEditing:function(){this.tcommentContext.set("showReplyBox",!0)}}),t.DeleteCommentButton=n.extend({onLoad:function(){var e=this;this.$id("@delete").click(function(t){
return e.deleteComment(),!1})},deleteComment:function(){this.serverCall("delete").liveMutate().send()}}),t.AnswerCommentsToggle=n.extend({onLoad:function(){var e=this;e.handleEvent(h.Types.ANSWER_COMMENT_SORT_ALL,function(t){t.payload.aid==e.aid&&e.toggleCommentList("other")}),e.handleEvent(h.Types.COMMENT_ADD,function(t){t.payload.object_id==e.aid&&"answer"==t.payload.comment_type&&e.toggleCommentList("featured")}),e.$id("@toggle_to_featured_link").click(function(t){t.preventDefault(),e.toggleCommentList("featured")}),e.$id("@toggle_to_all_link").click(function(t){t.preventDefault(),e.toggleCommentList("other")})},toggleCommentList:function(e){var t=this;"featured"==e?(t.$id("@featured_comments_container").removeClass("hidden"),t.$id("@all_comments_container").addClass("hidden"),t.$id("@featured_comments_toggle").removeClass("hidden"),t.$id("@all_comments_toggle").addClass("hidden")):(t.$id("@featured_comments_container").addClass("hidden"),t.$id("@all_comments_container").removeClass("hidden"),
t.$id("@featured_comments_toggle").addClass("hidden"),t.$id("@all_comments_toggle").removeClass("hidden"))}}),t.AnswerFeaturedTCommentEmptyState=n.extend({onLoad:function(){var e=this;e.$id("@all_comments").on("click",function(t){t.preventDefault(),e.emitEvent({type:h.Types.ANSWER_COMMENT_SORT_ALL,payload:{aid:e.aid}})})}}),t.AnswerCommentVoterListModalLink=n.extend({onLoad:function(){var e=this;this.$id("@modal_link").click(function(){return e.createModal("load_inner").kwargs({aid:e.aid,object_id:e.object_id}).show(),!1})}}),t.AnswerCommentCredibleVoterFact=n.extend({onLoad:function(){var e=this;this.$id("@social_voter_modal").on("click",function(t){return t.preventDefault(),e.createModal("load_social_voter_modal").kwargs({aid:e.aid,comment_id:e.comment_id}).show(),!1})}})}),define("app/view/topic",["shared/polyfills","shared/core/component","shared/cookies","w2.dialog","view/dialog","tooltip","shared/w2.context","shared/action_log","settings"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/cookies"),s=e("w2.dialog"),a=e("view/dialog"),r=e("tooltip"),d=e("shared/w2.context"),l=e("shared/action_log"),c=e("settings").interface_strings;
t.TopicAliases=n.extend({onLoad:function(){var e=this,t=this.addAliasSubmit.bind(this);this.$id("@topic_alias_add").click(t),this.$id("@topic_alias_add_form").submit(t),this.$id("@show_alias_link").click(function(t){t.preventDefault(),e.$id("@add_topic_alias").show(),e.$id("@show_alias").hide(),e.$id("@topic_alias_input").focus()})},get_value:function(){return this.$id("@topic_alias_input").val()},addAliasSubmit:function(){return this._request(this.get_value()),!1},_request:function(e){var t=this;return this.tid&&e?void this.serverCall("add_topic_alias").kwargs({tid:this.tid,alias:e}).success(function(){t.$id("@topic_alias_input").val(""),t.$id("@topic_alias_input").focus()}).liveMutate().send():!1}}),t.TopicAlias=n.extend({onLoad:function(){var e=this;this.$id("@topic_alias_remove").click(function(){return s.createDialog(e).title(e.dialog_title).cancel().ok(function(){e._request()}).text(e.dialog_contents),!1})},_request:function(){return this.tid&&this.alias?void this.serverCall("remove_topic_alias").kwargs({
tid:this.tid,alias:this.alias}).liveMutate().send():!1}}),t.TopicDelete=n.extend({onLoad:function(){var e=this;this.$id("@delete_topic_link").click(function(){return e.showDialog(!0),!1}),this.$id("@undelete_topic_link").click(function(){return e.showDialog(!1),!1})},getKwargs:function(e){return{tid:this.tid,comment:e.serialize()}},showDialog:function(e){var t=this.title,i=e?"delete_topic":"undelete_topic",n=e?"delete_dialog":"undelete_dialog",o=this;s.createDialog(o).title(t).ok(function(e){var t=e.dialogComponent.child("editor");return t.isOnlyWhiteSpace()?!1:void o.serverCall(i).kwargs(o.getKwargs(t)).liveMutate().send()},c.ok).cancel(null,c.cancel).load(n)}}),t.TopicFollowButton=n.extend({onLoad:function(){var e=this.follow.bind(this),t=this.unfollow.bind(this);this.$id("@follow").click(e),this.$id("@unfollow").click(t),this.tooltip&&r.attach(this.$id("@follow"),this.tooltip_text)},follow:function(e){o.setQfeedLog(this,"TopicFollow"),o.setQueryLog(this,"TopicFollow"),o.setTlog({type:"TopicFollow",
tid:this.tid}),l.logSecondaryAction("TopicFollow",{type:"topic",tid:this.tid}),this.serverCall("follow").kwargs({tid:this.tid}).liveMutate().send(),e.preventDefault()},unfollow:function(e){this.serverCall("unfollow").kwargs({tid:this.tid}).liveMutate().send(),e.preventDefault()}}),t.AdultTopicFollowButton=a.DialogLink.extend({onLoad:function(){var e=this;this._super.apply(this,arguments),this.$id("@link").click(function(){return e.serverCall("follow").liveMutate().send(),!1})}}),t.TopicNameLinkBase=n.extend({onLoad:function(){var e=this;this.$id("@link").mousedown(function(){o.setQfeedLog(e,"TopicClickthrough"),o.setQueryLog(e,"TopicClickthrough")})}}),t.HoverTopicMenuMuteLink=n.extend({onLoad:function(){this.hoverMenuContext=this.getContext(d.HoverMenu),this.$link=this.$id("@link");var e=this;this.$link.on("click",function(){var t=e.$link.hasClass("topic_muted");return t?e.serverCall("unmute").liveMutate().send():(e.hoverMenuContext&&e.hoverMenuContext.set("hidden",!0),e.serverCall("mute").liveMutate().send()),
!1})}}),t.TopicTrendingIndicator=n.extend({onLoad:function(){r.attach(this.$id("@trending"),this.tooltipText)}})}),define("app/view/topic/edit_topic_modal",["shared/polyfills","shared/core/component","shared/events/index"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/events/index");t.EditTopicsList=n.extend({onLoad:function(){var e=this;this.handleEvent(o.Types.TOPIC_LIST_REMOVE,function(t){e.removeTid(t.payload.tid)})},removeTid:function(e){this.serverCall("remove").kwargs({tid:e}).liveMutate().send()}}),t.EditTopicsLink=n.extend({onLoad:function(){var e=this;this.$id("@edit_topics").click(function(t){t.preventDefault(),e.createModal("load_modal").kwargs({metadata:e.metadata}).show()})}}),t.TopicRow=n.extend({onLoad:function(){var e=this;this.$id("@remove_topic").on("click",function(t){t.preventDefault(),e.emitEvent({type:o.Types.TOPIC_LIST_REMOVE,payload:{tid:e.tid}})})}})}),define("view/reorderable_list",["shared/polyfills","shared/core/component","shared/events/index","tooltip","shared/jquery"],function(e,t,i){
function n(e){var t=e.style[u];if(t)return{value:t,original:t};if(window.getComputedStyle){var i=window.getComputedStyle(e).getPropertyValue(p);if(i&&"none"!==i)return{value:i,original:""}}return{value:"",original:""}}function o(e){var t=e.ownerDocument&&e.ownerDocument.defaultView&&e.ownerDocument.defaultView.getComputedStyle&&e.ownerDocument.defaultView.getComputedStyle(e,null),i=t&&t.getPropertyValue("height")||"";return i=i&&i.indexOf(".")>-1?parseFloat(i)+parseInt(t.getPropertyValue("padding-top"))+parseInt(t.getPropertyValue("padding-bottom"))+parseInt(t.getPropertyValue("border-top-width"))+parseInt(t.getPropertyValue("border-bottom-width")):e.offsetHeight}function s(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()}var a=e("shared/core/component").Component,r=e("shared/events/index"),d=e("tooltip"),l=e("shared/jquery"),c=document.createElement("div"),h="webkitTransition"in c.style?"webkitTransition":"transition",u="webkitTransform"in c.style?"webkitTransform":"transform",p="webkitTransform"===u?"-webkit-transform":"transform",f="webkitUserSelect"in c.style?"webkitUserSelect":"userSelect";
c.style[u]="translateZ(0)";var _=c.style[u]?"translateZ(0) ":"",g=c.style[u]?"translateZ(1px) ":"";t.ReorderableList=a.extend({onLoad:function(){this.pageRoots=l(".Standard2ColLayout").add(l(".ContentPageFeed").parent());var e=this;this.handleEvent(r.Types.REORDERABLE_LIST_ITEM_UPDATE,function(){e.is_editing&&(e.detach(),e.attach()),e.showErrorOnLiveUpdate()}),this.handleEvent(r.Types.REORDERABLE_LIST_ITEM_ACTIVE,function(){e.$id("@wrapper").hasClass("is_editing")&&e.resetActiveState()})},isOnDragActive:!1,enableLocalUpdate:!0,onStartSectionMousedownCallback:null,onEndSectionMousedownCallback:null,onStartSubsectionMousedownCallback:null,onEndSubsectionMousedownCallback:null,onStartSectionMousemoveCallback:null,onEndSectionMousemoveCallback:null,onStartSubsectionMousemoveCallback:null,onEndSubsectionMousemoveCallback:null,onStartSectionMouseupCallback:null,onEndSectionMouseupCallback:null,onStartSubsectionMouseupCallback:null,onEndSubsectionMouseupCallback:null,setToDefaultView:function(){
this.target.node.style[f]="",this.target.node.style[h]="",this.target.node.style[u]=this.target.baseTransform.original,this.target.node.style.zIndex="",document.body.removeChild(this.targetNodeClone),this.targetNodeClone=null,this.target.node.style.visibility="";for(var e=0;e<this.sectionNodesContainer.length;e++){var t=this.sectionNodes[e][0];t.style.height="",t.style[u]="",t.style[h]="";for(var i=0;i<this.sectionNodesContainer[e].nodes.length;i++){var n=this.sectionNodesContainer[e].nodes[i];n.node.style[u]=n.baseTransform.original,n.node.style[h]=""}}this.pageRoots.removeClass("unselectable"),s(),this.removeMouseHandlers()},attach:function(){this.ReorderableList=this.$id("@wrapper")[0],this.otherNodes=[];var e=[];this.sectionNodes=this.$id("@wrapper").find(".ReorderableListBranch").each(function(){e.push(l(this).parent())}),this.sectionNodes=e;for(var t=0;t<this.sectionNodes.length;t++)for(var i=this.sectionNodes[t].find(".ReorderableListContents .drag_icon"),n=0;n<i.length;n++){var o=i[n],s=l(o).closest(".ReorderableListItem").parent(),a={
startSectionIndex:t,startSubsectionIndex:o,node:s};l(o).on("mousedown",a,this._onSubsectionMousedown.bind(this))}},detach:function(){if(this.sectionNodes)for(var e=0;e<this.sectionNodes.length;e++)for(var t=this.sectionNodes[e].find(".ReorderableListContents .drag_icon"),i=0;i<t.length;i++){var n=t[i];l(n).off("mousedown")}},updatePosition:function(e,t){this.latestPosition=t;var i=document.body,n=i.scrollTop;n!=i.scrollTop&&(this.startPosition.y+=n-i.scrollTop),this.latestPosition.time-this.previousPosition.time>100&&(this.previousPosition=this.latestPosition)},removeMouseHandlers:function(){this.mouseHandlersAttached&&(this.mouseHandlersAttached=!1,l(window).off("mousemove"),l(window).off("mouseup"))},_onMousedown:function(e){var t=e.data.node[0];this.startSectionIndex=e.data.startSectionIndex,this.startSubsectionIndex=e.data.startSubsectionIndex,this.target={node:t,baseTransform:n(t),height:t.offsetHeight},this.zero=this.target.node.offsetTop+this.target.height/2,this.sectionNodesContainer=[];
for(var i=0;i<this.sectionNodes.length;i++){var s,a=[],r=this.sectionNodes[i][0];this.target.node!==r&&(r.style[h]=p+" 0.2s ease-in-out");for(var d=this.sectionNodes[i].find(".ReorderableListContents .ReorderableListItem"),l=0;l<d.length;l++){var c=d.eq(l)[0].parentNode;this.target.node!==c&&(c.style[h]=p+" 0.2s ease-in-out"),s=c.offsetTop,a.push({node:c,baseTransform:n(c),pos:s+(s<this.zero?c.offsetHeight:0)-this.zero})}s=r.offsetTop,this.sectionNodesContainer.push({nodes:a,posRelative:s+(s<this.zero?r.offsetHeight:0)-this.zero,pos:r.getBoundingClientRect().top+window.pageYOffset-r.clientTop,height:o(r)})}var u={x:e.pageX,y:e.pageY,time:e.timeStamp};this.startTransformPosition=e.clientY,this.startPosition=this.previousPosition=this.latestPosition=u,this.targetNodeClone=this.target.node.cloneNode(!0),this.target.node.style.visibility="hidden";var f=this.target.node.getBoundingClientRect();this.targetNodeClone.style.position="fixed",this.targetNodeClone.style.top=f.top+"px",this.targetNodeClone.style.left=f.left+"px",
this.targetNodeClone.style["background-color"]="#fff",document.body.appendChild(this.targetNodeClone)},_onSectionMousedown:function(e){"function"==typeof this.onStartSectionMousedownCallback&&this.onStartSectionMousedownCallback(),this._onMousedown(e),"function"==typeof this.onEndSectionMousedownCallback&&this.onEndSectionMousedownCallback(this.target.node,this.targetNodeClone),this._onSectionMousemove(e),this.mouseHandlersAttached||(this.mouseHandlersAttached=!0,l(window).on("mousemove",this._onSectionMousemove.bind(this)),l(window).on("mouseup",this._onSectionMouseup.bind(this)))},_onSubsectionMousedown:function(e){"function"==typeof this.onStartSubsectionMousedownCallback&&this.onStartSubsectionMousedownCallback(),this._onMousedown(e),"function"==typeof this.onEndSubsectionMousedownCallback&&this.onEndSubsectionMousedownCallback(this.targetNodeClone,this.startSectionIndex),this._onSubsectionMousemove(e),this.mouseHandlersAttached||(this.mouseHandlersAttached=!0,l(window).on("mousemove",this._onSubsectionMousemove.bind(this)),
l(window).on("mouseup",this._onSubsectionMouseup.bind(this)))},_onMousemove:function(e){this.isOnDragActive=!0,this.updatePosition(e,{x:e.pageX,y:e.pageY,time:e.timeStamp}),this.transformY=e.clientY,this.scrollIfNearEdge(this.transformY),this.pageRoots.addClass("unselectable");var t=this.transformY-this.startTransformPosition;this.target.node.style[u]="translate(0, "+t+"px) "+g+this.target.baseTransform.value,this.targetNodeClone.style[u]=this.target.node.style[u]},_onSectionMousemove:function(e){"function"==typeof this.onStartSectionMousemoveCallback&&this.onStartSectionMousemoveCallback(),this._onMousemove(e);for(var t=this.getTotalMovement(),i=this.target.node.offsetHeight,n=0;n<this.sectionNodesContainer.length;n++){var o=this.sectionNodesContainer[n],s=this.sectionNodes[n][0],a=0;o.posRelative<0&&t.y<0&&o.posRelative>t.y?a=i:o.posRelative>0&&t.y>0&&o.posRelative<t.y&&(a=-i),a?s.style[u]="translate(0,"+a+"px) "+_:s.style[u]=""}"function"==typeof this.onEndSectionMousemoveCallback&&this.onEndSectionMousemoveCallback();
},_onSubsectionMousemove:function(e){"function"==typeof this.onStartSubsectionMousemoveCallback&&this.onStartSubsectionMousemoveCallback(),this._onMousemove(e);for(var t=this.getTotalMovement(),i=this.target.height,n=0;n<this.sectionNodesContainer.length;n++)this.latestPosition.y>this.sectionNodesContainer[n].pos&&this.latestPosition.y<(this.sectionNodesContainer[n+1]?this.sectionNodesContainer[n+1].pos:1/0)?(this.endSectionIndex=n,n!==this.startSectionIndex?this.sectionNodes[n][0].style.height=this.sectionNodesContainer[n].height+this.target.height+"px":this.sectionNodes[n][0].style.height=this.sectionNodesContainer[n].height+"px"):n===this.startSectionIndex?this.sectionNodes[n][0].style.height=this.sectionNodesContainer[n].height-this.target.height+"px":this.sectionNodes[n][0].style.height=this.sectionNodesContainer[n].height+"px";for(n=0;n<this.sectionNodesContainer.length;n++)for(var o=this.sectionNodesContainer[n],s=0;s<o.nodes.length;s++){var a=0,r=o.nodes[s];if(r.pos<0&&t.y<0&&r.pos>t.y?a+=i:r.pos>0&&t.y>0&&r.pos<t.y&&(a+=-i),
this.latestPosition.y>o.pos&&n>this.startSectionIndex){a+=i,this.zero=this.target.node.offsetTop+this.target.height/2;var d=r.node.offsetTop;t.y>0?r.pos=d+(d<this.zero?r.offsetHeight:0)-this.zero+i:t.y<0&&(r.pos=d+(d<this.zero?r.offsetHeight:0)-this.zero-i);for(var l=0;l<this.sectionNodes.length;l++)this.sectionNodesContainer[l].pos=this.sectionNodes[l][0].getBoundingClientRect().top+window.pageYOffset-this.sectionNodes[l][0].clientTop}r.node.style[u]=a?"translate(0,"+a+"px) "+_+r.baseTransform.value:r.baseTransform.original}"function"==typeof this.onEndSubsectionMousemoveCallback&&this.onEndSubsectionMousemoveCallback()},_onMouseup:function(){this.isOnDragActive=!1,l("html, body").stop()},_onSectionMouseup:function(){"function"==typeof this.onStartSectionMouseupCallback&&this.onStartSectionMouseupCallback(),this._onMouseup();var e,t=this.getTotalMovement();if(t.y<0){for(e=0;e<this.sectionNodesContainer.length;e++)if(this.sectionNodesContainer[e].posRelative>t.y){this.endSectionIndex=e,
this.enableLocalUpdate&&this.target.node.parentNode.insertBefore(this.target.node,this.sectionNodes[this.endSectionIndex]);break}}else for(e=this.sectionNodesContainer.length-1;e>=0;e--)if(this.sectionNodesContainer[e].posRelative<t.y){this.startSectionIndex===e+1?this.endSectionIndex=e+1:this.endSectionIndex=e,this.enableLocalUpdate&&this.target.node.parentNode.insertBefore(this.target.node,this.sectionNodes[e+1]?this.sectionNodes[e+1]:null);break}if(this.removeMouseHandlers(),!this.enableLocalUpdate){var i=this.targetNodeClone.getBoundingClientRect().left;this.targetNodeClone.style[u]="",this.targetNodeClone.style.position="absolute",this.targetNodeClone.style.left=i;var n,o=l(window).scrollTop();0!==this.endSectionIndex&&(t.y<0?(n=this.sectionNodes[this.endSectionIndex-1][0],o+=n.getBoundingClientRect().bottom):(n=this.sectionNodes[this.endSectionIndex][0],o+=n.getBoundingClientRect().bottom)),this.targetNodeClone.style.top=o+"px"}"function"==typeof this.onEndSectionMouseupCallback&&this.onEndSectionMouseupCallback(this.target.node,this.targetNodeClone,this.endSectionIndex,this.startSectionIndex);
},_onSubsectionMouseup:function(){this.removeMouseHandlers(),"function"==typeof this.onStartSubsectionMouseupCallback&&this.onStartSubsectionMouseupCallback(this.target.node,this.endSubsectionIndex,this.startSubsectionIndex),this._onMouseup();var e,t=this.sectionNodesContainer[this.endSectionIndex].nodes,i=this.getTotalMovement();if(0===t.length)this.enableLocalUpdate&&this.sectionNodes[this.endSectionIndex].querySelector("div.nested_contents").firstChild.appendChild(this.target.node),this.endSubsectionIndex=0;else if(i.y<0){for(t[t.length-1].pos+this.target.height>i.y&&(this.localUpdate&&this.sectionNodes[this.endSectionIndex].querySelector("div.nested_contents").firstChild.insertBefore(this.target.node,t[t.length-1].node.nextSibling),this.endSubsectionIndex=t.length),e=0;e<t.length;e++)if(t[e].pos>i.y){this.endSubsectionIndex=e,this.localUpdate&&this.sectionNodes[this.endSectionIndex].querySelector("div.nested_contents").firstChild.insertBefore(this.target.node,t[e].node);break}}else for(t[0].pos>i.y&&(this.localUpdate&&this.sectionNodes[this.endSectionIndex].querySelector("div.nested_contents").firstChild.insertBefore(this.target.node,t[0].node),
this.endSubsectionIndex=0),e=t.length-1;e>=0;e--)if(t[e].pos<i.y){this.endSectionIndex===this.startSectionIndex&&e+1!==this.startSubsectionIndex?this.endSubsectionIndex=e:this.endSubsectionIndex=e+1,this.localUpdate&&this.sectionNodes[this.endSectionIndex].querySelector("div.nested_contents").firstChild.insertBefore(this.target.node,t[e+1]?t[e+1].node:null);break}if(!this.enableLocalUpdate){var n=this.targetNodeClone.getBoundingClientRect().left;this.targetNodeClone.style[u]="",this.targetNodeClone.style.position="absolute",this.targetNodeClone.style.left=n;var o,s=l(window).scrollTop();0===this.endSubsectionIndex||0===this.sectionNodesContainer[this.endSectionIndex].nodes.length?(o=l(this.sectionNodes[this.endSectionIndex])[0],s+=o.getBoundingClientRect().top):i.y<0?(o=this.sectionNodesContainer[this.endSectionIndex].nodes[this.endSubsectionIndex-1].node,s+=o.getBoundingClientRect().bottom):(o=this.endSectionIndex!==this.startSectionIndex?this.sectionNodesContainer[this.endSectionIndex].nodes[this.endSubsectionIndex-1].node:this.sectionNodesContainer[this.endSectionIndex].nodes[this.endSubsectionIndex].node,
s+=o.getBoundingClientRect().bottom),this.targetNodeClone.style.top=s+"px"}"function"==typeof this.onEndSubsectionMouseupCallback&&this.onEndSubsectionMouseupCallback(this.target.node,this.targetNodeClone,this.endSubsectionIndex,this.startSubsectionIndex,this.endSectionIndex,this.startSectionIndex)},scrollIfNearEdge:function(e){this.isOnDragActive&&(e+50>l(window).height()?l("html, body").stop().animate({scrollTop:l(document).height()},6e3,"linear"):100>e?l("html, body").stop().animate({scrollTop:0},6e3,"linear"):l("html, body").stop())},getTotalMovement:function(){return{x:this.latestPosition.x-this.startPosition.x,y:this.latestPosition.y-this.startPosition.y}}}),t.ReorderableListContents=a.extend({onLoad:function(){this.separator_tooltip_content&&d.attach(this.$id("@separator"),this.separator_tooltip_content)}}),t.ReorderableListItem=a.extend({onLoad:function(){var e=this;this.emitEvent({type:r.Types.REORDERABLE_LIST_ITEM_UPDATE,payload:{}}),e.$id("@remove").click(function(){return e.remove(),
!1}),e.$id("@item").mousedown(function(){e.emitEvent({type:r.Types.REORDERABLE_LIST_ITEM_ACTIVE,payload:{}}),l(this).addClass("active").focus()})},remove:function(){this.serverCall("remove").liveMutate().send()}})}),define("app/view/topic/faq",["shared/polyfills","shared/core/component","shared/jquery","shared/events/index","view/selector","view/reorderable_list","view/modal","shared/action_log"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/jquery"),s=e("shared/events/index"),a=e("view/selector").WithServerCallMessageMixin,r=e("view/reorderable_list").ReorderableList,d=e("view/reorderable_list").ReorderableListContents,l=e("view/reorderable_list").ReorderableListItem,c=e("view/modal").Base,h=e("shared/action_log"),u=h.ActionableComponent;t.TopicFaqMainListWrapper=u.extend({onLoad:function(){this._super.apply(this,arguments),this.$id("@actionable").off("mousedown"),this.$id("@actionable").off("click")}}),t.TopicFaqSubPageMainList=r.extend({onLoad:function(){this._super.apply(this,arguments),
this.user_can_edit&&(this.setEditLink(),this.update(),this.bindClickHandler(),this.updateToc()),this.updateFixable();var e=this;this.handleEvent(s.Types.REORDERABLE_LIST_TOGGLE_EDIT,function(){e.toggleEditMode()}),this.handleEvent(s.Types.TOPIC_FAQ_HIGHLIGHT_QUESTION,function(t){if(e.is_editing){var i=["div[sid='",t.payload.section_id,"']","[oid='",t.payload.qid,"']"].join("");o(i).addClass("highlighted")}})},enableLocalUpdate:!1,resetActiveState:function(){this.$id("@wrapper").find(".active").removeClass("active")},update:function(){this.is_editing?(this.$id("@wrapper").addClass("is_editing"),this.attach()):(this.$id("@wrapper").removeClass("is_editing"),this.detach()),this.resetActiveState()},showErrorOnLiveUpdate:function(){if(this.isOnDragActive){this.isOnDragActive=!1,o("html, body").stop();var e=this;this.serverCall("show_error_on_liveupdate").success(function(){setTimeout(function(){e.detach(),e.attach()},0)}).send()}},toggleEditMode:function(){this.is_editing=!this.is_editing,this.update(),
this.resetActiveState(),this.updateFixable()},editLinkClickCallback:function(){},onEndSectionMousedownCallback:function(e,t){o(t).addClass("dragging_node node_clone_section on_drag"),e.style.height=o(t).outerHeight()+"px"},onEndSubsectionMousedownCallback:function(e,t){o(e).addClass("dragging_node node_clone on_drag"),1>t?o(e).addClass("primary_section"):o(e).addClass("sec_section")},onEndSubsectionMouseupCallback:function(e,t,i,n,s,a){if(o(t).removeClass("on_drag"),o(t).addClass("on_release"),i===n&&s===a)return void this.setToDefaultView();e=e.firstChild;var r=e.getAttribute("sid"),d=this.sectionNodes[s][0].firstChild.getAttribute("sid"),l=this;s===a?this.serverCall("move_question_in_section").kwargs({section_id:parseInt(d),qid:parseInt(e.getAttribute("oid")),new_pos:i}).liveMutate().success(function(){l.setToDefaultView()}).error(function(){l.setToDefaultView(),setTimeout(function(){l.detach(),l.attach()})}).send():this.serverCall("move_question_across_section").kwargs({section_id:parseInt(d),
old_section_id:parseInt(r),qid:parseInt(e.getAttribute("oid")),new_pos:i}).liveMutate().success(function(){l.setToDefaultView()}).error(function(){l.setToDefaultView(),setTimeout(function(){l.detach(),l.attach()})}).send()},onEndSectionMouseupCallback:function(e,t,i,n){if(o(t).removeClass("on_drag"),o(t).addClass("on_release"),1>i||i===n)return void this.setToDefaultView();if(e=e.firstChild,i!=n){var s=this;this.serverCall("move_section").kwargs({section_id:parseInt(e.getAttribute("sid")),tid:s.tid,new_pos:i}).liveMutate().success(function(){s.setToDefaultView()}).send()}},updateFixable:function(){},setEditLink:function(){},bindClickHandler:function(){},updateToc:function(){}}),t.TopicFaqMainListEditLink=u.extend({onLoad:function(){this._super.apply(this,arguments);var e=this;this.$id("@edit").on("click",function(t){t.preventDefault(),e.toggleMainListEditMode()}),this.$id("@done").on("click",function(t){t.preventDefault(),e.toggleMainListEditMode()})},toggleMainListEditMode:function(){this.emitEvent({
type:s.Types.REORDERABLE_LIST_TOGGLE_EDIT,payload:{}})}}),t.TopicFaqContents=d.extend({onLoad:function(){this._super.apply(this,arguments),this.emitEvent({type:s.Types.REORDERABLE_LIST_ITEM_UPDATE,payload:{}});var e=this;document.addEventListener("mousedown",function(){e.emitEvent({type:s.Types.REORDERABLE_LIST_ITEM_ACTIVE,payload:{}})},!0),this.handleEvent(s.Types.TOPIC_FAQ_VIEW_MORE,function(){e.$id("@contents_wrapper").addClass("show_hidden_items")})}}),t.TopicSection=n.extend({onLoad:function(){this.handleEvent(s.Types.REORDERABLE_LIST_TOGGLE_EDIT,this.focusSelector.bind(this))},focusSelector:function(){this.child("selector").$input.focus()}}),t.RecentlyAddedQuestionHighlighter=n.extend({onLoad:function(){this.emitEvent({type:s.Types.TOPIC_FAQ_HIGHLIGHT_QUESTION,payload:{section_id:this.section_id,qid:this.highlight_question}})}}),t.TopicSectionEmptyState=n.extend({onLoad:function(){var e=this;this.$id("@add_question").on("click",function(t){t.preventDefault(),e.emitEvent({type:s.Types.REORDERABLE_LIST_TOGGLE_EDIT,
payload:{}})})}});var p=!1;t.TopicFaqViewMoreLabel=n.extend({onLoad:function(){var e=this;e.$id("@view_more").click(function(t){p=!0,t.preventDefault(),e.expand()}),p&&e.expand()},expand:function(){this.emitEvent({type:s.Types.TOPIC_FAQ_VIEW_MORE,payload:{}}),this.$id("@view_more").removeClass("view_mode_only"),this.$id("@view_more").addClass("hidden")}}),t.TopicSectionQuestionItem=l.extend({remove:function(){this.createModal("remove").kwargs({oid:this.oid,section_id:this.section_id}).show()}}),t.TopicFaqRemoveQuestionWarning=c.extend({onSubmit:function(){var e=this;e.serverCall("remove").liveMutate().success(function(){e._closeModal()}).sendOnlyOnce()}}),t.TopicFaqQuestionSelector=a.extend({onLoad:function(){var e=this;e._super.apply(e,arguments),e.questionMarkInserted=!1},resultsServerCallHandler:function(){this._super.apply(this,arguments),this.$input.focus()},createNewQuestion:function(){var e=this;e.hasPendingServerCall()||(h.logPrimaryAction("WebTopicFaqMainListWrapperQuestionAdd",e.impression_target),
e.makeServerCall(e.serverCall("create_new_question").kwargs({input_text:e.query}).liveMutate()))},addExistingQuestion:function(e){var t=this;t.hasPendingServerCall()||t.makeServerCall(t.serverCall("add_existing_question").kwargs({qid:e}).liveMutate())},maybeInsertQuestionMark:function(){return"?"===this.query&&this.questionMarkInserted?(this.setQuery(""),void(this.questionMarkInserted=!1)):this.query?void(this.questionMarkInserted||null===this.query.match(/[?]$/)&&(this.questionMarkInserted=!0,this.setQuery(this.query+"?"))):void(this.questionMarkInserted=!1)},queryDidChange:function(){this._super.apply(this,arguments),this.maybeInsertQuestionMark()},resultWasSelected:function(e){switch(e.ty){case"question":this.addExistingQuestion(e.data.qid);break;case"create_question":this.createNewQuestion()}},updateServerMessage:function(e,t){if(e)this.faq_is_empty||this.setQuery("");else if(t&&t.message)return this.$id("@server_message_title").text(t.message.title),t.message.note&&this.$id("@server_message_note").text(t.message.note),
!0;return!1}})}),define("app/view/topic/flag",["shared/polyfills","view/dialog"],function(e,t,i){var n=e("view/dialog");t.EnableFAQFlagOverflowDialog=n.AddCommentDialog.extend({submitServerCall:function(e){var t=this;this.serverCall("dialog_submit_controller").kwargs(e).success(function(e){window.location.href=e,t.close()}).send()}})}),define("app/view/topic/leaderboard",["shared/polyfills","shared/core/component","shared/window_manager"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/window_manager");t.LeaderboardStatus=n.extend({onLoad:function(){var e=this;e.$id("@refresh_link").click(function(t){t.preventDefault(),e.refreshLeaderboard()})},refreshLeaderboard:function(){var e=this;e.serverCall("refresh_leaderboard").kwargs({tid:e.tid}).success(function(){e.$id("@refresh_link").addClass("completed").text("Refreshing completed. (Reloading the page)"),o.reload()}).error(function(){e.$id("@refresh_link").addClass("completed").text("Refreshing failed! Reload to retry.");
}).send(),e.$id("@refresh_link").addClass("completed").text("Refreshing started...")}}),t.AddToBlacklistMVW=n.extend({onLoad:function(){var e=this;e.$id("@add_link").click(function(t){t.preventDefault(),e.update(!1)}),e.$id("@remove_link").click(function(t){t.preventDefault(),e.update(!0)})},update:function(e){var t=this;t.serverCall("update").kwargs({tid:t.tid,is_removal:e}).success(function(){e===!0?t.$id("@remove_link").addClass("completed").text("Removed"):t.$id("@add_link").addClass("completed").text("Added")}).send()}})}),define("app/view/topic/location",["shared/polyfills","shared/core/component"],function(e,t,i){var n=e("shared/core/component").Component;t.TopicLocationPreview=n.extend({onLoad:function(){var e=this;this.$id("@enlarge_map").click(function(){return e.$id("@enlarge_map").hide(),e.$id("@wrapper").css("height","auto"),e.$id("@wrapper").css("width","auto"),e.$id("@wrapper").removeClass("mask"),e.$id("@content").removeClass("mask_content"),e.$id("@content").css("top","0px"),
e.child("topicmap").child("picker").toggleControls(!0),!1})}})}),define("app/view/topic/merge",["shared/polyfills","shared/core/component","w2.dialog","app/view/topic_selector","settings"],function(e,t,i){var n=e("shared/core/component").Component,o=e("w2.dialog"),s=e("app/view/topic_selector").TopicSelector,a=e("settings").interface_strings;t.TopicMergeSelector=s.extend({topicWasSelected:function(e){var t=function(t){var i=t.dialogComponent.child("editor");return i.isOnlyWhiteSpace()?!1:void this.serverCall("merge").kwargs({to_tid:e,from_tid:this.from_tid,comment:i.serialize()}).liveMutate().send()}.bind(this);o.createDialog(this).title(this.topic_merge_text).ok(t,a.ok).cancel(null,a.cancel).load("merge_dialog")}}),t.TopicMergeUnmerge=n.extend({onLoad:function(){var e=this;this.is_locked_for_user||this.$id("@show_merge").click(function(){return e.$id("@merge").removeClass("hidden"),e.$id("@show_merge").addClass("hidden"),e.child("selector").focus(),!1})}}),t.TopicUnmergeLink=n.extend({
onLoad:function(){var e=this;this.$id("@unmerge").click(function(){return e.serverCall("unmerge_topic").kwargs({tid:e.tid}).liveMutate().send(),!1})}})}),define("app/view/topic/topic_create",["shared/polyfills","shared/core/component","shared/window_manager","w2.dialog","view/selector"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/window_manager"),s=e("w2.dialog").Dialog,a=e("view/selector").Selector,r=e("view/selector").NavigateToResultUrlSelectorMixin;t.TopicNavigateSelector=a.extend(r),t.TopicCreateMain=n.extend({onLoad:function(){var e=this;this.submitted=!1,this.$id("@fake_editor").click(function(){return e.$id("@fake_editor_row").hide(),e.$id("@editor_row").show(),e.child("editor").focus(),!1}),this.$id("@create").click(function(){var t=e.getTopicName();if(!t||/^\s+$/.test(t)||e.submitted)return!1;e.submitted=!0;var i=e.child("editor").serialize();e.serverCall("create_topic").kwargs({topic_name:t,about:i}).success(function(e){o.sameDomainURL(e)&&(document.location=e);
}).liveMutate().send()}),this.$id("@cancel").click(function(){return e.cancelClicked(),!1})},getTopicName:function(){return this.child("selector").query},cancelClicked:function(){}}),t.TopicCreateDialog=t.TopicCreateMain.extend({cancelClicked:function(){s.dialogFor(this).close_()}})}),define("app/view/topic/topic_list",["shared/polyfills","shared/core/component","tooltip"],function(e,t,i){var n=e("shared/core/component").Component,o=e("tooltip");t.TopicListItem=n.extend({onLoad:function(){var e=this;o.attach(this.$id("@remove_topic"),this.remove_tooltip_text),this.$id("@remove_topic").click(function(t){e.serverCall("remove_topic").liveMutate().send(),t.preventDefault()}),this.$id("@remove_topic").hover(function(){e.$id("@topic_list_item").addClass("hover")},function(){e.$id("@topic_list_item").removeClass("hover")})}}),t.QuestionTopicHorizontalList=n.extend({onLoad:function(){var e=this;e.$id("@modal_link").on("click",function(t){t.preventDefault(),e.createModal("load_inner").kwargs({qid:e.qid
}).show()})}})}),define("app/view/topic/topic_ontology",["shared/polyfills","shared/core/component"],function(e,t,i){var n=e("shared/core/component").Component;t.AddTopicParent=n.extend({onLoad:function(){var e=this;this.$id("@existing_link").click(function(t){t.preventDefault(),e.$id("@existing_link").addClass("hidden"),e.$id("@existing").removeClass("hidden"),e.child("parent_selector").focus()})}}),t.AddTopicChildren=n.extend({onLoad:function(){var e=this;this.$id("@existing_link").click(function(t){t.preventDefault(),e.$id("@existing_link").addClass("hidden"),e.$id("@existing").removeClass("hidden"),e.child("child_selector").focus()})}}),t.OrganizeChildItem=n.extend({onLoad:function(){var e=this;e.$id("@remove").click(function(t){t.preventDefault(),e.serverCall("remove_topic").liveMutate().send()})},toggleInstruction:function(){this.$id("@instruction").toggleClass("hidden")}}),t.ManageParentTopicsLink=n.extend({onLoad:function(){var e=this;e.$id("@link").click(function(t){t.preventDefault(),
e.createModal("load").kwargs({tid:e.tid}).show()})}})}),define("app/view/topic/topic_redesign",["shared/polyfills","shared/core/component","shared/events/index"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/events/index");t.TopicPhotoCard=n.extend({onLoad:function(){var e=this;e.$id("@card").click(function(t){return e.onCardClick(),!1})},onCardClick:function(){this.isSelected=!this.isSelected,this.isSelected?this.select():this.deselect()},select:function(){this.$id("@card").addClass(this.selectClass),this.emitEvent({type:o.Types.TOPICS_GRID_ADD,payload:{tid:this.tid}})},deselect:function(){this.$id("@card").removeClass(this.selectClass),this.emitEvent({type:o.Types.TOPICS_GRID_REMOVE,payload:{tid:this.tid}})}})}),define("app/view/tumblr",["shared/polyfills","shared/core/component","shared/jquery"],function(e,t,i){var n=e("shared/core/component").Component;t.TumblrCallbackPage=n.extend({onLoad:function(){if(window.opener)if(this.url){var e=window.opener.require("shared/jquery");
e(window.opener.document).trigger("tumblr_oauth_approved",this.url),window.close()}else alert(this.error_message)}})}),define("app/view/tutorial",["shared/polyfills","shared/core/component"],function(e,t,i){var n=e("shared/core/component").Component;t.GoToWritepageNotif=n.extend({onLoad:function(){var e=this;window.setTimeout(function(){e.serverCall("send_notif").send()},1e3*e.delay)}})}),define("app/view/twitter",["shared/polyfills","shared/core/component","shared/cookies","shared/jquery"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/cookies");t.TwitterConnectCallbackPage=n.extend({onLoad:function(){if(o.setCookie("twitter_oauth_access_key",this.access_token.key,{path:"/twitter/"}),window.opener&&window.opener.document){var e=window.opener.require("shared/jquery");e(window.opener.document).trigger("twitter_oauth_approved",{accessToken:this.access_token,userData:this.user_data})}window.close()}})}),define("app/view/user",["shared/polyfills","shared/core/component","shared/jquery","shared/cookies","w2.dialog","settings"],function(e,t,i){
var n=e("shared/core/component").Component,o=e("shared/jquery"),s=e("shared/cookies"),a=e("w2.dialog"),r=e("settings"),d=r.interface_strings;t.UserStatusMain=n.extend({onLoad:function(){this.admin_log_list=this.$id("@admin_log_scroll_context"),this.admin_log_list.on("mouseover",function(){document.body.style.overflowY="hidden"}),this.admin_log_list.on("mouseout",function(){document.body.style.overflowY="auto"}),o(".inline_editor_create").on("click",function(){o(".admin_qtext").addClass("visible")}),o(".inline_editor_cancel_button").on("click",function(){o(".admin_qtext").removeClass("visible")})}}),t.ProfilePhoto=n.extend({toggleSuggestion:function(){}}),t.UserFollowLink=n.extend({onLoad:function(){var e=this;this.$id("@follow_user").click(function(t){e.follow(),t.preventDefault()}),this.$id("@unfollow_user").click(function(t){e.unfollow(),t.preventDefault()})},follow:function(){s.setQfeedLog(this,"UserFollow"),s.setQueryLog(this,"UserFollow"),s.setTlog({type:"UserFollow",uid:this.uid}),
this.serverCall("follow_user").liveMutate().send()},unfollow:function(){s.setQfeedLog(this,"UserUnfollow"),s.setQueryLog(this,"UserUnfollow"),s.setTlog({type:"UserUnfollow",uid:this.uid}),this.serverCall("unfollow_user").liveMutate().send()}}),t.BatchRevertControls=n.extend({onLoad:function(){var e=this;this.$id("@select_all_word").click(function(){return e.toggleCheckboxes(),"Select All"==e.$id("@select_all_word").text()?e.$id("@select_all_word").html("Select None"):e.$id("@select_all_word").html("Select All"),!1}),this.$id("@revert").click(function(){return e.batchRevert(),!1})},batchRevert:function(){var e=this,t=[];return o(".user_log_operations_to_revert input:checked").each(function(e){t.push(o(this).attr("name"))}),0===t.length?!1:(this._dialog=a.createDialog(this).title(this.dialog_title).cancel(null,d.cancel).ok(function(i){var n=i.dialogComponent,o=n.child("editor");if(!o.isOnlyWhiteSpace()){var s=o.serialize();e.serverCall("batch_revert").kwargs({revert_strings:t,comment:s}).liveMutate().send();
}}).load("batch_revert_dialog"),!1)},toggleCheckboxes:function(){var e=o(".user_log_operations_to_revert .pagedlist_hidden input:not(:disabled)").length,t=o(".user_log_operations_to_revert input:not(:disabled)").length-e,i=o(".user_log_operations_to_revert input:checked").length;t!=i?(o("input:not(:disabled)").prop("checked",!0),o(".user_log_operations_to_revert .pagedlist_hidden input").each(function(e){o(this).prop("checked",!1)})):o("input:not(:disabled)").prop("checked",!1)},getKwargs:function(e,t){return{revert_strings:e,comment:t.serialize()}}}),t.UnconfirmedEmailBlockedEditor=n.extend({onLoad:function(){var e=this;this.$id("@resend").click(function(){return e.serverCall("resend_email_confirmation").send(),!1})}})}),define("app/view/google_",["shared/polyfills","shared/core/component"],function(e,t,i){var n=e("shared/core/component").Component;t.GoogleConnectCallbackPage=n.extend({onLoad:function(){window.close()}})}),define("app/view/user/content",["shared/polyfills","shared/jquery","app/view/topic_selector","shared/window_manager","shared/core/component"],function(e,t,i){
var n=e("shared/jquery"),o=e("app/view/topic_selector").TopicSelector,s=e("shared/window_manager"),a=e("shared/core/component").Component;t.UserContentFilter=a.extend({onLoad:function(){var e=this;this.$id("@filter_links a").click(function(){var t=n(this);if(t.hasClass("selected"))return!1;var i=t.attr("data-value"),o={};o[e.data_key]=i;var a=s.makeUpdatedURL(o);return s.navigateTo(a),!1})}}),t.UserContentFilterTopics=a.extend({onLoad:function(){var e=this;this.$id("@all_topics").click(function(){return e.$id("@all_topics").hasClass("selected")||e.clearChosenTopic(),!1}),this.$id("@remove_chosen_topic").click(function(){return e.clearChosenTopic(),!1})},clearChosenTopic:function(){var e={};e[this.data_key]=null;var t=s.makeUpdatedURL(e);s.navigateTo(t)}}),t.UserContentFilterTopicSelector=o.extend({topicWasSelected:function(e,t,i,n,o){if(t){var a={};a.topic=o.data.topic_routing_name;var r=s.makeUpdatedURL(a);s.navigateTo(r)}}})}),define("app/view/user/profile",["shared/polyfills","shared/core/component","tooltip","view/editable_list"],function(e,t,i){
var n=e("shared/core/component").Component,o=e("tooltip"),s=e("view/editable_list").EditableList;t.VerificationBadge=n.extend({onLoad:function(){o.attach(this.$id("@badge"),this.tooltip_text)}}),t.NGProfileNameEditor=n.extend({onLoad:function(){this.$id("@update").click(this.updateName.bind(this)),this.$id("@edit").click(this.toggleEditor.bind(this)),this.$id("@cancel").click(this.toggleEditor.bind(this))},toggleEditor:function(){return this.$id("@initial").toggleClass("hidden"),this.$id("@editor").toggleClass("hidden"),!1},updateName:function(){var e=this.$id("@name").val();return this.serverCall("update").kwargs({name:e}).success(this.toggleEditor.bind(this)).liveMutate().send(),!1}}),t.ProfileExperienceList=s.extend({onLoad:function(){var e=this;e._super.apply(e,arguments),e.$id("@modal_link").on("click",function(t){t.preventDefault(),e.createModal("load_modal").show()})}})}),define("app/view/user/setup_",["shared/polyfills","shared/core/component","w2.dialog","shared/events/index"],function(e,t,i){
var n=e("shared/core/component").Component,o=e("w2.dialog"),s=e("shared/events/index"),a=!1;t.ChecklistStep=n.extend({onLoad:function(){var e=this,t=e.should_show_x;this.$id("@step_link").click(function(i){i.preventDefault(),a||(a=!0,e._dialog=o.createDialog(e).opt("width",500).opt("left","50%").opt("dialogClass","dialog_nux").opt("showXButton",t).title(e.dialog_title).load("get_step_dialog").close(e.onDialogClose.bind(e)))}),this.handleEvent(s.Types.NUX_DIALOG_STANDALONE_DONE,function(){e._dialog&&e._dialog.close_()})},onDialogClose:function(){a=!1,this.serverCall("mark_dialog_step_complete").send()}}),t.ChecklistLinkStep=n.extend({onLoad:function(){var e=this;this.$id("@step_link").click(function(){e.serverCall("log_link_click").send()})}})}),define("app/view/user/subscribe",["shared/polyfills","shared/core/component","view/modal"],function(e,t,i){var n=e("shared/core/component").Component,o=e("view/modal").Base;t.UserSubscribeLink=n.extend({onLoad:function(){var e=this;e.button=e.$id("@user_subscribe_button"),
e.button.click(function(t){e.isSubscribing?e.serverCall("unsubscribe").kwargs({subscribed_uid:e.uid,from_hovercard:e.getDvar("hovermenu_parent")}).liveMutate().send():e.createModal("load_inner").kwargs({should_show_subscribe:e.canSubscribe(),subscribe_to_uid:e.uid}).show(),t.preventDefault()})},canSubscribe:function(){return!this.button.hasClass("unsubscribe_button")}}),t.SubscribeConfirmModal=o.extend({onSubmit:function(){this.serverCall("change_subscription").kwargs({from_hovercard:this.getDvar("hovermenu_parent")}).liveMutate().success(this._closeModal.bind(this)).send()}})}),define("app/view/user/topics",["shared/polyfills","shared/events/index","view/modal","app/view/topic_selector","app/view/topic/edit_topic_modal"],function(e,t,i){var n=e("shared/events/index"),o=e("view/modal").Base,s=e("app/view/topic_selector").AddTopicSelector,a=e("app/view/topic/edit_topic_modal").EditTopicsList;t.EditKnowsAboutTopicsModal=o.extend({onLoad:function(){this._super.apply(this,arguments),this.topicsChanged=!1;
var e=this;this.handleEvent(n.Types.PROFILE_TOPICS_UPDATED,function(){e.topicsChanged=!0})},_closeModal:function(){this._super.apply(this,arguments),this.topicsChanged&&window.location.reload()}}),t.KnowsAboutTopicsList=a.extend({removeTid:function(){this._super.apply(this,arguments),this.emitEvent({type:n.Types.PROFILE_TOPICS_UPDATED,payload:{}})}}),t.EditKnowsAboutTopicsModalSelector=s.extend({topicWasSelected:function(){this._super.apply(this,arguments),this.emitEvent({type:n.Types.PROFILE_TOPICS_UPDATED,payload:{}})},createTopicWasSelected:function(){this._super.apply(this,arguments),this.emitEvent({type:n.Types.PROFILE_TOPICS_UPDATED,payload:{}})}})}),define("unified_view/switch",["shared/polyfills","shared/core/component"],function(e,t,i){var n=e("shared/core/component").Component;t.Switch=n.extend({onLoad:function(){this.getSwitch().on("click",this.handleClick.bind(this))},handleClick:function(){var e=this.getSwitch();e.hasClass("on")?this.toggleOff(e):this.toggleOn(e),this.toggleOnOffClasses(e);
},toggleOnOffClasses:function(e){e.toggleClass("on").toggleClass("off")},toggleOff:function(e){this.serverCall("off").kwargs(this.kwargs).liveMutate().error(function(){e.removeClass("on").addClass("off")}).send()},toggleOn:function(e){this.serverCall("on").kwargs(this.kwargs).liveMutate().error(function(){e.addClass("on").removeClass("off")}).send()},getSwitch:function(){return this.$id("@switch")}})}),define("app/view/user_settings/notifications",["shared/polyfills","shared/core/component","gating","unified_view/switch"],function(e,t,i){var n=e("shared/core/component").Component,o=e("gating"),s=e("unified_view/switch").Switch;t.DesktopPushGroupWrapper=n.extend({onLoad:function(){this.maybeLoadInner()},maybeLoadInner:function(){var e=this;"serviceWorker"in window.navigator&&o.desktop_push_notifs&&window.navigator.serviceWorker.ready.then(function(t){t.pushManager.getSubscription().then(function(t){var i=!!t;e.loadInnerComponent(i)})})},loadInnerComponent:function(e){this.serverCall("fetch_toggled_component").kwargs({
is_subscribed:e}).contentFor(this.$id("@desktop_push_group")).send()}}),t.DesktopPushToggle=s.extend({onLoad:function(){this._super.apply(this,arguments)},toggleOff:function(e){var t=this;window.navigator.serviceWorker.ready.then(function(e){e.pushManager.getSubscription().then(function(e){var i=t.getDeviceToken(e.endpoint);e.unsubscribe(),t.serverCall("off").kwargs({device_token:i}).send()})["catch"](function(e){})})},toggleOn:function(e){var t=this;window.navigator.serviceWorker.ready.then(function(e){e.pushManager.subscribe({userVisibleOnly:!0}).then(function(e){var i=t.getDeviceToken(e.endpoint);t.serverCall("on").kwargs({device_token:i}).send()})["catch"](function(e){})})},getDeviceToken:function(e){var t=e.split("/");return t[t.length-1]}})}),define("app/view/user_settings/settings",["shared/polyfills","shared/core/component"],function(e,t,i){var n=e("shared/core/component").Component;t.SettingsRow=n.extend({onLoad:function(){var e=this;this.$id(e.selectorId).on("click",function(){
e.optionSelected()})},optionSelected:function(){this.serverCall("settings_toggle").liveMutate().send()}})}),define("app/view/user_stats",["shared/polyfills","shared/core/component","shared/jquery","shared/events/index","view/hover_menu"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/jquery"),s=e("shared/events/index"),a=e("view/hover_menu").HoverMenu;t.StatsMain=n.extend({onLoad:function(){this.handleEvent(s.Types.USER_STATS_SHOW,this.show.bind(this));var e=this;this.handleEvent(s.Types.USER_STATS_UPDATE_ATTRIBUTES,function(t){e.updateAttributes(t.payload)})},show:function(){this.$id("@stats_main").removeClass("fade_in")},updateGraph:function(e){e||(e=this.content_type),this.child("graphs_section").updateGraphs(e,this.interval_type,this.oid)},updateContentList:function(){this.serverCall("render_new_content_list_wrapper").args(this.content_type,this.interval_type).contentFor(this.$id("@stats_side")).send()},updateAttributes:function(e){var t=!1,i=!1;return"oid"in e&&this.oid!=e.oid&&(this.oid=e.oid,
t=!0,4===this.content_type)?void this.updateGraph(e.content_type):("interval_type"in e&&(e.interval_type=parseInt(e.interval_type),this.interval_type!=e.interval_type&&(this.interval_type=e.interval_type,t=!0,i=!0)),"content_type"in e&&(e.content_type=parseInt(e.content_type),this.content_type!=e.content_type&&(this.content_type=e.content_type,t=!0,i=!0)),t&&this.updateGraph(),void(i&&this.updateContentList()))}}),t.Filter=a.extend({registerClickHandlers:function(){var e=this;this._super.apply(this,arguments),this.$id("@menu").on("click",".option",function(t){e.updateAttributes(o(t.target).attr("name")),e.$id("@link").text(o(t.target).text()),o(t.target).parent().siblings().removeClass("selected"),o(t.target).parent().addClass("selected"),t.preventDefault()})},updateAttributes:function(){}}),t.FilterIntervalType=t.Filter.extend({updateAttributes:function(e){this.emitEvent({type:s.Types.USER_STATS_UPDATE_ATTRIBUTES,payload:{interval_type:e}})}}),t.FilterContentType=t.Filter.extend({updateAttributes:function(e){
this.emitEvent({type:s.Types.USER_STATS_UPDATE_ATTRIBUTES,payload:{content_type:e}})}}),t.TabbedStatsNavController=n.extend({onLoad:function(){var e=this;o(".tabbed_nav_wrapper .content_type_tab").click(function(t){t.preventDefault();var i=o(this).attr("id");o(".tabbed_nav_wrapper .content_type_tab").removeClass("active"),o(this).addClass("active"),o("#"+i).addClass("active"),e.emitEvent({type:s.Types.USER_STATS_UPDATE_ATTRIBUTES,payload:{content_type:i}})})}}),t.ContentListWrapper=n.extend({onLoad:function(){var e=this.$id("@content_list_wrapper"),t=e.outerHeight(),i=o(window).height(),n=e.offset().top,a=i-n-32;a>t&&e.css("height",a),this.emitEvent({type:s.Types.USER_STATS_SHOW,payload:{}})}}),t.ContentListItem=n.extend({onLoad:function(){var e=this;this.$id("@content_external_link").click(function(e){e.stopPropagation()}),this.$id("@link").click(function(){e.$id("@link").hasClass("is_active")||(o(".is_active").removeClass("is_active"),e.$id("@link").addClass("is_active")),o(".StatsMain").hasClass("full_width_stats")&&o("html, body").animate({
scrollTop:0},1e3),e.emitEvent({type:s.Types.USER_STATS_UPDATE_ATTRIBUTES,payload:{oid:e.oid,content_type:e.content_type}})}),o(".StatsMain").hasClass("full_width_stats")&&o(".ContentListWrapper").click(function(){o(".ContentListItem.PagedListItem").hasClass("is_active")?o(".ContentListWrapper").addClass("selected_item"):o(".ContentListWrapper").removeClass("selected_item")})}}),t.RSGraph=n.extend({onLoad:function(){var e=this,t=new Rickshaw.Color.Palette({scheme:this.colors}),i=this.getHeight(),n=this.width;for(var s in this.data_json)this.data_json[s].color=t.color();o(".StatsMain").hasClass("full_width_stats")&&(i=300,n=960);var a=new Rickshaw.Graph({element:this.$id("@rsgraph").get(0),series:this.data_json,width:n,height:i,renderer:"bar",stroke:!0,min:this.min,max:this.max,xmin:this.xmin,xmax:this.xmax,interpolation:"step-after",nearestPoint:!1});a.render();var r=new Rickshaw.Graph.Axis.Y({graph:a,tickFormat:this.ypercent?function(e){return(100*e).toFixed(1)+"%"}:null});o(".StatsMain").hasClass("full_width_stats")&&(r=new Rickshaw.Graph.Axis.Y({
graph:a,element:this.$id("@y_axis").get(0)})),r.render();var d=new Rickshaw.Graph.Axis.Time({graph:a});d.render();new Rickshaw.Graph.HoverDetail({graph:a,formatter:function(t,i,n){return e.hover_text+": "+n}})},getHeight:function(){var e=o(window).height(),t=o(".graphs").offset().top,i=e-t-32;return i>this.height?i:this.height}}),t.Graphs=n.extend({onLoad:function(){var e=this,t=window.location.hash;this.metrics.forEach(function(t){e.child("headsup_section").$id("@"+t).click(function(i){var n=o(i.target);return n.hasClass("heads_up_item")||(n=n.parents(".heads_up_item")),n.hasClass("is_active")||(n.siblings(".is_active").removeClass("is_active"),n.addClass("is_active")),e.active_metric!=t&&(o(".stats_graph").hide(),e.child("stats_graphs").$id("@graph_"+t).fadeIn(500),e.active_metric=t),i.preventDefault(),!1})}),this.metrics.forEach(function(i){"#"+i==t&&e.child("headsup_section").$id("@"+i).click()})},updateGraphs:function(e,t,i){var n=this;o(".heads_up_item").first().addClass("is_active"),
this.serverCall("render_new_graphs").args(e,t,i).contentFor(this.$id("@graphs"),{useLoadingSpinner:!1}).send(),this.serverCall("get_new_counts").args(e,t,i).success(function(e){e.forEach(function(e){null===e[1]?n.child("headsup_section").$id("@"+e[0]).hide():(n.child("headsup_section").$id("@"+e[0]).show(),n.child("headsup_section").$id("@"+e[0]+">.big_num").text(e[1]),n.child("headsup_section").$id("@"+e[0]+">.num_label").text(e[2])),o(".heads_up_item").first().addClass("is_active")})}).send()}})}),define("app/view/vc",["shared/polyfills","shared/core/component","shared/jquery","w2.dialog","settings"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/jquery"),s=e("w2.dialog"),a=e("settings").interface_strings;t.RevertDialog=n.extend({onLoad:function(){this.shortcutKeyListener(),this.radioChangeListener()},radioChangeListener:function(){o("input:radio").change(function(){o("input:radio").each(function(){o(this).prop("checked")&&o(".content").html(o(this).val())})})},
shortcutKeyListener:function(){o(document).keypress(function(e){(49==e.which||50==e.which||51==e.which||52==e.which)&&(49==e.which?o("#spam").prop("checked",!0):50==e.which?o("#tos").prop("checked",!0):51==e.which?o("#vandalism").prop("checked",!0):52==e.which&&o("#other").prop("checked",!0),o("input:radio").each(function(){o(this).prop("checked")&&o(".content").html(o(this).val())}))})},validateReason:function(){return!0}}),t.OperationRevert=n.extend({onLoad:function(){var e=this;e.$id("@operation_revert").click(function(){return s.createDialog(e).title(e.dialog_title).ok(function(t){var i=t.dialogComponent.child("editor");e.serverCall("revert_revision").kwargs(e.getKwargs(i)).liveMutate().send()},e.ok_text).cancel(null,a.cancel).load("revert_dialog"),!1})},getKwargs:function(e){return{oid:this.oid,comment:e.serialize()}}}),t.AddQuestionRedirectRevertLink=n.extend({onLoad:function(){var e=this;e.$id("@revert").click(function(t){t.preventDefault(),s.createDialog(e).title(e.dialog_title).ok(function(t){
var i=t.dialogComponent.child("editor");e.serverCall("revert").kwargs({to_qid:e.to_qid,from_qid:e.from_qid,comment:i.serialize()}).liveMutate().send()},e.ok_text).cancel(null,a.cancel).load("revert_dialog")})}})}),define("app/view/write",["shared/polyfills","shared/core/component","view/fixable2","view/modal","shared/window_manager"],function(e,t,i){var n=e("shared/core/component").Component,o=e("view/fixable2"),s=e("view/modal").Base,a=e("shared/window_manager");t.WriteMain=n.extend({onLoad:function(){var e=this,t=this.$id("@left_col_inner"),i=this.$id("@left_col");e.notifBanner||i.length>0&&t.length>0&&o.makeFixable(t,{min_height:i.outerHeight()+i.offset().top,min_width:990})}}),t.RemoveAllDraftsLink=n.extend({onLoad:function(){var e=this;this.$id("@confirmation_dialogue").on("click",function(t){return e.createModal("load_inner").show(),!1})}}),t.WritePageBatchActionConfirmationModal=s.extend({onSubmit:function(){this.removeAll()},removeAll:function(){var e=this;this.serverCall("remove_all").liveMutate().success(function(t){
e._closeModal(),a.reload()}).send()}}),t.WritingListReminderSidebar=n.extend({onLoad:function(){this.serverCall("track_impression").send()}}),t.WritingListReminderButton=n.extend({onLoad:function(){var e=this;e.$id("@writing-list-reminder-complete").on("click",function(){e.serverCall("complete_answer_later_deck").send()})}}),t.WritingListReminderDismiss=n.extend({onLoad:function(){this.$id("@writing-list-reminder-dismiss").click(this.dismiss.bind(this))},dismiss:function(e){this.serverCall("dismiss_answer_later_deck").liveMutate().send(),e.preventDefault(),e.stopPropagation()}})}),define("app/view/zapdos/card",["shared/polyfills","shared/core/component","shared/jquery"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/jquery");t.CardButton=n.extend({onLoad:function(){var e=this;e.$id("@card-button-link").click(e.onClick.bind(e))},onClick:function(e){e.preventDefault();var t=this;return t.redirectUrl?window.location.href=t.redirectUrl:t.uiToHideId&&o("#"+t.uiToHideId).hide(),
t.serverCall("click").send(),!1}})}),define("login",["shared/polyfills","shared/jquery","shared/errors","shared/events/index","shared/core/component","shared/window_manager","shared/siteuri","settings","unified_view/signup/_signup","view/modal"],function(e,t,i){var n=e("shared/jquery"),o=e("shared/errors"),s=e("shared/events/index"),a=e("shared/core/component").Component,r=e("shared/window_manager"),d=e("shared/siteuri").URI,l=e("settings"),c=e("unified_view/signup/_signup").SignupContext,h=e("view/modal").Base;t.LoginButton=a.extend({onLoad:function(){this.$id("@login_link").click(function(e){var t=d("/?next="+encodeURIComponent(r.getURL()));return r.navigateTo(t.unicode()),!1})}});var u=t.InlineLogin=a.extend({onLoad:function(){var e=this;e.checkingPassword=!1,e.hasLoggedIn=!1;var t=function(t){var i=t.keyCode||t.which;13==i&&e.$id("@submit_button").click()},i=t.bind(e);e.$id("@password").keydown(i),e.$id("@email").keydown(i),e.$id("@resend_confirmation").click(function(t){return e.serverCall("resend_confirmation_link").kwargs({
email:e._email()}).success(function(){e.hideAllErrors()}).send(),!1}),e.$id("@reset_password_link").click(e.resetPasswordHandler.bind(this)),e.$id("@forgot_password_link").click(e.resetPasswordHandler.bind(this)),e.$id("@email").on("input",function(){setTimeout(function(){e.updatePreview()},10)}),e.$id("@submit_button").click(function(){return e.checkPassword(),!1}),e.$id("@submit_button").on("touchend",function(){return e.checkPassword(),!1}),e.$id("@login_link").click(function(){return e.$id("@associated").addClass("hidden"),e.$id("@alt_login_row").addClass("hidden"),e.$id("@login_form").removeClass("hidden"),e.$id("@email").focus(),!1}),this.handleEvent(s.Types.LOGIN_UPDATE_FIELDS,function(t){e.$id("@email").val(t.payload.email),e.updatePreview(),e.$id("@password").focus()});var o=this.getContext(c);o&&this.$id("@email_not_found_error a").click(function(){var e={email:this.$id("@email").val(),password:this.$id("@password").val()};return o.set("loginData",e),!1}.bind(this)),n(document).ready(function(){
e.updatePreview()})},resetPasswordHandler:function(){var e=this;return e.serverCall("reset_password").kwargs({email:e._email()}).success(function(){e.hideAllErrors()}).send(),!1},updatePreview:function(){this._updatePreviewMemCache=this._updatePreviewMemCache||{};var e=this,t=e._email(),i=e._updatePreviewMemCache,o=function(o){i[t]=o,e.customSuccessUpdatePreviewCallback?(e.customSuccessUpdatePreviewCallback(o),e.removeButtonDisabled()):(n(".usercard_big").fadeTo(1,1),e.$id("@preview").hide(),e.$id("@associated").addClass("hidden"),e.$id("@alt_login_row").addClass("hidden"),e.$id("@login_form").removeClass("hidden"),e.$id("@password").focus(),e.$id("@name").text(o.name),e.$id("@pic").attr("src",o.photo_url),e.$id("@preview").show(),e.removeButtonDisabled(),e.hideAllErrors())};return i[t]?void o(i[t]):void e.serverCall("preview_info").kwargs({email:t}).success(o).except("email_not_found",function(t){return e.$id("@preview").fadeOut(120),e.hideAllErrors(),e.showErrorOnComponent("@email_not_found_error","@email"),
e.addButtonDisabled(),!1}).except("no_email",function(t){e.$id("@preview").fadeOut(120),e.hideAllErrors(),e.addButtonDisabled()}).except("email_unconfirmed",function(t){e.$id("@preview").fadeOut(120),e.hideAllErrors(),e.showErrorOnComponent("@email_not_confirmed_error","@email"),e.removeButtonDisabled()}).except("refused",function(t){e.$id("@preview").fadeOut(120),e.hideAllErrors(),e.removeButtonDisabled()}).send()},removeButtonDisabled:function(){this.$id("@submit_button").removeClass("submit_button_disabled")},addButtonDisabled:function(){this.$id("@submit_button").addClass("submit_button_disabled")},loginKwargs:function(){var e=this.$id("@email").val(),t=this.$id("@password").val();return{email:e,password:t}},loginSuccessCallback:function(e){if(this.customSuccessLoginCallback)this.customSuccessLoginCallback(e);else{var t=e;this.hideAllErrors(),(l.uid==t||"post_reload"==l.pageMode)&&this.emitEvent(s.helpers.loginUser())}var i=this;i.addButtonDisabled()},checkPassword:function(){this.hideAllErrors();
var e=this;e.hasLoggedIn||e.checkingPassword||(e.checkingPassword=!0,e.serverCall("do_login").kwargs(e.loginKwargs()).success(function(t){e.hasLoggedIn=!0,e.checkingPassword=!1,e.loginSuccessCallback(t)}).except("email_not_found",function(){e.checkingPassword=!1,e.hideAllErrors(),e.showErrorOnComponent("@email_not_found_error","@email")}).except("incorrect_password",function(){e.checkingPassword=!1,e.hideAllErrors(),e.showErrorOnComponent("@incorrect_password_error","@password")}).except("email_unconfirmed",function(){e.checkingPassword=!1,e.hideAllErrors(),e.showErrorOnComponent("@email_not_confirmed_error","@email")}).except("banned_user",function(){e.checkingPassword=!1,e.hideAllErrors(),e.serverCall("login_user_is_banned").kwargs(e.loginKwargs()).send()}).except("too_many_attempts",function(){e.checkingPassword=!1,e.hideAllErrors(),e.serverCall("login_user_rate_limited").kwargs(e.loginKwargs()).send()}).except("password_leaked",function(){e.checkingPassword=!1,e.serverCall("load_password_leaked_dialog").kwargs({
email:e._email()}).contentFor(e.$id("@email_password_leak_error")).success(function(){e.hideAllErrors(),e.$id("@login_form .login_options").hide(),e.$id("@email_password_leak_error").show()}).send()}).except("two_factor_authentication",function(){e.checkingPassword=!1,e.hideAllErrors(),e.createModal("login_user_two_factor_authentication").kwargs({email:e._email()}).show()}).sendOnlyOnce())},_email:function(){return this.$id("@email").val()},hideAllErrors:function(){this.$id("@email_not_found_error").hide(),this.$id("@email_not_confirmed_error").hide(),this.$id("@incorrect_password_error").hide(),this.$id("@email_password_leak_error").hide(),this.$id("@email").removeClass("input_validation_error"),this.$id("@password").removeClass("input_validation_error")},showErrorOnComponent:function(e,t){this.$id(e).show(),this.$id(t+"_menu").show(),this.$id(t).addClass("input_validation_error")}});t.VerifyUser2FAModal=h.extend({onLoad:function(){this._super.apply(this,arguments)},onSubmit:function(){
var e=this;e._closeModal()}}),t.LoginSignal=a.extend({onLoad:function(e){if(!e){var t=this.uid;l.isLoggedIn&&o.logJsError("Got a login signal for logged in user: "+t),t?this.emitEvent(s.helpers.loginUser()):this.emitEvent(s.helpers.logoutUser())}}});var p=t.LoggedOutHomeHeaderInlineLogin=u.extend({onLoad:function(){this._super.apply(this,arguments),this.$id("@email").focus(),this.$id("@cancel_link").on("click",this.toggleLoginOptions.bind(this))},hideAllErrors:function(){this._super.apply(this,arguments),this.$id("@login_form .login_options").show()},showErrorOnComponent:function(e,t){this._super.apply(this,arguments),this.$id("@login_form .login_options").hide()},toggleLoginOptions:function(){return this.$id("@login_form").hide(),!0}});t.OAuthLogin=p.extend({customSuccessLoginCallback:function(e){this.hideAllErrors(),this.serverCall("get_permissions_page_response").success(function(e){window.location=e.next_url}).send()}}),t.LoginPageLoginListener=a.extend({init:function(){this._super.apply(this,arguments),
this._enabled=!0},onLoad:function(){var e=this;this.handleEvent(s.Types.LOGIN_USER,function(t){var i={};if(t.payload.pmsg&&(i.__pmsg__=t.payload.pmsg),e._enabled){var n,o=e.next,s=[];for(n in i)s.push(n+"="+encodeURIComponent(i[n]));s.length>0&&(o+=-1==o.indexOf("?")?"?":"&",o+=s.join("&")),r.navigateTo(o)}})}}),t.LeakedPasswordMessage=a.extend({onLoad:function(){var e=this;this.$id("@reset_password_link").click(function(){e.serverCall("reset_password").kwargs({email:e.email}).send()})}})}),define("shared/inline_css",["shared/polyfills","shared/cookies"],function(e,t,i){var n=e("shared/cookies"),o=function(e){window.requestAnimationFrame(function(){for(var t,i=document.getElementsByClassName(e);i.length;)t=i[0],t.parentElement.removeChild(t)})},s=function(e,t,i,s){o(e),t&&i&&n.setCookie(t,i,{expires:s})};t.loadStyleSheet=function(e,t,i,n,o){var a=document.createElement("link");a.setAttribute("rel","stylesheet"),a.setAttribute("type","text/css"),a.setAttribute("href",e),a.setAttribute("id","onLoadCss"),
a.onload=function(){s(t,i,n,o)},document.head.appendChild(a)}}),define("shared/skyfall",["shared/polyfills","shared/logging","settings","shared/errors"],function(e,t,i){function n(){return window.performance&&window.performance.now&&window.performance.timing?window.performance.timing.navigationStart+window.performance.now():Date.now()}function o(e,t,i,n){a.log("skyfall",{request_id:e,metric_type:t,metric_name:i,value:n})}function s(e){return!isNaN(parseFloat(e))&&isFinite(e)}var a=e("shared/logging"),r=e("settings"),d=e("shared/errors"),l={};t.logMarker=function(e,t){var i=r.request_id;return t||(t=n()),s(t)?void o(i,"marker",e,t):void d.logJsError("skyfall#logMarker","value for a marker must be a number: "+e+" "+t)};var c=t.logRange=function(e,t){var i=r.request_id;return t.startTime&&t.endTime?void o(i,"range",e,t):void d.logJsError("skyfall#logRange","value must have startTime and endtime")};t.logRangeStart=function(e,t){return t||(t=n()),s(t)?void(l[e]=t):void d.logJsError("skyfall#logRangeStart","value for a rangeStart must be a number.");
},t.logRangeEnd=function(e,t){if(t||(t=n()),!s(t))return void d.logJsError("skyfall#logRangeEnd","value for a rangeEnd must be a number.");var i=l[e];return i?void d.logJsError("skyfall#logRangeEnd","logRangeStart was not called for this metric: "+e):(c(e,{startTime:i,endTime:t}),void delete l[e])},t.logMeta=function(e,t){var i=r.request_id;o(i,"meta",e,t)},t.logResourceTiming=function(){var e=r.request_id;window.performance&&window.performance.getEntriesByType&&o(e,"resourceTiming","resourceTiming",window.performance.getEntriesByType("resource"))}}),define("unified_view/a2a",["shared/polyfills","shared/core/component","settings"],function(e,t,i){var n=e("shared/core/component").Component,o=e("settings"),s=o.pageIsMobile;t.A2AHeader=n.extend({onLoad:function(){if(this.scroll_to_self){var e=this.$id("@header_other").prop("offsetTop");e&&(s?window.scrollTo(0,e-75):window.scrollTo(0,e+80))}}})}),define("unified_view/util",["shared/polyfills"],function(e,t,i){t.positionForElement=function(e){
for(var t=0,i=0,n=e.offsetWidth,o=e.offsetHeight;e&&!isNaN(e.offsetLeft)&&!isNaN(e.offsetTop);)t+=e.offsetLeft-e.scrollLeft,i+=e.offsetTop-e.scrollTop,e=e.offsetParent;return{left:t,top:i,width:n,height:o}}}),define("sticky",["shared/polyfills","sticky","shared/debounce","shared/jquery"],function(e,t,i){var n=e("shared/debounce").debounce,o=e("shared/jquery"),s="sticky",a=[],r=!1;t.add=function(e){if(e.elem&&e.container){var t=o(e.elem),i=o(e.container),n=o.extend({top:0,bottom:0},e.offsets),d=t.css("position");t.addClass(s);var c=t.outerHeight(!0);t.removeClass(s);var h=o("<div>").css({height:0,margin:0,padding:0,clear:"both",display:"block"});t.before(h),a.push({elem:t,sentinelElem:h,container:i,origPadding:parseInt(i.css("padding-bottom")),origPos:d,curPos:d,offsets:n,height:c}),r||(r=!0,l())}},t.remove=function(e){for(var t=0;t<a.length;++t){var i=a[t];if(i.elem[0]===o(e)[0]){a.splice(t,1),d(i,i.origPos);break}}};var d=function(e,t){if(t!=e.curPos){e.curPos=t,e.elem.css("position",t);
var i=e.elem.outerHeight(!0);"fixed"==t?(e.sentinelElem.css("height",i),e.elem.addClass(s)):(e.sentinelElem.css("height",0),e.elem.removeClass(s),e.height=i)}},l=n(function(){for(var e=o(window),t=e.scrollTop()+e.height(),i=0;i<a.length;++i){var n=a[i];if(n.elem.is(":visible")){var s=n.container.offset().top+n.height+n.offsets.top,r=n.sentinelElem.offset().top+n.height-n.offsets.bottom;t>=s&&r>=t?d(n,"fixed"):d(n,n.origPos)}}window.requestAnimationFrame(l)},100)}),define("unified_view/action_bar/base",["shared/polyfills","shared/core/component","shared/w2.context","shared/perf","interface/settings","unified_view/util","view/hover_menu","sticky","shared/window_manager"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/w2.context"),s=e("shared/perf"),a=e("interface/settings"),r=e("unified_view/util");if(a.pageIsMobile)var d=e("mobile_app2/client"),l=e("mobile_app2/messages");else var c=e("view/hover_menu"),h=e("sticky"),u=e("shared/window_manager");t.ActionBarWeb=n.extend({
contextConstructor:function(){return o.ActionBar},onLoad:function(){this.overflowMenuShown=!1,this.overflowMenuMovedToBody=!1,this.overflowMenuLoaded=!this.lazy_loaded,this.$overflowLinkElem=this.$id("@overflow_link"),this.$overflowMenuElem=this.$id("@overflow_menu"),this.$actionBarElem=this.$id("@action_bar"),this.$overflowMenuContentsElem=this.$id("@overflow_menu_contents"),this.actionBarContext=this.getContext(o.ActionBar),this.overflowMenu=new c.ToggleableMenu({$linkElem:this.$overflowLinkElem,$menuElem:this.$overflowMenuElem,loadFunction:this.loadOverflowMenu.bind(this),alignment:"right",clickOpen:!0,shouldAttachToBody:!1}),this.is_sticky&&(this.actionBarContext.on("commentsElem",this.maybeEnableSticky.bind(this)),this.actionBarContext.on("updateSticky",this.updateSticky.bind(this))),this.userPerceivedAction=null},loadOverflowMenu:function(){var e=this;this.overflowMenuLoaded||(this.userPerceivedAction=s.startUserPerceived({vcon:this.__vcon,method:"load_menu"}),this.overflowMenuLoaded=!0,
this.serverCall("load_menu").disableDefaultUserPerceivedLogging().contentFor(this.$overflowMenuContentsElem.get(0)).success(function(){e.overflowMenu.shown===!0&&e.userPerceivedAction&&(s.finishAction(e.userPerceivedAction),e.userPerceivedAction=null)}).send())},maybeEnableSticky:function(){if(this.is_sticky){var e=this.actionBarContext.get("commentsElem"),t=this.actionBarContext.get("showComments");e&&!t?h.add({elem:this.$actionBarElem,container:this.$actionBarElem.parent().parent(),offsets:this.sticky_offsets}):h.remove(this.$actionBarElem)}},updateSticky:function(){this.is_sticky&&(this.maybeEnableSticky(),u.scrollIntoView(this.$actionBarElem))}}),t.ActionBarMobile=n.extend({contextConstructor:function(){return o.ActionBar},onLoad:function(){this.overflowMenuLoaded=!this.lazy_loaded,this.overflowMenuLoading=!1,this.overflowMenuShown=!1,this.overflowMenuShownPending=!1,this.$overflowMenuContentsElem=this.$id("@overflow_menu_contents"),this.$overflowLinkElem=this.$id("@overflow_link"),
this.$overflowLinkElem.on("click",this.showMenu.bind(this)),this.lazy_loaded&&this.loadOverflowMenu(),this.userPerceivedAction=null},loadOverflowMenu:function(){this.overflowMenuLoading||this.overflowMenuLoaded||this.$overflowMenuContentsElem.get(0)&&(this.overflowMenuLoading=!0,this.serverCall("load_menu").disableDefaultUserPerceivedLogging().contentFor(this.$overflowMenuContentsElem.get(0)).success(this.maybeShowMenu.bind(this)).send({batched:!0}))},enterLoadingState:function(){l.send("showLoadingView")},exitLoadingState:function(){l.send("hideLoadingView")},maybeShowMenu:function(){this.overflowMenuLoaded=!0,this.overflowMenuLoading=!1,this.overflowMenuShownPending&&(this.overflowMenuShownPending=!1,this.exitLoadingState(),this.showMenu())},showMenu:function(){if(this.userPerceivedAction||(this.userPerceivedAction=s.startUserPerceived({vcon:this.__vcon,method:"load_menu"})),!this.overflowMenuLoaded)return this.overflowMenuShownPending=!0,this.enterLoadingState(),void this.loadOverflowMenu();
if(!this.overflowMenuShown){this.overflowMenuShown=!0;for(var e=[],t=-1,i=this.getActionSheetItemsData(),n=0;n<i.length;n++){var o=i[n];e[o.index]=o.label,o.is_destructive&&(t=o.index)}d.supportsDestructiveActionSheetButtons()||(t=-1);var a={title:this.title,buttonTitles:e,destructiveButtonIndex:t,position:r.positionForElement(this.$overflowLinkElem.get(0))};l.send("showActionSheet",a,function(e){this.overflowMenuShown=!1;var t=parseInt(e.buttonIndex,10);0>t||setTimeout(this.selectOverflowItem.bind(this,t),100)}.bind(this)),this.userPerceivedAction&&(s.finishAction(this.userPerceivedAction),this.userPerceivedAction=null)}},getActionSheetItemsData:function(){for(var e=this.children(),t=[],i=0;i<e.length;i++){var n=e[i];n.getActionSheetItemData&&t.push(n.getActionSheetItemData()),n.getActionSheetItemsData&&Array.prototype.push.apply(t,n.getActionSheetItemsData())}return t},selectOverflowItem:function(e){for(var t=this.children(),i=0;i<t.length;i++){var n=t[i];if(n.getActionSheetItemData){
var o=n.getActionSheetItemData();if(o.index==e)return n.selectItem()}else if(n.selectOverflowItem)return n.selectOverflowItem(e)}}})}),define("unified_view/action_bar/_action_bar",["shared/polyfills","unified_view/action_bar/base","shared/events/index","shared/util","shared/scroll_animation_handler"],function(e,t,i){var n=e("unified_view/action_bar/base"),o=e("shared/events/index"),s=e("shared/util").firstScrollingParent,a=e("shared/scroll_animation_handler");t.Question=n.ActionBarWeb.extend({onLoad:function(){this._super.apply(this,arguments);var e=this;this.handleEvent(o.Types.QUESTION_EDITING_STATE,function(t){t.payload.qid==e.oid&&("edit"==t.payload.state?e.$actionBarElem.addClass("hidden"):"cancel"==t.payload.state?e.$actionBarElem.removeClass("hidden"):"request"==t.payload.state&&e.$actionBarElem.removeClass("hidden"))})}}),t.Answer=n.ActionBarWeb.extend({onLoad:function(){var e=this;e._super.apply(e,arguments)}}),t.AnswerInModal=t.Answer.extend({onLoad:function(){this._super.apply(this,arguments);
var e=s(this.$actionBarElem.get(0));a.add(e,this.update.bind(this)),this.$actionBarElem.css("margin-bottom",0)},maybeEnableSticky:function(){if(this.is_sticky){var e=this.actionBarContext.get("commentsElem"),t=this.actionBarContext.get("showComments");e&&!t?(this.stickyEnabled=!0,this.update()):(this.stickyEnabled=!1,this.$actionBarElem.css("position","static"),this.$actionBarElem.removeClass("sticky"))}},updateSticky:function(){if(this.is_sticky){this.maybeEnableSticky();var e=this.$actionBarElem.parent(),t=e.offset().top,i=window.scrollY+window.innerHeight;if(t>i){var n=this.$modalOverlay.scrollTop(),o=t-window.scrollY,s=n+o,a=Math.min(500,Math.abs(s-.5*n));this.$modalOverlay.animate({scrollTop:s},a)}}},update:function(){if(this.stickyEnabled){var e=this.$actionBarElem.parent(),t=this.$actionBarElem.outerHeight(!0),i=e.offset().top+t,n=window.scrollY+window.innerHeight;i>=n?(this.$actionBarElem.css("position","fixed"),this.$actionBarElem.addClass("sticky")):(this.$actionBarElem.css("position","static"),
this.$actionBarElem.removeClass("sticky"))}}})}),define("unified_view/ama_self_serve",["shared/polyfills","shared/core/component","unified_view/modal","shared/events/index","unified_view/button/abstract"],function(e,t,i){var n=e("shared/core/component").Component,o=e("unified_view/modal").ModalBase,s=e("shared/events/index"),a=e("unified_view/button/abstract").TwoStateButton;t.AskQuestionSelfServe=n.extend({onLoad:function(){this.$id("@add_question_button").on("click",this.openSessionModal.bind(this)),this.shouldOpenModal&&this.openSessionModal()},openSessionModal:function(){this.createModal("open_modal").kwargs({host_uid:this.host_uid}).show()}}),t.StartSessionModal=o.extend({onLoad:function(){this._super.apply(this,arguments),this.input=this.$id("@input"),this.counter=this.child("counter");var e=this;e.input.keyup(function(t){if(e.updateNotifPreview(),e.counter){var i=e.input.val().length;e.counter.updateCounter(i)}})},updateNotifPreview:function(){var e=this.input.val();this.$id("@description").text(e);
},onSubmit:function(e){var t=this.input.val(),i=this;t&&i.serverCall("start_session").kwargs({description:t}).success(function(){i.close()}).error(function(){i.close()}).liveMutate().send()}}),t.AmaSelfServeStopSessionLink=n.extend({onLoad:function(){var e=this,t=e.$id("@link");t&&t.on("click",function(){e.createModal("close_session_modal").show()})}}),t.StopSessionModal=o.extend({onLoad:function(){this._super.apply(this,arguments)},onSubmit:function(e){var t=this;t.serverCall("stop_session").success(function(){t.close()}).error(function(){t.close()}).liveMutate().send()}}),t.CurrentTakingQuestionsInfo=n.extend({onLoad:function(){var e=this;e.handleEvent(s.Types.ASK_QUESTION_MODAL_QUERY_CHANGE,function(t){""==t.payload.query||"?"==t.payload.query?e.$id("@recent_questions_header").show():e.$id("@recent_questions_header").hide()})}}),t.AmaSelfServeStartAma=n.extend({onLoad:function(){var e=this,t=e.$id("@start_button");t&&t.on("click",function(){e.createModal("open_session_modal").show()});
}}),t.RequestedQuestionsInAskModal=n.extend({onLoad:function(){var e=this;e.handleEvent(s.Types.ASK_QUESTION_MODAL_QUERY_CHANGE,function(t){""==t.payload.query||"?"==t.payload.query?e.$id("@answer_list").show():e.$id("@answer_list").hide()})}}),t.SelfServeAmaButton=a.extend({switchState:function(e){var t=this;this.pressed||t._super.apply(t,arguments)},onUnpressed:function(){}})}),define("unified_view/action_bar/answer",["shared/polyfills","shared/core/component","shared/events/index"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/events/index");t.AskQuestionPromptExtraItem=n.extend({onLoad:function(){var e=this;this.handleEvent(o.Types.ANSWER_VOTE_STATE,function(t){t.payload.aid==e.aid&&(null==t.payload.state?e.$id("@wrapper").addClass("hidden"):"upvoted"==t.payload.state&&e.$id("@wrapper").removeClass("hidden"))})}})}),define("unified_view/action_bar/blog",["shared/polyfills","shared/core/component","interface/settings"],function(e,t,i){var n=e("shared/core/component").Component,o=e("interface/settings");
if(o.pageIsMobile)var s=e("mobile_app2/messages");t.AddPostActionItem=n.extend({onLoad:function(){this.$id(this.link_id).on("click",this.handleClick.bind(this))},handleClick:function(e){e.preventDefault(),this.editor_kwargs.is_qtext2?this.createModal("load_editor_modal").kwargs({bid:this.bid}).onSubmit(function(){s.send("reload")}).show():s.send("invokeRichTextEditor",this.editor_kwargs)}})}),define("unified_view/action_bar/overflow_menu/base",["shared/polyfills","shared/core/component","interface/settings","shared/client_tracker","shared/cookies"],function(e,t,i){var n=e("shared/core/component").Component,o=e("interface/settings").pageIsMobile,s=e("shared/client_tracker"),a=e("shared/cookies");if(o)var r=e("mobile_app2/client"),d=e("mobile_app2/messages"),l=e("mobile_app2/app/view/common");t.Item=n.extend({onLoad:function(){o||this.desktopOnLoad()},desktopOnLoad:function(){this.$id("@overflow_menu_item").on("click",this.selectItem.bind(this))},selectItem:function(){return this.qfeed_log_action&&(a.setQfeedLog(this,this.qfeed_log_action),
s.track(this.qfeed_log_action,null,this)),this.onSelectAction(),this.close_on_click},onSelectAction:function(){},getActionSheetItemData:function(){return{index:this.index,label:this.label,is_destructive:this.is_destructive}},invokeRichTextEditor:function(e){r.invokeRichTextEditor(e,{onSucceed:function(){e.broadcast_key&&r.broadcastReload(e.broadcast_key)}})}}),t.WithServerCall=t.Item.extend({onSelectAction:function(){var e=this;e.serverCall("selected").success(function(t){o?e.onSuccessMobile(t):t.url&&(document.location=t.url)}).send()},onSuccessMobile:function(e){e&&e.url&&d.send("openURL",{url:e.url})}}),t.WithLink=t.Item.extend({desktopOnLoad:function(){var e=this;this.$id("@overflow_menu_item").on("click",function(t){e.onSelectAction(t)})},onSelectAction:function(){if(o){var e={url:this.url};this.target&&(e.target=this.target),d.send("openURL",e)}else document.location=this.url}}),t.WithModal=t.WithLink.extend({onSelectAction:function(e){o?this._super.apply(this,arguments):(e.preventDefault(),
this.createModal("load_modal").show())}}),t.Toggleable=t.Item.extend({onToggledOff:function(){if(!this.one_way){if(this.qfeed_log_action_on_disable&&a.setQfeedLog(this,this.qfeed_log_action_on_disable),this.tlog_action_context&&this.tlog_action_on_disable){var e={type:this.tlog_action_on_disable};e[this.tlog_action_context]=this.oid,a.setTlog(e)}this.with_server_call&&this.makeServerCall("on_toggled_off")}},onToggledOn:function(){if(this.qfeed_log_action_on_enable&&a.setQfeedLog(this,this.qfeed_log_action_on_enable),this.tlog_action_context&&this.tlog_action_on_enable){var e={type:this.tlog_action_on_enable};e[this.tlog_action_context]=this.oid,a.setTlog(e)}this.with_server_call&&this.makeServerCall("on_toggled_on")},makeServerCall:function(e){var t=this;t.serverCall(e).liveMutate().success(function(){o&&(t.broadcast_key&&r.broadcastReload(t.broadcast_key),t.should_reload&&d.send("reload"))}).send()},onSelectAction:function(){this.is_on?this.onToggledOff():this.onToggledOn()}}),t.ToggleableWithConfirmation=t.Toggleable.extend({
onToggledOn:function(){var e=this,t=e._super,i=function(){t.apply(e)};this.should_show_on_toggled_on?o?l.showConfirm({title:this.modal_kwargs.on_toggled_on_title,message:this.modal_kwargs.on_toggled_on_message,callback:i}):this.createModal("load_modal").onSubmit(i).kwargs(this.modal_kwargs).show():i()},onToggledOff:function(){var e=this,t=e._super,i=function(){t.apply(e)};this.should_show_on_toggled_off?o?l.showConfirm({title:this.modal_kwargs.on_toggled_off_title,message:this.modal_kwargs.on_toggled_off_message,callback:i}):this.createModal("load_modal").onSubmit(i).kwargs(this.modal_kwargs).show():i()}})}),define("unified_view/action_bar/overflow_menu/answer",["shared/polyfills","shared/events/index","unified_view/action_bar/overflow_menu/base"],function(e,t,i){var n=e("shared/events/index"),o=e("unified_view/action_bar/overflow_menu/base");t.ChooseCredential=o.WithServerCall.extend({onSelectAction:function(){this.createModal("selected").kwargs({aid:this.aid}).show()}}),t.Downvote=o.Toggleable.extend({
onToggledOn:function(){this.emitEvent(n.helpers.addAnswerDownvote(this.aid)),this._super.apply(this,arguments)},onToggledOff:function(){this.emitEvent(n.helpers.removeAnswerDownvote(this.aid)),this._super.apply(this,arguments)}})}),define("unified_view/action_bar/overflow_menu/comment",["shared/polyfills","interface/settings","unified_view/action_bar/overflow_menu/base"],function(e,t,i){var n=e("interface/settings").pageIsMobile,o=e("unified_view/action_bar/overflow_menu/base");if(n)var s=e("mobile_app2/messages");t.CopyLink=o.WithServerCall.extend({onSelectAction:function(){s.send("shareCopyURL",{url:this.share_url}),this._super.apply(this,arguments)}})}),define("unified_view/action_bar/overflow_menu/profile",["shared/polyfills","unified_view/action_bar/overflow_menu/base","interface/settings","shared/browser","settings"],function(e,t,i){var n=e("unified_view/action_bar/overflow_menu/base"),o=e("interface/settings").pageIsMobile,s=e("shared/browser"),a=e("settings").interface_strings;if(o)var r=e("mobile_app2/messages"),d=e("mobile_app2/app/view/common");
t.BlockUser=n.Toggleable.extend({onToggledOff:function(){var e=this,t=e._super;this.createModal("load_unblock_modal").onSubmit(function(){t.apply(e)}).kwargs({target_uid:this.target_uid}).show()},onToggledOn:function(){var e=this,t=e._super;this.createModal("load_block_modal").onSubmit(function(){t.apply(e)}).kwargs({target_uid:this.target_uid}).show()}}),t.Logout=n.Item.extend({onSelectAction:function(){var e=this;s.ios&&s.chrome?e.logout():d.showAlert({title:e.dialog_title,message:e.dialog_message,callback:function(t){0===t.buttonIndex&&e.logout()},cancelButtonTitle:e.dialog_title,otherButtonTitles:[a.cancel]})},logout:function(){var e=this;this.serverCall("logout").success(function(){r.send("disableAutoSignIn"),r.send("loginStateChanged",{isLoggedIn:!1})}).error(function(){d.showAlert({title:e.dialog_title,message:e.dialog_error_message,cancelButtonTitle:a.ok})}).send()}})}),define("unified_view/privacy",["shared/polyfills","shared/core/component","interface/settings"],function(e,t,i){
var n=e("shared/core/component").Component,o=e("interface/settings").pageIsMobile;if(o)var s=e("mobile_app2/messages");t.ToggleQuestionPrivacyJSMixin={loadConfirmationDialog:function(e){this.createModal("confirm_dialog_contents").kwargs({to_privacy:this.to_privacy,acted_inconsistent_qids:e.acted_inconsistent_qids}).onSubmit(this._setPrivacyUNSAFE.bind(this,{qid:this.qid,to_privacy:this.to_privacy,all_inconsistent_qids:e.all_inconsistent_qids})).show()},loadEmailConfirmationDialog:function(){var e=this;e.createModal("email_confirmation_dialog_contents").onSubmit(function(){e.serverCall("resend_email_confirmation").send()}).show()},_setPrivacyUNSAFE:function(e){this.serverCall("set_privacy").kwargs(e).liveMutate().success(function(){o&&s.send("reload")}).send()},trySetPrivacy:function(){var e=this;return e.serverCall("try_set_privacy").kwargs({qid:e.qid,to_privacy:e.to_privacy}).success(function(t){o&&(t||s.send("reload")),t&&"response"in t&&("privacy_change_needs_confirmation"==t.response?e.loadConfirmationDialog(t):"privacy_change_needs_email_confirmation"==t.response&&e.loadEmailConfirmationDialog());
}).liveMutate().send(),!1}};var a=n.extend(t.ToggleQuestionPrivacyJSMixin);t.QuestionAnonLink=a.extend({onLoad:function(){var e=this;this.$id("@set_privacy").on("click",function(t){t.preventDefault(),e.trySetPrivacy()})}})}),define("unified_view/action_bar/overflow_menu/question",["shared/polyfills","unified_view/action_bar/overflow_menu/base","shared/events/index","unified_view/privacy","interface/settings"],function(e,t,i){var n=e("unified_view/action_bar/overflow_menu/base"),o=e("shared/events/index"),s=e("unified_view/privacy"),a=e("interface/settings").pageIsMobile;if(a)var r=e("mobile_app2/action_view");t.PrivacyToggle=n.Toggleable.extend(s.ToggleQuestionPrivacyJSMixin).extend({onToggledOn:function(){this.trySetPrivacy()},onToggledOff:function(){this.trySetPrivacy()}}),t.AddAnonAnswer=n.WithServerCall.extend({onSuccessMobile:function(e){e&&e.url&&r.showFromUrl(e.url)}}),t.Downvote=n.Toggleable.extend({onToggledOn:function(){this.emitEvent(o.helpers.addQuestionDownvote(this.qid)),this._super.apply(this,arguments);
}}),t.EditMenu=n.Item.extend({onSelectAction:function(){this.child("menu").showMenu()}}),t.ToggleEditQuestionItem=n.Item.extend({onSelectAction:function(){this.emitEvent({type:o.Types.QUESTION_EDITING_STATE,payload:{qid:this.qid,state:"edit"}})}}),t.DisclaimerQuestion=n.Toggleable.extend({onToggledOn:function(){this.emitEvent(o.helpers.inlineEditorDisclaimer("answer",this.qid))}}),t.CantAnswer=n.Toggleable.extend({onToggledOn:function(){this._super.apply(this,arguments),this.emitEvent(o.helpers.addQuestionCantAnswer(this.qid))}})}),define("unified_view/action_bar/overflow_menu/shared",["shared/polyfills","interface/settings","shared/events/index","unified_view/action_bar/overflow_menu/base","shared/client"],function(e,t,i){var n=e("interface/settings").pageIsMobile,o=e("shared/events/index"),s=e("unified_view/action_bar/overflow_menu/base");if(n)var a=e("mobile_app2/client"),r=e("shared/client"),d=e("mobile_app2/messages");t.AddModerationFlagWrapper=s.Item.extend({desktopOnLoad:function(){},
onSelectAction:function(){this.one_click_report?this.serverCall("one_click_report").liveMutate().send():d.send("openURL",{target:"modal",url:this.url})}}),t.NativeShare=s.Item.extend({onSelectAction:function(){var e=this,t=function(t,i){switch(i){case 0:d.send("openURL",t.quora_message_data);break;case 1:d.send("shareCopyURL",t.copy_data),e.serverCall("share_log_copy_link").kwargs({data:t}).send();break;case 2:d.send("openURL",t.share_to_blog_data)}},i=r.isAndroidApp()?t:function(){};a.showNativeShareSheet(this.share_data,i)}}),t.EditItemMobile=s.Item.extend({onSelectAction:function(){this.editor_kwargs.is_qtext2?this.createModal("load_editor_modal").kwargs({oid:this.oid}).onSubmit(function(e){e.next_url&&d.send("openURL",{url:e.next_url})}).show():this.invokeRichTextEditor(this.editor_kwargs)}}),t.EditItemWeb=s.Item.extend({onLoad:function(){this._super(),this.$labelElem=this.$id("@contents"),this.bindEditorEvents()},bindEditorEvents:function(){var e=this;this.handleEvent(o.Types.INLINE_EDITOR_STATE,function(t){
t.payload.contentType==e.content_type&&t.payload.oid==e.oid&&("cancel"==t.payload.state?e.setToggled(!1):"submit"==t.payload.state?e.setToggled(!1):"submitted"==t.payload.state?e.setToggled(!1):"edit"==t.payload.state&&e.setToggled(!0))})},onSelectAction:function(){this.toggled?this.emitEvent(o.helpers.inlineEditorCancel(this.content_type,this.oid)):this.emitEvent(o.helpers.inlineEditorEdit(this.content_type,this.oid))},setToggled:function(e){this.toggled=e,this.updateLabel()},toggle:function(){this.setToggled(!this.toggled)},updateLabel:function(){var e=this.toggled?this.alternate_label:this.label;this.$labelElem.text(e)}}),t.SuggestionsPendingItemWeb=t.EditItemWeb.extend({bindEditorEvents:function(){var e=this;this.handleEvent(o.Types.INLINE_EDITOR_STATE,function(t){t.payload.contentType==e.content_type&&t.payload.oid==e.oid&&("submit"==t.payload.state?e.toggle():"toggle"==t.payload.state?e.toggle():"cancel"==t.payload.state?e.setToggled(!1):"edit"==t.payload.state&&e.setToggled(!0))});
},onSelectAction:function(){this.emitEvent(o.helpers.inlineEditorToggle(this.content_type,this.oid))}}),t.AddComment=s.Item.extend({onSelectAction:function(){this.editor_kwargs.is_qtext2?this.createModal("load_editor_modal").kwargs({oid:this.oid,comment_type:this.comment_type}).onSubmit(function(e){e.next_url&&d.send("openURL",{url:e.next_url})}).show():this.invokeRichTextEditor(this.editor_kwargs)}})}),define("unified_view/action_bar/question",["shared/polyfills","shared/core/component","shared/events/index","shared/cookies","shared/action_log","interface/settings"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/events/index"),s=e("shared/cookies"),a=e("shared/action_log"),r=e("interface/settings").pageIsMobile;if(r)var d=e("mobile_app2/client"),l=e("mobile_app2/messages");t.AddAnswerEditorWrapper=n.extend({onLoad:function(){var e=this;e.editorLoaded=!e.lazy_loaded,e.$editorWrapper=e.$id("@add_answer_editor_wrapper"),e.handleEvent(o.Types.ANSWER_TOGGLE_EDITOR,function(t){
t.payload.bundle==e.getDvar("__writeMultiFeedBundle")&&t.payload.qid==e.qid&&e.toggleEditor()})},toggleEditor:function(){!this.editorLoaded||r?this.loadEditor():this.$editorWrapper.hasClass("hidden")?this.$editorWrapper.removeClass("hidden"):this.$editorWrapper.addClass("hidden")},loadEditor:function(){r?this.loadEditorMobile():this.loadEditorDesktop()},loadEditorMobile:function(){var e=this;e.trackQuestionState(),this.editor_kwargs.is_qtext2?this.createModal("load_editor_modal").kwargs({qid:e.qid}).onSubmit(function(t){s.setTlog({type:"AddAnswer"}),s.setQfeedLog(e,"AddAnswer"),a.logPrimaryAction("MobileEditorAddAnswer",e.getDvar("impression_target")),a.logSecondaryAction("MobileEditorAddAnswer",null),l.send("openURL",{url:t.next_url})}).show():d.invokeRichTextEditor(e.editor_kwargs,{onSucceed:function(){s.setTlog({type:"AddAnswer"}),s.setQfeedLog(e,"AddAnswer"),d.broadcastReload(e.editor_kwargs.broadcast_key),a.logPrimaryAction("MobileEditorAddAnswer",e.getDvar("impression_target")),a.logSecondaryAction("MobileEditorAddAnswer",null);
},onCancel:function(){d.broadcastReload(e.editor_kwargs.broadcast_key)}})},loadEditorDesktop:function(){var e=this;e.$editorWrapper.removeClass("hidden"),e.serverCall("load_add_answer_editor").contentFor(e.$editorWrapper.get(0)).success(function(){e.editorLoaded=!0}).send()},trackQuestionState:function(){this.serverCall("track_question_state").kwargs({qid:this.qid}).send()}})}),define("unified_view/action_bar/shared",["shared/polyfills","shared/core/component","shared/w2.context"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/w2.context");t.CommentsActionItem=n.extend({onLoad:function(){this.actionBarContext=this.getContext(o.ActionBar),this.$linkElem=this.$id(this.link_id),this.$linkElem.on("mouseenter",this.loadComments.bind(this)),this.$linkElem.on("click",this.toggleComments.bind(this))},loadComments:function(){this.actionBarContext.set("loadComments",!0)},toggleComments:function(e){e.preventDefault();var t=this.actionBarContext.get("showComments");this.actionBarContext.set("showComments",!t);
}}),t.CommentsExtraItem=n.extend({onLoad:function(){this.actionBarContext=this.getContext(o.ActionBar),this.$defaultCommentsElem=this.$id(this.wrapper_id),this.$feedCommentElem=this.$id(this.feed_comment_wrapper_id),this.feed_comment_id?this.$currentWrapperElem=this.$feedCommentElem:this.$currentWrapperElem=this.$defaultCommentsElem,this.fetched=!1,this.isFirstToggle=!0,this.actionBarContext.set("commentsElem",this.$currentWrapperElem),this.actionBarContext.on("loadComments",this.loadComments.bind(this)),this.actionBarContext.on("showComments",this.toggleComments.bind(this))},loadComments:function(){this.fetched||(this.fetched=!0,this.feed_comment_id&&this.actionBarContext.get("feedCommentExpanded")||this.fetchComments())},fetchComments:function(){this.serverCall("fetch_comments").contentFor(this.$defaultCommentsElem.get(0),{parentCid:this.parent().cid}).send()},toggleComments:function(e,t){if(this.isFirstToggle&&this.feed_comment_id)if(this.isFirstToggle=!1,this.actionBarContext.get("feedCommentExpanded")){
if(!this.actionBarContext.get("feedCommentsPaged")){var i=this.actionBarContext.get("pageFeedCommentsLink");if(i)return this.actionBarContext.set("feedCommentsPaged",!0),void i.click()}}else this.$currentWrapperElem=this.$defaultCommentsElem,this.actionBarContext.set("commentsElem",this.$defaultCommentsElem),this.$id("@feed_comment_container").toggleClass("hidden",!0);this.$currentWrapperElem.toggleClass("hidden",!t),this.actionBarContext.set("updateSticky",!0)}})}),define("unified_view/action_bar/user",["shared/polyfills","shared/core/component","interface/settings","shared/client"],function(e,t,i){var n=e("shared/core/component").Component,o=e("interface/settings");if(o.pageIsMobile)var s=e("mobile_app2/client"),a=e("mobile_app2/messages"),r=e("shared/client");t.SendMessageActionItem=n.extend({onLoad:function(){var e=this;e.$id("@message_link").on("click",function(t){t.preventDefault(),e.editor_kwargs.is_qtext2?e.createModal("load_editor_modal").kwargs(e.editor_kwargs.kwargs).onSubmit(function(e){
e.next_url&&a.send("openURL",{url:e.next_url})}).show():s.invokeRichTextEditor(e.editor_kwargs,{onSucceed:function(){s.markPageAsDirty("/inbox"),s.reloadDirtyPages(),r.isIOSApp()&&a.send("dismissModal")}})})}})}),define("unified_view/activation",["shared/polyfills","shared/core/component"],function(e,t,i){var n=e("shared/core/component").Component;t.FollowPrompt=n.extend({onLoad:function(){var e=this;e.$question_follow=e.$id("@question_follow"),e.$prompt=e.$id("@prompt"),e.$question_follow.click(function(){e.$prompt.hasClass("fixed_prompt")&&setTimeout(function(){e.$prompt.addClass("slideOutDown")},500)})}})}),define("unified_view/answer/anon",["shared/polyfills","shared/core/component","shared/debounce","shared/window_manager"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/debounce").debounce,s=e("shared/window_manager");t.AnonAnswerDraftEditor=n.extend({onLoad:function(){var e=this;e.editor=e.child("editor"),e.$id("@anon_answer_editor_submit").on("click",function(){
e.submit()}),e.$id("@anon_answer_editor_save_draft").on("click",function(){e.saveDraft()});var t=o(function(){e.saveDraft()},750,{maxWait:1e4,leading:!0});e.editor.setMeaningfulChangeCallback(function(){t()})},getContent:function(){return this.editor.serialize()},submit:function(){this.serverCall("submit").kwargs({oid:this.oid,anon_content_key:this.anon_content_key,content:this.getContent()}).success(function(e){s.navigateTo(e.ans_url)}).liveMutate().sendOnlyOnce()},saveDraft:function(){this.serverCall("save_draft").kwargs({oid:this.oid,content:this.getContent()}).send()}}),t.AnonAnswerEditor=t.AnonAnswerDraftEditor.extend({saveDraft:function(){}}),t.AnonAnswerLink=n.extend({onLoad:function(){var e=this;e.$id("@anon_answer_link").on("click",function(){e.createAnonLink()})},createAnonLink:function(){this.serverCall("create_anon_link").kwargs({qid:this.qid}).success(function(e){s.navigateTo(e.anon_url)}).liveMutate().send()}})}),define("unified_view/answer/credibility",["shared/polyfills","shared/core/component","shared/events/index"],function(e,t,i){
var n=e("shared/core/component").Component,o=e("shared/events/index");t.CredibilitySection=n.extend({onLoad:function(){var e=this;this.handleEvent(o.Types.ANSWER_VOTE_STATE,function(t){if(t.payload.aid==e.aid){var i="upvoted"==t.payload.state;e.$id("@credibility_facts").toggleClass("hidden",i),e.$id("@credibility_facts_upvoted").toggleClass("hidden",!i)}})}}),t.CredibleVoterFact=n.extend({onLoad:function(){var e=this;this.$id("@social_voter_modal").on("click",function(t){return t.preventDefault(),e.createModal("load_social_voter_modal").kwargs({aid:e.aid}).show(),!1})}})}),define("unified_view/button/ads",["shared/polyfills","unified_view/button/abstract"],function(e,t,i){var n=e("unified_view/button/abstract").Button;t.LearnMoreButton=n.extend({onPressed:function(){var e=this;e.win=window.open(e.ad_url,"_blank"),e.win.focus()}})}),define("unified_view/button/downvote",["shared/polyfills","unified_view/button/abstract","shared/cookies","shared/events/index"],function(e,t,i){var n=e("unified_view/button/abstract").TwoStateButton,o=e("shared/cookies"),s=e("shared/events/index");
t.Answer=n.extend({onLoad:function(){var e=this;this._super.apply(this,arguments),this.handleEvent(s.Types.ANSWER_VOTE_STATE,function(t){if(t.payload.aid==e.aid){var i="downvoted"==t.payload.state;e.switchState(i)}})},onUnpressed:function(){this.emitEvent(s.helpers.removeAnswerDownvote(this.aid)),this._super.apply(this,arguments)},onPressed:function(){o.setQfeedLog(this,"AnswerDownvote"),o.setTlog({type:"AnswerVoteDown",aid:this.aid}),this.emitEvent(s.helpers.addAnswerDownvote(this.aid)),this._super.apply(this,arguments)}}),t.BlogPost=n.extend({onPressed:function(){o.setTlog({type:"BoardItemVoteDown",board_item_id:this.biid}),this._super.apply(this,arguments)}}),t.Question=n.extend({onLoad:function(){var e=this;this._super.apply(this,arguments),this.handleEvent(s.Types.QUESTION_VOTE_STATE,function(t){if(t.payload.qid==e.qid){var i="downvoted"==t.payload.state;e.switchState(i)}})},onPressed:function(){o.setQfeedLog(this,"QuestionDownvote"),o.setTlog({type:"QuestionDownvote",qid:this.qid}),
this.emitEvent(s.helpers.addQuestionDownvote(this.qid)),this._super.apply(this,arguments)},onUnpressed:function(){this.emitEvent(s.helpers.removeQuestionDownvote(this.qid)),this._super.apply(this,arguments)}})}),define("unified_view/button/follow",["shared/polyfills","unified_view/button/abstract","shared/cookies","shared/w2.context","interface/settings"],function(e,t,i){var n=e("unified_view/button/abstract").TwoStateButton,o=e("shared/cookies"),s=e("shared/w2.context").ActionBar,a=e("interface/settings").pageIsMobile;if(a)var r=e("mobile_app2/client");t.Topic=n.extend({onPressed:function(){o.setTlog({type:"TopicFollow",tid:this.tid}),o.setQfeedLog(this,"TopicFollow"),this._super.apply(this,arguments)},onUnpressed:function(){o.setTlog({type:"TopicUnfollow",tid:this.tid}),o.setQfeedLog(this,"TopicUnfollow"),this._super.apply(this,arguments)}}),t.Question=n.extend({onLoad:function(){var e=this;e._super.apply(this,arguments),e.actionBarContext=this.getContext(s),a&&(e.reaskBroadcastKey=r.getBroadcastKey("question",this.qid,"reasked"),
e.followBroadcastKey=r.getBroadcastKey("question",this.qid,"following"),r.registerMessageHandler(e.reaskBroadcastKey,function(t){"yes"===t.state&&e.switchState(!0)})),e.actionBarContext&&(e.actionBarContext.get("toggleRAD")&&e.$id("@nub").addClass("is_active"),e.actionBarContext.on("toggleRAD",function(t,i){i===!0?e.$id("@nub").addClass("is_active"):setTimeout(function(){e.$id("@nub").removeClass("is_active")},160)}))},onPressed:function(){o.setTlog({type:"QuestionFollow",qid:this.qid}),this.actionBarContext&&this.actionBarContext.set("toggleRAD",!0),this.$id("@nub").addClass("is_active"),a&&r.broadcastKeyUpdate(this.followBroadcastKey,"yes"),this._super.apply(this,arguments)},onUnpressed:function(){o.setTlog({type:"QuestionUnfollow",qid:this.qid}),this.actionBarContext&&this.actionBarContext.set("toggleRAD",!1),this.$id("@nub").removeClass("is_active"),a&&r.broadcastKeyUpdate(this.followBroadcastKey,"no"),this._super.apply(this,arguments)}}),t.User=n.extend({onPressed:function(){o.setTlog({
type:"UserFollow",uid:this.uid}),o.setQfeedLog(this,"UserFollow"),this._super.apply(this,arguments)},onPressedKwargs:function(){return{from_hovercard:this.getDvar("hovermenu_parent")}},onUnpressed:function(){o.setTlog({type:"UserUnfollow",uid:this.uid}),o.setQfeedLog(this,"UserUnfollow"),this._super.apply(this,arguments)},onUnpressedKwargs:function(){return{from_hovercard:this.getDvar("hovermenu_parent")}}}),t.Blog=n.extend({onPressed:function(){o.setTlog({type:"BoardFollow",bid:this.bid}),this._super.apply(this,arguments)}}),t.Session=n.extend({})}),define("unified_view/button/network",["shared/polyfills","unified_view/button/abstract","interface/settings","shared/client"],function(e,t,i){var n=e("unified_view/button/abstract").Button,o=e("interface/settings").pageIsMobile;if(o)var s=e("mobile_app2/client"),a=e("mobile_app2/messages"),r=e("shared/client");t.ActivationButton=n.extend({onPressed:function(){this.serverCall("press").success(this.onPressedSuccess.bind(this)).liveMutate().send();
},onPressedSuccess:function(e){o?r.isMobileWeb()?a.send("openURL",{url:"/"}):r.isNativeApp()&&e.supportsSwitch?(s.updateConfig(e.subdomain,e.language),a.send("dismiss")):a.send("reload"):document.location="/"}})}),define("unified_view/button/notif",["shared/polyfills","unified_view/button/abstract","shared/window_manager","interface/settings"],function(e,t,i){var n=e("unified_view/button/abstract").Button,o=e("shared/window_manager"),s=e("interface/settings").pageIsMobile;if(s)var a=e("mobile_app2/client"),r=e("mobile_app2/messages");t.Next=n.extend({onLoad:function(){s?this.onLoadMobile():this._super.apply(this,arguments)},onLoadMobile:function(){var e=this;e.nextId&&r.send("setPageAction",{rightTextButton:{title:e.text,callback:function(){r.send("setPageAction",{noRightButtons:!0}),a.broadcastKeyUpdate(a.getBroadcastKey("notification",e.nextId,"read_state"),"seen"),a.broadcastMessageToWebViews("notifRead"),r.send("setCanonicalURL",{url:e.nextUrl}),e.serverCall("track_click").success(function(){
r.send("reload")}).send()}}})},onClick:function(){var e=this;this.serverCall("track_click").liveMutate().success(function(){e.nextUrl&&o.navigateTo(e.nextUrl)}).send()}})}),define("unified_view/button/pause_ad",["shared/polyfills","unified_view/button/abstract","shared/events/index"],function(e,t,i){var n=e("unified_view/button/abstract").TwoStateButton,o=e("shared/events/index");t.Ad=n.extend({onLoad:function(){var e=this;this._super.apply(this,arguments),this.handleEvent(o.Types.ADS_MANAGER_TABLE_SORT,function(t){e.$id("@button").on("click",function(t){t.preventDefault(),e.onClick()})})}}),t.Campaign=n.extend({onLoad:function(){var e=this;this._super.apply(this,arguments),this.handleEvent(o.Types.ADS_MANAGER_TABLE_SORT,function(t){e.$id("@button").on("click",function(t){t.preventDefault(),e.onClick()})})},onClick:function(){this.dirtyURL();var e=this.pressed;e?this.onUnpressed():(this.onPressed(),this.switchState(!e))},onUnpressed:function(){this.createModal("load_enable_campaign_workflow_modal").kwargs({
campaign_id:this.campaign_id}).show()}})}),define("unified_view/button/pin",["shared/polyfills","unified_view/button/abstract","shared/cookies"],function(e,t,i){var n=e("unified_view/button/abstract").TwoStateButton,o=e("shared/cookies");t.Topic=n.extend({onPressed:function(){o.setTlog({type:"PinFollow",oid:this.oid}),o.setQfeedLog(this,"PinFollow"),this._super.apply(this,arguments)},onUnpressed:function(){o.setTlog({type:"PinFollow",oid:this.oid}),o.setQfeedLog(this,"PinUnfollow"),this._super.apply(this,arguments)}})}),define("unified_view/button/prize",["shared/polyfills","unified_view/button/abstract"],function(e,t,i){var n=e("unified_view/button/abstract").Button;t.PrizeCollectButton=n.extend({onPressed:function(){this.createModal("load_modal").kwargs({application_id:this.application_id}).show()}}),t.PrizeChooseWinnerButton=n.extend({onPressed:function(){this.createModal("load_modal").kwargs({prize_id:this.prize_id}).show()}})}),define("unified_view/button/upvote",["shared/polyfills","unified_view/button/abstract","shared/cookies","shared/events/index","settings"],function(e,t,i){
var n=e("unified_view/button/abstract").TwoStateButton,o=e("shared/cookies"),s=e("shared/events/index"),a=e("settings");t.Answer=n.extend({onLoad:function(){var e=this;this._super.apply(this,arguments),this.handleEvent(s.Types.ANSWER_VOTE_STATE,function(t){if(t.payload.aid==e.aid){var i="upvoted"==t.payload.state;e.switchState(i)}})},onPressedKwargs:function(){var e=null,t=this.getDvar("feed_story_hash");return t?e=t:a.trail&&(e=JSON.parse(a.trail).args[0]),{feed_story_hash:e}},onUnpressed:function(){this.emitEvent(s.helpers.removeAnswerUpvote(this.aid)),this._super.apply(this,arguments)},onPressed:function(){this.emitEvent(s.helpers.addAnswerUpvote(this.aid)),o.setQfeedLog(this,"AnswerUpvote"),o.setTlog({type:"AnswerVoteUp",aid:this.aid}),this._super.apply(this,arguments)}}),t.BlogPost=n.extend({onPressed:function(){o.setQfeedLog(this,"BoardItemUpvote"),o.setTlog({type:"BoardItemUpvote",board_item_id:this.biid}),this._super.apply(this,arguments)}})}),define("unified_view/button/writing_list",["shared/polyfills","unified_view/button/abstract","shared/cookies"],function(e,t,i){
var n=e("unified_view/button/abstract").TwoStateButton,o=e("shared/cookies");t.WritingList=n.extend({onPressed:function(){o.setTlog({type:"QuestionAnswerLater",oid:this.oid}),o.setQfeedLog(this,"QuestionAnswerLater"),this._super.apply(this,arguments)},onUnpressed:function(){o.setTlog({type:"UnmarkQuestionAnswerLater",oid:this.oid}),o.setQfeedLog(this,"UnmarkQuestionAnswerLater"),this._super.apply(this,arguments)}})}),define("unified_view/captcha",["shared/polyfills","shared/core/component","shared/recaptcha","shared/w2.context"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/recaptcha"),s=e("shared/w2.context").CaptchaInput,a=t.AllCaptchaInstances=[];t.CaptchaInput=n.extend({onLoad:function(){var e=this;a.push(e),e._isGrecaptchaReady=!1,e.captchaContext=e.getContext(s),e.captchaContext.set("present",!0),e.captchaContext.on("sync",function(t,i){var n=e.getCaptchaResponse();e.captchaContext.set("captchaResponse",n),e.captchaContext.set("isCaptchaFilled",""!==n),i===!0&&e.maybeAddValidationText();
}),e.renderedId=null,e.tryToRender(),e.$id("@captcha_loading").removeClass("hidden")},onUnload:function(){var e=a.indexOf(this);-1!==e&&a.splice(e,1)},getCaptchaResponse:function(){return grecaptcha.getResponse(this.renderedId)},tryToRender:function(){var e=this;o.onInit(function(){e.$id("@captcha_loading").addClass("hidden");var t=function(){e.captchaContext.set("sync",!0)},i=e.$id("@captcha"),n=i.get()[0];e.renderedId=grecaptcha.render(n.id,{sitekey:e.recaptcha_key,theme:"light",callback:t,"expired-callback":t}),e.captchaContext.set("captchaResponse","")})},maybeAddValidationText:function(){var e=this;o.onInit(function(){var t=e.getCaptchaResponse();""===t?e.$id("@captcha_validation_text").text(e.missing_captcha_text):e.$id("@captcha_validation_text").text("")})}})}),define("unified_view/carousel",["shared/polyfills","shared/core/component","shared/events/index","settings","shared/jquery","shared/client"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/events/index"),s=e("settings").pageIsMobile,a=e("shared/jquery");
if(s)var r=e("mobile_app2/messages"),d=e("shared/client");t.Carousel=n.extend({onLoad:function(){var e=this;e.num_suggestions=e.suggestions.length,e.handleCheckDismissAll(),e.container=e.$id("@container"),e.distance=0,e.oldScrollLeft=0,e.newScrollLeft=0,e.$id("@right_arrow").on("click",function(t){t.preventDefault(),e.scrollCarousel("right")}),e.$id("@left_arrow").on("click",function(t){t.preventDefault(),e.scrollCarousel("left")}),s&&d.isAndroidApp()&&e.container.on("touchstart",function(e){r.send("setSwipeEnabled",{enabled:!1})})},scrollCarousel:function(e){var t=this,i=t.getScrollAmount(),n=300;"right"==e?t.distance+=i:(t.distance-=i,t.distance<0&&(t.distance=0)),t.toggleNav(t.distance,i),t.container.animate({scrollLeft:t.distance},n,function(){t.newScrollLeft=a(this).scrollLeft(),t.oldScrollLeft==t.newScrollLeft&&(t.distance=t.oldScrollLeft),t.oldScrollLeft=t.newScrollLeft})},getScrollAmount:function(){return 486},toggleNav:function(e,t){var i=this,n=i.$id("@left_arrow"),o=i.$id("@right_arrow"),s=i.container.find(".CarouselItem").length,a=i.container.find(".CarouselItem").width(),r=s*a;
0==e?n.addClass("disabled"):n.removeClass("disabled"),e+t>r?o.addClass("disabled"):o.removeClass("disabled")},handleCheckDismissAll:function(){var e=this;e.handleEvent(o.Types.CAROUSEL_CHECK_DISMISS_ALL,function(t){-1!=e.suggestions.indexOf(t.payload.oid)&&(e.num_suggestions--,e.num_suggestions>0||e.emitEvent({type:o.Types.CAROUSEL_DISMISS_ALL,payload:{story_oid:e.story_oid}}))})}}),t.CarouselItem=n.extend({onLoad:function(){var e=this;e.carouselItemWrapper=a(e.$id("@carousel_item").get(0)).parent(),e.$id("@dismiss").on("click",function(t){t.preventDefault(),e.dismissCarouselItem()})},dismissCarouselItem:function(){var e=this;e.carouselItemWrapper.addClass("hidden"),e.serverCall("dismiss").liveMutate().success(function(){e.emitEvent({type:o.Types.CAROUSEL_CHECK_DISMISS_ALL,payload:{oid:e.oid}})}).send()}})}),define("unified_view/character_counter",["shared/polyfills","shared/core/component"],function(e,t,i){var n=e("shared/core/component").Component;t.CharacterCounter=n.extend({updateCounter:function(e){
var t=this,i=t.$id("@counter");t.left=parseInt(t.limit)-e,i.text(t.left),i.toggleClass("warning",t.left<=t.warning_limit),t.updateVisibility()},updateVisibility:function(){this.left<this.visible_on?this.show():this.hide()},show:function(){this.left<this.visible_on&&this.$id("@counter").removeClass("fade_out")},hide:function(){this.left>=0&&this.$id("@counter").addClass("fade_out")}})}),define("unified_view/components",["shared/polyfills","shared/core/component","interface/settings","shared/core/rpc"],function(e,t,i){var n=e("shared/core/component").Component,o=e("interface/settings"),s=e("shared/core/rpc").atLeastOneServerCallIsSent;t.JSTest=n.extend({onLoad:function(){var e=this;if(setTimeout(function(){s()||e.serverCall("noop").send()},2e3),o.pageIsMobile){var t=(new Date).getTime();window.addEventListener("unload",function(){var e=(new Date).getTime(),i=o.windowId,n=new Image;n.src="/api/time_on_site?start="+t+"&end="+e+"&wid="+i})}}})}),define("unified_view/cookie_warning",["shared/polyfills","shared/core/component"],function(e,t,i){
var n=e("shared/core/component").Component;t.CookieBanner=n.extend({onLoad:function(){var e=this;e.$id("@dismiss").on("click",function(){e.serverCall("dismiss").success(function(){e.onDismiss()}).send()})},onDismiss:function(){var e=this;e.$id("@banner").addClass("hidden")}})}),define("unified_view/paged_list",["shared/polyfills","shared/core/component","shared/jquery","shared/debounce","shared/events/index","shared/scroll_animation_handler","shared/loading","interface/settings","shared/perf","shared/util","shared/w2.context","shared/viewport","fx","webnode2"],function unified_view_paged_list(require,exports,module){var Component=require("shared/core/component").Component,coreComponent=require("shared/core/component"),$=require("shared/jquery"),debounce=require("shared/debounce").debounce,events=require("shared/events/index"),scrollAnimationHandler=require("shared/scroll_animation_handler"),loading=require("shared/loading"),pageIsMobile=require("interface/settings").pageIsMobile,perf=require("shared/perf"),util=require("shared/util"),context=require("shared/w2.context"),viewport=require("shared/viewport"),fx,messages,client;
pageIsMobile?(messages=require("mobile_app2/messages"),client=require("mobile_app2/client")):fx=require("fx"),exports.PagedList=Component.extend({spinner:null,resyncIndex:null,updatedHashesDuringResync:null,elementsToDelete:null,scrollHandler:null,pagingInProgress:!1,onLoad:function(){this.$paged_list=this.$id("@paged_list"),this.$wrapper=this.$id("@paged_list_wrapper"),this.$container=this.$getContainer(),this.$spinnerDisplayArea=this.$id("@spinner"),this.$resyncButton=this.$id("@resync"),this.$resyncButtonWrapper=this.$id("@resync_wrapper"),this.$resyncButton.on("click",this.resyncButtonPressed.bind(this)),this.$moreButton=this.$id("@more"),this.$moreButton.on("click",this.moreButtonPressed.bind(this));var e=this.getContext(context.HoverMenu);e?(this.inHoverMenu=!0,e.on("isShown",this.onVisiblityChange.bind(this)),this.isVisible=e.get("isShown")):(this.isVisible=!0,this.inHoverMenu=!1),this.setupPaging(),this.maybeRetargetLinks(),this.enable_mobile_hide_content&&this.mapOverNodesBelowList(function(e){
$(e).addClass("paged_list_hidden_footer")}),pageIsMobile&&client.registerMessageHandler("newStoriesButtonTapped",this.resyncButtonPressed.bind(this)),this.debug_show_resync&&this.showResyncButton()},onVisiblityChange:function(e,t){this.isVisible=t,this.isVisible||null===this.resyncIndex||this.performResync(),this.scrollHandler&&this.scrollHandler()},$getContainer:function(){var e=util.firstScrollingParent(this.$wrapper.get(0));return e===document.body&&(e=window),$(e)},getContainerBottom:function(){return this.$container.height()+this.$container.scrollTop()},setScrollHandler:function(e){null!==this.scrollHandler&&this.$container.off("scroll",this.scrollHandler),null!==e&&this.$container.on("scroll",e),this.scrollHandler=e},setupPaging:function(){this.has_more?this.auto_paged?(this.bindAutoPaging(),this.showLoading()):(this.hideLoading(),this.$moreButton.removeClass("hidden")):this.onPagingDone()},calculateAutoPageHeight:function(){var e=this.getContainerBottom(),t=this.$wrapper.height(),i=.1*(t-e)+e-100,n=t-4e3;
return Math.max(i,n)},bindAutoPaging:function(){var e=this,t=function(){var t=e.calculateAutoPageHeight();e.getContainerBottom()>=t&&e.isVisible&&(e.bindAutoPagePerfLogging(),e.requestNextPage())},i=debounce(t,200,{leading:!0,maxWait:500});e.setScrollHandler(i),pageIsMobile&&client.registerMessageHandler("tick",t),t()},bindAutoPagePerfLogging:function(){var e=this,t=debounce(function(){e.getContainerBottom()>e.$wrapper.height()&&(e.setScrollHandler(null),e.startUserPerceivedAction())},50,{leading:!0});e.setScrollHandler(t),t()},requestNextPage:function(e){var t=this;t.pagingInProgress||(t.pagingInProgress=!0,t.serverCall("get_next_page").kwargs({paged_list_parent_cid:t.parent().cid,client_hashes:t.hashes,force_cid:t.cid,domids_to_remove:t.domIdsToDelete()}).success(function(i){t.pagingInProgress=!1,t.appendPage(i,e)}).error(function(){t.pagingInProgress=!1,t.onPagingDone(!0)}).send())},domIdsToDelete:function(){for(var e=[],t=this.elementsToDelete||[],i=0;i<t.length;i++)e.push(t[i].id);return e;
},startUserPerceivedAction:function(){this.userPerceivedAction||(this.userPerceivedAction=perf.startUserPerceived({vcon:this.__vcon,method:"get_next_page"}))},finishUserPerceivedAction:function(){this.startUserPerceivedAction(),perf.finishAction(this.userPerceivedAction),this.userPerceivedAction=null},appendPage:function(data,highlight){var fragment=util.documentFragmentFromString(data.html),originalNumItems=this.hashes.length,W2,item;this.has_more=data.has_more,this.hashes=this.hashes.concat(data.hashes),this.$wrapper.get(0).appendChild(fragment),pageIsMobile||(W2=require("webnode2")),eval(data.js),null===this.scrollHandler?this.finishUserPerceivedAction():this.setScrollHandler(null),this.removeComponentsToDelete(),this.setupPaging(),this.maybeRetargetLinks(),this.handleModelUpdates(this.updatedHashesDuringResync),highlight&&!pageIsMobile&&(item=this.$wrapper.get(0).children[originalNumItems],0!==originalNumItems&&fx.highlight(item,2e3))},showLoading:function(){pageIsMobile&&client.usesNativePagingIndicator()?client.showNextPageIndicator():(null===this.spinner&&(this.spinner=loading.createLoadingDotsElement(),
this.$spinnerDisplayArea.append(this.spinner)),this.$spinnerDisplayArea.removeClass("hidden"))},hideLoading:function(){pageIsMobile&&client.usesNativePagingIndicator()?client.hideNextPageIndicator():this.$spinnerDisplayArea.addClass("hidden")},onPagingDone:function(e){this.hideLoading(),e&&(this.$moreButton.removeClass("hidden"),this.resyncIndex&&window.location.href.reload()),this.enable_mobile_hide_content&&this.mapOverNodesBelowList(function(e){$(e).removeClass("paged_list_hidden_footer")})},handleModelUpdates:function(e){if(e){if(null!==this.elementsToDelete)return void(this.updatedHashesDuringResync=e);this.updatedHashesDuringResync=null;var t=firstNewItemIndex(this.hashes,e);return null===t?void this.hideResyncButton():t>=this.hashes.length?(this.has_more===!1&&(this.has_more=!0,this.setupPaging()),void this.hideResyncButton()):(this.resyncIndex=t,this.resyncIndexIsBelowViewport()?void this.performResync(!1):void this.showResyncButton())}},$getChildAtIndex:function(){var e=this.$wrapper.get(0),t=e.children[this.resyncIndex];
return $(t)},resyncIndexIsBelowViewport:function(){if(!this.isVisible)return!0;if(null===this.resyncIndex)return!1;var e=this.$getChildAtIndex(this.resyncIndex);return e.offset().top>this.getContainerBottom()},performResync:function(e){if(null!==this.resyncIndex){if(pageIsMobile||this.emitEvent({type:events.Types.LIVENODE_LOADING_SPINNER,payload:{show:!0}}),this.$paged_list.addClass("resyncing"),e&&this.resyncIndex<this.hashes.length){var t=this.$getChildAtIndex(this.resyncIndex),i=0;this.$container.get(0)!==window&&(i=this.$container.offset().top);var n=200,o=t.offset().top-i-n;this.$container.scrollTop(o)}this.markComponentsToDelete(this.resyncIndex),this.resyncIndex=null,this.requestNextPage(!0),this.hideResyncButton()}},showResyncButton:function(){var e=this,t=e.$container.get(0);if(pageIsMobile)return void messages.send("updateNewStoriesButton",{visible:!0,text:e.resync_button_text});if(!e.inHoverMenu){e.$resyncButtonWrapper.removeClass("hidden");var i=function(i){var n,o,s;t===window?(n=viewport.siteHeaderHeight(),
o=e.$wrapper.offset().top):(n=0,o=0),s=o+e.$wrapper.height()-2*e.$resyncButton.height(),i+=n,o>i?e.$resyncButtonWrapper.css("position","absolute").css("top",0).css("width","100%"):i>s?e.$resyncButtonWrapper.css("position","absolute").css("top",s-o).css("width","100%"):e.$resyncButtonWrapper.css("position","fixed").css("top",n).css("width",e.$wrapper.width())};e.resyncButtonScrollCallback=scrollAnimationHandler.add(t,i)}},hideResyncButton:function(){if(!this.debug_show_resync){if(pageIsMobile)return void messages.send("updateNewStoriesButton",{visible:!1});this.resyncButtonScrollCallback&&(this.$resyncButtonWrapper.addClass("hidden"),this.$container.off("scroll",this.resyncButtonScrollCallback))}},resyncButtonPressed:function(){this.performResync(!0)},markComponentsToDelete:function(e){this.hashes=this.hashes.slice(0,e);var t,i,n=this.$wrapper.get(0),o=n.children;for(this.elementsToDelete=[],i=e;i<o.length;i++)t=o[i],this.elementsToDelete.push(t)},removeComponentsToDelete:function(){var e,t,i,n=this.$wrapper.get(0),o=this.elementsToDelete||[];
for(this.elementsToDelete=null,i=0;i<o.length;i++)e=o[i],t=coreComponent.getComponentFromElement(e),t&&coreComponent.unloadComponent(t.cid),n.removeChild(e);o&&(pageIsMobile||this.emitEvent({type:events.Types.LIVENODE_LOADING_SPINNER,payload:{show:!1}}),this.$paged_list.removeClass("resyncing"))},moreButtonPressed:function(){this.$moreButton.addClass("hidden"),this.showLoading(),this.requestNextPage()},maybeRetargetLinks:function(){this.retarget_links&&this.$id('@paged_list_wrapper a:not([href^="#"])').each(function(){"feed_modal"!=this.target&&$(this).attr("target","_blank")})},mapOverNodesBelowList:function(e){for(var t=this.$spinnerDisplayArea.get(0).nextSibling;t;)if(e(t),t.nextSibling)t=t.nextSibling;else{if(!t.parentNode||"main_page_wrapper"==t.parentNode.id)break;t=t.parentNode.nextSibling}},forceResync:function(e){e=e?e:0,this.resyncIndex=e,this.setScrollHandler(null),this.performResync(!0)}}),exports.InvisibleUpdater=Component.extend({onLoad:function(e){e||this.parent().handleModelUpdates(this.hashes);
}});var firstNewItemIndex=exports.firstNewItemIndex=function(e,t){var i,n={};for(i=0;i<e.length;i++)n[e[i]]=!0;for(i=0;i<t.length;i++)if(!n[t[i]])return i;return null}}),define("unified_view/form",["shared/polyfills","shared/core/component","interface/settings","shared/client"],function(e,t,i){var n,o,s,a=e("shared/core/component").Component,r=e("interface/settings").pageIsMobile;r&&(n=e("shared/client"),o=e("mobile_app2/client"),s=e("mobile_app2/messages")),t.Form=a.extend({onLoad:function(){var e=this;e.autofocusField(),e.should_render_submit_button&&e.$id("@submit").on("click",function(t){t.preventDefault(),e.submitForm()})},autofocusField:function(){var e=this,t=function(){e.children().forEach(function(t){t.getFieldId&&t.getFieldId()==e.field_id_to_autofocus&&t.whenOnLoaded(function(){t.focusField()})})};e.field_id_to_autofocus&&(r?o.registerMessageHandler("pageReadyComplete",function(){t()}):t())},getServerCallKwargsFromForm:function(){var e={};return this.children().forEach(function(t){
if(t.getFieldId){var i=t.getFieldId();e[i]=t.getValue()}}),e},validateForm:function(){var e=!0;return this.children().forEach(function(t){t.isSubmittable&&(t.isSubmittable()?t.removeRequiredIndicator():(t.addRequiredIndicator(),e=!1))}),e===!0&&(e=this.validateFormExtra(e)),e},validateFormExtra:function(e){return e},clearForm:function(){this.children().forEach(function(e){e.clearValue&&e.clearValue()})},submitForm:function(){this.validateForm()?this._submitForm():this.onSubmitFailure()},_submitForm:function(){var e=this;e.$id("@submit").addClass("disabled"),e.serverCall("submit").kwargs(e.getServerCallKwargsFromForm()).success(function(){e.onSubmitSuccess(),e.$id("@submit").removeClass("disabled")}).error(function(){e.onSubmitFailure(),e.$id("@submit").removeClass("disabled")}).liveMutate().send()},registerOnSubmitSuccess:function(e){this._callbackSuccess=e},registerOnSubmitFailure:function(e){this._callbackFailure=e},onSubmitSuccess:function(){this._callbackSuccess&&this._callbackSuccess(),
this.should_clear_form_after_submitting&&this.clearForm()},onSubmitFailure:function(){this._callbackFailure&&this._callbackFailure()}}),t.FormField=a.extend({onLoad:function(){var e=this;e.$field=e.$id("@"+e.field_id),e.$field.on("keydown",function(){e.onKeydown()})},onKeydown:function(){this.removeRequiredIndicator()},getFieldId:function(){return this.field_id},focusField:function(){this.$field.focus(),r&&n.isAndroidApp()&&s.send("showKeyboard")},getValue:function(){return this.$field.get(0).value},setValue:function(e){this.$field.get(0).value=e},clearValue:function(){this.setValue("")},isValid:function(){return this.$field.get(0).value.length>0},addRequiredIndicator:function(){this.$field.addClass("required_indicator"),this.$id("@error_tooltip").removeClass("hidden")},removeRequiredIndicator:function(){this.$field.removeClass("required_indicator"),this.$id("@error_tooltip").addClass("hidden")},isSubmittable:function(){return this.required?this.isValid():!0}}),t.FormFieldInput=t.FormField.extend({
onKeydown:function(){if(this._super.apply(this,arguments),this.counter=this.child("counter"),this.counter){var e=this.$field.get(0).value.length;this.counter.updateCounter(e)}}}),t.FormFieldSelect=t.FormField.extend({setValue:function(e){this.$field.get(0).value=e[0]},clearValue:function(){var e=this.options[this.default_selection];return e?this.setValue(e):void 0}}),t.FormFieldCheckbox=t.FormField.extend({onLoad:function(){if(this._super.apply(this,arguments),r){var e=this;e.$id("@label").on("click",function(){e.$id("@wrapper").hasClass("is_checked")?e.$field.get(0).checked=!1:e.$field.get(0).checked=!0,e.$id("@wrapper").toggleClass("is_checked")})}},getValue:function(){return this.$field.get(0).checked},setValue:function(e){"true"==e||"checked"==e?this.$field.get(0).setAttribute("checked"):this.$field.get(0).removeAttribute("checked")},clearValue:function(){this.setValue(!1)}}),t.FormFieldTopicSelector=t.FormField.extend({onLoad:function(){this._super.apply(this,arguments),this.$value=this.$id("@value");
var e=this;this.child("selector").onTopicSelected(function(t,i){e.setInput(t),e.setValue(i)}),e.$id("@remove_topic").on("click",function(t){t.preventDefault(),e.clearInput()})},setInput:function(e){var t=this,i=document.createElement("span");i.className="TopicName",i.textContent=e,t.$field.get(0).appendChild(i),t.$field.removeClass("hidden"),t.$id("@remove_topic").removeClass("hidden"),t.$id("@selector").addClass("hidden")},clearInput:function(){var e=this;e.$field.addClass("hidden"),e.$id("@remove_topic").addClass("hidden"),e.$id("@selector").removeClass("hidden"),e.$field.get(0).innerHTML="",e.setValue("")},focusField:function(){this.child("selector").focus()},getValue:function(){return parseInt(this.$value.get(0).value)},setValue:function(e){this.$value.get(0).value=e},clearValue:function(){this.clearInput()},isValid:function(){var e=this.getValue();return e&&""!==e},addRequiredIndicator:function(){this.$id("@selector").addClass("required_indicator"),this.$id("@error_tooltip").removeClass("hidden");
},removeRequiredIndicator:function(){this.$id("@selector").removeClass("required_indicator"),this.$id("@error_tooltip").addClass("hidden")}}),t.FormFieldQTextEditor=t.FormField.extend({focusField:function(){this.child("content").focus()},getValue:function(){return this.child("content").serialize()},clearValue:function(){this.child("content").clear()},isValid:function(){return!this.child("content").isEmpty()}})}),define("unified_view/credential",["shared/polyfills","shared/core/component","interface/settings","unified_view/modal","unified_view/paged_list","unified_view/form","settings","shared/events/index","shared/client","view/hover_menu"],function(e,t,i){var n=e("shared/core/component").Component,o=e("interface/settings").pageIsMobile,s=e("unified_view/modal").ModalBase,a=e("unified_view/paged_list").PagedList,r=e("unified_view/modal").FormModal,d=e("unified_view/form").Form,l=e("settings").interface_strings,c=e("shared/events/index"),h=e("shared/client");if(o)var u=e("mobile_app2/client"),p=e("mobile_app2/app/view/common"),f=e("mobile_app2/messages");else var _=e("view/hover_menu");
t.CredentialsModal=s.extend({onLoad:function(){var e=this;e._super.apply(e,arguments),o||e.handleEvent(c.Types.CREDENTIAL_ADD_FORM_VISIBILITY,function(){e.$id("@wrapper").toggleClass("hidden")})}}),t.ChooseCredentialModal=t.CredentialsModal.extend({onSubmit:function(){if(o){var e=this;e.$id("@edit_wrapper").hasClass("hidden")?e.toggleNavigationButton(!0):e.toggleNavigationButton(!1),this.$id("@choose_wrapper").toggleClass("hidden"),this.$id("@edit_wrapper").toggleClass("hidden")}else this._super.apply(this,arguments)},toggleNavigationButton:function(e){var t=this,i=l.edit;e&&(i=t.choose_text),h.isNativeApp()?f.send("setPageAction",{rightTextButton:{title:i,callback:t._mobileOnSubmit.bind(t)}}):t.$id("@nav").text(i)}}),t.CredentialsListBase=a.extend({onLoad:function(){var e=this;e._super.apply(e,arguments),e.handleEvent(c.Types.CREDENTIAL_ADDED,function(){e.forceResync()}),e.handleEvent(c.Types.CREDENTIAL_DELETED,function(){e.forceResync()})}}),t.CredentialsListItemBase=n.extend({onLoad:function(){
o?this.onLoadMobile():this.onLoadDesktop()},onLoadMobile:function(){},onLoadDesktop:function(){var e=this;if(e.is_viewer){e.editWrapperLoaded=!1;var t=e.$id("@edit_wrapper_inner").get(0);t&&e.serverCall("get_edit_wrapper").contentFor(t).success(function(){var t=e.child("form");t&&e.child("form").registerOnSubmitSuccess(function(){e.toggleState()}),e.$id("@edit_wrapper .toggle_link").on("click",function(t){e.toggleState(),t.preventDefault()}),e.editWrapperLoaded=!0}).send({batched:!0}),e.$id("@view_wrapper .toggle_link").on("click",function(t){e.toggleState(),t.preventDefault(),t.stopPropagation()})}},toggleState:function(){this.$id("@view_wrapper").toggleClass("hidden"),this.$id("@edit_wrapper").toggleClass("hidden"),this.editWrapperLoaded===!0&&(this.$id("@edit_wrapper").hasClass("hidden")||this.child("form").autofocusField())}}),t.ChooseCredentialListItem=t.CredentialsListItemBase.extend({onLoadMobile:function(){var e=this;e.is_viewer&&!e.is_bad_credential&&(e.$id("@list_item").on("click",function(){
e.$id("@list_item").hasClass("is_checked")||e.emitCredentialChosen()}),e.handleEvent(c.Types.CREDENTIAL_CHOSEN,function(t){t.payload.credential_id==e.credential_id?(e.$id("@list_item").addClass("is_checked"),e.setCredentialOnQuestion()):e.$id("@list_item").removeClass("is_checked")}))},onLoadDesktop:function(){var e=this;e._super.apply(e,arguments),e.$id("@view_wrapper").on("click",function(){e.$id("@list_item").hasClass("is_checked")||e.emitCredentialChosen()}),e.handleEvent(c.Types.CREDENTIAL_CHOSEN,function(t){t.payload.credential_id==e.credential_id?(e.setCredentialOnQuestion(),e.$id("@list_item").addClass("is_checked"),e.$id("@radio").get(0).checked=!0):(e.$id("@list_item").removeClass("is_checked"),e.$id("@radio").get(0).checked=!1)})},emitCredentialChosen:function(){var e=this;e.emitEvent({type:c.Types.CREDENTIAL_CHOSEN,payload:{credential_id:e.credential_id}})},setCredentialOnQuestion:function(){var e=this;e.serverCall("set_credential_on_question").kwargs({qid:e.qid,credential_id:e.credential_id
}).liveMutate().send()}}),t.EditCredentialListItem=t.CredentialsListItemBase.extend({onLoadMobile:function(){var e=this;e.is_viewer&&e.$id("@list_item").on("click",function(){e.createModal("load_modal").kwargs({category:e.category,credential_id:e.credential_id}).show()})}}),t.AddCredentialsModal=r.extend({onLoad:function(){var e=this;e._super.apply(e,arguments),e.handleEvent(c.Types.CREDENTIAL_DELETED,function(t){t.payload.credential_id==e.credential_id&&(e.submit(),e.close())})},registerOnFormSubmitSuccessExtra:function(){this.emitEvent({type:c.Types.CREDENTIAL_ADDED,scope:c.scope.GLOBAL,payload:{}})}}),t.AddCredentialsForm=d.extend({validateFormExtra:function(e){var t,i,n=this;return this.children().forEach(function(e){if(e.getFieldId){var n=e.getFieldId();"start_year"==n?t=e.getValue():"end_year"==n&&(i=e.getValue())}}),t&&i&&t>i&&(e=!1,o?p.showAlert({title:n.dialog_title,message:n.dialog_message,cancelButtonTitle:l.ok}):window.alert(n.dialog_title_message)&&n.deleteCredential()),e}}),
t.AddCredentialsModalLink=n.extend({onLoad:function(){o&&this.onLoadMobile()},onLoadMobile:function(){var e=this;e.$id("@create_modal_link").on("click",function(t){t.preventDefault(),u.showActionSheet({title:e.action_sheet_title,buttonTitles:e.action_sheet_options,destructiveButtonIndex:-1,callback:function(t){if(4!==t){var i=e.category_enums[t];e.loadModal(i)}}})})},loadModal:function(e){this.createModal("load_modal").kwargs({category:e,aid:this.aid}).show()}}),t.LifeExperienceExamples=n.extend({onLoad:function(){var e=this,t=0;e.interval=setInterval(function(){e.$id("@example").get(0).textContent=e.examples[t],e.$id("@example").removeClass("animate_out"),e.$id("@example").addClass("animate_in"),setTimeout(function(){e.$id("@example").removeClass("animate_in"),e.$id("@example").addClass("animate_out")},2800),t==e.examples.length-1?t=0:t++},3e3)},onUnload:function(){clearInterval(this.interval)}}),t.AddCredentialDropdown=n.extend({onLoad:function(){var e=this;e.overflowMenu=new _.ToggleableMenu({
$linkElem:this.$id("@add_link"),$menuElem:this.$id("@overflow_menu"),loadFunction:function(){},alignment:"left",clickOpen:!0,useCssPositioning:!0}),e.default_category?e.emitEvent({type:c.Types.CREDENTIAL_ADD_FORM_VISIBILITY,payload:{category:e.default_category}}):e.serverCall("get_add_forms").contentFor(e.$id("@add_forms").get(0)).send({batched:!0}),e.$id("@overflow_menu .js_category_link").on("click",function(){var t=this.getAttribute("data-category");e.emitEvent({type:c.Types.CREDENTIAL_ADD_FORM_VISIBILITY,payload:{category:t}}),e.serverCall("log_open_add_edit").kwargs({category:t}).send()}),e.handleEvent(c.Types.CREDENTIAL_ADD_FORM_VISIBILITY,function(){e.$id("@add_link").toggleClass("hidden")})}}),t.AddCredentialDropdownForms=n.extend({onLoad:function(){var e=this;e.handleEvent(c.Types.CREDENTIAL_ADD_FORM_VISIBILITY,function(t){var i=t.payload.category;e.$id("@wrapper_"+i).toggleClass("hidden"),e.child("form_"+i).autofocusField()}),e.categories.forEach(function(t){e.child("form_"+t).registerOnSubmitSuccess(function(){
var i=e.child("form_"+t);i&&(i.clearForm(),e.emitCredentialAddFormVisibility(t),this.emitEvent({type:c.Types.CREDENTIAL_ADDED,scope:c.scope.GLOBAL,payload:{}}))}),e.$id("@wrapper_"+t+" .toggle_link").on("click",function(i){e.child("form_"+t).clearForm(),e.emitCredentialAddFormVisibility(t),i.preventDefault()})})},emitCredentialAddFormVisibility:function(e){this.emitEvent({type:c.Types.CREDENTIAL_ADD_FORM_VISIBILITY,payload:{category:e}})}}),t.CredentialModalLink=n.extend({onLoad:function(){var e=this;e.$id("@modal_link").on("click",function(t){t.preventDefault(),e.createModal("load_modal").kwargs(e.getKwargs()).show()})},getKwargs:function(){return{}}}),t.EditCredentialsModalLink=t.CredentialModalLink.extend({getKwargs:function(){return{target_uid:this.target_uid}}}),t.ChooseCredentialModalLink=t.CredentialModalLink.extend({getKwargs:function(){return{target_uid:this.target_uid,qid:this.qid,aid:this.aid}}}),t.EditCredentialModalLink=t.CredentialModalLink.extend({getKwargs:function(){return{
target_uid:this.target_uid,category:this.category}}}),t.DeleteCredentialLink=n.extend({onLoad:function(){o?this.onLoadMobile():this.onLoadDesktop()},onLoadMobile:function(){var e=this;e.$id("@link").on("click",function(t){t.preventDefault(),p.showAlert({title:e.dialog_title,message:e.dialog_message,cancelButtonTitle:l.cancel,otherButtonTitles:[e.dialog_button_text],callback:function(t){1==t.buttonIndex&&e.deleteCredential()}})})},onLoadDesktop:function(){var e=this;e.$id("@link").on("click",function(t){t.preventDefault(),window.confirm(e.dialog_title_message)&&e.deleteCredential()})},deleteCredential:function(){var e=this;e.serverCall("delete_credential").kwargs({credential_id:e.credential_id}).success(function(){e.emitEvent({type:c.Types.CREDENTIAL_DELETED,scope:c.scope.GLOBAL,payload:{credential_id:e.credential_id}})}).send()}}),t.SetDefaultCredentialLink=n.extend({onLoad:function(){o?this.onLoadMobile():this.onLoadDesktop()},onLoadMobile:function(){var e=this;e.$id("@link").on("click",function(t){
t.preventDefault(),p.showAlert({title:e.dialog_title,message:e.dialog_message,cancelButtonTitle:l.cancel,otherButtonTitles:[e.dialog_button_text],callback:function(t){1==t.buttonIndex&&e.setDefaultCredential()}})})},onLoadDesktop:function(){var e=this;e.$id("@link").on("click",function(t){t.preventDefault(),window.confirm(e.dialog_title_message)&&e.setDefaultCredential()})},setDefaultCredential:function(){var e=this;e.serverCall("set_default").kwargs({credential_id:e.credential_id}).send()}}),t.EditFreeformCredentialModal=s.extend({onLoad:function(){var e=this;e._super.apply(e,arguments),e.child("form").registerOnSubmitSuccess(function(){e.submit(),e.close()}),e.$id("@list_item .toggle_link").on("click",function(t){t.preventDefault(),e.submit(),e.close()})}})}),define("shared/datetime",["shared/polyfills","settings"],function(e,t,i){var n=e("settings"),o=t.SECOND=1e3,s=t.MINUTE=60*o,a=t.HOUR=60*s,r=t.DAY=24*a,d={en:{monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],
timeAbbrevs:["d","h","m","s"],justNow:"just now",yesterday:"yesterday",agoTemplate:"{time} ago",dayMonthTemplate:"{day} {month}",dayMonthYearTemplate:"{day} {month} {year}"},es:{monthNames:["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sept.","oct.","nov.","dic."],timeAbbrevs:["d","h","m","s"],justNow:"ahora mismo",yesterday:"ayer",agoTemplate:"Hace {time}",dayMonthTemplate:"{day} {month}",dayMonthYearTemplate:"{day} {month} {year}"}},l=function(){return d[n.interfaceLanguage]},c=function(e,t){return e.replace(/\{([^{}]*)\}/g,function(e,i){return t[i]})},h=function(e,t){var i,n=new Array(4),d=[r,a,s,o],c=l().timeAbbrevs;for(i=0;i<n.length;++i)n[i]=Math.floor(e/d[i]),e-=n[i]*d[i];for(var h=0;h<n.length&&!n[h];)++h;for(var u=n.length-1;u>=0&&d[u]<t;)--u;var p="";for(i=h;u>=i;++i)p+=n[i].toString()+c[i],u>i&&(p+=" ");return p};t.dayStr=function(e){var t=new Date(e/1e3);return c(l().dayMonthYearTemplate,{day:t.getDate().toString(),month:l().monthNames[t.getMonth()],year:t.getFullYear()
})},t.timestampStr=function(e,t){var i,d=new Date,u=new Date(e/1e3),p=d.getTime()-u.getTime();if(0>p)return p>=-2*o?l().justNow:u.toLocaleDateString(n.interfaceLanguage,{weekday:"short",year:"numeric",month:"short",day:"numeric"});if(t&&(i=h(p,t)))return c(l().agoTemplate,{time:i});if(s>p)return l().justNow;if(a>p){var f=Math.floor(d.getTime()/s)-Math.floor(u.getTime()/s);return i=f.toString()+l().timeAbbrevs[2],c(l().agoTemplate,{time:i})}if(12*a>p||r>p&&d.getDate()==u.getDate()){var _=Math.floor(d.getTime()/a)-Math.floor(u.getTime()/a);return i=_.toString()+l().timeAbbrevs[1],c(l().agoTemplate,{time:i})}var g=new Date;if(g.setDate(d.getDate()-1),2*r>p&&u.getDate()==g.getDate())return l().yesterday;if(31*r>p&&d.getMonth()==u.getMonth()){var m=Math.floor(d.getTime()/r)-Math.floor(u.getTime()/r);return i=m.toString()+l().timeAbbrevs[0],c(l().agoTemplate,{time:i})}return u.getFullYear()==d.getFullYear()?c(l().dayMonthTemplate,{day:u.getDate().toString(),month:l().monthNames[u.getMonth()]}):c(l().dayMonthYearTemplate,{
day:u.getDate().toString(),month:l().monthNames[u.getMonth()],year:u.getFullYear()})}}),define("unified_view/datetime_",["shared/polyfills","shared/core/component","shared/datetime"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/datetime");t.DateTimeComponent=n.extend({onLoad:function(){if(this.$timespanElem=this.$id("@datespan"),this.js_disp&&this.updateDisplayStr(),this.js_update_interval){var e=this.js_update_interval+Math.floor(Math.random()*this.js_update_interval*.1);setInterval(this.updateDisplayStr.bind(this),e)}},updateDisplayStr:function(){this.date_only?this.$timespanElem.html(o.dayStr(this.epoch_us)):this.$timespanElem.html(o.timestampStr(this.epoch_us,this.granularity))}})}),define("unified_view/download_csv",["shared/polyfills","shared/core/component"],function(e,t,i){var n=e("shared/core/component").Component;t.DownloadCSV=n.extend({onLoad:function(){var e=this;this.$id("@download_link").on("click",function(t){t.preventDefault(),e.downloadData()});
},createCSV:function(){var e,t,i="";if(this.print_all_keys)for(e=0;e<this.data.length;e++)for(var n in this.data[e])-1==this.header.indexOf(n)&&this.header.push(n);for(e=0;e<this.data.length;e++){var o=[];for(t=0;t<this.header.length;t++){var s=this.data[e][this.header[t]];void 0!==s?(s=String(s),/[,"\n]/.test(s)?o.push('"'+s.replace(/"/g,'""')+'"'):o.push(s)):o.push(s)}i+=o.join(",")+"\n"}return i},downloadData:function(){var e=this.createCSV(),t=this.header.join(",")+"\n",i=document.createElement("a"),n=void 0===this.file_name?"data":this.file_name;i.setAttribute("href","data:text/csv;charset=utf-8,"+encodeURIComponent(t)+encodeURIComponent(e)),i.setAttribute("download",n+".csv"),i.click()}})}),define("unified_view/facebook",["shared/polyfills","shared/core/component","shared/facebook","settings","shared/window_manager"],function(e,t,i){var n,o=e("shared/core/component").Component,s=e("shared/facebook"),a=e("settings"),r=e("shared/window_manager"),d=a.pageIsMobile;d&&(n=e("mobile_app2/messages")),
t.TokenRefresher=o.extend({onLoad:function(){var e=this;s.onInit(function(){window.FB.getLoginStatus(function(t){if("connected"==t.status){var i=t.authResponse;e.serverCall("update_access_token").kwargs({fb_uid:i.userID,access_token:i.accessToken,expires:i.expiresIn}).success(e.onSuccess.bind(e)).send()}})})},onSuccess:function(e){if(d){if(e){var t=function(){n.send("loginStateChanged",{isLoggedIn:!0})},i={name:"login_redirect_url",value:this.redirect_url,options:{expires:1}};n.send("setCookie",i,t)}}else e&&"post_reload"==a.pageMode&&r.reload()}})}),define("unified_view/feed/explanation",["shared/polyfills","shared/core/component"],function(e,t,i){var n=e("shared/core/component").Component;t.FeedExplanationLink=n.extend({onLoad:function(){this.$id("@feed_explanation_link").on("click",this.showFeedExplanationModal.bind(this))},showFeedExplanationModal:function(){this.createModal("show_feed_explanation_modal").kwargs({story_view:this.story_view}).show()}})}),define("unified_view/feed/feedback",["shared/polyfills","shared/core/component","interface/settings"],function(e,t,i){
var n=e("shared/core/component").Component,o=e("interface/settings").pageIsMobile;if(o)var s=e("mobile_app2/app/view/common");t.UnfollowOrMuteTopic=n.extend({onLoad:function(){this.$id("@unfollow_topic").on("click",this.unfollow.bind(this)),this.$id("@mute_topic").on("click",this.mute.bind(this))},unfollow:function(e){e.preventDefault(),this.serverCall("unfollow_topic").liveMutate().send()},mute:function(e){e.preventDefault(),this.serverCall("mute_topic").liveMutate().send()}}),t.MuteUserModalLink=n.extend({onLoad:function(){var e=this,t=function(){e.serverCall("toggle_mute_for_user").liveMutate().send()};e.$id("@mute_user").on("click",function(i){i.preventDefault(),o?e.modal_kwargs.is_muted?s.showConfirm({title:e.modal_kwargs.translated_unmute_title,message:e.modal_kwargs.translated_unmute_message,callback:t}):s.showConfirm({title:e.modal_kwargs.translated_mute_title,message:e.modal_kwargs.translated_mute_message,callback:t}):e.createModal("toggle_mute_user_modal").onSubmit(t).show()});
}})}),define("unified_view/feed/modal",["shared/polyfills","shared/core/component","shared/client_tracker","shared/cookies"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/client_tracker"),s=e("shared/cookies");t.OneClickOverlay=n.extend({onLoad:function(){var e=this;e.$id("@link").on("click",function(){o.track(e.qfeed_log_action,null,e),s.setQfeedLog(e,e.qfeed_log_action)})}})}),define("unified_view/home/logged_out_feed",["shared/polyfills","unified_view/toggle"],function(e,t,i){var n=e("unified_view/toggle");t.LoggedOutMultifeedBundle=n.ToggleBase.extend({onLoad:function(){this._super.apply(this,arguments);var e=this;this.$id("@view_more").on("click",function(){e.$id("@view_more").text(e.loading_text)})}})}),define("unified_view/inline_editor",["shared/polyfills","unified_view/modal"],function(e,t,i){var n=e("unified_view/modal");t.ClearDraftConfirmationModal=n.ModalBase.extend({onSubmit:function(){this.serverCall("clear_draft").kwargs({draft_space:this.draft_space
}).liveMutate().success(this._super.bind(this)).send()}})}),define("unified_view/lazy",["shared/polyfills","shared/core/component","shared/core/rpc"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/core/rpc");t.LazyComponent=n.extend({onLoad:function(){var e=this,t=e.$id("@wrapper").get()[0];t&&o.rpc("/api/rerender_component_POST").contentFor(t,{parentCid:e.parent().cid}).kwargs({serialized_component:e.serialized_component,vcon:e.vcon()}).send({batched:!0})}})}),define("unified_view/mobile_debug",["shared/polyfills","shared/core/component","shared/cookies","shared/keystrokes"],function(e,t,i){var n,o,s=e("shared/core/component").Component,a=e("shared/cookies"),r=e("shared/keystrokes"),d=s.extend({toggle:function(){var e=this;e.has_cookie?a.setCookie(e.cookie_key,null):a.setCookie(e.cookie_key,1),window.location.reload()}});t.ToggleMobileButton=d.extend({onLoad:function(){var e=this;n=e,e.$id("@toggle").on("click",function(t){return e.toggle(),t.preventDefault(),t.stopPropagation(),
!1})}}),t.ToggleTabletButton=d.extend({onLoad:function(){var e=this;o=e,e.$id("@toggle").on("click",function(t){return e.toggle(),t.preventDefault(),t.stopPropagation(),!1})}}),r.on([77,48,77,48],function(){n&&n.toggle()}),r.on([84,48,84,48],function(){o&&o.toggle()})}),define("unified_view/multifeed/_multifeed",["shared/polyfills","shared/core/component","settings","unified_view/toggle","shared/events/index","shared/client","view/hover_menu"],function(e,t,i){var n=e("shared/core/component").Component,o=e("settings"),s=o.pageIsMobile,a=e("unified_view/toggle"),r=e("shared/events/index");if(s)var d=e("mobile_app2/client"),l=e("mobile_app2/messages"),c=e("shared/client");else var h=e("view/hover_menu");t.QuestionsInTopicHeader=n.extend({onLoad:function(){var e=this;s&&e.$id("@bundle_action").on("click",function(){e.showActionSheet()}),e.handleEvent(r.Types.KNOWS_ABOUT_ADD_TOPIC,function(t){t.payload.tid==e.tid&&e.addKnowsAboutTopic()}),e.handleEvent(r.Types.KNOWS_ABOUT_REMOVE_TOPIC,function(t){
t.payload.tid==e.tid&&e.removeKnowsAboutTopic()})},addKnowsAboutTopic:function(){var e=this;e.serverCall("add_knowsabout_topic").kwargs({tid:e.tid}).liveMutate().send()},removeKnowsAboutTopic:function(){var e=this;e.serverCall("remove_knowsabout_topic").kwargs({tid:e.tid}).liveMutate().send()},showActionSheet:function(){var e=this;d.showActionSheet({buttonTitles:e.actionSheetTitles,destructiveButtonIndex:0,callback:function(t){if(e.is_knows_about_topic){if(0!=t)return;e.emitEvent({type:r.Types.KNOWS_ABOUT_REMOVE_TOPIC,payload:{tid:e.tid}})}else if(0==t)e.emitEvent({type:r.Types.KNOWS_ABOUT_ADD_TOPIC,payload:{tid:e.tid}});else{if(1!=t)return;e.emitEvent({type:r.Types.MULTIFEED_BUNDLE_REMOVE,payload:{tid:e.tid}})}}})}}),t.QuestionsInTopic=a.ToggleBase.extend({onLoad:function(){this._super.apply(this,arguments);var e=this;this.handleEvent(r.Types.MULTIFEED_BUNDLE_REMOVE,function(t){t.payload.tid==e.tid&&e.hideBundle()})},hideBundle:function(){this.$id("@normal_state").addClass("hidden"),this.$id("@removed_state").removeClass("hidden"),
this.serverCall("hide_bundle").kwargs({tid:this.tid}).send()}}),t.SuggestedAMAsBundle=n.extend({onLoad:function(){s&&c.isAndroidApp()&&this.$id("@inline_suggestions").on("touchstart",function(e){l.send("setSwipeEnabled",{enabled:!1})})}}),t.QuestionsInTopicWebOverflowLink=n.extend({onLoad:function(){var e=this;this.overflowMenu=new h.ToggleableMenu({$linkElem:this.$id("@bundle_action"),$menuElem:this.$id("@overflow_menu"),loadFunction:function(){},alignment:"right",clickOpen:!0,shouldAttachToBody:!0}),e.$id("@remove_knowsabout_topic").on("click",function(){e.emitEvent({type:r.Types.KNOWS_ABOUT_REMOVE_TOPIC,payload:{tid:e.tid}})}),e.$id("@add_knowsabout_topic").on("click",function(){e.emitEvent({type:r.Types.KNOWS_ABOUT_ADD_TOPIC,payload:{tid:e.tid}})}),e.$id("@hide_topic_bundle").on("click",function(){e.emitEvent({type:r.Types.MULTIFEED_BUNDLE_REMOVE,payload:{tid:e.tid}})})}}),t.AmaSelfServeBundleHeader=n.extend({onLoad:function(){var e=this,t=e.$id("@stop_button");t&&t.on("click",function(){
e.createModal("close_session_modal").show()})}})}),define("unified_view/multifeed/home",["shared/polyfills","unified_view/paged_list","shared/client","shared/window_manager","settings","interface/settings"],function(e,t,i){var n=e("unified_view/paged_list").PagedList,o=e("shared/client"),s=e("shared/window_manager"),a=e("settings"),r=e("interface/settings").pageIsMobile;if(r)var d=e("mobile_app2/client"),l=e("mobile_app2/messages");t.HomeMultifeed=n.extend({onLoad:function(){var e=this;if(this._super.apply(this,arguments),this.prefetchNativeTabs(),this.removeVisitParams(),this.should_show_mobile_nux){var t={name:"nux_redirect_url",value:window.location.href,options:{expires:1}};l.send("setCookie",t),this.showNUX(),d.registerMessageHandler("showNUX",function(){e.showNUX()})}},prefetchNativeTabs:function(){o.isNativeApp()&&!a.disablePrefetchTabs&&d.registerOneTimeMessageHandler("pageReadyComplete",function(){setTimeout(function(){l.send("prefetchTabs")},500)})},removeVisitParams:function(){
var e=s.getURL();-1!=e.indexOf("?qp_story=")&&(s.replaceURL("/"),r&&o.isIOSApp()&&l.send("setCanonicalURL",{url:"/"}))},showNUX:function(){setTimeout(function(){l.send("openURL",{url:"/nux/follow_topic",target:"nondismissable_modal",nux:!0})},1)}})}),define("unified_view/multifeed/view_tracker",["shared/polyfills","shared/core/component","shared/Class","shared/errors","interface/settings","shared/debounce","shared/viewport","gating"],function(e,t,i){var n,o=e("shared/core/component"),s=e("shared/Class").Class,a=e("shared/errors"),r=e("interface/settings").pageIsMobile,d=e("shared/debounce").throttle,l=e("shared/viewport"),c=e("gating");r&&(n=e("mobile_app2/client"));var h=1e3,u=new Date,p=s.extend({__init__:function(){this.debugView=c.view_tracker_debug,this.throttledLogViews=d(this.logViews.bind(this),h),r?n.registerMessageHandler("tick",this.throttledLogViews):(document.addEventListener("scroll",this.throttledLogViews),document.addEventListener("mousemove",this.throttledLogViews)),this.trackedComponentCids=[],
this.alreadyLoggedCids={}},trackComponent:function(e,t){var i=this;if(t||(t=0),!e.getViewableElement)return void a.logJsError("ViewTracker","Component "+e.cid+" must implement getViewableElement");if(!e.onEnterView)return void a.logJsError("ViewTracker","Component "+e.cid+" must implement onEnterView");var n=new Date-u,o=Math.max(0,t-n);setTimeout(function(){i.delayedTrackComponent(e)},o)},delayedTrackComponent:function(e){this.trackedComponentCids.push(e.cid),r||this.throttledLogViews()},logViews:function(){for(var e=0;e<this.trackedComponentCids.length;e++){var t=this.trackedComponentCids[e],i=o._safeGetComponentByCID(t),n=this.isComponentVisible(i),s=i.getViewableElement();this.debugView&&(n?s.classList.add("__debug_background"):s.classList.remove("__debug_background")),this.alreadyLoggedCids[t]||n&&(i.onEnterView(),this.alreadyLoggedCids[t]=!0,this.debugView&&s.classList.add("__debug_border"))}},isComponentVisible:function(e){var t=e.getViewableElement();return l.isElementInViewport(t);
}});t.viewTracker=new p}),define("unified_view/multifeed/story",["shared/polyfills","shared/core/component","shared/events/index","shared/logging","interface/settings","unified_view/multifeed/view_tracker","shared/window_manager","gating","fx","shared/errors"],function(e,t,i){var n,o=e("shared/core/component").Component,s=e("shared/events/index"),a=e("shared/logging"),r=e("interface/settings").pageIsMobile,d=e("unified_view/multifeed/view_tracker").viewTracker,l=e("shared/window_manager"),c=e("gating");r||(n=e("fx")),t.FeedStory=o.extend({onLoad:function(){if(this.initiallyVisible=d.isComponentVisible(this),this.waitUntilImpressionLogMs=2e3,this.setDvar("feed_story_hash",this.qfeed_log_hash),this.setDvar("feed_story_position",this.position),this.setDvar("bundle_position",this.bundle_position),this.setDvar("feed_story_initial",this.initiallyVisible),this.setDvar("feed_ty",this.feed_ty),this.setDvar("feed_page",this.feed_page),this.setDvar("focus_ty",this.focus_ty),this.setDvar("page_data",this.page_data),
this.setDvar("enable_feed_logging",!0),d.trackComponent(this,this.waitUntilImpressionLogMs),this.scroll_to_top){var e=this.$id("@item"),t=e.offset().top;t-=l.headerOffset+20,window.scroll(0,t),r||n.highlight(e.get(0),2e3)}},onUnload:function(){e("shared/errors").logJsError("MultifeedStory","onUnload should not be called b/c everything is dead")},onEnterView:function(){var e={hash:this.qfeed_log_hash,initially_visible:this.initiallyVisible,position:this.position,bundle_position:this.bundle_position},t={uid:this.__js_init.uid,focus_ty:this.__js_init.focus_ty,feed_ty:this.__js_init.feed_ty,feed_page:this.__js_init.feed_page,page_data:this.__js_init.page_data};a.log("feed_impression",{request_data:[e],__js_data__:t}),c.qfeed_log_impression_debug&&console.log("feed_impression:",JSON.stringify(e,null,2))},getViewableElement:function(){return this.$id("@item").get(0)}}),t.AnswerFeedStory=t.FeedStory.extend({onLoad:function(){var e=this;this._super.apply(this,arguments),e.answerFeedbackLoaded=!1,
e.questionFeedbackLoaded=!1,e.handleEvent(s.Types.ANSWER_VOTE_STATE,function(t){t.payload.aid==e.aid&&("downvoted"==t.payload.state?e.showAnswerDownvoteFeedback():e.hideAnswerDownvoteFeedback())}),e.handleEvent(s.Types.QUESTION_VOTE_STATE,function(t){t.payload.qid==e.qid&&("downvoted"==t.payload.state?e.showQuestionDownvoteFeedback():e.hideQuestionDownvoteFeedback())})},showAnswerDownvoteFeedback:function(){var e=this;e.$id("@item").addClass("hidden"),e.$id("@answer_feedback").removeClass("hidden"),e.answerFeedbackLoaded===!1&&e.serverCall("load_answer_downvote_feedback").contentFor(e.$id("@answer_feedback")).success(function(){e.answerFeedbackLoaded=!0}).send()},hideAnswerDownvoteFeedback:function(){this.$id("@item").removeClass("hidden"),this.$id("@answer_feedback").addClass("hidden")},showQuestionDownvoteFeedback:function(){var e=this;e.$id("@item").addClass("hidden"),e.$id("@question_feedback").removeClass("hidden"),e.questionFeedbackLoaded===!1&&e.serverCall("load_question_downvote_feedback").contentFor(e.$id("@question_feedback")).success(function(){
e.questionFeedbackLoaded=!0}).send()},hideQuestionDownvoteFeedback:function(){this.$id("@item").removeClass("hidden"),this.$id("@question_feedback").addClass("hidden")}}),t.QuestionFeedStory=t.FeedStory.extend({onLoad:function(){var e=this;this._super.apply(this,arguments),e.questionFeedbackLoaded=!1,e.handleEvent(s.Types.QUESTION_VOTE_STATE,function(t){t.payload.qid==e.qid&&("downvoted"==t.payload.state?e.showQuestionDownvoteFeedback():e.hideQuestionDownvoteFeedback())}),this.handleEvent(s.Types.QUESTION_CANT_ANSWER_STATE,function(t){if(t.payload.qid==e.qid){var i="passed"==t.payload.state;e.$id("@item").toggleClass("cant_answer",i)}})},showQuestionDownvoteFeedback:function(){var e=this;e.$id("@item").addClass("hidden"),e.$id("@question_feedback").removeClass("hidden"),e.questionFeedbackLoaded===!1&&e.serverCall("load_downvote_feedback").contentFor(e.$id("@question_feedback")).success(function(){e.questionFeedbackLoaded=!0}).send()},hideQuestionDownvoteFeedback:function(){this.$id("@item").removeClass("hidden"),
this.$id("@question_feedback").addClass("hidden")}})}),define("unified_view/multifeed/write",["shared/polyfills","shared/core/component","settings"],function(e,t,i){var n=e("shared/core/component").Component,o=e("settings"),s=o.pageIsMobile;t.EditKnowsAboutTopicsSection=n.extend({onLoad:function(){var e=this;s||e.$id("@add_topics_link").on("click",function(){e.createModal("load_modal").show()})}})}),define("unified_view/network/invite",["shared/polyfills","shared/events/index","interface/settings","unified_view/modal","shared/modal","shared/core/component"],function(e,t,i){var n=e("shared/events/index"),o=e("interface/settings"),s=e("unified_view/modal").ModalBase,a=e("shared/modal"),r=e("shared/core/component").Component;if(o.pageIsMobile)var d=e("mobile_app2/messages");t.InviteModalLink=r.extend({onLoad:function(){var e=this;e.$id("@link").on("click",function(){e.createModal("load_modal").show()})}}),t.InviteForm=r.extend({onLoad:function(){var e=this;this.handleEvent(n.Types.NETWORK_INVITE_USER,function(t){
t.payload.uid?e.setToUser(t.payload.uid):t.payload.email&&e.performInviteActionToEmail(t.payload.email)})},setToUser:function(e){this.serverCall("perform_invite_existing_user_action").kwargs({invitee_uid:e}).success(this.onSuccessfulInvite.bind(this)).liveMutate().send()},onSuccessfulInvite:function(){o.pageIsMobile?a.handleClose(this):this.child("selector")&&this.child("selector").setQuery("")},performInviteActionToEmail:function(e){this.serverCall("perform_invite_action").kwargs({email:e}).success(this.onSuccessfulInvite.bind(this)).liveMutate().send()}}),t.InviteModal=s.extend({onUnload:function(){o.pageIsMobile&&d.send("hideSearchInput")}})}),define("unified_view/network/join",["shared/polyfills","shared/core/component","shared/events/index","unified_view/modal","interface/settings"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/events/index"),s=e("unified_view/modal").ModalBase,a=e("interface/settings").pageIsMobile;if(a)var r=e("mobile_app2/messages");t.SwitchableWithLoginForms=n.extend({
onLoad:function(){var e=this;this.handleEvent(o.Types.NETWORK_BETA_LOGIN_FORM_STATE,function(t){t.payload.showLogin?e.showLoginForm():e.showNonLoginForm()})},showLoginForm:function(){this.$id("@non_login_form").addClass("hidden"),this.$id("@login_form").removeClass("hidden")},showNonLoginForm:function(){this.$id("@non_login_form").removeClass("hidden"),this.$id("@login_form").addClass("hidden")}}),t.LoggedOutMainBase=n.extend({onLoad:function(){var t=this;if(a&&t.setPageScrollable){var i=e("mobile_app2/messages");i.send("setPageProperties",{scrollable:!0}),this.$id("@link").on("click",function(){i.send("setPageProperties",{scrollable:!1})})}}}),t.PublicRequestForm=n.extend({onLoad:function(){var e=this;a?(e.$email=e.child("email").$id("@email"),e.$name=e.child("name").$id("@name"),e.$bio=e.child("bio").$id("@bio")):(e.$email=e.$id("@email"),e.$name=e.$id("@name"),e.$bio=e.$id("@bio")),e.handleEvent(o.Types.NETWORK_BETA_WAITLIST_FORM_STATE,function(t){t.payload.email&&e.$email.val(t.payload.email),
t.payload.name&&e.$name.val(t.payload.name),e.showLoginAttemptFailedDescription(),e.updateButton()}),e.$email.on("input",function(){e.updateButton()}),e.$name.on("input",function(){e.updateButton()}),e.$bio.on("input",function(){e.updateButton()}),e.$id("@submit").on("click",function(){e.sendRequest()}),e.$id("@login").on("click",function(){e.showLoginForm()}),e.$id("@login2").on("click",function(){e.showLoginForm()})},showLoginForm:function(){this.emitEvent({type:o.Types.NETWORK_BETA_LOGIN_FORM_STATE,payload:{showLogin:!0}})},showLoginAttemptFailedDescription:function(){this.$id("@login_attempt_failed").removeClass("hidden")},updateButton:function(){var e=this;e.$email.val().length>0&&e.$name.val().length>0&&e.$bio.val().length>0?e.$id("@submit").removeClass("disabled"):e.$id("@submit").addClass("disabled")},sendRequest:function(){var e=this,t=e.$email.val(),i=e.$name.val(),n=e.$bio.val();e.serverCall("request").kwargs({email:t,name:i,bio:n}).contentFor(e.$id("@request_form_content")).send();
}}),t.EmailRequestInlineFeedback=n.extend({onLoad:function(){var e=this;this.$id("@login").on("click",function(){e.emitEvent({type:o.Types.NETWORK_BETA_LOGIN_FORM_STATE,payload:{showLogin:!1}})})}});var d=t.LoggedInJoinSiloPromptLink=n.extend({onLoad:function(){var e=this;e.setLinkHandler(),e.should_show_modal_on_load&&e.showModal()},setLinkHandler:function(){var e=this;e.$id("@link").on("click",function(){e.showModal()})},showModal:function(){var e=this;e.can_show_modal?a?e.emitEvent({type:o.Types.NETWORK_JOIN_MODAL,payload:{showModal:!0}}):e.createModal("load_desktop").show():a?r.send("openURL",{url:e.fallback_redirect_url_if_cannot_show_modal}):document.location=e.fallback_redirect_url_if_cannot_show_modal}});t.MobileAppLoggedInJoinSiloPromptPageAction=d.extend({setLinkHandler:function(){var e=this;e.setModalLinkState(!1),e.handleEvent(o.Types.NETWORK_JOIN_MODAL,function(t){t.payload.modalShown?e.setModalLinkState(!0):t.payload.modalDismissed&&e.setModalLinkState(!1)})},setModalLinkState:function(e){
r.send("setPageAction",{rightTextButton:{title:this.join_text,callback:this.showModal.bind(this),disabled:e}})}}),t.DesktopLoggedInJoinSiloModal=s.extend({onLoad:function(){var e=this;e._super.apply(e,arguments),e.handleEvent(o.Types.NETWORK_JOIN_MODAL,function(t){t.payload.showModal||(t.payload.hasBeenMarkedAsDecideLater?e.close():e.onClose())})},onClose:function(){var e=this;e.serverCall("mark_as_decide_later").success(function(){e.close()}).send()}}),t.MobileLoggedInJoinSiloModalWrapper=n.extend({onLoad:function(){var e=this;e.$id("@background").on("click",function(){e.dismissModal(!0)}),e.handleEvent(o.Types.NETWORK_JOIN_MODAL,function(t){t.payload.showModal?e.showModal():t.payload.hideModal&&e.dismissModal(!t.payload.hasBeenMarkedAsDecideLater)})},showModal:function(){var e=this;e.$id("@wrapper").addClass("show");var t=e.$id("@modal_wrapper");t.html().length||e.serverCall("load_modal").contentFor(t).send(),e.emitEvent({type:o.Types.NETWORK_JOIN_MODAL,payload:{modalShown:!0}})},_hideWrapper:function(){
var e=this;e.$id("@wrapper").addClass("animate_out"),setTimeout(function(){e.$id("@wrapper").removeClass("show"),e.$id("@wrapper").removeClass("animate_out")},200),e.emitEvent({type:o.Types.NETWORK_JOIN_MODAL,payload:{modalDismissed:!0}})},dismissModal:function(e){var t=this;e?t.serverCall("mark_as_decide_later").success(function(){t._hideWrapper()}).send():t._hideWrapper()}}),t.MobileLoggedInJoinSiloModal=n.extend({onLoad:function(){var e=this;e.$id("@close").on("click",function(){e.emitEvent({type:o.Types.NETWORK_JOIN_MODAL,payload:{hideModal:!0,hasBeenMarkedAsDecideLater:!1}})})}}),t.LoggedInJoinSiloPrompt=n.extend({onLoad:function(){var e=this;e.serverCall("mark_as_shown").send(),e.$id("@decide_later").on("click",function(){e.serverCall("mark_as_decide_later").success(function(){e.dismissModal()}).send()}),e.$id("@mark_as_do_not_know").on("click",function(){e.serverCall("mark_as_do_not_know").success(function(){e.dismissModal()}).send()})},dismissModal:function(){this.emitEvent({type:o.Types.NETWORK_JOIN_MODAL,
payload:{hideModal:!0,hasBeenMarkedAsDecideLater:!0}})}}),t.JoinSuggestedNetworksSidebar=n.extend({onLoad:function(){var e=this;e.$id("@dismiss").on("click",function(t){t.preventDefault(),e.serverCall("dismiss").success(function(){e.$id("@wrapper").addClass("hidden")}).liveMutate().send()})}})}),define("shared/oauth",["shared/polyfills","interface/settings","shared/google_","shared/facebook","settings"],function(e,t,i){function n(e){return e&&"False"!==e&&"false"!==e}function o(e,t,i){return function(o){if(o.provider===e){if("google"===o.provider){if(h)return;void 0!==o.success&&(h=!0)}n(o.success)?(o.success=!0,t(o)):i(o)}}}var s=e("interface/settings"),a=s.pageIsMobile,r=e("shared/google_"),d=e("shared/facebook"),l=e("settings");if(a)var c=e("mobile_app2/messages");var h=!1;t.googleOnLoad=function(e,t,i){if(a){var o=e.mobile_data;if(null!==o.success)if(n(o.success)){var s={target:"signup",provider:o.provider,success:o.success,access_token:o.access_token};c.send("showLoadingView"),t(s);
}else{var r="failed in googleOnLoad";i(r)}}},t.googleConnect=function(e,t,i){if(h=!1,a){var n=e.mobile_data,s=o("google",t,i);c.send("showOauthConnectDialog",{provider:"google",url:n.url,scope:n.scope,perms:n.perms},s)}else{var d=function(e){return h?void 0:(void 0!==e.success&&(h=!0),e&&void 0===e.error&&("AUTO"===e.status.method&&1===e.num_sessions||"PROMPT"===e.status.method)?void t(e):void(e.error&&"immediate_failed"!==e.error&&i()))},u={callback:d,clientid:l.googleClientId,cookiepolicy:l.googleCookiePolicy,scope:e.web_data.scope};e.web_data.prompt_ota_install&&(u.apppackagename=l.androidAppPackageName),r.onInit(function(){window.gapi.auth.setToken(null),window.gapi.auth.signIn(u)})}},t.facebookConnect=function(e,t,i){if(a){var n=o("facebook",t,i);c.send("showOauthConnectDialog",{provider:"facebook",perms:e.perms},n)}else{var s=function(e){e&&"connected"==e.status?t(e.authResponse):i()};d.onInit(function(){FB.login(s,{scope:e.perms})})}}}),define("unified_view/signup/facebook",["shared/polyfills","unified_view/signup/_signup","shared/oauth","shared/facebook","settings"],function(e,t,i){
var n=e("unified_view/signup/_signup").SignupContext,o=e("shared/oauth"),s=e("shared/facebook"),a=e("unified_view/signup/_signup").SignupActionableComponent;t.SignupFacebookConnectButton=a.extend({onLoad:function(){this._super.apply(this,arguments),this.signupContext=this.getContext(n),this.$id("@facebook_connect_button").on("click",this.clicked.bind(this)),s.load()},clicked:function(){this.serverCall("log_click_to_scribe").kwargs({button_type:"facebook"}).send(),o.facebookConnect(this,this.onConnectSucceeded.bind(this),this.onConnectFailed.bind(this)),e("settings").instance.includes("test")&&document.addEventListener("facebook_ui_test_event",function(e){var t={userID:e.detail.fb_uid,accessToken:e.detail.fb_access_token,expiresIn:e.detail.expires,use_test_signup:e.detail.use_test_signup};this.onConnectSucceeded(t)}.bind(this))},onConnectSucceeded:function(e){this.signupContext.set("facebookOauthData",e)},onConnectFailed:function(){}})}),define("unified_view/signup/google",["shared/polyfills","unified_view/signup/_signup","settings","shared/oauth","shared/window_manager","shared/google_","shared/core/component","interface/settings"],function(e,t,i){
var n=e("unified_view/signup/_signup").SignupContext,o=e("settings"),s=e("shared/oauth"),a=e("shared/window_manager"),r=e("unified_view/signup/_signup"),d=e("shared/google_"),l=r.SignupActionableComponent,c=e("shared/core/component").Component,h=e("interface/settings").pageIsMobile;if(h)var u=e("mobile_app2/app/view/common"),p=e("mobile_app2/messages");window.loginInProgress=!1,t.SignupGoogleConnectButton=l.extend({onLoad:function(){this._super.apply(this,arguments),this.signupContext=this.getContext(n),this.$id("@google_connect_button").on("click",this.onClick.bind(this)),s.googleOnLoad(this,this.onConnectSuceeded.bind(this),this.onConnectFailed.bind(this))},onClick:function(){this.serverCall("log_click_to_scribe").kwargs({button_type:"google"}).send(),s.googleConnect(this,this.onConnectSuceeded.bind(this),this.onConnectFailed.bind(this)),e("settings").instance.includes("test")&&document.addEventListener("google_ui_test_event",function(e){var t={access_token:e.detail.access_token,use_test_signup:!0
};this._setGoogleOauthDataOnConnectSucceeded(t)}.bind(this))},_setGoogleOauthDataOnConnectSucceeded:function(e){this.signupContext.set("googleOauthData",e)},onConnectSuceeded:function(t){h&&(e("settings").instance.includes("test")&&(t.access_token="fake.google",t.use_test_signup=!0),t.access_token||(t.access_token=this.mobile_data.access_token)),this._setGoogleOauthDataOnConnectSucceeded(t)},onConnectFailed:function(e){h?this.onConnectFailedMobile(e):this.onConnectFailedWeb()},onConnectFailedWeb:function(){this.serverCall("render_google_connect_failed_message").send()},onConnectFailedMobile:function(e){var t=this;u.showAlert({title:this.mobile_data.error_title,message:this.mobile_data.error_message});var i="";try{i=JSON.stringify(e)}catch(n){i=""+n}t.serverCall("log_google_oauth_failure").kwargs({data_or_error:i}).send()}}),t.GoogleAutoLoginWeb=c.extend({onLoad:function(){var e=this;d.onInit(function(){window.gapi.auth.authorize({immediate:!0,client_id:o.googleClientId,cookiepolicy:o.googleCookiePolicy,
scope:e.scopes},e.signInCallback.bind(e))})},signInCallback:function(e){e&&void 0===e.error&&this.onLogin(e)},onLogin:function(e){window.loginInProgress!==!0&&(window.loginInProgress=!0,this.serverCall("try_auto_login").kwargs({access_token:e.access_token}).success(function(e){e&&"post_reload"===o.pageMode&&a.reload(),window.loginInProgress=!1}).error(function(){window.loginInProgress=!1}).except(function(){window.loginInProgress=!1}).send())}}),t.GoogleAutoLoginMobile=c.extend({onLoad:function(){var e=this;this.requestedGoogleAPI=!1,d.onInit(function(){window.gapi.auth.authorize({immediate:!0,client_id:o.googleClientId,cookiepolicy:o.googleCookiePolicy,scope:e.scopes},e.signInCallback.bind(e))})},signInCallback:function(e){e&&void 0===e.error&&this.serverCall("try_auto_login").kwargs({access_token:e.access_token}).success(this.onLogin.bind(this)).send()},onLogin:function(e){if(e){var t=function(){p.send("loginStateChanged",{isLoggedIn:!0})},i={name:"login_redirect_url",value:this.redirect_url,
options:{expires:1}};p.send("setCookie",i,t)}}})}),define("unified_view/network/login",["shared/polyfills","unified_view/signup/_signup","shared/events/index","unified_view/signup/facebook","unified_view/signup/google"],function(e,t,i){var n=e("unified_view/signup/_signup").BaseSignupForm,o=e("shared/events/index"),s=e("unified_view/signup/facebook").SignupFacebookConnectButton,a=e("unified_view/signup/google").SignupGoogleConnectButton;t.LoginOnlyForm=n.extend({onLoad:function(){this._super.apply(this,arguments);var e=this;e.$id("@cancel_login").on("click",function(){e.emitEvent({type:o.Types.NETWORK_BETA_LOGIN_FORM_STATE,payload:{showLogin:!1}})})}}),t.LoginFacebookConnectButton=s.extend({onConnectSucceeded:function(e){var t=e,i=this;t.onFailure=function(e){i.emitEvent({type:o.Types.NETWORK_BETA_WAITLIST_FORM_STATE,payload:{email:e.facebookOauthData.email,name:e.facebookOauthData.name}}),i.emitEvent({type:o.Types.NETWORK_BETA_LOGIN_FORM_STATE,payload:{showLogin:!1}})},this.signupContext.set("facebookOauthData",t);
}}),t.LoginGoogleConnectButton=a.extend({_setGoogleOauthDataOnConnectSucceeded:function(e){var t=e,i=this;t.onFailure=function(e){i.emitEvent({type:o.Types.NETWORK_BETA_WAITLIST_FORM_STATE,payload:{email:e.googleOauthData.email,name:e.googleOauthData.name}}),i.emitEvent({type:o.Types.NETWORK_BETA_LOGIN_FORM_STATE,payload:{showLogin:!1}})},this.signupContext.set("googleOauthData",t)}})}),define("unified_view/network/signup",["shared/polyfills","unified_view/signup/_signup","shared/core/component","shared/events/index"],function(e,t,i){var n=e("unified_view/signup/_signup").BaseSignupForm,o=e("shared/core/component").Component,s=e("shared/events/index"),a=e("unified_view/signup/_signup").SignupContext;t.SignupWithCodeForm=n.extend({onLoad:function(){this._super.apply(this,arguments);var e=this;e.SignupContext=e.getContext(a),e.signupContext.set("emailSubmitButton",e.$id("@submit")),e.SignupContext.on("showEmailSignup",function(t,i){i?e.showEmailSignupForm():e.hideEmailSignupForm()}),e.$id("@login").on("click",function(){
e.emitEvent({type:s.Types.NETWORK_BETA_LOGIN_FORM_STATE,payload:{showLogin:!0}})}),e.$id("@cancel_signup_with_email").on("click",function(){e.SignupContext.set("showEmailSignup",!1)})},showEmailSignupForm:function(){this.$id("@email_signup_form").removeClass("hidden"),this.$id("@social_signup_form").addClass("hidden")},hideEmailSignupForm:function(){this.$id("@email_signup_form").addClass("hidden"),this.$id("@social_signup_form").removeClass("hidden")}}),t.SignupWithEmailButton=o.extend({onLoad:function(){var e=this;e.SignupContext=e.getContext(a),this.$id("@button").on("click",function(){e.SignupContext.set("showEmailSignup",!0)})}})}),define("unified_view/network/switcher",["shared/polyfills","shared/core/component","interface/settings","shared/client"],function(e,t,i){var n=e("shared/core/component").Component,o=e("interface/settings");if(o.pageIsMobile)var s=e("mobile_app2/client"),a=e("mobile_app2/messages"),r=e("shared/client");t.MobileNetworkSwitcherActionSheetSetter=n.extend({onLoad:function(){
var e=this;e.$id("@link").on("click",function(t){t.preventDefault(),s.showActionSheet({buttonTitles:e.actionSheetTitles,callback:function(t){t>=e.actionSheetTitles.length||e.maybeSwitchNetwork(t)}})})},maybeSwitchNetwork:function(e){var t=this.destinationData[e];r.isMobileWeb()?window.location=t.url:t.is_member?s.updateConfig(t.subdomain,t.language):a.send("openURL",{target:"modal",url:t.url})}}),t.NativeSwitcherSetter=n.extend({onLoad:function(){a.send("updateSiloSwitcher",this.data)}})}),define("unified_view/notifications",["shared/polyfills","unified_view/paged_list","interface/settings"],function(e,t,i){var n,o=e("unified_view/paged_list").PagedList,s=e("interface/settings").pageIsMobile;s&&(n=e("mobile_app2/client")),t.NotificationsListContentsBaseUnified=o.extend({resyncButtonPressed:function(){this._super.apply(this,arguments),this.serverCall("clear_notif_badge").send()}}),t.AllNotificationsListContentsUnified=t.NotificationsListContentsBaseUnified.extend({onLoad:function(){this._super.apply(this,arguments);
var e=this;s&&n.registerMessageHandler("drawerHashBroadcast",function(t){var i=t.notifsHash;e.hashes[0]!=i&&(window.pageYOffset<300?e.forceResync(0):e.handleModelUpdates([i]))})}})}),define("unified_view/nux",["shared/polyfills","shared/core/component","unified_view/modal"],function(e,t,i){var n=e("shared/core/component").Component,o=e("unified_view/modal").ModalBase;t.NuxModal=o.extend({onLoad:function(){var e=this;e.submit=this.$id("@submit"),e.next=this.$id("@next"),e.skip=this.$id("@skip"),e.title=this.$id("@modal_title"),e.content=this.$id("@content"),e.currentStep=-1,e.submit.addClass("hidden"),this._super.apply(this),e.next.on("click",function(t){t.preventDefault(),e.loadStepData()}),e.skip.on("click",function(t){t.preventDefault(),e.loadStepData()}),e.loadStepData()},updateTitle:function(e){this.title.text(e)},showSkip:function(){this.skip.removeClass("hidden")},hideSkip:function(){this.skip.addClass("hidden")},showFinish:function(){this.next.addClass("hidden"),this.submit.removeClass("hidden");
},onSubmit:function(){this.close()},loadStepData:function(){var e=this;this.currentStep++;var t=this[this.step_order[this.currentStep]];e.serverCall(t.content).contentFor(e.content).liveMutate().success(function(){e.updateTitle(t.title),t.allow_skip?e.showSkip():e.hideSkip(),e.currentStep==e.step_order.length-1&&e.showFinish()}).send()}}),t.NuxLink=n.extend({onLoad:function(){this.$id("@create_dialog_link").on("click",this.loadModal.bind(this))},loadModal:function(){this.createModal("load_modal").show()}})}),define("shared/stripeLoader",["shared/polyfills","settings","shared/util","shared/loadjs"],function(e,t,i){var n=e("settings"),o=e("shared/util"),s=e("shared/loadjs").loadJS,a="https://js.stripe.com/v2/";t.load=o.once(function(){s(a,function(){Stripe.setPublishableKey(n.stripePublishableKey)})})}),define("unified_view/payment/_payment",["shared/polyfills","shared/core/component","shared/stripeLoader","interface/settings","shared/jquery"],function(e,t,i){function n(e,t){var i;i=r.pageIsMobile?"keyup paste change":"keydown paste change",
e&&e.on(i,function(i){setTimeout(function(){var i=e.val(),n=t(i);i!==n&&e.val(n)},1)})}var o,s=e("shared/core/component").Component,a=e("shared/stripeLoader"),r=e("interface/settings"),d=e("shared/jquery");r.pageIsMobile&&(o=e("mobile_app2/messages")),t.PaymentMethod=s,t.AddCardForm=s.extend({onLoad:function(){a.load();var e=this;e.$name=e.$id("@name"),e.$number=e.$id("@number"),e.$expiry=e.$id("@expiry"),e.$cvc=e.$id("@cvc"),e.$zip=e.$id("@zip"),e.cardType=null,e.isSubmitting=!1,n(e.$number,function(t){var i=Stripe.card.cardType(t);switch(i){case"Unknown":i=null;break;case"American Express":i="amex";break;case"Diners Club":i="diners";break;default:i=i.toLowerCase().replace(/\s+/g,"")}e._setCardType(i);var n=t.replace(/[^0-9]/g,"");return n="amex"===i?(n.slice(0,4)+" "+n.slice(4,10)+" "+n.slice(10,n.length)).trim():(n.slice(0,4)+" "+n.slice(4,8)+" "+n.slice(8,12)+" "+n.slice(12,n.length)).trim()}),n(e.$expiry,function(e){var t=e.replace(/[^0-9]/g,"");return" /"===e.slice(2,e.length)?t[0]:(1===t.length&&("0"!==t[0]&&"1"!==t[0]||2===e.length&&"1"===t[0]&&(" "===e[1]||isNaN(e[1])))&&(t="0"+t),
t.length>1&&(t=t.slice(0,2)+" / "+t.slice(2,t.length)),t)}),n(e.$cvc,function(e){return e.replace(/[^0-9]/g,"")})},getExpiryMonth:function(){return this.$expiry.val().replace(/[^0-9]/g,"").slice(0,2)},getExpiryYear:function(){var e=this.$expiry.val();return e.replace(/[^0-9]/g,"").slice(2,e.length)},getEmail:function(){return this.$email.length?this.$email.val():void 0},submit:function(e){var t=this;t.isSubmitting||(t.isSubmitting=!0,r.pageIsMobile&&o.send("showLoadingView"),document.activeElement.blur(),t._getStripeToken(function(i,n){t.serverCall("submit").kwargs({stripe_response:n,source_type:t.source_type,source_id:t.source_id}).success(function(i){var n;n=r.pageIsMobile?i.value:i,n?(t.isSubmitting=!1,e()):(t.isSubmitting=!1,r.pageIsMobile&&o.send("hideLoadingView"))}).error(function(){t.isSubmitting=!1,r.pageIsMobile&&o.send("hideLoadingView"),t.showServerError()}).liveMutate().send()}))},showServerError:function(){this.serverCall("show_error_pmsg").send()},_getStripeToken:function(e){
Stripe.card.createToken({name:this.$name.val(),number:this.$number.val(),exp_month:this.getExpiryMonth(),exp_year:this.getExpiryYear(),cvc:this.$cvc.val(),address_zip:this.$zip.val(),currency:"usd"},e)},_setCardType:function(e){this.cardType!==e&&(this.cardType&&this.$number.removeClass(this.cardType),this.cardType=e,this.cardType&&this.$number.addClass(this.cardType),"amex"===this.cardType?this.$number.attr("maxlength","17"):this.$number.attr("maxlength","19"))}}),t.AddBankForm=s.extend({onLoad:function(){a.load();var e=this;e.$form=e.$id("@form"),r.pageIsMobile?(e.$name=e.child("name").$id("@name"),e.$country=e.child("country").$id("@country")):(e.$name=e.$id("@name"),e.$country=e.$id("@country")),e.$routing_1_row=e.$id("@routing_1_row"),r.pageIsMobile?(e.$routing_1_label=e.child("routing_1").$id("@label"),e.$routing_1=e.child("routing_1").$id("@routing_1")):(e.$routing_1_label=e.$id("@routing_1_label"),e.$routing_1=e.$id("@routing_1")),e.$routing_2_row=e.$id("@routing_2_row"),r.pageIsMobile?(e.$routing_2_label=e.child("routing_2").$id("@label"),
e.$routing_2=e.child("routing_2").$id("@routing_2")):(e.$routing_2_label=e.$id("@routing_2_label"),e.$routing_2=e.$id("@routing_2")),e.$currency_row=e.$id("@currency_row"),r.pageIsMobile?e.$currency=e.child("currency").$id("@currency"):e.$currency=e.$id("@currency"),e.$account_row=e.$id("@account_row"),r.pageIsMobile?(e.$account_label=e.child("account").$id("@label"),e.$account=e.child("account").$id("@account")):(e.$account_label=e.$id("@account_label"),e.$account=e.$id("@account")),e.$us_tax_info=e.$id("@us_tax_info"),e.taxFormShown=!1,r.pageIsMobile?(e.$dob=e.child("dob").$id("@dob"),e.$address_line1=e.child("address_line1").$id("@address_line1"),e.$address_city=e.child("address_city").$id("@address_city"),e.$address_state=e.child("address_state").$id("@address_state"),e.$address_postal_code=e.child("address_postal_code").$id("@address_postal_code"),e.$ssn=e.child("ssn").$id("@ssn")):(e.$dob=e.$id("@dob"),e.$address_line1=e.$id("@address_line1"),e.$address_city=e.$id("@address_city"),
e.$address_state=e.$id("@address_state"),e.$address_postal_code=e.$id("@address_postal_code"),e.$ssn=e.$id("@ssn")),e.$i18n_verify=e.$id("@i18n_verify"),e.verifyFormShown=!1,r.pageIsMobile?(e.$dob_year_first=e.child("dob_year_first").$id("@dob_year_first"),e.$i18n_address_line1=e.child("i18n_address_line1").$id("@i18n_address_line1"),e.$i18n_address_city=e.child("i18n_address_city").$id("@i18n_address_city"),e.$i18n_address_state=e.child("i18n_address_state").$id("@i18n_address_state"),e.$i18n_address_postal_code=e.child("i18n_address_postal_code").$id("@i18n_address_postal_code"),e.$i18n_address_country=e.child("i18n_address_country").$id("@i18n_address_country")):(e.$dob_year_first=e.$id("@dob_year_first"),e.$i18n_address_line1=e.$id("@i18n_address_line1"),e.$i18n_address_city=e.$id("@i18n_address_city"),e.$i18n_address_state=e.$id("@i18n_address_state"),e.$i18n_address_postal_code=e.$id("@i18n_address_postal_code"),e.$i18n_address_country=e.$id("@i18n_address_country")),e.$country.on("change",function(t){
e.switchCountry(e.$country.val()),"US"===e.countryCode?(e.showVerifyForm(!1),e.$account.val().length>0&&e.showTaxForm(!0),e.$dob_year_first.val(""),e.$i18n_address_line1.val(""),e.$i18n_address_city.val(""),e.$i18n_address_state.val(""),e.$i18n_address_postal_code.val("")):(e.showTaxForm(!1),e.$account.val().length>0&&e.showVerifyForm(!0),e.$ssn.val(""),e.$dob.val(""),e.$address_line1.val(""),e.$address_city.val(""),e.$address_state.val(""),e.$address_postal_code.val(""))}),n(e.$routing_1,function(t){return e._fireOnEdit(),t.replace(/[^0-9]/g,"")}),n(e.$routing_2,function(t){return e._fireOnEdit(),t.replace(/[^0-9]/g,"")}),n(e.$account,function(t){return e._fireOnEdit(),!e.taxFormShown&&"US"===e.countryCode&&e.$account.val().length>0?e.showTaxForm(!0):!e.verifyFormShown&&"US"!==e.countryCode&&e.$account.val().length>0&&e.showVerifyForm(!0),e.inputs().account_numbers_only?t.replace(/[^0-9]/g,""):t.replace(/\s/g,"")}),n(e.$ssn,function(e){var t=e.replace(/[^0-9]/g,"");return t=t.slice(0,3)+"-"+t.slice(3,5)+"-"+t.slice(5,t.length),
t.endsWith("--")?t=t.slice(0,t.length-2):t.endsWith("-")&&(t=t.slice(0,t.length-1)),t}),n(e.$dob,function(e){var t=e.replace(/[^0-9]/g,"");" /"===e.slice(-2)&&(t=t.slice(0,t.length-1));var i=t.slice(0,2),n=parseInt(i,10);(n>12||i.length<2&&n>1)&&(t="0"+t);var o=t.slice(2,4),s=parseInt(o,10);(s>31||o.length<2&&s>3)&&(t=t.slice(0,2)+"0"+t.slice(2,t.length));var a=t.slice(4,6);if(2==a.length&&"19"!=a&&"20"!=a){var r="19";parseInt(a,10)<16&&(r="20"),t=t.slice(0,4)+r+t.slice(4,t.length)}var d=t.slice(0,2);return t.length>=2&&(d+=" / "+t.slice(2,4)),t.length>=4&&(d+=" / "+t.slice(4,t.length)),d}),n(e.$dob_year_first,function(e){var t=e.replace(/[^0-9]/g,"");" /"===e.slice(-2)&&(t=t.slice(0,t.length-1));var i=t.slice(0,2);if(2==i.length&&"19"!=i&&"20"!=i){var n="19";parseInt(i,10)<16&&(n="20"),t=n+i+t.slice(4,t.length)}var o=t.slice(4,6),s=parseInt(o,10);(s>12||o.length<2&&s>1)&&(t=t.slice(0,4)+"0"+o+t.slice(6,t.length));var a=t.slice(6,t.length),r=parseInt(a,10);(r>31||a.length<2&&r>3)&&(t=t.slice(0,6)+"0"+a);
var d=t.slice(0,4);return t.length>=4&&(d+=" / "+t.slice(4,6)),t.length>=6&&(d+=" / "+t.slice(6,t.length)),d}),n(e.$address_state,function(e){return e.replace(/[^a-zA-Z]/g,"").toUpperCase()}),n(e.$address_postal_code,function(e){return e.replace(/[^0-9]/g,"")}),e.focus()},updateCurrencySelector:function(){var e=this;e.$currency.empty();var t=e.currencies[e.countryCode];d.each(t,function(t,i){e.$currency.append(d("<option></option>").val(i).text(i))}),1===t.length?e.$currency_row.addClass("hidden"):e.$currency_row.removeClass("hidden")},onEdit:function(e){void 0===this._editCallbacks&&(this._editCallbacks=[]),this._editCallbacks.push(e)},focus:function(){this.$routing_1_row.hasClass("hidden")?this.$account.focus():this.$routing_1.focus()},showTaxForm:function(e){var t=this,i=333,n="swing";e&&!t.taxFormShown?(t.taxFormShown=!0,r.pageIsMobile?t.$us_tax_info.removeClass("hidden"):d("#"+t.$us_tax_info.attr("id")).animate({height:"show",opacity:"show"},i,n)):!e&&t.taxFormShown&&(t.taxFormShown=!1,
r.pageIsMobile?t.$us_tax_info.addClass("hidden"):d("#"+t.$us_tax_info.attr("id")).animate({height:"hide",opacity:"hide"},i,n))},showVerifyForm:function(e){var t=this,i=333,n="swing";e&&!t.verifyFormShown?(t.verifyFormShown=!0,r.pageIsMobile?t.$i18n_verify.removeClass("hidden"):d("#"+t.$i18n_verify.attr("id")).animate({height:"show",opacity:"show"},i,n)):!e&&t.verifyFormShown&&(t.verifyFormShown=!1,r.pageIsMobile?t.$i18n_verify.addClass("hidden"):d("#"+t.$i18n_verify.attr("id")).animate({height:"hide",opacity:"hide"},i,n))},getRoutingNumber:function(){if(this.inputs().labels.routing_2){var e=this.inputs().routing_join_template;return e.replace("{1}",this.$routing_1.val()).replace("{2}",this.$routing_2.val())}return this.inputs().labels.routing_1?this.$routing_1.val():void 0},getBirthYear:function(){if("US"===this.countryCode){var e=this.$dob.val();return e.replace(/[^0-9]/g,"").slice(4,e.length)}return this.$dob_year_first.val().replace(/[^0-9]/g,"").slice(0,4)},getBirthMonth:function(){
return"US"===this.countryCode?this.$dob.val().replace(/[^0-9]/g,"").slice(0,2):this.$dob_year_first.val().replace(/[^0-9]/g,"").slice(4,6)},getBirthDay:function(){return"US"===this.countryCode?this.$dob.val().replace(/[^0-9]/g,"").slice(2,4):this.$dob_year_first.val().replace(/[^0-9]/g,"").slice(6,8)},getSSN:function(){return this.$ssn.val().replace(/[^0-9]/g,"")},getAddressLine1:function(){return"US"===this.countryCode?this.$address_line1.val():this.$i18n_address_line1.val()},getAddressCity:function(){return"US"===this.countryCode?this.$address_city.val():this.$i18n_address_city.val()},getAddressState:function(){return"US"===this.countryCode?this.$address_state.val():this.$i18n_address_state.val()},getAddressPostalCode:function(){return"US"===this.countryCode?this.$address_postal_code.val():this.$i18n_address_postal_code.val()},getAddressCountry:function(){return"US"===this.countryCode?"US":this.$i18n_address_country.val()},submit:function(e){var t=this;t.isSubmitting||(t.isSubmitting=!0,
document.activeElement.blur(),t._getStripeToken(function(i,n){t.serverCall("submit").kwargs({stripe_response:n,country:t.countryCode,name:t.$name.val(),birth_year:t.getBirthYear(),birth_month:t.getBirthMonth(),birth_day:t.getBirthDay(),address_line1:t.getAddressLine1(),address_city:t.getAddressCity(),address_state:t.getAddressState(),address_postal_code:t.getAddressPostalCode(),address_country:t.getAddressCountry(),ssn:t.getSSN()}).success(function(i){i?(t.isSubmitting=!1,e()):t.isSubmitting=!1}).error(function(){t.isSubmitting=!1,t.showServerError()}).liveMutate().send()}))},showServerError:function(){this.serverCall("show_error_pmsg").send()},inputs:function(e){var t=this.countryInputs[e||this.countryCode];return t.maxlength||(t.maxlength={}),t.placeholders||(t.placeholders={}),t},switchCountry:function(e){this.$form.removeClass("form_country_"+this.countryCode),this.countryCode=e,this.$form.addClass("form_country_"+this.countryCode),this.inputs().labels.routing_1?(this.$routing_1_label.text(this.inputs().labels.routing_1),
this.$routing_1.attr("maxlength",this.inputs().maxlength.routing_1||""),this.$routing_1.attr("placeholder",this.inputs().placeholders.routing_1||""),this.$routing_1_row.removeClass("hidden")):this.$routing_1_row.addClass("hidden"),this.inputs().labels.routing_2?(this.$routing_2_label.text(this.inputs().labels.routing_2),this.$routing_2.attr("maxlength",this.inputs().maxlength.routing_2||""),this.$routing_2.attr("placeholder",this.inputs().placeholders.routing_2||""),this.$routing_2_row.removeClass("hidden")):this.$routing_2_row.addClass("hidden"),this.$account_label.text(this.inputs().labels.account),r.pageIsMobile&&this.$account.attr("type",this.inputs().account_numbers_only?"tel":"text"),this.$account.attr("maxlength",this.inputs().maxlength.account||""),this.$account.attr("placeholder",this.inputs().placeholders.account||""),this.focus(),this.updateCurrencySelector(),this.$i18n_address_country.val(this.countryCode).trigger("change")},_fireOnEdit:function(){if(void 0!==this._editCallbacks)for(;this._editCallbacks.length>0;)this._editCallbacks.pop()();
},_getStripeToken:function(e){Stripe.bankAccount.createToken({country:this.countryCode,currency:this.$currency.val(),routing_number:this.getRoutingNumber(),account_number:this.$account.val(),name:this.$name.val(),account_holder_type:"individual"},e)}})}),define("unified_view/payment/money",["shared/polyfills","shared/core/component"],function(e,t,i){var n=e("shared/core/component").Component;t.MoneyAmountInput=n.extend({onLoad:function(){var e=this;e.$amount=e.$id("@amount"),e.$amount.on("keydown paste change",function(t){setTimeout(function(){e._filter()},1)}),e.$amount.on("blur",function(t){e._filter(!0)})},getValueInCents:function(){var e=this._cleanVal(!0)[1];return-1===e.indexOf(".")?e+="00":e=e.replace(".",""),parseInt(e)},_filter:function(e){var t=this._cleanVal(e),i=t[0],n=t[1],o=t[2];if(i!==n){var s=this.$amount.get()[0],a=s.selectionStart+o,r=s.selectionEnd+o;this.$amount.val(n),s.setSelectionRange(a,r)}},_cleanVal:function(e){for(var t=this.$amount.val(),i="",n=0,o=0,s=0,a=0;a<t.length;a++){
var r=t.charAt(a);this.allowCents&&"."===r?0===o&&(0===n&&(i+="0",n++,s++),i+=r,o++):isNaN(r)||(o>0?3!==o&&(i+=r,o++):n<this.maxDollarNumbers&&(i+=r,n++))}if(e)for(;0!==o&&3>o;)i+="0",o++;var d=i.length;i=i.replace(/^0+(?=\d)/,"");var l=d-i.length;return l>0&&(n-=l,s-=l),[t,i,s]}})}),define("unified_view/pmsg",["shared/polyfills","shared/core/component","shared/toast"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/toast").Toast;t.PMsg=n.extend(o).extend({onLoad:function(){this.$container=this.$id("@container"),this.show()}})}),define("shared/prize_views",["shared/polyfills","shared/core/rpc","shared/debounce","shared/Class"],function(e,t,i){var n=e("shared/core/rpc"),o=e("shared/debounce").debounce,s=e("shared/Class").Class.extend({__init__:function(){var e=this;e.buffer={},this.debouncedFlush=o(function(){var t=Object.keys(e.buffer);t.length&&(n.rpc("/ajax/log_prize_views_POST").kwargs({prize_ids:t}).send(),e.buffer={})},400)},log:function(e){this.buffer[e]||(this.buffer[e]=!0,
this.debouncedFlush())}});t.logger=new s}),define("unified_view/prize/_prize",["shared/polyfills","shared/core/component","shared/prize_views"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/prize_views").logger;t.PrizeQuestionPagePrompt=n.extend({onLoad:function(){var e=this;this.should_log_view&&o.log(this.prize_id),e.$id("@opt_into_notifs").on("click",function(t){t.preventDefault(),e.serverCall("opt_into_notifs").liveMutate().send()})},hide:function(){this.$id("@prompt").addClass("hidden")}}),t.PrizeConditionsModalLink=n.extend({onLoad:function(){var e=this;e.$id("@link").on("click",function(t){t.preventDefault(),e.createModal("load_modal").kwargs({prize_id:e.prize_id}).show()})}}),t.PrizeBadge=n.extend({onLoad:function(){this.beta_enabled&&o.log(this.prize_id)}}),t.PrizeAdminToolbar=n.extend({onLoad:function(){var e=this;e.$id("@submit").on("click",function(t){t.preventDefault();var i=e.$id("@score").val();e.serverCall("set_score_override").kwargs({score:i}).liveMutate().send();
})}})}),define("unified_view/prize/collect",["shared/polyfills","shared/core/component","shared/jquery","unified_view/modal","interface/settings","shared/client"],function(e,t,i){var n,o,s,a=e("shared/core/component").Component,r=e("shared/jquery"),d=e("unified_view/modal").ModalBase,l=e("interface/settings"),c=e("shared/client");l.pageIsMobile&&(o=e("mobile_app2/client"),n=e("mobile_app2/messages"),s=e("mobile_app2/app/view/common")),t.PrizeCollectModal=d.extend({onLoadMobile:function(){this._super.apply(this,arguments);var e=this;o.registerMessageHandler("dismissPrizeCollect",function(){e.close()}),e.setMobileDoneButtonDisabled(!0),e.child("prize_collect_form").child("picker").onToggleCell(function(){e.setMobileDoneButtonDisabled(!1)})},onSubmit:function(){var e=this;e.child("prize_collect_form").submit(function(){e.close()})}});var h={collectPrizeServerCall:function(e,t){var i=this;void 0===i._collectPrizeServerCallIsSubmitting&&(i._collectPrizeServerCallIsSubmitting=!0,l.pageIsMobile&&n.send("showLoadingView"),
i.serverCall("collect_prize").kwargs({deposit_method:e}).success(function(e){l.pageIsMobile?(n.send("hideLoadingView"),s.showAlert({title:e.title,message:e.message,callback:function(){t()}})):t()}).error(function(){i._collectPrizeServerCallIsSubmitting=void 0,l.pageIsMobile&&n.send("hideLoadingView"),i._prizeCollectServerCallServerError()}).liveMutate().send())},_prizeCollectServerCallServerError:function(){this.serverCall("show_prize_collect_error_pmsg").send()}};t.PrizeCollectForm=a.extend(h).extend({onLoad:function(){var e=this;if(l.pageIsMobile)e.picker=e.child("picker");else{e.$radios=e.$id("@picker input[type=radio]"),e.$bank_radio=e.$id("@bank"),e.$bank_details=e.$id("@bank_details"),e.addBankForm=e.child("add_bank_form");var t=function(){e.$radios.map(function(){var e=r(this),t=r("label[for='"+e.attr("id")+"']").parent();t.toggleClass("selected",e.is(":checked")),t.toggleClass("not_selected",!e.is(":checked"))})};e.$radios.on("change",function(i){if(e.addBankForm){var n=333,o="swing";
e.$bank_details.length&&(e.$bank_radio.is(":checked")?r("#"+e.$bank_details.attr("id")).animate({height:"show",opacity:"show"},n,o,function(){e.addBankForm&&e.addBankForm.focus()}):r("#"+e.$bank_details.attr("id")).animate({height:"hide",opacity:"hide"},n,o))}t()}),e.addBankForm&&e.addBankForm.onEdit(function(){t()})}},getSelectedDepositMethod:function(){var e;if(l.pageIsMobile){var t=this.picker.checkedRadioIndex();void 0!==t&&(e=this.options[t])}else{var i=this.$id("@picker input[type=radio]:checked");i&&(e=i.val())}return e},submit:function(e){var t=this,i=t.getSelectedDepositMethod();i&&!t.isSubmitting&&("bank"===i&&t.missing_bank?l.pageIsMobile?n.send("openURL",{url:"/prizes/collect?application_id="+t.application_id}):t.addBankForm.submit(function(){t.collectPrizeServerCall(i,e)}):t.collectPrizeServerCall(i,e))}}),t.PrizeCollectBankMain=a.extend(h).extend({onLoad:function(){if(l.pageIsMobile){var e=this;o.registerMessageHandler("dismissPrizeCollect",function(){n.send("dismiss")}),n.send("setPageAction",{
rightTextButton:{title:l.interface_strings.done,callback:function(){e.submit()}}})}},submit:function(){if(l.pageIsMobile){var e=this;e.child("add_bank_form").submit(function(){e.collectPrizeServerCall("bank",function(){c.isMobileWeb()?n.send("openURL",{url:"/notifications"}):o.broadcastMessageToWebViews("dismissPrizeCollect")})})}}})}),define("unified_view/prize/sponsor",["shared/polyfills","shared/core/component","unified_view/modal","shared/jquery"],function(e,t,i){var n=e("shared/core/component").Component,o=e("unified_view/modal").ModalBase,s=e("shared/jquery"),a={showBuyCreditsModal:function(e,t){this.createModal("load_buy_credits_modal").kwargs({num_credits_required:e}).onSubmit(function(){t&&t()}).show()}};t.NewPrizeForm=n.extend(a).extend({onLoad:function(){var e=this;e.$show_details_editor_link=e.$id("@show_details_editor_link"),e.$details_editor_wrapper=e.$id("@details_editor_wrapper"),e.$default_amount=e.$id("@amount_"+e.default_amount_cents),e.$default_duration=e.$id("@duration_"+e.default_duration),
e.$anonymous=e.$id("@anonymous"),e.$submit=e.$id("@submit"),e.$form_actions=e.$id("@form_actions"),e.textEditor=e.child("text_editor"),e.detailsEditor=e.child("details_editor"),e.textTooLong=!1,e.detailsTooLong=!1,e.submitShown=!1,e._isSubmitting=!1,e.$show_details_editor_link.on("click",function(t){t.preventDefault(),e.$show_details_editor_link.addClass("hidden"),e.$details_editor_wrapper.removeClass("hidden"),e.detailsEditor.focus()}),e.textEditor.setMeaningfulChangeCallback(function(){e._maybeDisableSubmit(),e.textEditor.isOnlyWhiteSpace()?e._toggleSubmitShown(!1):e._toggleSubmitShown(!0)}),e.textEditor.setLengthChangeCallback(function(t){e.textTooLong=t,e._maybeDisableSubmit()}),e.detailsEditor.setLengthChangeCallback(function(t){e.detailsTooLong=t,e._maybeDisableSubmit()}),e.$submit.on("click",function(t){t.preventDefault(),e.submit()})},getSelectedAmountCents:function(){if(!this.is_subscriber){var e=this.$id("@amount_picker input[type=radio]:checked");return e?parseInt(e.val()):void 0;
}},getSelectedDuration:function(){var e=this.$id("@duration_picker input[type=radio]:checked");return e?parseInt(e.val()):void 0},getAnonymous:function(){return this.$anonymous.length?this.$anonymous.prop("checked"):!0},reset:function(){this.textEditor.clear(),this.detailsEditor.clear(),this.$show_details_editor_link.removeClass("hidden"),this.$details_editor_wrapper.addClass("hidden"),this._toggleSubmitShown(!1),this.is_subscriber||this.$default_amount.prop("checked",!0),this.$default_duration.prop("checked",!0)},isValid:function(){return!this.textEditor.isOnlyWhiteSpace()&&!this.textTooLong&&!this.detailsTooLong},submit:function(){var e=this;e._isSubmitting||e.isValid()&&(e._toggleSubmitting(!0),e.serverCall("submit").kwargs({text:e.textEditor.serialize(),details:e.detailsEditor.serialize(),amount_cents:e.getSelectedAmountCents(),duration:e.getSelectedDuration(),anonymous:e.getAnonymous()}).success(function(t){e._toggleSubmitting(!1),t.success?e.reset():e.showBuyCreditsModal(t.num_credits_required,function(){
e.submit()})}).error(function(){e._toggleSubmitting(!1)}).liveMutate().send())},_maybeDisableSubmit:function(){this.$submit.toggleClass("disabled",!this.isValid())},_toggleSubmitShown:function(e){var t=s("#"+this.$form_actions.attr("id")),i=166,n="swing";e?this.submitShown||(this.submitShown=!0,t.animate({height:"show",opacity:"show"},i,n).css("overflow","visible")):this.submitShown&&(this.submitShown=!1,t.animate({height:"hide",opacity:"hide"},i,n).css("overflow","visible"))},_toggleSubmitting:function(e){this._isSubmitting=e,this._isSubmitting?(this.textEditor.disable(),this.detailsEditor.disable(),this.$id("@amount_picker input[type=radio]").prop("disabled",!0),this.$id("@duration_picker input[type=radio]").prop("disabled",!0)):(this.textEditor.enable(),this.detailsEditor.enable(),this.$id("@amount_picker input[type=radio]").attr("disabled",!1),this.$id("@duration_picker input[type=radio]").attr("disabled",!1))}}),t.PrizesCreditBalance=n.extend(a).extend({onLoad:function(){var e=this;
e.$id("@buy").on("click",function(t){t.preventDefault(),e.showBuyCreditsModal()})}}),t.PrizesBuyCreditsModal=o.extend({onSubmit:function(){var e=this,t=e._super;e.child("buy_credits_form").submit(function(){t.apply(e,arguments)})}}),t.PrizesBuyCreditsForm=n.extend({onLoad:function(){var e=this;e.$radios=e.$id("@option_picker input[type=radio]"),e.$radios.on("change",function(t){e.$radios.map(function(){var e=s(this),t=s("label[for='"+e.attr("id")+"']");t.toggleClass("selected",e.is(":checked")),t.toggleClass("not_selected",!e.is(":checked"))}),e.updatePurchaseDetails()})},updatePurchaseDetails:function(){var e=this,t=e.$id("@purchase_details .purchase_details_item");t.map(function(){var t=s(this),i=parseInt(t.attr("id").split("_").slice(-1)[0]);t.toggleClass("hidden",i!==e.getSelectedNumCredits())}),e.purchaseDetailsShown||(e.purchaseDetailsShown=!0,s("#"+e.$id("@purchase_details").attr("id")).animate({height:"show",opacity:"show"},166,"swing"))},getSelectedNumCredits:function(){var e=this.$id("@option_picker input[type=radio]:checked");
return e?parseInt(e.val()):void 0},submit:function(e){function t(){i.serverCall("submit").kwargs({num_credits:o}).success(function(){e(),i.isSubmitting=!1}).error(function(){i.isSubmitting=!1}).liveMutate().send()}var i=this,n=i.child("add_card_form"),o=i.getSelectedNumCredits();i.isSubmitting||o&&(i.isSubmitting=!0,n?n.submit(function(){t()}):t())}}),t.PrizeChooseWinnerModal=o.extend({onSubmit:function(){var e=this,t=e._super;e.child("choose_winner_form").submit(function(){t.apply(e,arguments)})}}),t.PrizeChooseWinnerForm=n.extend({getSelectedAppIDs:function(){var e=[];return this.$id("@applications input[type=checkbox]:checked").map(function(){e.push(parseInt(this.value))}),e},submit:function(e){var t=this;t.serverCall("submit").kwargs({prize_id:t.prize_id,winning_application_ids:t.getSelectedAppIDs()}).success(function(t){e()}).liveMutate().send()}})}),define("unified_view/qtext",["shared/polyfills","interface/settings","shared/client_tracker","shared/core/component","shared/events/index","unified_view/toggle","shared/cookies","shared/jquery","shared/action_log","video"],function(e,t,i){
var n=e("interface/settings"),o=e("shared/client_tracker"),s=e("shared/core/component").Component,a=e("shared/events/index"),r=e("unified_view/toggle"),d=e("shared/cookies"),l=e("shared/jquery"),c=e("shared/action_log");t.Expandable=r.ToggleBase.extend({onLoad:function(){this._super.apply(this,arguments);var e=this;this.handleEvent(a.Types.QTEXT_EXPANDABLE_STATE,function(t){e.content_type&&t.payload.content_type==e.content_type&&t.payload.oid==e.oid&&e.triggerSwitch()})},actualSwitch:function(){if(this.emitEvent({type:a.Types.ANSWER_FEED_INLINE_EXPAND,payload:{aid:this.oid}}),!this.switchCompleted&&(this.obj_type&&(o.track(this.obj_type+"Expand",null,this),d.setQfeedLog(this,this.obj_type+"Expand")),c.logSecondaryAction("ContentExpand",null),!n.pageIsMobile)){var t=l(this.$switchHide.get(0)),i=e("video");i.handleVideosBeforeSelectionHidden(t)}this.css_truncation?(this.$id("@wrapper").addClass("expanded"),this.$id("@wrapper").removeClass("truncated")):this._super()}}),t.Diff=s.extend({onLoad:function(){
var e=this;e.$id("@more_link").on("click",function(){return e.$id("@diff_snip").addClass("hidden"),e.$id("@full_diff").removeClass("hidden"),!1})}})}),define("unified_view/qtext2/photo_search",["shared/polyfills","shared/core/component","shared/debounce"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/debounce").debounce;t.PhotoSearch=n.extend({onLoad:function(){this.hasInitialized=!1},initSearchInput:function(){var e=this,t="",i=e.$id("@search"),n=o(function(){var n=i.val();n!==t&&n.length>=3&&(e.getPhotos(n),t=n)},500);i.on("keydown",function(){n()})},initUploadLink:function(){var e=this;e.$id("@upload").on("click",function(t){t.preventDefault(),e.$uploader&&(e.uploadCallback&&e.uploadCallback(),e.$uploader.click())})},setUploader:function(e){this.$uploader=e},makeActive:function(){this.$id("@search").focus(),this.serverCall("log_action").kwargs({action_type:"open"}).send(),this.hasInitialized===!1&&(this.initSearchInput(),this.initUploadLink(),this.load_default_results&&this.getPhotos(),
this.hasInitialized=!0)},getPhotos:function(e){var t=this;e&&0!==e.length||(e=t.default_query),t.clearPhotos(),t.$id("@spinner").removeClass("hidden"),t.serverCall("get_photos").kwargs({query:e}).success(function(e){t.$id("@spinner").addClass("hidden"),t.renderPhotos(e)}).send()},renderEmptyState:function(){var e=this.$id("@empty_state");e.text(this.empty_msg),e.removeClass("hidden")},renderPhotos:function(e){var t=document.createDocumentFragment(),i=this;return 0===e.length?void i.renderEmptyState():(e.forEach(function(e){var n=document.createElement("img");n.src=e[1],n.dataset.original=e[0],n.addEventListener("click",function(){i.selectCallback&&i.selectCallback(n.dataset.original),i.serverCall("log_action").kwargs({action_type:"insert_image"}).send()}),t.appendChild(n)}),void this.$id("@container").get(0).appendChild(t))},clearPhotos:function(){for(var e=this.$id("@container").get(0),t=0;t<e.childNodes.length;)"IMG"==e.childNodes[t].tagName?e.removeChild(e.childNodes[t]):++t;this.$id("@empty_state").addClass("hidden");
},setSelectCallback:function(e){this.selectCallback=e},setUploadCallback:function(e){this.uploadCallback=e}})}),define("qtext2",["shared/polyfills","unified_view/qtext2/editor/mobile","unified_view/qtext2/toolbar"],function(e,t,i){var n=e("unified_view/qtext2/editor/mobile"),o=e("unified_view/qtext2/toolbar");t.handleToolbarAction=function(e,t){o.activeToolbar&&o.activeToolbar.trigger(e,t)},t.handleRestoreState=function(e){n.activeEditor.restoreState(e)},t.saveDraft=function(){n.activeEditor.saveDraft()},t.clearDraft=function(){n.activeEditor.clearDraft()},t.focus=function(){n.activeEditor.focus()}}),define("qtext2/keys",["shared/polyfills","shared/Class"],function(e,t,i){var n=e("shared/Class").Class,o=t.isMac=/Mac/.test(window.navigator.platform),s={8:"BACKSPACE",9:"TAB",13:"RETURN",27:"ESCAPE",35:"END",36:"HOME",37:"LEFT",38:"UP",39:"RIGHT",40:"DOWN",46:"DELETE",106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"
},a=function(e){return-1!=[35,36,37,38,39,40].indexOf(e.which)},r=function(e){return e.shiftKey&&16==e.which},d=n.extend({__init__:function(e){e=e.toUpperCase(),this.alt=/ALT-/.test(e),this.ctrl=/CTRL-/.test(e)||!o&&/CMD-/.test(e),this.meta=/META-/.test(e)||o&&/CMD-/.test(e),this.shift=/SHIFT-/.test(e),this.character=e.split("-").pop()},toString:function(){var e="";return this.alt&&(e+="ALT-"),this.ctrl&&(e+="CTRL-"),this.meta&&(e+="META-"),this.shift&&(e+="SHIFT-"),e+=this.character}}),l=function(e){var t=s[e.which]||String.fromCharCode(e.which).toUpperCase(),i="";return e.altKey&&(i+="ALT-"),e.ctrlKey&&(i+="CTRL-"),e.metaKey&&(i+="META-"),e.shiftKey&&(i+="SHIFT-"),i+=t},c=n.extend({__init__:function(){this._handlers=[]},on:function(e,t){var i=new d(e);if(i in this._handlers)throw new Error("Already attached handler for "+i);this._handlers[i]=t},trigger:function(e){var t=l(e),i=this._handlers[t];return i?i(e):!0}});t.getShortcutHint=function(e){var t=new d(e),i="";return o?(t.meta&&(i+="&#x2318;"),
t.ctrl&&(i+="^"),t.alt&&(i+="&#x2325;"),t.shift&&(i+="&#x21E7;")):(t.ctrl&&(i+="Ctrl-"),t.alt&&(i+="Alt-"),t.shift&&(i+="Shift-")),i+t.character[0]+t.character.slice(1).toLowerCase()},t.isNavigation=a,t.isOnlyShiftKey=r,t.Hub=c,t.SPECIAL_KEYS=s}),define("qtext2/shortcuts",["shared/polyfills","qtext2/keys","shared/util"],function(e,t,i){var n=e("qtext2/keys"),o=e("shared/util").extend,s={Backspace:"backspace",Delete:"delete",Return:"return","Alt-Return":"return","Ctrl-Return":"return","Shift-Return":"soft-return"," ":"space",Tab:"indent","Shift-Tab":"deindent","Cmd-B":"bold","Cmd-I":"italic","Cmd-U":"underline","Cmd-K":"link","Cmd-Shift-7":"ordered_list","Cmd-Shift-8":"unordered_list","Cmd-Shift-9":"quote","Cmd-Shift-K":"code","Cmd-Shift-L":"math","Cmd-Z":"undo","Cmd-Shift-Z":"redo"};n.isMac?o(s,{"Ctrl-H":"backspace","Ctrl-D":"delete","Ctrl-K":"delete-forward","Cmd-Backspace":"delete-backward","Ctrl-T":"transpose","Ctrl-Backspace":"backspace","Ctrl-Delete":"delete","Shift-Backspace":"backspace",
"Shift-Delete":"delete","Alt-Backspace":"delete-previous-word","Alt-Delete":"delete-next-word","Ctrl-U":"underline"}):o(s,{"Ctrl-Backspace":"delete-previous-word","Ctrl-Delete":"delete-next-word","Shift-Backspace":"backspace","Shift-Delete":"delete","Alt-Backspace":"backspace","Alt-Delete":"delete"}),t.SHORTCUTS=s}),define("qtext2/tooltip",["shared/polyfills","shared/jquery"],function(e,t,i){var n,o,s=null,a=e("shared/jquery"),r=function(){n||(n=a("<div>").addClass("qtext2_tooltip"),a(document.body).append(n),o=a("<div>"),n.append(o))};t.show=function(e,t){r(),e=a(e);var i=e.offset(),d=i.left+.5*e.width();o.html(t),i.top<30?n.css("top",e.height()+20):n.css("top",i.top-30),n.css("left",Math.max(0,d-.5*n.width())),n.removeClass("hidden"),clearTimeout(s),s=setTimeout(function(){n.addClass("visible")},500)},t.hide=function(){n&&(clearTimeout(s),s=setTimeout(function(){n.removeClass("visible"),n.addClass("hidden")},100))}}),define("unified_view/qtext2/toolbar",["shared/polyfills","shared/core/component","shared/jquery","interface/settings","shared/scroll_animation_handler","qtext2","qtext2/keys","qtext2/shortcuts","qtext2/util","qtext2/tooltip"],function(e,t,i){
var n,o=e("shared/core/component").Component,s=e("shared/jquery"),a=e("interface/settings").pageIsMobile,r=e("shared/scroll_animation_handler"),d=e("qtext2"),l=e("qtext2/keys"),c=e("qtext2/shortcuts").SHORTCUTS,h=e("qtext2/util").Util,u=e("qtext2/tooltip");a&&(n=e("mobile_app2/messages"));var p=o.extend({onLoad:function(){this._barIdx=1},on:function(e,t){this._handlers=this._handlers||[],this._handlers[e]=t},trigger:function(e,t){this._handlers[e]&&this._handlers[e](t)},makeActive:function(e){this.showBar(1),this._doc=e,this._startUpdating(),t.activeToolbar=this},makeInactive:function(){this._doc=null,this._updating=!1,t.activeToolbar=null},showBar:function(e){this._barIdx<e?this._animation="up":this._barIdx>e?this._animation="down":this._animation="",this._barIdx=e},_startUpdating:function(){var e=this;if(this.currentState=null,!this._updating){this._updating=!0;var t=function(){e._doc&&(e.update(e._doc.getToolbarState(e._barIdx),e._animation),e._animation=!1,requestAnimationFrame(t))};
t()}},update:function(e,t){h.jsonEqual(e,this.currentState)||(this._update(e,t),this.currentState=e)},_update:null});t.Web=p.extend({onLoad:function(){this._super.apply(this,arguments),this.$linkInput=this.$id("@link_input"),this.$linkSave=this.$id("@link_save"),this.$isCitation=this.$id("@is_citation"),this.buttons.forEach(this.bindButtonEvents.bind(this)),this.bindLinkInput(),this.fix()},bindButtonEvents:function(e){this._bindButtonClick(e),this._bindButtonTooltip(e)},_bindButtonClick:function(e){var t="image"==e?"click":"touchstart mousedown",i=this;this.$id("@"+e).on(t,function(){return u.hide(),i.trigger("click",e),!1})},_bindButtonTooltip:function(e){this.$id("@"+e).on("mouseenter",function(){var t,i=this.getAttribute("tooltip");for(t in c)if(c[t]==e){i+=" ("+l.getShortcutHint(t)+")";break}u.show(this,i)}),this.$id("@"+e).on("mouseout",function(){u.hide()})},bindLinkInput:function(){var e=this;this.$linkSave.on("click",function(){return e._triggerLinkInput(),!1}),this.$linkInput.on("keydown",function(t){
13==t.which?(t.preventDefault(),t.stopPropagation(),e._triggerLinkInput()):27==t.which&&(t.preventDefault(),t.stopPropagation(),e.$linkInput.val(""),e._triggerLinkInput())})},_triggerLinkInput:function(){this.trigger("linkInput",{url:this.$linkInput.val(),isCitation:this.$isCitation.prop("checked")}),this.$linkInput.val(""),this.$isCitation.prop("checked",!1)},_update:function(e,t){var i,n=this,o=this.$id("@bar"+this._barIdx),s=n.$id("@storage"),a=o.children(".left"),r=n.$id("@scroller");o.find(".modifier").each(function(e,t){s.append(t)}),e.forEach(function(e){"space"==e.name?a=o.children(".right"):(i=n.$id("@"+e.name),e.disabled?(i.removeClass("pressed"),i.addClass("disabled")):e.pressed?(i.removeClass("disabled"),i.addClass("pressed")):(i.removeClass("disabled"),i.removeClass("pressed")),a.append(i),e.focused&&i.focus())}),t?r.addClass("animate"):r.removeClass("animate"),r.css("top",100*-this._barIdx+"%")},setLinkToolbarStatus:function(e,t){this.$linkInput.val(e),this.$isCitation.prop("checked",!!t),
this.$linkSave.text(e?"Update":"Add")},fix:function(){var e=this.$id("@toolbar"),t=e.parent(),i=h.firstScrollingParent(e.get(0)),n=s(".SiteHeader").height();(0!==s(".is_zen").length||i!==document.body)&&(n=0);var o=function(o){var a=t.offset().top-n;a-=i===document.body?o:s(i).offset().top;var r=a+t.height()-2*e.height();0>a&&r>0?e.css("position","fixed").css("top",n).css("left",t.offset().left).css("width",t.width()).css("-webkit-transform","translateZ(0)"):e.css("position","absolute").css("top",0).css("left",0).css("width","").css("-webkit-transform","")};i===document.body?r.add(window,o):r.add(i,o)}}),t.activeToolbar=null;var f;t.MobileWebShim=t.Web.extend({onLoad:function(){this._super.apply(this),f=this},_bindButtonTooltip:function(e){},trigger:function(e,t){d.handleToolbarAction(e,t)},fix:function(){}}),t.updateMobileWebShim=function(e){if(f){for(var t=1,i=0;i<e.buttons.length;i++){if("link_input"==e.buttons[i].name){t=0;break}if("undo"==e.buttons[i].name){t=2;break}}f.showBar(t),
f.update(e.buttons,e.animation)}},t.Mobile=p.extend({_update:function(e,t){n.send("updateToolbar",{buttons:e,animation:t})}})}),define("unified_view/question/ask_question",["shared/polyfills","shared/core/component","shared/events/index","shared/window_manager","unified_view/modal","interface/settings","shared/w2.context","shared/debounce","view/selector"],function(e,t,i){var n,o=e("shared/core/component").Component,s=e("shared/events/index"),a=e("shared/window_manager"),r=e("unified_view/modal").ModalBase,d=e("interface/settings").pageIsMobile,l=e("shared/w2.context"),c=e("shared/debounce").debounce;if(d){var h=e("mobile_app2/client"),u=e("mobile_app2/messages");n=e("mobile_app2/view/selector").Selector}else n=e("view/selector").Selector;t.AskQuestionButton=o.extend({onLoad:function(){var e=this;this.actionBarContext=this.getContext(l.ActionBar),this.$id("@button").on("click",function(){e.showModal()}),e.shouldOpenModal&&e.showModal()},showModal:function(){var e=this;d?u.send("showActionView",{
url:"/ask_question",dragToDismiss:!0}):e.createModal("ask_question_modal").kwargs({target_type:e.targetType,target_oid:e.targetOid,source:e.source}).onSubmit(function(){e.onSubmit()}).show()},onSubmit:function(){this.actionBarContext&&(this.actionBarContext.set("loadComments",!0),this.actionBarContext.set("showComments",!0))}}),t.AskQuestionModal=r.extend({onLoad:function(){var e=this;e.busy=!1,e._super.apply(e,arguments),d?e.loadModalMobile():e.loadModalDesktop(),e.handleEvent(s.Types.ASK_QUESTION_MODAL_QUERY_CHANGE,function(t){e.updateCounter()})},loadModalDesktop:function(){var e=this;this.handleEvent(s.Types.ASK_QUESTION_MODAL_SUBMIT,function(t){e.onSubmit()}),this.$id("@anon_checkbox").on("change",function(t){e.toggleAnon(e.$id("@anon_checkbox").prop("checked")||!1)})},loadModalMobile:function(){var e=this,t={buttonText:e.submitButtonText,anonToggleText:e.anonymouslyText,enabled:!0};u.send("showAskToolbar",t),h.registerMessageHandler("askToolbarSubmit",function(t){e.ask(t.is_anonymous);
}),h.registerMessageHandler("askToolbarToggleAnon",function(t){e.toggleAnon(t.is_anonymous)})},onSubmit:function(){this.ask(this.$id("@anon_checkbox").prop("checked")||!1)},ask:function(e){var t=this,i=t.child("question_bar");t.setBusyState(!0),t.serverCall("ask_question").liveMutate().kwargs({question_text:i.query,is_anon:e,question_details:"",source:t.source,target_type:t.targetType,target_oid:t.targetOid}).success(function(e){var i=e[0],n=e[1];t.setBusyState(!1),i&&(t.submit(),t.close()),n&&a.navigateTo(n)}).except(function(e){t.setBusyState(!1)}).error(function(e){t.setBusyState(!1)}).send()},setBusyState:function(e){if(this.busy=e,this.toggleButtonState(!this.busy),d){var t;t=this.busy?{buttonText:this.busyButtonText}:{buttonText:this.submitButtonText},u.send("showAskToolbar",t)}else this.busy?this.$id("@submit").html(this.busyButtonText):this.$id("@submit").html(this.submitButtonText)},toggleAnon:function(e){e?(this.$id("@user_asks").addClass("hidden"),this.$id("@anon_asks").removeClass("hidden")):(this.$id("@anon_asks").addClass("hidden"),
this.$id("@user_asks").removeClass("hidden"))},toggleButtonState:function(e){if(d){var t={enabled:e};u.send("showAskToolbar",t)}else e?this.$id("@submit").removeClass("submit_button_disabled"):this.$id("@submit").addClass("submit_button_disabled")},updateCounter:function(){var e=this.child("question_bar").charactersLeft();if(d){var t="";15>e&&(t+=e);var i={currentCount:t};u.send("showAskToolbar",i)}this.toggleButtonState(e>=0)}}),t.AskQuestionSelector=n.extend({onLoad:function(){var e=this;e.$input=e.$id("@input"),e.queryChangeDebounced=c(function(){e.emitEvent({type:s.Types.ASK_QUESTION_MODAL_QUERY_CHANGE,payload:{query:e.query}})},10,{maxWait:2e3,trailing:!0}),e._super.apply(e,arguments),e.$input.on("keydown",function(t){13==t.which&&(t.preventDefault(),e.emitEvent({type:s.Types.ASK_QUESTION_MODAL_SUBMIT,payload:{}}))}),e.handleEvent(s.Types.ASK_QUESTION_MODAL_RESULT_CLICK,function(t){var i=t.payload.question_text;e.query=i,e.setInputVal(i);var n=i.length;i.endsWith(e.closing_question_punctuation)&&(n-=e.closing_question_punctuation.length),
e.$input.get(0).setSelectionRange(n,n),e.resizeInput()}),e.minWords=3,e.delay=500,e.timer=null,e.firstEdit=!0,e.allow_no_selection=!0,e.$input.get(0).focus(),e.$id("@add_details").on("click",function(t){t.preventDefault(),e.showQuestionDetailsEditor(!0)}),e.$id("@remove_details").on("click",function(t){t.preventDefault(),e.showQuestionDetailsEditor(!1)})},charactersLeft:function(){return this.question_length_limit-this.query.length},resizeInput:function(){var e=document.createEvent("Event");e.initEvent("autosize:update",!0,!1),this.$input.get(0).dispatchEvent(e)},setInputVal:function(e,t){var i=this.$input.get(0).selectionStart,n=this.$input.get(0).selectionEnd;t&&(i+=t,n+=t),this.$input.val(e),e.length>0&&this.$input.get(0).setSelectionRange(i,n)},showQuestionDetailsEditor:function(e){e?(this.$id("@add_details").addClass("hidden"),this.$id("@remove_details").removeClass("hidden"),this.$id("@details_wrapper").removeClass("hidden")):(this.$id("@remove_details").addClass("hidden"),this.$id("@add_details").removeClass("hidden"),
this.$id("@details_wrapper").addClass("hidden"))},capitalize:function(e){if(!e)return e;var t=this.opening_question_punctuation.length;return e=e.slice(0,t)+e.charAt(t).toUpperCase()+e.slice(t+1)},queryDidChange:function(){var e=this,t=0;this.firstEdit&&(this.firstEdit=!1,this.query=this.opening_question_punctuation+this.query+this.closing_question_punctuation,t=this.opening_question_punctuation.length),this.setInputVal(this.capitalize(this.query),t),e.queryChangeDebounced()},wrapperFocusoutHandler:function(){},updateResults:function(){window.clearTimeout(this.timer),this.query.split(" ").length>=this.minWords&&(this.timer=window.setTimeout(this._super.bind(this),this.delay))}}),t.AskQuestionSelectorResult=o.extend({onLoad:function(){var e=this;this.$id("@question_text").on("click",function(t){e.emitEvent({type:s.Types.ASK_QUESTION_MODAL_RESULT_CLICK,payload:{question_text:e.$id("@question_text").text()}})})}})}),define("unified_view/question/prompt",["shared/polyfills","shared/core/component","interface/settings"],function(e,t,i){
var n=e("shared/core/component").Component,o=e("interface/settings").pageIsMobile;if(o)var s=e("mobile_app2/client"),a=e("mobile_app2/messages");t.QuestionMergedPrompt=n.extend({onLoad:function(){var e=this;o&&s.registerMessageHandler("questionsMerged",function(t){for(var i=0;i<t.qids.length;i++)t.qids[i]===e.qid&&(a.send("setCanonicalURL",{url:t.canonical_url}),a.send("reload"))})}})}),define("unified_view/question/rad",["shared/polyfills","shared/core/component","shared/w2.context","shared/cookies","shared/action_log"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/w2.context").ActionBar,s=e("shared/cookies"),a=e("shared/action_log");t.RADToggle=n.extend({onLoad:function(){var e=this;e.actionBarContext=e.getContext(o),e.$id("@toggle").on("click",function(t){t.preventDefault(),e.actionBarContext.set("toggleRAD",!e.actionBarContext.get("toggleRAD"))}),e.actionBarContext.on("toggleRAD",function(t,i){i===!0?(e.$id("@toggle").addClass("is_active"),e.$id("@nub").addClass("is_active")):(e.$id("@toggle").removeClass("is_active"),
setTimeout(function(){e.$id("@nub").removeClass("is_active")},160))})}}),t.RequestAnswersDrawer=n.extend({onLoad:function(){var e=this;e.actionBarContext=e.getContext(o),e.should_open_by_default&&e.actionBarContext.set("toggleRAD",!0),e.actionBarContext.on("toggleRAD",function(t,i){e.toggleDrawer(i)}),e.$id("@close_button").on("click",function(t){t.preventDefault(),e.$id("@drawer").removeClass("is_active"),e.actionBarContext.set("toggleRAD",!1)})},toggleDrawer:function(e){var t=this;e?t.showDrawer():t.hideDrawer()},showDrawer:function(){var e=this;e.$id("@drawer").hasClass("is_active")||(e.animated?(e.$id("@drawer").addClass("transitioning_in"),setTimeout(function(){e.$id("@drawer").removeClass("transitioning_in"),e.$id("@drawer").addClass("is_active")},200)):e.$id("@drawer").addClass("is_active"))},hideDrawer:function(){var e=this;e.$id("@drawer").hasClass("is_active")&&(e.$id("@drawer").removeClass("is_active"),e.animated&&(e.$id("@drawer").addClass("transitioning_out"),setTimeout(function(){
e.$id("@drawer").removeClass("transitioning_out")},200)))}}),t.RequestAnswersDrawerStandalone=t.RequestAnswersDrawer.extend({onLoad:function(){var e=this;e.toggleDrawer(!0)}}),t.RequestFromQuoraLink=n.extend({onLoad:function(){var e=this;e.$id("@request_answers_button").on("click",function(){e.$id("@request_answers_button").hasClass("is_active")?e.unRequestAnswers():e.requestAnswers()})},requestAnswers:function(){var e=this;e.$id("@list_item").addClass("is_active"),e.$id("@request_answers_button").addClass("is_active"),e.serverCall("request_answers").error(function(){e.$id("@request_answers_button").removeClass("is_active")}).send(),s.setTlog({type:"QuestionReask",qid:e.qid}),s.setQfeedLog(e,"QuestionReask")},unRequestAnswers:function(){var e=this;e.$id("@list_item").removeClass("is_active"),e.$id("@request_answers_button").removeClass("is_active"),e.serverCall("unrequest_answers").error(function(){e.$id("@request_answers_button").addClass("is_active")}).send()}}),t.Suggestions=n.extend({
onLoad:function(){var e=this;e.suggestionsLoaded=e.should_load_by_default,e.actionBarContext=e.getContext(o),e.actionBarContext.get("toggleRAD")&&e.loadSuggestions(),e.actionBarContext.on("toggleRAD",function(t,i){i===!0&&e.loadSuggestions()})},loadSuggestions:function(){var e=this;e.suggestionsLoaded!==!0&&e.serverCall("get_suggestions_list").contentFor(e.$id("@suggestions_list").get(0)).success(function(){e.suggestionsLoaded=!0}).send()}}),t.SuggestionListItem=a.ActionableComponent.extend({onLoad:function(){var e=this;e.$id("@request_button").on("click",function(){e.request()}),e._super.apply(e,arguments)},request:function(){var e=this;e.renderRequested(),e.serverCall("request").success(function(t){"failed"==t&&e.renderDefault(),"reached"==t&&e.renderDefault()}).error(function(){e.renderDefault()}).liveMutate().send(),s.setQfeedLog(e,"AskToAnswer"),s.setTlog({type:"AskToAnswer",qid:e.qid}),a.logPrimaryAction("AskToAnswer",{type:e.impression_type,hash:e.impression_hash})},renderRequested:function(){
this.$id("@list_item").addClass("is_active"),this.$id("@request_button").addClass("is_active")},renderDefault:function(){this.$id("@list_item").removeClass("is_active"),this.$id("@request_button").removeClass("is_active")}}),t.SuggestionsStandalone=t.Suggestions.extend({onLoad:function(){this.loadSuggestions()}})}),define("unified_view/question/text",["shared/polyfills","shared/core/component","shared/qtext"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/qtext").renderQText;t.QuestionText=n.extend({onLoad:function(){o(this.$id("@question_text"))}})}),define("unified_view/reauth",["shared/polyfills","shared/core/component","shared/events/index","unified_view/modal"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/events/index"),s=e("unified_view/modal").ModalBase;t.ReauthWrapper=n.extend({onLoad:function(){var e=this;this.handleEvent(o.Types.WEBNODE_RPC_EXCEPTION,function(t){"reauth_required"==t.payload.exceptionType&&e.load_reauth(t.payload.requestId);
})},load_reauth:function(e){return this.createModal("load_reauth_modal").kwargs({request_id:e}).show(),!1}}),t.ReauthModal=s.extend({onSubmit:function(e){if(!this.submit_disabled){var t=this,i=t._super,n=function(n){n.login_success?(t.emitEvent({type:o.Types.WEBNODE_RPC_RETRY_FAILED,scope:o.scope.GLOBAL,payload:{requestId:t.request_id}}),i.call(t,e)):t.$id("@password").val("")},s=function(){t.serverCall("load_password_leaked_dialog").contentFor(t.$id("@email_password_leak_error")).success(function(){t.$id("@normal_subtitle").hide(),t.$id("@email_password_leak_error").show(),t.submit_disabled=!0}).send()},a={password:this.$id("@password").val()};this.serverCall("verify").kwargs(a).success(n).except("password_leaked",s).send()}},onLoad:function(){this._super.apply(this,arguments);var e=this;this.$id("@password").focus(),this.$id("@password").on("keypress",function(t){13==t.keyCode&&e.onSubmit()}),this.$id("@create_password").on("click",this.sendResetPasswordEmail.bind(this)),this.$id("@forgot_password").on("click",this.sendResetPasswordEmail.bind(this));
},sendResetPasswordEmail:function(e){e.preventDefault(),this.serverCall("send_reset_password_email").send()}})}),define("unified_view/refresh",["shared/polyfills","shared/core/component","shared/events/index"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/events/index"),s=o.GlobalProxy;t.RefreshFeedButton=n.extend({onLoad:function(){var e=this;e.$refreshButtonWrapper=this.$id("@refresh_wrapper"),s.subscribe(o.Types.DISCOVER_TOOL_CONFIRMED,function(t){e.showRefreshButton()}),e.$id("@refresh").on("click",function(){window.location.href="/"})},showRefreshButton:function(){this.$refreshButtonWrapper.removeClass("hidden")}})}),define("unified_view/repeat_offender",["shared/polyfills","shared/core/component","shared/onload"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/onload");t.RepeatOffenderModalLink=n.extend({onLoad:function(){var e=this;o.execAfterLoad(function(){e.createModal("load_repeat_offender_modal").kwargs({offense_type:e.offense_type,
target_type:e.target_type,level:e.level,anon:e.anon}).webOnlyOptions({closeOnBackgroundClick:!1,closeOnEscape:!1}).onSubmit(function(){e.serverCall("mark_modal_as_read").send()}).show()})}})}),define("unified_view/settings/languages",["shared/polyfills","shared/core/component","unified_view/modal","interface/settings","shared/client"],function(e,t,i){var n=e("shared/core/component").Component,o=e("unified_view/modal").ModalBase,s=e("interface/settings"),a=e("shared/client");if(s.pageIsMobile)var r=e("mobile_app2/client"),d=e("mobile_app2/messages");t.LeaveModalLink=n.extend({onLoad:function(){var e=this;this.$id("@leave_link").on("click",function(){e.openModal()})},openModal:function(){var e=this;e.createModal("load_modal").kwargs({nid:e.nid}).show()}}),t.MakeNetworkDefaultLink=n.extend({onLoad:function(){var e=this;e.$id("@make_default_link").on("click",function(){e.serverCall("set_default_network").liveMutate().send()})}}),t.LeaveNetworkModal=o.extend({onLoad:function(){this._super.apply(this,arguments);
},onSubmit:function(e){var t=this;t.redirectUrl&&(a.isNativeApp()?r.updateConfig(t.redirectSubdomain,t.redirectLanguage):window.location.href=t.redirectUrl),a.isNativeApp()&&d.send("updateSiloSwitcher",t.siloSwitcherData),t.serverCall("leave_network").kwargs({nid:t.nid}).success(function(){t.redirectUrl||t.close()}).liveMutate().send()}})}),define("unified_view/settings/privacy",["shared/polyfills","shared/core/component","interface/settings","w2.modal","settings"],function(e,t,i){var n=e("shared/core/component").Component,o=e("interface/settings").pageIsMobile;if(o)var s=e("mobile_app2/app/view/common"),a=e("mobile_app2/messages"),r=e("settings").interface_strings;else var d=e("w2.modal").ModalWithCallBacks;var l=n.extend({onLoad:function(e){o?this.mobileOnLoad():this.desktopOnLoad(e)},desktopOnLoad:function(){var e=this;this.$id("@check_reauth").on("click",function(t){e.serverCall("check_reauth").success(function(){e.showControl()}).send(),t.preventDefault()})},showControl:function(){
this.$id("@check_reauth").addClass("hidden"),this.$id("@option_control").removeClass("hidden")},showAlert:function(e){var t=this;s.showAlert({title:t.dialog_title,message:t.dialog_message,callback:function(t){0===t.buttonIndex&&e&&e()},cancelButtonTitle:t.dialog_button_title,otherButtonTitles:[r.cancel]})}});t.DeactivateAccountCell=l.extend({desktopOnLoad:function(){this._super.apply(this,arguments);var e=this;this.$id("@deactivate").on("click",function(){var t=new d(e,{});t.onSubmitCallBack(function(){e.deactivateAccount()}),t.load("load_deactivate_account_modal")})},mobileOnLoad:function(){var e=this;this.$id("@deactivate").on("click",function(){e.showAlert(e.deactivateAccount.bind(e))})},deactivateAccount:function(){this.serverCall("deactivate_account").success(function(){o&&a.send("loginStateChanged",{isLoggedIn:!1})}).send()}}),t.DeleteAccountCell=l.extend({desktopOnLoad:function(){this._super.apply(this,arguments);var e=this;this.$id("@delete").on("click",function(){var t=new d(e,{});
t.onSubmitCallBack(function(){e.deleteAccount()}),t.load("load_delete_account_modal")})},mobileOnLoad:function(){var e=this;this.$id("@delete").on("click",function(){e.showAlert(e.deleteAccount.bind(e))})},deleteAccount:function(){var e=this;this.serverCall("delete_account").success(function(){o&&s.showAlert({title:e.dialog_title,message:e.confirmation_dialog_message,callback:function(){a.send("loginStateChanged",{isLoggedIn:!1})}})}).send()}})}),define("unified_view/signup/conversion_logging",["shared/polyfills","shared/core/component","shared/cookies","settings","shared/jquery"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/cookies"),s=e("shared/core/component"),a=e("settings"),r=e("shared/jquery");t.ConversionLogging=n.extend({onLoad:function(){var e=function(e){var t=e.currentTarget,i=t.getAttribute("href");if(i&&"#"!=i){for(var n=s.getComponentFromElement(t),r=[],d=0;3>d&&n&&n.__vcon;d++)r.push(n),n=n.parent();var l=[];for(d=0;d<r.length;d++)l.push(r[d].__vcon[0]);
var c=[];c.push(a.controller),c.push(a.action),c.push(window.location.pathname);var h=c.concat(l);JSON.stringify(h).length<400&&o.setMessage("cl",h)}};r("a").on("click",e)}})}),define("unified_view/signup/oauth",["shared/polyfills","shared/core/component","interface/settings","shared/client"],function(e,t,i){var n=e("shared/core/component").Component,o=e("interface/settings").pageIsMobile,s=e("shared/client");if(o)var a=e("mobile_app2/messages");t.PermissionsMain=n.extend({onLoad:function(){var e=this;this.$id("@accept_button").on("click",function(){e.serverCall("authenticate_user").success(function(e){if(o){var t;t=s.isNativeApp()?"external":null,a.send("openURL",{url:e.location,target:t})}else window.location=e.location}).send()})}})}),define("third_party/smyte",["shared/polyfills","shared/onload"],function(e,t,i){var n=e("shared/onload");t.asyncInit=function(e,t,i){n.execAfterLoadDelayed(function(){!function(e,t,i,n,o){e._smyte=e._smyte||[],n=t.createElement(i),n.async=1,n.src="//ping.smyte.com/p.js",
o=t.getElementsByTagName(i)[0],o.parentNode.insertBefore(n,o)}(window,document,"script"),_smyte.push(["_setClientKey",e]),_smyte.push(["_setSession",{id:t,actor:{id:i,type:"user"}}]),_smyte.push(["_log"])})}}),define("unified_view/smyte",["shared/polyfills","shared/core/component","third_party/smyte"],function(e,t,i){var n=e("shared/core/component").Component;t.SmyteComponent=n.extend({onLoad:function(){e("third_party/smyte").asyncInit(this.api_key,this.session_id,this.uid)}})}),define("unified_view/survey",["shared/polyfills","shared/core/component","unified_view/modal","shared/errors","interface/settings"],function(e,t,i){var n=e("shared/core/component").Component,o=e("unified_view/modal").ModalBase,s=e("shared/errors"),a=e("interface/settings").pageIsMobile;t.SurveyMobileLink=n.extend({onLoad:function(){var e=this;e.$id("@mobile_link").on("click",function(){e.createModal("load_modal").kwargs({survey_id:e.survey_id,extra_data:e.extra_data,actor_id:e.actor_id}).show(),e.$id("@mobile_link").addClass("hidden");
}),e.serverCall("mark_as_seen").kwargs({}).send()}}),t.SurveyMobileLinkLoggedOut=n.extend({onLoad:function(){var e=this;e.$id("@mobile_link").on("click",function(){e.createModal("load_modal").kwargs({survey_id:e.survey_id,extra_data:e.extra_data,uid:e.uid}).show(),e.$id("@mobile_link").addClass("hidden")}),e.serverCall("mark_as_seen").kwargs({}).send()}}),t.SurveyModalWrapper=o.extend({onLoad:function(){this.child("survey_in_modal").onSubmit(this.close.bind(this))}}),t.Survey=n.extend({onLoad:function(){var e=this;e.index=0,e.on_last_question=!1,e.buttons_attached=[],1==e.num_of_questions&&(e.on_last_question=!0),e._bindSurveyCellClickHandler(),e.serverCall("mark_as_seen").kwargs({}).send()},onSubmit:function(e){this.__submitCallback=e},_bindSurveyCellClickHandler:function(){for(var e=this,t=this.children(),i=0;i<t.length;i++){var n=t[i];n.setResponseChangeCallback&&n.setResponseChangeCallback(e._enableButton.bind(e))}},_enableButton:function(e){var t=this;t.buttons_attached[e]||(t.buttons_attached.push(!0),
t.on_last_question?(t.$id("@submit_button_"+e).removeClass("disabled"),t.$id("@submit_button_"+e).on("click",function(){t._cleanupAndSubmit()})):(t.$id("@next_button_"+e).removeClass("disabled"),t.$id("@next_button_"+e).on("click",function(){t._handleNext()})))},_showNextQuestion:function(){var e=this;e.$id("@question_"+e.index).addClass("hidden"),e.index++,e.$id("@question_"+e.index).removeClass("hidden"),e.index+1==e.num_of_questions&&(e.on_last_question=!0)},_handleNext:function(){var e=this;e._recordResponse(!1),e._showNextQuestion()},_cleanupAndSubmit:function(){var e=this;e.$id("@done_message").css("height",e.$id("@survey").css("height")),e.$id("@survey").addClass("survey_fade_out"),setTimeout(function(){e.$id("@survey").addClass("hidden"),e.$id("@done_message").removeClass("hidden"),setTimeout(function(){e.$id("@done_message").css("height",0),e.$id("@done_inner").addClass("hidden"),e.$id("@done_message").addClass("collapse"),e._recordResponse(!0),setTimeout(function(){e.$id("@done_message").addClass("hidden"),
e.__submitCallback&&e.__submitCallback()},200)},2e3)},200)},_recordResponse:function(e){var t=this,i=t.child("answer_section_"+t.index).getResponse();t.serverCall("record_response").kwargs({question_index:t.index,response:i,is_last_question:e}).liveMutate().send()}}),t.ResponseSection=n.extend({setResponseChangeCallback:function(e){var t=this;t.$id("@section").on("click",function(){e(t.index)})},getResponse:function(){var e=this.child("response_type");return e?e.getResponse():(s.logJsError("SurveyResponseSection","A ResponseSection should have a ResponseType in it."),"")}}),t.ResponseType=n.extend({onLoad:function(){var e=this;e.selectedIndex=null,e.$id("@response .survey_cell.radio").on("click",function(t){var i=t.currentTarget.dataset.index;if(null!==e.selectedIndex&&i!=e.selectedIndex){var n=e.getIdForSelection(e.selectedIndex);e.$id(n).removeClass("selected"),e.$id(n).prop("checked",!1)}var o=e.getIdForSelection(i);e.$id(o).addClass("selected"),e.$id(o).prop("checked",!0),e.selectedIndex=i;
})},getIdForSelection:function(e){return a?"@option-"+e:"@value-"+e},getResponse:function(){return this.$id("@value-"+this.selectedIndex).val()}}),t.FreeResponse=t.ResponseType.extend({getResponse:function(){return this.$id("@response .free_response").val()}}),t.MultipleChoiceWithOther=t.ResponseType.extend({getResponse:function(){return this.num_of_options.toString()==this.selectedIndex?"Other: "+this.$id("@other_input").val():this._super()}})}),define("unified_view/translation",["shared/polyfills","shared/core/component","shared/keystrokes"],function(e,t,i){var n=e("shared/core/component").Component;t.TranslationInterfaceToggle=n.extend({onLoad:function(){this._state=!1,this.setupKeyboardShortcut()},toggle:function(){var e,t=this,i=document.getElementsByClassName("translation_interface_info");if(t._state)for(t._state=!1,e=0;e<i.length;e++)i[e].style.display="none";else for(t._state=!0,e=0;e<i.length;e++)i[e].style.display="block"},setupKeyboardShortcut:function(){e("shared/keystrokes").on([76,73,68,76,73,68],this.toggle.bind(this));
}})}),define("unified_view/write/writing_list",["shared/polyfills","shared/core/component","interface/settings","unified_view/modal"],function(e,t,i){var n=e("shared/core/component").Component,o=e("interface/settings").pageIsMobile,s=e("unified_view/modal").ModalBase;if(o)var a=e("mobile_app2/app/view/common");t.RemoveAllWritingListLink=n.extend({onLoad:function(){var e=this;this.$id("@confirmation_dialogue").on("click",function(){if(o){var t=e.alert_data;t.callback=function(t){0===t.buttonIndex&&e.serverCall("remove_all").liveMutate().send()},a.showAlert(t)}else e.showModal();return!1})},showModal:function(){this.createModal("load_modal").show()}}),t.RemoveAllWritingListConfirmationModal=s.extend({onSubmit:function(){var e=this._super.bind(this);this.serverCall("remove_all").success(function(t){e(t)}).liveMutate().send()}})}),define("unified_view/zapdos/wall",["shared/polyfills","shared/core/component","shared/events/index"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/events/index");
t.DialogZapdosFormWrapper=n.extend({onLoad:function(){var e=this;e.scrollToTopAndDisableScroll(),e.$id("@background").on("click",function(){e.dismissZapdosWall()}),e.handleEvent(o.Types.ZAPDOS_WALL_DISMISS,function(t){e.dismissZapdosWall(t.payload.cardType)})},scrollToTopAndDisableScroll:function(){window.scrollTo(0,0),document.body.classList.add("zapdos_wall_prevent_scroll")},dismissZapdosWall:function(e){var t=this;this.serverCall("dismiss_wall").kwargs({card_type:t.card_type}).send(),this.$id("@zapdos_wall_wrapper").removeClass("show"),document.body.classList.remove("zapdos_wall_prevent_scroll")}}),t.ZapdosWallBase=n.extend({onLoad:function(){var e=this;e.serverCall("log_impression").send(),e.$id("@close").on("click",function(){e.dismissWall()})},dismissWall:function(){var e=this;this.emitEvent({type:o.Types.ZAPDOS_WALL_DISMISS,payload:{cardType:e.card_type}})}}),t.CancelWallButton=n.extend({onLoad:function(){var e=this;e.$id("@cancel_link").on("click",function(){e.dismissWall()})},dismissWall:function(){
var e=this;e.emitEvent({type:o.Types.ZAPDOS_WALL_DISMISS,payload:{cardType:e.card_type}})}}),t.ConfirmWallButton=n.extend({onLoad:function(){var e=this;e.$id("@confirm_link").on("click",function(){e.serverCall("confirm_clicked").kwargs({card_type:e.card_type}).send()})}})}),define("unified_view/anon",["shared/polyfills","shared/core/component","unified_view/modal","shared/events/index","shared/window_manager","shared/beforeunload"],function(e,t,i){var n=e("shared/core/component").Component,o=e("unified_view/modal").ModalBase,s=e("shared/events/index"),a=e("shared/window_manager"),r=e("shared/beforeunload");t.AnonQuestionInfoModalLink=n.extend({onLoad:function(){var e=this;e.$id("@create_modal_link").on("click",function(t){t.preventDefault(),e.createInfoModal()}),e.handleEvent(s.Types.ANON_LINK_SAVED,function(){a.removeURLParam("show_alert")}),r.registerHandler(this.beforeUnload.bind(this))},beforeUnload:function(){var e=a.isParamInURL("show_alert");return e?(this.createInfoModal(),!0):void 0;
},createInfoModal:function(){var e=this;e.createModal("load_inner").kwargs({anon_user_content_key:e.anon_user_content_key,target:e.target}).show()}}),t.AnonEmailModalLink=n.extend({onLoad:function(){var e=this;e.$id("@create_modal_link").on("click",function(t){t.preventDefault(),e.createModal("load_inner").kwargs({anon_user_content_key:e.anon_user_content_key,target:e.target}).show()})}}),t.AnonEmailModal=o.extend({onSubmit:function(){var e=this;e.serverCall("email_link").kwargs({anon_user_content_key:e.anon_user_content_key,target:e.target,to_address:e.$id("@email").val()}).success(function(){e.onAnonLinkSaved(),e.onClose()}).send()},onAnonLinkSaved:function(){this.emitEvent({type:s.Types.ANON_LINK_SAVED,scope:s.scope.GLOBAL,payload:{}})}}),t.AnonDestroyModalLink=n.extend({onLoad:function(){var e=this;e.$id("@create_modal_link").on("click",function(t){t.preventDefault(),e.createModal("load_inner").kwargs({anon_user_content_key:e.anon_user_content_key,target:e.target}).show()})}}),t.AnonDestroyModal=o.extend({
onSubmit:function(){var e=this;e.serverCall("destroy_link").kwargs({anon_user_content_key:e.anon_user_content_key,target:e.target}).success(function(e){e&&e.url&&a.navigateTo(e.url)}).send()}}),t.AnonLinkGroup=n.extend({onLoad:function(){var e=this,t=e.$id("@link_input"),i=e.$id("@copy_link");i.on("click",function(n){n.preventDefault(),t.select(),document.execCommand("copy"),i.text(e.translated_copied),e.onAnonLinkSaved()}),t.on("click",function(){t.select(),e.onAnonLinkSaved()})},onAnonLinkSaved:function(){this.emitEvent({type:s.Types.ANON_LINK_SAVED,scope:s.scope.GLOBAL,payload:{}})}})}),define("unified_view/old_anon_content",["shared/polyfills","unified_view/form","interface/settings"],function(e,t,i){var n=e("unified_view/form").Form,o=e("interface/settings").pageIsMobile;t.OldAnonContentEmailForm=n.extend({onLoad:function(){var e=this;e._super.apply(e,arguments),o&&e.$id("@submit").addClass("hidden")},validateFormExtra:function(e){var t,i=this;return i.children().forEach(function(e){
e.getFieldId&&(t=e.getValue())}),i.serverCall("check_validity").kwargs({email:t}).success(function(e){e?i._submitForm():i.serverCall("display_error_message").send()}).liveMutate().send(),!1}})}),define("unified_view/login",["shared/polyfills","unified_view/modal","shared/events/index","unified_view/signup/_signup","interface/settings"],function(e,t,i){var n=e("unified_view/modal").ModalBase,o=e("shared/events/index"),s=e("unified_view/signup/_signup"),a=e("interface/settings").pageIsMobile;if(a)var r=e("mobile_app2/app/view/common");t.SetPasswordForUnconfirmedEmailModal=n.extend({onSubmit:function(){this.$id("@email_password_leak_error").hide(),this.serverCall("on_password_set").kwargs({password:this.$id("@password").val()}).success(this.passwordSetCallback.bind(this)).send()},onLoad:function(){this._super.apply(this,arguments),s.hideSignupWall();var e=this;this.$id("@password").focus(),this.$id("@password").on("keypress",function(t){13==t.keyCode&&e.onSubmit()})},onClose:function(){s.loadSignupWall(),
this._super.apply(this,arguments)},passwordSetCallback:function(e){e.success?this.emitEvent(o.helpers.loginUser()):e.error_message&&a&&r.showAlert({title:e.error_message})}})}),define("unified_view/sharethis",["shared/polyfills","shared/core/component"],function(e,t,i){var n=e("shared/core/component").Component;t.SharethisImageTracker=n.extend({onLoad:function(){var e=this;e.image_source&&setTimeout(function(){e.delayedImageTracker()},500)},delayedImageTracker:function(){var e=new Image;e.src=this.image_source}})}),define("unified_view/main",["shared/polyfills"],function(e,t,i){}),define("view/announcement",["shared/polyfills","shared/core/component"],function(e,t,i){var n=e("shared/core/component").Component;t.Announcement=n.extend({onLoad:function(){var e=this;this.$id("@close").click(function(){return e.closeAnnouncement("x"),!1}),this.serverCall("track_announcement_view").send()},closeAnnouncement:function(e){this.serverCall("close_announcement").kwargs({closing_action:e}).liveMutate().send();
}})}),define("view/board_selector",["shared/polyfills","view/selector"],function(e,t,i){var n=e("view/selector").Selector,o=e("view/selector").SelectorWithTypeaheadLogMixin;t.BoardSelector=n.extend(o).extend({onLoad:function(){var e=this;this._super.apply(this,arguments),e.$input_wrapper=e.$id("@input_wrapper"),e.$selected_board_wrapper=e.$id("@selected_board_wrapper"),e.$new_board_name_wrapper=e.$id("@new_board_name_wrapper"),e.$new_board_name=e.$id("@new_board_name");var t=function(t){t.preventDefault(),t.stopPropagation(),e.clear(),e.$input.focus()};e.$selected_board_wrapper.click(t),e.$new_board_name_wrapper.click(t)},shouldTypeaheadLog:function(e){var t=this.child("results");return!!e&&"board"===e.ty&&!!t.typeahead_log_data},resultWasSelected:function(e,t){this._super.apply(this,arguments);var i=this;"board"===e.ty?(i.selected_board={name:null,bid:e.data.bid,is_submission:!!e.data.is_submission},i.serverCall("update_selected_board").kwargs({bid:e.data.bid}).contentFor(i.$selected_board_wrapper).success(function(){
i.$wrapper.focusout(),i.$input_wrapper.addClass("hidden"),i.$new_board_name_wrapper.addClass("hidden"),i.$selected_board_wrapper.removeClass("hidden")}).send()):"additem"===e.ty?(this.selected_board={name:i.query,bid:null,is_submission:!1},i.$new_board_name.text(i.query),i.$wrapper.focusout(),i.$input_wrapper.addClass("hidden"),i.$selected_board_wrapper.addClass("hidden"),i.$new_board_name_wrapper.removeClass("hidden")):console.assert(!1)},clear:function(){this.setQuery(""),this.$input_wrapper.removeClass("hidden"),this.$selected_board_wrapper.addClass("hidden"),this.$selected_board_wrapper.empty(),this.$new_board_name_wrapper.addClass("hidden"),this.$new_board_name.empty(),this.selected_board=null}})}),define("view/captcha",["shared/polyfills","shared/recaptcha","shared/events/index","shared/core/component","view/modal"],function(e,t,i){var n=e("shared/recaptcha"),o=e("shared/events/index"),s=e("shared/core/component").Component,a=e("view/modal").Base;t.Captcha=s.extend({onLoad:function(){
var e=this;this.handleEvent(o.Types.WEBNODE_RPC_EXCEPTION,function(t){"captcha_required"==t.payload.exceptionType&&e.load_captcha()})},load_captcha:function(){return this.createModal("load_captcha_modal").show(),!1}}),t.CaptchaModal=a.extend({onLoad:function(){this._super.apply(this,arguments);var e=this,t=function(){e.serverCall("on_captcha_verified").liveMutate().success(function(){e._closeModal()}).send()};n.onInit(function(){grecaptcha.render(e.$id("@captcha")[0],{sitekey:e.recaptcha_key,theme:"light",callback:t})})}})}),define("view/datetime_",["shared/polyfills","shared/core/component"],function(e,t,i){var n=e("shared/core/component").Component,o=null,s={};t.CountdownClock=n.extend({onLoad:function(){var e=this,t=e.$id("@countdown");null===o&&(o=setInterval(function(){var e=!0;for(var t in s)s.hasOwnProperty(t)&&(e=!1,s[t]());e&&(clearInterval(o),o=null)},200)),s[e.cid]=function(){var i,n=Math.floor(Date.now()/1e3),o=e.getTimeDifference(n),a=Math.floor(o/60%60),r=Math.floor(o/3600),d=Math.floor(o%60);
if(e.should_pad_zeroes){var l=function(e){var t=e.toString();return t.length>1?t:"0"+t};a=l(a),d=l(d)}i=e.template.replace("{hrs}",r).replace("{mins}",a).replace("{secs}",d),e.text!==i&&(e.text=i,t.text(i)),e.hasExpired(n)&&delete s[e.cid]}},onUnload:function(){delete s[this.cid]},getTimeDifference:function(e){return Math.max(this.expires_secs-e,0)},hasExpired:function(e){return e>this.expires_secs}}),t.TimeElapsedClock=t.CountdownClock.extend({getTimeDifference:function(e){return Math.max(e-this.expires_secs,0)},hasExpired:function(e){return!1}})}),define("view/embed",["shared/polyfills","shared/core/component","shared/jquery"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/jquery");t.ExternalEmbed=n.extend({onLoad:function(e){var t=this;this.$id("@embed_logo").mouseover(function(){t.$id("@embed_logo").css({"background-position":"0 -20px"}).animate({right:"0px"},80)}),this.$id("@external_embed_wrapper").on("mousedown",'a[href!="#"]',function(e){var t=o(e.currentTarget);
t.attr("target","_blank")})}})}),define("view/filter_nav_list",["shared/polyfills","shared/core/component","shared/jquery","shared/events/index","shared/window_manager"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/jquery"),s=e("shared/events/index"),a=e("shared/window_manager");t.FilterNavListItem=n.extend({onLoad:function(){var e=this;this.$id("@item").on("click",function(){var t=o(this);if(t.hasClass("selected"))return!1;var i=t.attr("data-value");return e.updateDataAndReloadList(e.data_key,i),!1})},updateDataAndReloadList:function(e,t){var i=a.parseURLParams(window.location.search.substring(1).replace(/\+/g,"%20"));i[e]=t;for(var n in i)("all"===i[n]||""===i[n])&&delete i[n];var s=o.param(i);window.location=window.location.pathname+"?"+s}}),t.FilterMultipleValuesNavListBase=n.extend({onLoad:function(){var e=this;this.handleEvent(s.Types.FILTER_NAV_LIST_UPDATE,function(t){t.payload.key==e.data_key&&t.payload.remove&&e.removeFilterFromKey(t.payload.remove)})},
updateDataAndReloadList:function(e){var t=o.param(e);window.location=window.location.pathname+"?"+t},addFilterToKey:function(e){var t=this.data_key,i=a.parseURLParams(window.location.search.substring(1).replace(/\+/g,"%20")),n=[];if("followed"==i[t]&&delete i[t],i[t]&&(n=i[t].split(" ")),0===n.length)i[t]=e;else{n.push(e);var o=n.join(" ");i[t]=o}this.updateDataAndReloadList(i)},removeFilterFromKey:function(e){var t=this.data_key,i=a.parseURLParams(window.location.search.substring(1).replace(/\+/g,"%20")),n=i[t].split(" "),o=n.indexOf(e);if(o>-1){n.splice(o,1);var s=n.join(" ");i[t]=s}for(var r in i)("all"===i[r]||""===i[r])&&delete i[r];this.updateDataAndReloadList(i)}}),t.FilterMultipleValuesNavListItemBase=n.extend({onLoad:function(){var e=this;this.$id("@remove").click(function(){return e.emitEvent({type:s.Types.FILTER_NAV_LIST_UPDATE,payload:{key:e.data_key,remove:e.filter_value.toString()}}),!1})}})}),define("view/filterable_list",["shared/polyfills","shared/core/component"],function(e,t,i){
var n=e("shared/core/component").Component;t.FilterableList=n.extend({onLoad:function(){this.lastQuery=null,this.delay=100;var e=this;this.$id("@search").keyup(function(){var t=function(t){e.fetchResults(t)};setTimeout(t,e.delay,e.$id("@search").val())}),this.$id("@search_link").click(function(){return e.$id("@search_link").hide(),e.$id("@bullet").hide(),e.$id("@search").show().focus(),e.$id("@after_search").show().focus(),e.$id("@search_row").show().focus(),!1})},newQueryEntered:function(e){},fetchResults:function(e){var t=this;e==this.$id("@search").val()&&e!=this.lastQuery&&(e&&""!==e&&e!=this.lastQuery?(this.serverCall("search_results").kwargs({query:e}).contentFor(this.$id("@search_results"),{useLoadingSpinner:!1}).success(function(){var e=t.$id("@search").val();e&&""!==e?(t.$id("@search_results").show(),t.$id("@default").hide()):(t.$id("@search_results").hide(),t.$id("@default").show())}).send(),this.lastQuery=e,this.newQueryEntered(e)):""===e&&(this.$id("@search_results").hide(),
this.$id("@default").show()))}})}),define("view/fixable_component",["shared/polyfills","shared/core/component","view/fixable2"],function(e,t,i){var n=e("shared/core/component").Component,o=e("view/fixable2");t.FixableComponent=n.extend({onLoad:function(){var e=this.$id("@fixable_component");o.makeFixable(e.parent(),this.options),e.remove()}})}),define("view/follower_list",["shared/polyfills","shared/core/component"],function(e,t,i){var n=e("shared/core/component").Component;t.FollowerListModalLink=n.extend({onLoad:function(){var e=this;this.$id("@modal_link").click(function(){return e.createModal("load_inner").kwargs({object_id:e.object_id}).show(),!1})}})}),define("view/invisibleinfo",["shared/polyfills","shared/core/component","shared/keystrokes","shared/jquery"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/keystrokes"),s=e("shared/jquery");t.InfoToggle=n.extend({onLoad:function(){this._state=!1,this.setupKeyboardShortcut()},toggle:function(){this._state?(this._state=!1,
s(".invisible_info").hide()):(this._state=!0,s(".invisible_info").show())},setupKeyboardShortcut:function(){o.on([81,73,68,81,73,68],this.toggle.bind(this))}})}),define("view/link_selector",["shared/polyfills","view/selector"],function(e,t,i){var n=e("view/selector").Selector,o=e("view/selector").SelectorWithTypeaheadLogMixin;t.LinkSelector=n.extend(o).extend({onLoad:function(){this._super.apply(this,arguments);var e=this;e.$id("@input").keydown(function(){return e._escKeyDown?e._escKeyDown.apply(this,arguments):void 0}),e.$id("@input").keyup(function(t){return e._keyUp?e._keyUp.apply(this,arguments):void 0})},setEscKeyDown:function(e){this._escKeyDown=e},setKeyUp:function(e){this._keyUp=e}})}),define("view/photo",["shared/polyfills","shared/core/component","w2.dialog","shared/cookies"],function(e,t,i){var n=e("shared/core/component").Component,o=e("w2.dialog"),s=e("shared/cookies");t.InlinePhotoEditor=n.extend({onLoad:function(){var e=this;this.$id("@x_photo").click(function(){return o.createDialog(e).title(e.dialog_title).cancel(null,e.close_button_text).ok(function(){
e.serverCall("remove_photo").send()},e.dialog_button_text).html(e.dialog_message),!1}),e.whenOnLoaded(function(){e.$id("@photo").hover(function(){e.$id("@edit").toggleClass("hidden"),e.$id("@x_photo").toggleClass("hidden")})})}}),t.BoardPhoto=n.extend({onLoad:function(e){var t=this;this.$id("@link").mousedown(function(){s.setQfeedLog(t,"BoardClickthrough"),s.setQueryLog(t,"BoardClickthrough")})}}),t.TopicPhoto=n.extend({onLoad:function(e){var t=this;this.$id("@link").mousedown(function(){s.setQfeedLog(t,"TopicClickthrough"),s.setQueryLog(t,"TopicClickthrough")})}})}),define("view/placepicker",["shared/polyfills","shared/core/component","shared/jquery","shared/loadjs","shared/util","w2.dialog","shared/window_manager","settings"],function(e,t,i){function n(e){c?e():(p(),h.push(e))}var o=e("shared/core/component").Component,s=e("shared/jquery"),a=e("shared/loadjs").loadJS,r=e("shared/util"),d=e("w2.dialog"),l=e("shared/window_manager"),c=!1,h=[],u=e("settings").interface_strings,p=r.once(function(){
var e="//maps.googleapis.com/maps/api/js?sensor=false&libraries=places";a(e,function(){for(c=!0;h.length;)h.pop().call()})});t.PlacePicker=o.extend({onLoad:function(){n(this.onLoadBase.bind(this))},onLoadBase:function(){var e=this;this.address=this.default_location,this.initializeGoogleMaps(),this.mutable===!0&&(this.$id("@edit_map").click(function(){return e.toggleEditor(),!1}),this.$id("@change_location").click(function(){if(e.place||e.marker){e.$id("@search_text_field").blur();var t,i;if(e.map.getBounds().contains(e.marker.getPosition())?(t=e.marker.getPosition().lat(),i=e.marker.getPosition().lng()):(t=e.map.getCenter().lat(),i=e.map.getCenter().lng()),!e.place){var n=new google.maps.LatLng(t,i),o=new google.maps.Geocoder;o.geocode({location:n},function(t,i){if(i==google.maps.GeocoderStatus.OK&&t.length){var n=t[0];e.radius=e.computeRadius(n.geometry.viewport),e.setAddress(n.address_components)}})}var a=s.trim(e.$id("@search_text_field").val());e.serverCall("place_changed").kwargs({
radius:e.radius,reference:e.place&&e.place.reference||e.reference,lat:t,lng:i,viewport:{zoom:e.map.getZoom(),mapTypeId:e.map.getMapTypeId(),icon:e.place&&e.place.icon,tilt:e.map.getTilt(),heading:e.map.getHeading()},address:a.length?a:e.address}).success(function(){e.default_location.hasLocation=!0}).send()}else e.$id("@search_text_field").focus()}),this.$id("@edit").click(function(){return e.toggleEditor(),!1}),this.$id("@add").click(function(){return e.reinitializeMap(),!1}),this.$id("@clear").click(function(){return d.createDialog(e).title(e.dialog_title).cancel(null,u.cancel).ok(function(){e.serverCall("place_cleared").success(e.toggleEditor.bind(e)).send()},e.dialog_title).html(e.dialog_message),!1}),this.$id("@close").click(function(){return e.toggleEditor(),e.initializeGoogleMaps(),e.default_location.hasLocation===!1&&e.$id("@map_wrapper").hide(),!1}),"#editlocation"==l.getHash().substr(0,13)&&this.reinitializeMap())},initializeGoogleMaps:function(){n(this.initializeGoogleMapsBase.bind(this));
},initializeGoogleMapsBase:function(){var e=this;this.mapOptions={center:window.google&&google.maps&&new google.maps.LatLng(this.default_location.latitude,this.default_location.longitude),zoom:this.viewport&&this.viewport.zoom||7,mapTypeId:this.viewport&&this.viewport.mapTypeId||window.google&&google.maps&&google.maps.MapTypeId.ROADMAP||"roadmap",tilt:this.viewport&&void 0!==this.viewport.tilt&&this.viewport.zoom>=18?this.viewport.tilt:45,heading:this.viewport&&this.viewport.heading,streetViewControl:!this.mutable};var t=this.viewport&&this.viewport.icon;if(this.static_map===!0){var i="//maps.googleapis.com/maps/api/staticmap?center="+encodeURIComponent(this.default_location.latitude+","+this.default_location.longitude)+"&zoom="+encodeURIComponent(this.mapOptions.zoom)+"&size="+encodeURIComponent(this.size.width+"x"+this.size.height)+"&maptype="+encodeURIComponent(this.mapOptions.mapTypeId)+"&markers="+encodeURIComponent("icon:"+t+"shadow:false|"+this.default_location.latitude+","+this.default_location.longitude)+"&sensor=false",n=s('<img src="'+i+'" />');
return void this.$id("@map_canvas").replaceWith(n)}if(this.map=new google.maps.Map(this.$id("@map_canvas").get(0),this.mapOptions),(this.simple_view===!0||this.mutable===!0)&&this.toggleControls(!1),this.default_location.hasLocation!==!1&&this.updateMarker(t,this.mapOptions.center,this.default_text),this.mutable===!0&&this.toggleDraggable(!1),this.mutable===!0){var o=this.$id("@search_text_field").get(0),a=new google.maps.places.Autocomplete(o);a.bindTo("bounds",this.map),google.maps.event.addListener(a,"place_changed",function(){e.infowindow&&e.infowindow.close(),e.place=a.getPlace(),e.place.geometry.viewport?(e.map.fitBounds(e.place.geometry.viewport),e.radius=e.computeRadius(e.place.geometry.viewport)):(e.map.setCenter(e.place.geometry.location),e.map.setZoom(17),e.radius=30),e.setAddress(e.place.address_components),e.updateMarker(e.place.icon,e.place.geometry.location)}),google.maps.event.addListener(this.map,"click",function(t){if(e.getControlState()){var i=t.latLng;e.radius=e.computeRadius(e.map.getBounds()),
e.handleMarkerReposition(i),e.updateMarker(null,i)}})}},setAddress:function(e){var t=this;if(this.address="",e){this.address=[e[0]&&e[0].short_name||"",e[1]&&e[1].short_name||"",e[2]&&e[2].short_name||""],this.address[1]==this.address[2]&&this.address.splice(2,1),this.address[0]==this.address[1]&&this.address.splice(1,1);var i="";s.each(this.address,function(e,n){i+=n,/^[0-9]+$/.test(n)?i+=" ":e!=t.address.length-1&&(i+=", ")}),this.address=i}},reinitializeMap:function(){var e=this;this.$id("@map_wrapper").show(0,function(){e.initializeGoogleMaps(),e.toggleEditor(),e.$id("@search_text_field").focus()})},toggleEditor:function(){this.$id("@view").toggle(),this.$id("@editor").toggle(),this.$id("@edit_map").toggle(),this.toggleDraggable(),this.toggleControls()},getControlState:function(){return!!this.mapOptions.mapTypeControl},toggleControls:function(e){n(this.toggleControlsBase.bind(this,e))},toggleControlsBase:function(e){var t=void 0!==e?e:!this.getControlState();this.mapOptions.mapTypeControl=t,
this.mapOptions.panControl=t,this.mapOptions.zoomControl=t,this.mapOptions.scaleControl=t,this.mapOptions.rotateControl=t,this.mapOptions.overviewMapControl=t,this.map.setOptions(this.mapOptions)},toggleDraggable:function(e){n(this.toggleDraggableBase.bind(this,e))},toggleDraggableBase:function(e){this.mapOptions.draggable=void 0!==e?e:!this.mapOptions.draggable,this.mapOptions.draggable?(this.mapOptions.minZoom=void 0,this.mapOptions.maxZoom=void 0,this.marker&&this.marker.setDraggable(!0)):(this.mapOptions.minZoom=this.map.getZoom(),this.mapOptions.maxZoom=this.map.getZoom(),this.marker&&this.marker.setDraggable(!1)),this.map.setOptions(this.mapOptions)},updateMarker:function(e,t){n(this.updateMarkerBase.bind(this,e,t))},updateMarkerBase:function(e,t){var i=this;this.marker&&this.marker.setMap(null);var n=new google.maps.MarkerImage(e||"//maps.gstatic.com/mapfiles/place_api/icons/geocode-71.png",new google.maps.Size(40,40),new google.maps.Point(0,0),new google.maps.Point(20,40),new google.maps.Size(40,40));
this.marker=new google.maps.Marker({clickable:!0,draggable:this.mapOptions&&this.mapOptions.draggable,icon:n,map:this.map,position:t}),google.maps.event.addListener(this.marker,"dragend",function(e){var t=e.latLng;i.handleMarkerReposition(t)}),this.updateInfoWindow(t)},handleMarkerReposition:function(e){n(this.handleMarkerRepositionBase.bind(this,e))},handleMarkerRepositionBase:function(e){var t=this;this.place=null,window.setTimeout(function(){t.map.panTo(e)},1e4);var i=new google.maps.Geocoder;i.geocode({location:e},function(i,n){if(n==google.maps.GeocoderStatus.OK&&i.length){var o=i[0];t.radius=t.computeRadius(o.geometry.viewport),t.setAddress(o.address_components),t.updateInfoWindow(e)}})},updateInfoWindow:function(e){n(this.updateInfoWindowBase.bind(this,e))},updateInfoWindowBase:function(e){var t=this;this.infowindow&&this.infowindow.close(),this.address&&this.address.length&&(this.infowindow=new google.maps.InfoWindow({content:this.address,position:e}),google.maps.event.addListener(this.marker,"click",function(){
t.infowindow.open(t.map,t.marker)}))},computeRadius:function(e){var t=e.getNorthEast(),i=e.getSouthWest(),n=t.lat(),o=i.lat();return Math.floor(111045*Math.abs(n-o)/2)}})}),define("view/suggested_edits",["shared/polyfills","shared/core/component","shared/events/index"],function(e,t,i){var n=e("shared/core/component").Component,o=e("shared/events/index");t.SuggestedEditBar=n.extend({toggleButtons:function(){this.$id("@suggested_answer_buttons").toggleClass("hidden")}}),t.SuggestedEditButtons=n.extend({onLoad:function(){var e=this;e.$id("@view_original").click(function(){return e.content_type?e.emitEvent(o.helpers.inlineEditorToggle(e.content_type,e.object_id)):e.parent().parent().toggleSuggestion(),!1}),e.content_type&&e.$id("@edit_suggestion").on("click",function(){return e.emitEvent(o.helpers.inlineEditorEdit(e.content_type,e.object_id)),!1})}})}),define("view/tooltip",["shared/polyfills","shared/core/component","tooltip"],function(e,t,i){var n=e("shared/core/component").Component,o=e("tooltip");
t.TooltipComponent=n.extend({onLoad:function(){var e=this.$id("@tooltip");o.attach(e.parent(),this.options.contents,this.options),e.remove()}})}),define("view/user",["shared/polyfills","shared/core/component","view/hover_menu","tooltip","shared/cookies"],function(e,t,i){var n=e("shared/core/component").Component,o=e("view/hover_menu").HoverMenu,s=e("tooltip"),a=e("shared/cookies");t.Name=o.extend({onLoad:function(e){var t=this;this._super.apply(this,arguments),this.$id("@name_link").mousedown(function(){a.setQfeedLog(t,"UserClickthrough"),a.setQueryLog(t,"UserClickthrough")})}}),t.UserPhoto=n.extend({onLoad:function(e){var t=this;this.$id("@link").mousedown(function(){a.setQfeedLog(t,"UserClickthrough"),a.setQueryLog(t,"UserClickthrough")})}}),t.TopAskerIcon=n.extend({onLoad:function(){s.attach(this.$id("@icon"),this.tooltip_text)}})}),define("view/voter_list",["shared/polyfills","shared/core/component"],function(e,t,i){var n=e("shared/core/component").Component;t.VoterListModalLink=n.extend({
onLoad:function(){var e=this;this.$id("@modal_link").click(function(){return e.createModal("load_inner").kwargs({object_id:e.object_id}).show(),!1})}})}),require.whenReady(["shared/polyfills","third_party/json2","shared/log","shared/beforeunload","w2.errors","init","shared/init","shared/w2.timing"],function(){require("third_party/json2"),require("shared/log"),require("shared/beforeunload"),require("w2.errors"),require("init"),require("shared/init"),window.log&&window.log.enabled&&window.log("main","main is loaded."),require("shared/w2.timing").logTime("mainScriptEnd")}),define("shared/main-loaded",["shared/polyfills"],function(e,t,i){});
